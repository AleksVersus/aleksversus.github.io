QSP-Game Загрузчик. По сути эта локация помогает выбрать плеер
# [launcher]
!!! ДЛЯ РАЗРАБОТЧИКОВ. ВНИМАНИЕ!!! В релизной версии игры удалено большинство комментариев
! если вы хотите понимать, как работает игра, и что за что тут отвечает,
! пройдите по ссылке https://github.com/AleksVersus/merphy_law и скачайте исходники игры
! из папки game/[source]
killall
usehtml=1
$onnewloc='onNewLoc'
$onobjsel='onObjSel'
$ongsave='onGameSave'
$ongload='onGameLoad'
$usercom='uc'
debug=1
showinput 0
$AVS_PLAYERTYPE+=$func('player.prv')
if instr($AVS_PLAYERTYPE,'[qSpider]')<>0:
	fsize=16
else
	fsize=12
end
gosub 'set.Screen','обложка.чёрный'
'<qhtml>
<center><table border=0><tr name=заголовок><td align=center><font color=#dddd00>ОЛЬГА ГОЛОТВИНА<br><font size=+3>ВЕРЕНИЦА МИРОВ</font><br>или<br><font size=+3>ВЫВОДЫ ИЗ ЗАКОНА МЕРФИ</font></font><br><font size=-3>Книга-игра</font></td></tr><tr name=text><td align=right>

<center><font color=#008888>Каким плеером вы пользуетесь?</font></center>
</td></tr><tr name=link><td align=center><a href="exec:goto ''[start]''" class="plain">Версия для компьютера</a>

<a href="exec: $AVS_PLAYERTYPE+=''[MINI]'' & goto ''[start]''" class="plain">Версия для мобильника</a></td></tr></table></center>
</qhtml>'
--- [launcher] ---------------------------------

QSP-Game локация, рассказывающая о текущей версии порта книги-игры
# [1.0_about]
$fname = "Courier New"
$args['head.floor1']='Несколько слов о текущем порте'
$args['version']='Версия: 3.2'
$args['resolution']='Предпочтительное разрешение экрана не менее 740х535.'
$args['href.back']='<a href="exec:goto ''[start]''" id="back_href" class="plain">&lt;&nbsp;назад</a>'
if $AVS_PLAYERTYPE['size']='MINI' or $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
	$args['save.about']='В ключевых моментах игра ведёт автоматическое сохранение в первый слот.'
else
	$args['save.about']='В ключевых моментах игра ведёт автоматическое сохранение в папку "save".'
end
$args['p.1']='Книга-игра Ольги Голотвиной "Вереница миров" попала ко мне в руки в виде fb2-документа. Играть в неё очень просто, но (хотя в fb2-версии переходы между главами происходят при помощи гиперссылок) книга проигрывает в динамике из-за необходимости "бросать кубик" и вести записи по количеству предметов, очков и проч. Подобные действия отнимают много времени, а значит и продвижение по сюжету происходит очень медленно. К тому же в случае проигрыша, не всегда можно вернуться на несколько страниц назад и вспомнить, какое состояние у вас тогда было. Всё это, на самом деле, требует автоматизации.'
$args['p.2']='Книги-игры, подобные этой, меня всегда удручали именно необходимостью вести записи и пребывать в постоянном сражении с собственной совестью и ленью. Совесть твердит, что я должен быть ответственным и соблюдать все правила игры, иначе смысла играть нет; а лень предпочитает не ходить в заведомо опасный райончик, чтобы не переигрывать заново, чтобы не вспоминать о состоянии рессурсов на момент выбора, чтобы продвигаться по сюжету хоть сколь-нибудь быстро.'
$args['p.3']='Поэтому-то я и решил портировать игру в электронный вид.'
$args['p.4']='Портирование слегка изменило управление в книге-игре. Нет-нет, перемещения по-прежнему выполняются при помощи гиперссылок, однако теперь у вас есть и возможность пролистать главы назад. Причём при пролистывании глав в обратном направлении откатывается и состояние ваших рессурсов. Т.е. если вы растеряли все заряды бластера к нужному месту, вы вполне можете пролистать главы назад и пройти участок книги снова, не теряя зарядов. Вы так же можете сохраняться в любом месте, чтобы возобновить игру тогда, когда вам будет удобно.'
$args['p.5']='Предметы, которые вы можете подобрать с локации, будут записаны в самом низу листа, или непосредственно в тексте.'
$args['p.6']='Подсчёт ваших очков и характеристик происходит автоматически, записывать ничего не нужно. Если есть желание рисовать карту - рисуйте. Все броски кубиков выполняются автоматически, автоматически же происходит вычитание и прибавление очков. Если по текущим очкам вы погибли - вас перекинет на локацию смерти.'
$args['p.7']='Весь текст оригинала сохранён, за исключением некоторых случаев. Изменённый или добавленный текст выделен особо. Правила игры вынесены в раздел "Об игре" и рекомендованы к прочтению. Они не изменены ни на слово, но всегда имейте ввиду, что эти правила писались для fb2-версии.'
$args['p.8']='Авторские права на игру принадлежат, естественно, Ольге Голотвиной. Порт распространяется бесплатно и в ознакомительных целях, поэтому если вам понравилась книга-игра, поддержите её автора - Ольгу Голотвину. Где её искать, вам подскажет интернет.'
$args['p.9']='Данная версия книгры разрабатывалась для плеера QSP версии 5.7.0. Нормальная работа на плеерах иных версий не гарантируется. Обо всех найденных ошибках сообщать на aleksversus@mail.ru или на форум qsp.su в соответствующей теме, скриншоты (или подробные описания) ошибок приветствуются.'
$args['p.10']='Приятного времяпровождения.'
$args['postscript']='С уважением,<br>Aleks Versus.'
$args['href.back.1']='<a href="exec:goto ''[start]''" id="back_href_1" class="plain">&gt; Вернуться в главное меню</a>'
$args['p.11']='Большое спасибо всем, кто так или иначе способствовал созданию и улучшению электронной версии книги.'
$args['p.12']='В частности, <span class="yello_text">Ольге Владимировне Голотвиной</span> - автору «Вереницы...», за то, что создала эту интересную и весёлую игру, а так же за то, что позволила мне опубликовать порт; Нексу (<span class="yello_text">Nex</span>) - вечному хранителю платформы, за советы, за бесконечный энтузиазм и отрезвляющие умозаключения (ну и за многое другое, всего не перечислишь); Господину Леосану (<span class="yello_text">Leosan</span>) за великолепные критические замечания и общий тест книги-игры, а так же за то, что обнаружил мои сокрушительные ляпы; всему сообществу QSP, кто вольно или невольно поспособствовал появлению этого порта: <span class="yello_text">RomaDova</span>, <span class="yello_text">Oliver</span>, <span class="yello_text">Ajenta</span>, <span class="yello_text">Storm</span>, <span class="yello_text">Mioirel</span>, <span class="yello_text">Casralis</span> и другие (простите, кого не упомянул).'
$args['p.13']='Благодарю сообщество <span class="yello_text">quest-book.ru</span> за посильную помощь в официальной публикации книги-игры. <span class="yello_text">Jumanjee</span>, <span class="yello_text">Таро</span>, <span class="yello_text">Maltiez</span>, <span class="yello_text">Arven</span>, спасибо вам.'
$args['p.14']='Ну и спасибо моим друзьям и родным, которые находили в себе силы не отвлекать меня в часы кропотливой и страстной работы. :)'
$args['p.15']='Страница с онлайн-версией игры всегда доступна по ссылке: <a href="https://aleksversus.github.io/merphy_law/">aleksversus.github.io/merphy_law</a>'
$args['p.16']='Страница проекта, где вы можете найти исходный код игры на QSP: <a href="https://github.com/AleksVersus/merphy_law">github.com/AleksVersus/merphy_law</a>'
$args['p.17']='Если есть желание поддержать другие мои проекты,<br>есть патреон: <a href="https://www.patreon.com/aleksversus">patreon.com/aleksversus</a>;<br>есть бусти: <a href="https://boosty.to/aleksversus">boosty.to/aleksversus</a>;<br>есть donation-alerts: <a href="https://www.donationalerts.com/r/aleksversus">donationalerts.com/r/aleksversus</a>.'
$args['head.floor2.1']='Исправления в версии 1.0:'
$args['li.01.1']='переходы между мирами осуществляются автоматически со случайным вбросом в непосещённые миры. Таким образом нет необходимости посещать параграфы с выбором следующего мира. Эти параграфы исключены.'
$args['li.01.2']='выбор начальных характеристик предоставлен игроку. Можно выбрать вручную именно тот набор, который вам больше нравится. Числа удачи и неудачи генерируются автоматически.'
$args['li.01.3']='предисловие разбито на 8 страниц, но организовано на одной локации. Введены колонтитулы. Номера параграфов указываются в колонтитулах. В заголовке указывается текущий мир.'
$args['li.01.4']='Поскольку слова «бластер» и «браслет» являются анаграммами друг друга, браслет назван коммуникатором, по своим функциям.'
$args['li.01.5']='исправлена ошибка, приводившая к перемещению на пункт 593 вместо 539 при проверке удачи.'
$args['li.01.6']='введены настройки, позволяющие изменить цвет гиперссылок. Доступны четыре цвета.'
$args['li.01.7']='исправлены ошибки в работе кнопки «Назад».'
$args['li.01.8']='изменены тексты описания при проверке удачи в связи с введением в игру модификатора вероятностей.'
$args['li.01.9']='исправлена ошибка на локации 105, где были перепутаны номера параграфов.'
$args['li.01.10']='исправлена ошибка, приводившая к переходу на новый параграф при сбросе и поднятии пояса.'
$args['li.01.11']='исправлена ошибка, делавшая параграф 599 непроходимым.'
$args['li.01.12']='исправлен неправильный переход с параграфа 53.'
$args['li.01.13']='исправлены неверные переходы с параграфов, на которых происходили сражения с вариантом предпоражения.'
$args['li.01.14']='изменён алгоритм описания сражения. Составлены описания схваток с муравьями и кустом-хищником.'
$args['head.floor2.2']='Исправления в версии 1.1:'
$args['li.02.1']='Исправлен недочёт, в результате которого на экране во время боя не отображалась информация о смерти героя.'
$args['li.02.2']='Исправлен досадный баг в параграфе 646. Спасибо <span class="yello_text">Alterlimbus</span>''у'
$args['li.02.3']='Исправлен наконец-то номер версии в заголовке данной страницы :)'
$args['li.02.4']='Добавлена кнопка «Назад» в шапку разделов «об игре» и «о текущей версии»'
$args['li.02.5']='Убран текст о пересчёте параграфа из описания локации 253. Спасибо <span class="yello_text">Leosan</span>''у'
$args['li.02.6']='Исправлен текст описания в локации 545. Убраны лишние ссылки. Спасибо <span class="yello_text">Leosan</span>''у'
$args['li.02.7']='Закрыт не закрытый div в локации 546. Спасибо <span class="yello_text">Leosan</span>''у'
$args['li.02.8']='Исправлены косячные переходы в 190. Спасибо <span class="yello_text">Leosan</span>''у'
$args['li.02.9']='Исправлено описание лечебной пасты. Спасибо <span class="yello_text">Leosan</span>''у'
$args['li.02.10']='Подкостылены «странности» предисловия при возврате. Спасибо <span class="yello_text">Leosan</span>''у'
$args['head.floor2.3']='Изменения и исправления в версии 2.0:'
$args['li.03.1']='Игра адаптирована под Quest Navigator. Огромное спасибо за помощь в адаптации <span class="yello_text">Storm</span>''у. А так же всем участникам беседы в теме обсуждения Quest Navigator для Windows на форуме qsp.su.'
$args['li.03.2']='Сконструирован лаунчер, предлагающий игроку перед началом игры выбрать плеер, которым игрок пользуется. Лаунчер может порекомендовать игроку, вариант игры для какого именно плеера ему следует выбрать. К сожалению сам лаунчер не умеет выбирать плеер.'
$args['li.03.3']='Введена система гибкой настройки интерфейса, позволяющая настраивать каждый элемент игры по своему усмотрению и предпочтению. Будьте внимательны: различные настройки интерфейса по разному воспринимаются Quest Navigator''ом и «классическим» плеером.'
$args['li.03.4']='Добавлено описание сражения со змеёй.'
$args['li.03.5']='Добавлено описание сражения с шаром-хищником.'
$args['li.03.6']='Исключены из механизма сохранения состояний переменные настройки интерфейса. Таким образом при пролистывании книги назад, настройки оформления отменяться не будут.'
$args['li.03.7']='Блоки div в тексте заменены блоками p.'
$args['li.03.8']='Добавлена возможность пролистать предисловие (ссылка в колонтитуле).'
$args['li.03.9']='Исправлено описание локации 567.'
$args['li.03.10']='Исправлено описание локации 617'
$args['li.03.11']='Исправлена жуткая ошибка в локации 259'
$args['head.floor2.4']='Изменения и исправления в версии 2.1:'
$args['li.04.1']='Исправлен и переработан шаблон под QuestNavigator. Огромнейшее спасибо <span class="yello_text">Storm</span>''у за подсказки, советы и терпеливое выслушивание моего нытья.'
$args['li.04.2']='Исправлена ошибка, приводившая к включению строки ввода на обложке.'
$args['li.04.3']='Исправлена команда на локации avs.save приводившая к ошибке.'
$args['head.floor2.5']='Изменения и исправления в версии 3.0 (адаптация для Quest Player Fork):'
$args['li.05.1']='Библиотека easy.math перенесена в основной файл игры. Quest Player Fork отказывался присоединять файл библиотеки через inclib и addqst.'
$args['li.05.2']='Добавлена возможность выбирать Quest Player Fork в меню лаунчера.'
$args['li.05.3']='Переработан дизайн некоторых страниц и таблиц. Исправлены цветовые решения.'
$args['li.05.4']='Подкостылена выборка типа локации для адекватной работы предметов.'
$args['li.05.5']='Удалены папки disdoc и lib из архива.'
$args['li.05.6']='Исправлены мелкие недочёты, связанные с адаптацией под новый плеер.'
$args['head.floor2.6']='Изменения и исправления в версии 3.1 (разделение версий):'
$args['li.06.1']='Отделены настройки для различных библиотек. В классическом плеере и в Quest Navigator используются разные библиотеки под одним номером 5.7.0., и на 28.06.2020 единственный способ отличить одну от другой — костыль (см. локацию player.prv). Выбор того, какую версию игры запускать — десктопную или мобильную, по прежнему остаётся за игроком. Однако теперь примерно одинаково будут работать мобильные версии для обоих вариантов библиотек.'
$args['li.06.2']='Исправлены недочёты оформления, из-за которых игра криво отображалась в мобильном представлении.'
$args['li.06.3']='Отключена возможность смены настроек оформления. Никто ею не пользуется, она только отвлекает людей.'
$args['li.06.4']='Скорректирован дизайн некоторых страниц и таблиц.'
$args['li.06.5']='Исправлен лютейший баг с подсказкой, если вы запускали игру в мобильной версии.'
$args['li.06.6']='Исправлены мелкие недочёты, связанные с адаптацией к новым реалиям. Однако остаются открытыми вопросы о дальнейшей судьбе как классического плеера, так и Quest Navigator, из-за чего сложно сейчас предсказать, как будет вести себя игра на иных версиях.'
$args['head.floor2.7']='Изменения и исправления в версии 3.2 (адаптация для qSpider и онлайн-версия):'
$args['li.07.1']='Исправлены ошибки локаций 133 и 305 — создавались тупики из-за неверно закрытых кавычек.'
$args['li.07.2']='Удалена часть с тонкими настройками, так как это больше не используется и недоступно.'
$args['li.07.3']='Исправлена работа некоторых алгоритмов, комментарии полностью перенесены в исходники. Исходники можно посмотреть на https://github.com/AleksVersus/merphy_law.'
$args['li.07.4']='Игра адаптирована для qSpider, исправлены моменты, которые приводили к вылету игры в qSpider.'
$args['ending']='Если Вы обнаружили, что игра не запускается, или некорректно отображается в вашей версии плеера, напишите мне на aleksversus@mail.ru, посмотрим, что с этим можно сделать. Целенаправленно отслеживать и исправлять косяки отображения я больше не буду.'
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		if $AVS_PLAYERTYPE['size']<>"MINI":
			$args["styles.1"]='style="display:flex;align-justify:flex-start;"'
			$args["styles.2"]=' style="font-size:0.9em;position: sticky; top: 0;"'
		end
		$args['screen']+='<div <<$args["styles.1"]>> class="main_cover">'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='<div syle="padding:0.15em;">'
				$args['screen']+='<span <<$args["styles.2"]>> class="back_href">'+$args['href.back']+'</span><br>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='</div>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='<div>'
			$args['screen']+='<span class="heading">'+$args['head.floor1']+'</span><br>'
			$args['screen']+='<span class="subhead">'+$args['version']+'</span><br>'
			$args['screen']+='<span class="subhead">'+$args['resolution']+'</span><br>'
			args['i']=1
			:for_paragraph
			if $args['p.<<args["i"]>>']<>'':
				$args['screen']+='<p class="pgf">'+$args['p.<<args["i"]>>']+'</p>'
				if args['i']=4:
					$args['screen']+='<p class="pgf" style="color:#888888;font-size:0.8em">'+$args['save.about']+'</p>'
				end
				if args['i']=10:
					$args['screen']+='<p style="text-align:right;">'+$args['postscript']+'</p>'
				end
				if args['i']=10 or args['i']=14:
					$args['screen']+='<p style="text-align:center;">'+$args['href.back.1']+'</p>'
				end
				args['i']+=1
				jump 'for_paragraph'
			end
			args['j']=1
			:for_list
			if $args['head.floor2.<<args["j"]>>']<>'':
				$args['screen']+='<span class="heading">'+$args['head.floor2.<<args["j"]>>']+'</span><br>'
				$args['screen']+='<ul style="text-align:left;">'
				args['i']=1
				:for_dot
				if $args['li.0<<args["j"]>>.<<args["i"]>>']<>'':
					$args['screen']+='<li>'+$args['li.0<<args["j"]>>.<<args["i"]>>']+'</li>'
					args['i']+=1
					jump 'for_dot'
				end
				$args['screen']+='</ul>'
				$args['screen']+='<p style="text-align:center;">'+$args['href.back.1']+'</p>'
				args['j']+=1
				jump 'for_list'
			end
			$args['screen']+='<p class="pgf">'+$args['ending']+'</p>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='</div>'
		$args['screen']+='</div>'
		jump 'end_keep'
	else
		:classical
		if $AVS_PLAYERTYPE['size']<>"MINI":$args['screen']+='<center><table border=0><tr name=port>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='<td align=left valign=top width=5%>'
				$args['screen']+='<font size=-4>'+$args['href.back']+'</font>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='</td><td align=justify>'
				$args['screen']+='<p align=center>'
					$args['screen']+='<font color=#dddd00 size=+3>'+$args['head.floor1']+'</font><br><br>'
					$args['screen']+='<font color=#dddd00 size=-4>'+$args['version']+'</font>'
				$args['screen']+='</p>'
				$args['screen']+='<p align=justify>'+$args['resolution']+'</p>'
				args['i']=1
				:for_paragraph_1
				if $args['p.<<args["i"]>>']<>'':
					$args['screen']+='<p align=justify>'
						$args['screen']+=$replace($args['p.<<args["i"]>>'],'<span class="yello_text">','<span style="color:#888800;">')
					$args['screen']+='</p>'
					if args['i']=4:
						$args['screen']+='<p align=justify><font color=#888888 size=-2>'+$args['save.about']+'</font></p>'
					end
					if args['i']=10:
						$args['screen']+='<p align=right>'+$args['postscript']+'</p>'
					end
					if args['i']=10 or args['i']=14:
						$args['screen']+='<p align=center>'+$args['href.back.1']+'</p>'
					end
					args['i']+=1
					jump 'for_paragraph_1'
				end
				args['j']=1
				:for_list_1
				if $args['head.floor2.<<args["j"]>>']<>'':
					$args['screen']+='<p align=left><font color=#dddd00>'+$args['head.floor2.<<args["j"]>>']+'</font></p>'
					$args['screen']+='<ul style="text-align:left;">'
					args['i']=1
					:for_dot_1
					if $args['li.0<<args["j"]>>.<<args["i"]>>']<>'':
						$args['screen']+='<li>'+$replace($args['li.0<<args["j"]>>.<<args["i"]>>'],'<span class="yello_text">','<span style="color:#888800;">')+'</li>'
						args['i']+=1
						jump 'for_dot_1'
					end
					$args['screen']+='</ul>'
					$args['screen']+='<p align=center>'+$args['href.back.1']+'</p>'
					args['j']+=1
					jump 'for_list_1'
				end
				$args['screen']+='<p align=justify>'+$args['ending']+'</p>'
			if $AVS_PLAYERTYPE['size']<>"MINI":$args['screen']+='</td><td width=5%>'
				$args['screen']+='<font size=-4>'+$args['href.back']+'</font>'
			if $AVS_PLAYERTYPE['size']<>"MINI":$args['screen']+='</td>'
		if $AVS_PLAYERTYPE['size']<>"MINI":$args['screen']+='</tr></table></center>'
		jump 'end_keep'
	end
:end_keep
*p $args['screen']
--- [1.0_about] ---------------------------------

QSP-Game локация, рассказывающая о том, как играть в эту игру
# [1.1_gameplay]
$fname = "Times New Roman"
$args['href.back']='<a href="exec:goto ''[start]''" id="back_href" class="plain">&lt;&nbsp;назад</a>'
$args['head.floor1.1']='ПРАВИЛА ИГРЫ'
$args['subhead1.1']='(Перенесено из fb2-версии)'
$args['p1']='Всё, что вам нужно для того, чтобы отправиться навстречу приключениям, — это карандаш, ластик и игральный кубик.'
$args['head.floor2.1']='ЛОВКОСТЬ, СИЛА И ОБАЯНИЕ'
$args['p1.1']='Перед тем как отправиться в путешествие, необходимо при помощи кубика определить ваши изначальные <span class="yello_text">ЛОВКОСТЬ, СИЛУ и ОБАЯНИЕ</span>.'
$args['p1.2']='Все три параметра определяются по таблице. Киньте кубик два раза и найдите строчку, соответствующую сумме выпавших на нём чисел. <span style="color:#008888;">(Ловкость, силу, обаяние и удачу вы сможете установить в начале игры. AVS)</span>'
$args['p1.3']='<span class="yello_text">ЛОВКОСТЬ</span> — это оценка вашего боевого мастерства и умения выпутываться из любых передряг. По ходу игры ваша <span class="yello_text">ЛОВКОСТЬ</span> остаётся неизменной (кроме особых случаев, о которых вы прочтете в тексте).'
$args['p1.4']='<span class="yello_text">СИЛА</span> — это показатель вашего здоровья, воли к жизни, решимости довести начатое дело до конца. Невзгоды и раны будут уменьшать <span class="yello_text">СИЛУ</span>, еда и отдых помогут восстановить её (но не выше первоначальной цифры). Если ваша <span class="yello_text">СИЛА</span> снизилась до нуля — вы погибли, игра проиграна. Придётся начинать всё сначала.'
$args['p1.5']='Встречая на своем пути самых разных людей, вам придётся не раз полагаться на своё <span class="yello_text">ОБАЯНИЕ</span>. Этим словом называется способность расположить человека к себе, заставить его себе поверить, привлечь на свою сторону.'
$args['p1.6']='Чтобы проверить, насколько вы <span class="yello_text">ОБАЯТЕЛЬНЫ</span>  в данной ситуации, бросьте кубик два раза. Если сумма выпавших чисел меньше вашего <span class="yello_text">ОБАЯНИЯ</span> или равна ему — всё в порядке. Если больше — вам не удалось расположить к себе встреченного человека.'
$args['p1.7']='В случае успеха ваше <span class="yello_text">ОБАЯНИЕ</span>  увеличится на 1, в случае неудачи уменьшится на 1.'
$args['head.floor2.2']='УДАЧА'
$args['p2.1']='К сожалению, есть ситуации, где не помогут ни <span class="yello_text">ЛОВКОСТЬ</span>, ни <span class="yello_text">СИЛА</span>, ни даже <span class="yello_text">ОБАЯНИЕ</span>. В таких случаях приходится рассчитывать на <span class="yello_text">УДАЧУ</span>.'
$args['p2.2']='Перед началом игры напишите на <span class="yello_text">ЛИСТКЕ ПУТЕШЕСТВЕННИКА</span> (в графе <span class="yello_text">УДАЧА</span>) цифры от 1 до 6. Затем дважды бросьте кубик. Вычеркните в своем списке цифры, которые выпадут на кубике. Впредь эти цифры будут означать неудачу. Если на кубике оба раза выпала одна и та же цифра, вычеркните только её.'
$args['p2.3']='Встретив в тексте слова <span class="yello_text"><font color=#339900>ПРОВЕРЬТЕ СВОЮ УДАЧУ</span>, БРОСЬТЕ КУБИК</font>. Если выпадет одна из цифр, вычеркнутых в вашем списке, то вам не повезло. Увы, вас ждут неприятности или даже гибель. Если же выпавшая цифра в вашем списке не вычеркнута, то удача сопутствует вам. Но выпавшую «счастливую» цифру придётся в списке вычеркнуть, и при следующих проверках <span class="yello_text">УДАЧИ</span> она оказывается уже «несчастливой».'
$args['p2.4']='Раз за разом проверка становится всё более рискованным делом. Но некоторые приключения дадут вам право увеличить шансы на счастливый случай. Встретив в тексте фразу <span class="yello_text">УДАЧА: ВОССТАНОВИТЕ 1 ЦИФРУ</span>, вы вновь вписываете в <span class="yello_text">ЛИСТОК ПУТЕШЕСТВЕННИКА</span> любую из вычеркнутых цифр, и она ещё раз сможет принести вам удачу.'
$args['head.floor2.3']='БИТВЫ И ОРУЖИЕ'
$args['p3.1']='В пути вам предстоит немало сражений. В тексте указаны <span class="yello_text">СИЛА</span> и <span class="yello_text">ЛОВКОСТЬ</span> каждого из ваших противников.'
$args['p3.2']='Бой происходит так: вы дважды кидаете кубик за противника и прибавляете к полученному числу его <span class="yello_text">ЛОВКОСТЬ</span>. Полученная цифра покажет <span class="yello_text">МОЩНОСТЬ УДАРА</span> врага. Затем дважды киньте кубик за себя и прибавьте к выпавшим цифрам свою <span class="yello_text">ЛОВКОСТЬ</span>. Так вы узнаете свою <span class="yello_text">МОЩНОСТЬ УДАРА</span>.'
$args['p3.3']='Если <span class="yello_text">МОЩНОСТЬ УДАРА</span> вашего противника больше вашей, то он ранит вас (ваша <span class="yello_text">СИЛА</span> уменьшается на 2). Если ваш <span class="yello_text">УДАР</span> мощнее — вы ранили врага (вычтите 2 из его <span class="yello_text">СИЛЫ</span>). Если <span class="yello_text">МОЩНОСТЬ УДАРОВ</span> одинакова — не ранен никто.'
$args['p3.4']='Затем наносите следующий удар — и так до тех пор, пока чья-нибудь <span class="yello_text">СИЛА</span>, ваша или вашего врага, не станет равна нулю. Это означает гибель. Если вы убили противника — продолжайте свой путь.'
$args['p3.5']='Иногда вам придётся биться сразу с несколькими противниками. В таком случае выберите того, с кем будете биться в первую очередь. Для каждого раунда измеряйте <span class="yello_text">МОЩНОСТЬ УДАРОВ</span> всех противников, но ранить вы можете лишь того, с кем сражаетесь. Вас же может ранить любой, чья <span class="yello_text">МОЩНОСТЬ УДАРА</span> выше вашей (причем каждая рана уменьшает <span class="yello_text">СИЛУ</span>  на 2). Расправившись с первым противником, переходите ко второму. И так до тех пор, пока вы не победите всех или не погибнете.'
$args['p3.6']='Во время боя нельзя подкреплять силы едой и лекарствами.'
$args['p3.7']='На поясе у вас боевой линейный излучатель — бластер. Вы можете в любой момент убить любого из противников смертоносным лучом. Сделать это можно даже в разгаре боя. Но по причинам, объясненным в Предисловии, число зарядов невелико, их приходится беречь.'
$args['p3.8']='По ходу путешествия в ваши руки может попасть другое мощное оружие — протонная граната. Её нельзя использовать в случайной стычке — нужно иметь надежное укрытие, чтобы при взрыве гранаты не пострадать самому. Все такие случаи оговорены в тексте.'
$args['head.floor2.4']='НАХОДКИ И ЕДА'
$args['p4.1']='В пути вы можете найти или купить разные вещи, которые захотите взять с собой. Помните: в заплечный рюкзак может поместиться лишь 6 предметов. Любую из вещей вы можете в любой момент вынуть и оставить на дороге, чтобы положить на её место что-нибудь более полезное.'
$args['p4.2']='Если сумеете разжиться в дороге зарядами для бластера — берите их без ограничения: они разместятся не в рюкзаке, а в заряднике оружия.'
$args['p4.3']='Если удастся добыть или купить еду, не обязательно есть её сразу. Можете взять её с собой (она займет в мешке 1 место) и подкрепить свои силы тогда, когда сочтете нужным.'
$args['p4.4']='В Предисловии указано, что из вещей вы можете взять с собой ещё в начале путешествия.'
$args['p4.5']='В дороге пользуйтесь <span class="yello_text">ЛИСТКОМ ПУТЕШЕСТВЕННИКА</span>. Не забывайте вписывать в него свои находки и вычеркивать то, с чем вы расстались. Отмечайте также изменения <span class="yello_text">СИЛЫ</span>, <span class="yello_text">ЛОВКОСТИ</span> и <span class="yello_text">ОБАЯНИЯ</span> (но не вычеркивайте первоначальной цифры). Аккуратно записывайте также полученную в пути информацию о местах, по которым пролег ваш путь. Попробуйте составить карту — это поможет вам в дальнейших странствиях по этим краям.'
$args['p4.6']=''
$args['head.floor1.2']='КАК ЧИТАТЬ ЭТУ КНИГУ'
$args['p2']='Книга разбита на пронумерованные параграфы. Читать её подряд бесполезно. Это только собьёт вас, и потом, в нужный момент, вы не сможете принять правильное решение.'
$args['p3']='В конце каждого параграфа сказано, какие параграфы надо смотреть дальше (в зависимости от развития сюжета и от вашего выбора).
 <span style="color:#008888;">(Конечно же отсылки к номерам параграфов в данной версии заменены на гиперссылки. Все гиперссылки выделены цветом. AVS)</span>'
$args['p4']='Следуйте этим указаниям — и вы станете главным героем книги, отважным майором Космического Патруля, выполняющим опасное спецзадание.'
$args['p5']='В путь, майор! Возвращайтесь с победой.'
$args['href.back.1']='<a href="exec:goto ''[start]''" title="переход к начальной локации" class="plain">В главное меню</a>'
$args['head.floor1.3']='Несколько слов о геймплее'
if $AVS_PLAYERTYPE['size']="MINI":
	$args['p5.1']='Я пострался сделать простое и понятное управление. Переходы между локациями/эпизодами происходят по гиперссылкам, которые, как правило, располагаются в тексте. Иногда переходы осуществляются автоматически при использовании предметов.'
	$args['p5.2']='Вверху и внизу экрана располагаются три ссылки:<qhtml><ul style="text-align:left;"><li><span class="yello_text">[Назад]</span> — позволяет пролистывать страницы в обратном порядке, т.е. откатывать прохождение.</li><li><span class="yello_text">[9|33|12]</span> — эта ссылка отображает состояние характеристик ЛОВКОСТЬ|СИЛА|ОБАЯНИЕ, а так же позволяет войти на экран статистики. Там отображаются те же самые характеристики, но в более развёрнутом виде, а так же числа удачи и неудачи и кое-какие заметки.</li><li><span class="yello_text">[Предметы]</span> — эта ссылка открывает экран со списком имеющихся у вас предметов.</li></ul></qhtml>'
	$args['p5.3']='Если вы находитесь на экране статистики или на экране предметов, вместо ссылки <span class="yello_text">[назад]</span> появляется ссылка <span class="yello_text">[закрыть]</span>, которая возвращает вас на экран описания локации.'
	$args['p5.4']='Сброшенные на локации предметы отображаются или непосредственно в описании, или под описанием в виде гиперссылок. Внимание! Покидая локацию с оставленным на ней предметом, вы таким образом навсегда теряете предмет.'
	$args['p5.5']='Поскольку все подсчёты и записи игра будет вести сама, вам остаётся только мудро распоряжаться имеющимися у вас ресурсами и по возможности избегать ловушек. Впрочем, вы всегда можете воспользоваться кнопкой отката и вернуться на несколько страниц назад.'
	$args['p5.6']='Использование предметов реализовано несколькими способами. Во-первых, при наличии у вас того или иного предмета, на локациях будут показываться или скрываться ссылки переходов. Поэтому внимательно читайте текст (тем более что это всё-таки книга-игра). Во-вторых, некоторые предметы можно использовать только в определённой местности. Например, шлем уместнее носить в мире, где правят законы рыцарства, а очки ночного видения — в тёмных пещерах, или ночью. При этом пункт "Надеть" в меню этих предметов доступен всегда, но работает только тогда, когда соблюдается условие использования.'
	$args['p5.7']='Есть ещё и третий вариант. Предметы, которые можно использовать исключительно тогда, когда они необходимы. В тексте прямо, или намёками, будет указано, что можно использовать некий предмет, тогда в меню этого предмета появится пункт "Воспользоваться". Выбор этого пункта перебросит вас на новую локацию.'
	$args['p5.8']='Использование очков ночного видения хотя и реализовано по второму способу, но в некоторых случаях переход на другую локацию осуществляется автоматически при использовании очков.'
	$args['p5.9']='В некоторых случаях одежда и снаряжение поднимаются не в рюкзак, а сразу надеваются на тело. Например, плащ, пояс-антигравитатор и др. Поскольку каждый такой предмет занимает одну "часть тела", надеть ещё что-нибудь на ту же "часть тела" будет уже невозможно. Т.е. нельзя, например, носить на лице маску и очки ночного видения.'
	$args['p5.10']='Пункт меню "Снять и убрать в рюкзак" для надетых на тело предметов не предусмотрен. Чтобы снять что-то, нужно выбрать пункт "Выбросить". Затем, если хотите (и если получится), можете поднять предмет в рюкзак.'
	$args['p5.11']='В игру встроена система автоматического сохранения состояний (чекпоинтов), которая сохраняет состояние в ключевые моменты игры. Загрузить чекпоинт можно перейдя на экран статистики и воспользовавшись ссылкой "Загрузить контрольную точку". Там же доступны ссылки "Быстрое сохранение" и "Быстрая загрузка". Сохранение последнего чекпоинта пишется в первый слот сохранений игры. Быстрое сохранение — во второй.'
	$args['p5.12']='Заголовки параграфов-чекпоинтов подсвечиваются оранжевым цветом. Сохранять игру после смерти героя нельзя.'
	$args['p5.13']='Номера параграфов/страниц указываются внизу экрана вот в таком виде <span style="color:#888888;">-123-</span>.'
else
	$args['p5.1']='Управление в игре довольно простое и интуитивно понятное. Особых трудностей возникунть не должно.'
	$args['p5.2']='Слева от текста находятся счётчики состояния и важная информация, справа - кликабельные предметы.'
	$args['p5.3']='Каждый параграф книги является отдельной локацией, и далее вместо слова «параграф» используется слово «локация».'
	$args['p5.4']='Сброшенные на локации предметы выводятся списком гиперссылок. Некоторые предметы, поднимаемые с локации, обозначены ссылками прямо в тексте. Внимание! Покидая локацию с оставленным на ней предметом, вы таким образом навсегда теряете предмет.'
	$args['p5.5']='Поскольку все подсчёты и записи игра будет вести сама, вам остаётся только мудро распоряжаться имеющимися у вас ресурсами и по возможности избегать ловушек. Впрочем, вы всегда можете воспользоваться кнопкой отката и вернуться на несколько страниц назад.'
	$args['p5.6']='Если по какой либо причине вы застрянете в прохождении, воспользуйтесь командной строкой для чита. Для этого посмотрите локацию-микроотладчик "uc".'
	$args['p5.7']='Использование предметов реализовано несколькими способами. Во-первых, при наличии у вас того или иного предмета, на локациях будут показываться или скрываться ссылки переходов. Поэтому внимательно читайте текст (тем более что это всё-таки книга-игра). Во-вторых, некоторые предметы можно использовать только в определённой местности. Например, шлем уместнее носить в мире, где правят законы рыцарства, а очки ночного видения в тёмных пещерах, или ночью. При этом пункт "Надеть" в меню этих предметов доступен всегда, но работает только тогда, когда соблюдается условие использования.'
	$args['p5.8']='Есть ещё и третий вариант. Предметы, которые можно использовать исключительно тогда, когда они необходимы. В тексте прямо, или намёками, будет указано, что можно использовать некий предмет, тогда в меню этого предмета появится пункт "Воспользоваться". Выбор этого пункта перебросит вас на новую локацию.'
	$args['p5.9']='Использование очков ночного видения хотя и реализовано по второму способу, но в некоторых случаях переход на другую локацию осуществляется автоматически при использовании очков.'
	$args['p5.10']='В некоторых случаях одежда и снаряжение поднимаются не в рюкзак, а сразу надеваются на тело. Например, плащ, пояс-антигравитатор и др. Поскольку каждый такой предмет занимает одну "часть тела", надеть ещё что-нибудь на ту же "часть тела" будет уже невозможно. Т.е. нельзя, например, носить на лице маску и очки ночного видения.'
	$args['p5.11']='Пункт меню "Снять и убрать в рюкзак" для надетых на тело предметов не предусмотрен. Чтобы снять что-то, нужно выбрать пункт "Выбросить". Затем, если хотите (и если получится), можете поднять предмет в рюкзак.'
	$args['p5.12']='В игру встроена система автоматического сохранения состояний (чекпоинтов), которая сохраняет состояние в ключевые моменты игры. В любой момент вы можете загрузить последнее сохранённое состояние, щёлкнув по букве «<b>S</b>» в правом верхнем  углу экрана и выбрав в контекстном меню пункт «Загрузить чекпоинт». Помимо этого всякий раз при сохранении игры пишется отдельный уникальный файл с сохранением состояния. Таким образом вы можете загрузить любое состояние игры, даже если прошли уже несколько чекпоинтов. Заголовки параграфов-чекпоинтов подсвечиваются оранжевым цветом. Сохранять игру после смерти героя нельзя.'
	$args['p5.13']='<span class="yello_text">Вы можете на лету переключать настройки интерфейса и функционирования игры, воспользовавшись меню «Настройки» (буква «<b>é</b>»). Вот список основных команд, доступных из контекстного меню:</span>'
	$args['p5.14']='<span class="yello_text">Не создавать резервные копии сохранений/Создавать резервные копии сохранений</span>'
	$args['p5.15']='		—	по умолчанию при быстрых сохранениях, а так же при создании чекпоинтов, создаются дополнительные файлы сохранений, по которым вы можете восстановить любое из сохранённых состояний. Вы можете отключить эту функцию, чтобы не засорять жёсткий диск ненужными сохранениями.'
	$args['p5.16']='<span class="yello_text">Быстро сохранить игру, загрузить быстрое сохранение, контрольную точку, или любое другое сохранение всегда можно из меню «Сохранения» (буква «<b>S</b>»).</span>'
	$args['p5.17']='Быстрые сохранения - это сохранения, которые пишутся в файл quicksave.sav в папку sav. Названы так потому что сохранить и загрузить состояние игры можно буквально в два клика.'
	$args['p5.18']='Чекпоинты - это сохранения, которые в ключевые моменты игры автоматически пишутся в файл autosave.sav в папку sav. Таким образом, если вы проиграли, вы можете загрузить состояние на момент последней контрольной точки.'
	$args['p5.19']='Другие пункты меню отвечают за загрузку и сохранение отдельных файлов состояний.'
end
$args['p6']='Надеюсь, эти сведения хоть немного помогут вам в прохождении.'
$args['p7']='Приятной игры!'
$args['p8']='С уважением,<br>Aleks Versus'
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		if $AVS_PLAYERTYPE['size']<>"MINI":
			$args["styles.1"]='style="display:flex;align-justify:flex-start;"'
			$args["styles.2"]=' style="font-size:0.9em;position: sticky; top: 0;"'
		end
		$args['screen']+='<div <<$args["styles.1"]>> class="main_cover">'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='<div syle="padding:0.15em;">'
				$args['screen']+='<span <<$args["styles.2"]>> class="back_href">'+$args['href.back']+'</span><br>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='</div>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='<div>'
			$args['screen']+='<span class="heading">'+$args['head.floor1.1']+'</span><br>'
			$args['screen']+='<span class="subhead">'+$args['subhead1.1']+'</span>'
			$args['screen']+='<p class="pgf">'+$args['p1']+'</p>'
			args['j']=1
			:for_head
			if $args['head.floor2.<<args["j"]>>']<>'':
				$args['screen']+='<span class="heading">'+$args['head.floor2.<<args["j"]>>']+'</span><br>'
				args['i']=1
				:for_paragraph
				if $args['p<<args["j"]>>.<<args["i"]>>']<>'':
					$args['screen']+='<p class="pgf">'+$args['p<<args["j"]>>.<<args["i"]>>']+'</p>'
					if args['i']=2 and args['j']=1:
						if $AVS_PLAYERTYPE['size']="MINI": $args['screen']+="<br>"
						$args['screen']+=$func('base.txt','table.mainsets')
					end
					args['i']+=1
					jump 'for_paragraph'
				end
				args['j']+=1
				jump 'for_head'
			end
			$args['screen']+='<span class="heading">'+$args['head.floor1.2']+'</span><br>'
			$args['screen']+='<p class="pgf">'+$args['p2']+'</p>'
			$args['screen']+='<p class="pgf">'+$args['p3']+'</p>'
			$args['screen']+='<p class="pgf">'+$args['p4']+'</p>'
			$args['screen']+='<p class="pgf">'+$args['p5']+'</p>'
			$args['screen']+='<p style="text-align:center;">'+$args['href.back.1']+'</p>'
			$args['screen']+='<span class="heading">'+$args['head.floor1.3']+'</span><br>'
			args['i']=1
			:for_paragraph_5
			if $args['p5.<<args["i"]>>']<>'':
				$args['screen']+='<p class="pgf">'+$args['p5.<<args["i"]>>']+'</p>'
				args['i']+=1
				jump 'for_paragraph_5'
			end
			$args['screen']+='<p class="pgf">'+$args['p6']+'</p>'
			$args['screen']+='<p class="pgf">'+$args['p7']+'</p>'
			$args['screen']+='<p style="text-align:right;">'+$args['p8']+'</p>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='</div>'
		$args['screen']+='</div>'
		jump 'end_keep'
	else
		:classical
		if $AVS_PLAYERTYPE['size']<>"MINI":$args['screen']+='<center><table border=0><tr name=port>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='<td align=left valign=top width=5%>'
				$args['screen']+='<font size=-4>'+$args['href.back']+'</font>'
			if $AVS_PLAYERTYPE['size']<>"MINI": $args['screen']+='</td><td align=justify>'
				$args['screen']+='<p align=center>'
					$args['screen']+='<font color=#dddd00 size=+3>'+$args['head.floor1.1']+'</font><br><br>'
					$args['screen']+='<font color=#dddd00 size=-4>'+$args['subhead1.1']+'</font>'
				$args['screen']+='</p>'
				$args['screen']+='<p align=justify>'+$args['p1']+'</p>'
				args['j']=1
				:for_head_1
				if $args['head.floor2.<<args["j"]>>']<>'':
					$args['screen']+='<p align=left><font color=#dddd00>'+$args['head.floor2.<<args["j"]>>']+'</font></p>'
					args['i']=1
					:for_paragraph_1
					if $args['p<<args["j"]>>.<<args["i"]>>']<>'':
						$args['screen']+='<p align=justify>'
							$args['screen']+=$replace($args['p<<args["j"]>>.<<args["i"]>>'],'<span class="yello_text">','<span style="color:#888800;">')
						$args['screen']+='</p>'
						if args['i']=2 and args['j']=1:
							if $AVS_PLAYERTYPE['size']="MINI": $args['screen']+="<br>"
							$args['screen']+=$func('base.txt','table.mainsets')
						end
						args['i']+=1
						jump 'for_paragraph_1'
					end
					args['j']+=1
					jump 'for_head_1'
				end
				$args['screen']+='<p align=center>'
					$args['screen']+='<font color=#dddd00 size=+3>'+$args['head.floor1.2']+'</font><br>'
				$args['screen']+='</p>'
				$args['screen']+='<p align=justify>'+$args['p2']+'</p>'
				$args['screen']+='<p align=justify>'+$args['p3']+'</p>'
				$args['screen']+='<p align=justify>'+$args['p4']+'</p>'
				$args['screen']+='<p align=justify>'+$args['p5']+'</p>'
				$args['screen']+='<p align=center>'+$args['href.back.1']+'</p>'
				$args['screen']+='<p align=center>'
					$args['screen']+='<font color=#dddd00 size=+3>'+$args['head.floor1.3']+'</font><br>'
				$args['screen']+='</p>'
				args['i']=1
				:for_paragraph_6
				if $args['p5.<<args["i"]>>']<>'':
					$args['screen']+='<p align=justify>'
						$args['screen']+=$replace($args['p5.<<args["i"]>>'],'<span class="yello_text">','<span style="color:#888800;">')
					$args['screen']+='</p>'
					args['i']+=1
					jump 'for_paragraph_6'
				end
				$args['screen']+='<p align=justify>'+$args['p6']+'</p>'
				$args['screen']+='<p align=justify>'+$args['p7']+'</p>'
				$args['screen']+='<p align=right>'+$args['p8']+'</p>'
			if $AVS_PLAYERTYPE['size']<>"MINI":$args['screen']+='</td><td width=5%>'
				$args['screen']+='<font size=-4>'+$args['href.back']+'</font>'
			if $AVS_PLAYERTYPE['size']<>"MINI":$args['screen']+='</td>'
		if $AVS_PLAYERTYPE['size']<>"MINI":$args['screen']+='</tr></table></center>'
		jump 'end_keep'
	end
:end_keep
*p $args['screen']
--- [1.1_gameplay] ---------------------------------

QSP-Game самая первая локация. Здесь может быть заставка или вступительное слово
# [start]
gosub 'set.newgame','kill'
$GAME_VALUE['interface']=''
$save['game.number']=$func('#rndstr#',4,'буквы и цифры')
if instr($AVS_PLAYERTYPE,"[MINI]")<>0: $AVS_PLAYERTYPE['size']="MINI" else $AVS_PLAYERTYPE['size']=""
if instr($AVS_PLAYERTYPE,"[QN]")<>0:
	$AVS_PLAYERTYPE['type']="QN"
elseif instr($AVS_PLAYERTYPE,"[qSpider]")<>0:
	$AVS_PLAYERTYPE['type']="qSpider"
else
	$AVS_PLAYERTYPE['type']=""
end
gosub 'set.Screen','обложка.чёрный'
$args['author']='ОЛЬГА ГОЛОТВИНА'
$args['head.floor1']='ВЕРЕНИЦА МИРОВ'
$args['subhead.floor1']='или'
$args['head.floor2']='ВЫВОДЫ ИЗ ЗАКОНА МЕРФИ'
$args['subhead.floor2']='Книга-игра'
$args['epigraph.1']='«Если неприятность может произойти, она обязательно происходит».'
$args['epigraph.2']='Закон Мерфи, 2-я пол. ХХ века'
$args['link.startgame']='<a href="exec:goto ''page.-1''" id="start_the_game" class="plain">Начать игру</a>'
$args['link.gameplay']='<a href="exec:goto ''[1.1_gameplay]''" id="about_gameplay" class="plain">Об игре</a>'
$args['link.release']='<a href="exec:goto ''[1.0_about]''" id="about_release" class="plain">О текущей версии</a>'
if $AVS_PLAYERTYPE['size']<>"MINI":
	if $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']="qSpider":
		$args['screen']+='<div class="main_cover">'
			$args['screen']+='<span class="author">'+$args['author']+'</span><br>'
			$args['screen']+='<span class="heading">'+$args['head.floor1']+'</span><br>'
			$args['screen']+='<span class="subhead" style="color:#dddd00;">'+$args['subhead.floor1']+'</span><br>'
			$args['screen']+='<span class="heading">'+$args['head.floor2']+'</span><br>'
			$args['screen']+='<span class="subhead">'+$args['subhead.floor2']+'</span>'
			$args['screen']+='<br><br><div class="epigraph">'
				$args['screen']+='<div id="epigraph_1">'+$args['epigraph.1']+'</div>'
				$args['screen']+='<div id="epigraph_2">'+$args['epigraph.2']+'</div>'
			$args['screen']+='</div><br><br>'
			$args['screen']+=$args['link.startgame']+'<br><br>'
			$args['screen']+=$args['link.gameplay']+'<br><br>'
			$args['screen']+=$args['link.release']
		$args['screen']+='</div>'
	else
		$args['screen']+='<center><table border=0 id="main_cover">'
			$args['screen']+='<tr name="Заголовок"><td align=center>'
				$args['screen']+='<font color=#dddd00>'+$args['author']+'</font><br>'
				$args['screen']+='<font color=#dddd00 size=+3>'+$args['head.floor1']+'</font><br>'
				$args['screen']+='<font color=#dddd00>'+$args['subhead.floor1']+'</font><br>'
				$args['screen']+='<font color=#dddd00 size=+3>'+$args['head.floor2']+'</font><br>'
				$args['screen']+='<font size=-3>'+$args['subhead.floor2']+'</font>'
			$args['screen']+='</td></tr>'
			$args['screen']+='<tr name=text><td align=right>'
				$args['screen']+='<br><br><font size=-1><i>'+$args['epigraph.1']+'</i></font><br>'
				$args['screen']+='<font size=-1><i>'+$args['epigraph.2']+'</i></font><br><br>'
			$args['screen']+='</td></tr>'
			$args['screen']+='<tr name=link><td align=center>'
				$args['screen']+=$args['link.startgame']+'<br><br>'
				$args['screen']+=$args['link.gameplay']+'<br><br>'
				$args['screen']+=$args['link.release']
			$args['screen']+='</td></tr>'
		$args['screen']+='</table></center>'
	end
else
	if $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']="qSpider":
		$args['screen']+='<div class="main_cover">'
			$args['screen']+='<span class="author">'+$args['author']+'</span><br>'
			$args['screen']+='<span class="heading">'+$args['head.floor1']+'</span><br>'
			$args['screen']+='<span class="subhead" style="color:#dddd00;">'+$args['subhead.floor1']+'</span><br>'
			$args['screen']+='<span class="heading">'+$args['head.floor2']+'</span><br>'
			$args['screen']+='<span class="subhead">'+$args['subhead.floor2']+'</span>'
			$args['screen']+='<br><br><div class="epigraph">'
				$args['screen']+='<div id="epigraph_1">'+$args['epigraph.1']+'</div>'
				$args['screen']+='<div id="epigraph_2">'+$args['epigraph.2']+'</div>'
			$args['screen']+='</div><br><br>'
			$args['screen']+=$args['link.startgame']+'<br><br>'
			$args['screen']+=$args['link.gameplay']+'<br><br>'
			$args['screen']+=$args['link.release']
		$args['screen']+='</div>'
	else
		$args['screen']+='<center>'
			$args['screen']+='<font color=#dddd00>'+$args['author']+'</font><br>'
			$args['screen']+='<font color=#dddd00 size=+3>'+$args['head.floor1']+'</font><br>'
			$args['screen']+='<font color=#dddd00>'+$args['subhead.floor1']+'</font><br>'
			$args['screen']+='<font color=#dddd00 size=+3>'+$args['head.floor2']+'</font><br>'
			$args['screen']+='<font size=-3>'+$args['subhead.floor2']+'</font>'
			$args['screen']+='<br><br><font size=-1><i>'+$args['epigraph.1']+'</i></font><br>'
			$args['screen']+='<font size=-1><i>'+$args['epigraph.2']+'</i></font><br><br>'
			$args['screen']+=$args['link.startgame']+'<br><br>'
			$args['screen']+=$args['link.gameplay']+'<br><br>'
			$args['screen']+=$args['link.release']
		$args['screen']+='</center>'
	end
end
*p $args['screen']
showinput 1
! ВСЕМУ СООБЩЕСТВУ QSP, людям из quest-book, и просто проходившим мимо СПАСИБО !
--- [start] ---------------------------------

QSP-Game ! локация, выполняющая стандартную атаку
GAME_WAR['hero.fast'] - штраф или бонус к силе атаки
# int.war.attack
$args[0] = $args[0]
$GAME_WAR['select.enemy']=$args[0]
$GAME_WAR_LOG[]=$func('base.txt','war.round')
args['cube.hero']=rand(2,12)
args['might.hero']=fast['now']+args['cube.hero']+GAME_WAR['hero.fast']
killvar '$temp_id'
gosub 'get.daughter.obj',$curloc,'<ratch>','$temp_id'
:for
$args['attacks.all']="[pfast:<<fast['now']>>] [pcube:<<args['cube.hero']>>] [pfbns:<<GAME_WAR['hero.fast']>>]"
if arrsize('$temp_id')>0:
	if GAME_WAR['ratch.power.'+$temp_id[0]]>0:
		args['cube.enemy']=rand(2,12)
		args['might.enemy']=GAME_WAR['ratch.fast.'+$temp_id[0]]+args['cube.enemy']
		args['pit']=arrpos('$id_array',$temp_id[0])
		$args['attacks.all']+="[emight:<<args['might.enemy']>>] [ecube:<<args['cube.enemy']>>] [eblow:<<GAME_WAR['ratch.blow.'+$temp_id[0]]>>]"
		if args['might.enemy']>args['might.hero']:
			gosub 'power',-GAME_WAR['ratch.blow.'+$temp_id[0]],'war'
			$GAME_WAR_LOG[]=$func('war.txt','eblow',$temp_id[0],$args['attacks.all'])
			if instr($GAME_WAR['DIN.'+$curloc],'!war.powerdown!')<>0:
				gosub 'run.dynamic.script','!war.powerdown!','//run.this.dynamic//',$GAME_WAR['DIN.'+$curloc]
			end
			if power['now']<1:
				$GAME_WAR_LOG[]=$func('war.txt','pdeath',$temp_id[0],$args['attacks.all'])
			end
		elseif args['might.enemy']<args['might.hero'] and $temp_id[0]=$args[0]:
			GAME_WAR['ratch.power.'+$temp_id[0]]-=2
			$args['attacks.all']+=" [epower:<<GAME_WAR['ratch.power.'+$temp_id[0]]>>]"
			$GAME_WAR_LOG[]=$func('war.txt','pblow',$temp_id[0],$args['attacks.all'])
			if GAME_WAR['ratch.power.'+$temp_id[0]]<1:
				$GAME_WAR_LOG[]=$func('war.txt','edeath',$temp_id[0],$args['attacks.all'])
				$GAME_WAR['ratch.dead.'+$temp_id[0]]=$func('base.txt','ed',$func('get.tag.cont',$object_array[args['pit']],'sex'))
				GAME_WAR['death.enemy']+=1
				$GAME_WAR['select.enemy']=''
			end
			if instr($GAME_WAR['DIN.'+$curloc],'!war.ratchdown!')<>0:
				gosub 'run.dynamic.script','!war.ratchdown!','//run.this.dynamic//',$GAME_WAR['DIN.'+$curloc]
			end
		elseif args['might.enemy']<=args['might.hero'] and $temp_id[0]<>$args[0]:
			$GAME_WAR_LOG[]=$func('war.txt','pblock',$temp_id[0],$args['attacks.all'])
		else
			$GAME_WAR_LOG[]=$func('war.txt','block',$temp_id[0],$args['attacks.all'])
		end
	end
	killvar '$temp_id',0
	jump 'for'
end
killvar '$temp_id'
GAME_WAR['round']+=1
gosub 'int.war.prove'
gosub 'int.war'
--- int.war.attack ---------------------------------

QSP-Game ! локация полного уничтожения противника
$args[0] - айди противника
# int.war.blaster
$args[9] = $args[9]
$args['pos.bl']=$func('prv.obj.inBag','бластер')
if $args['pos.bl']<>"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
	$GAME_WAR_LOG[]=$func('base.txt','war.round')
	charge_array[arrpos('$id_array',$args['pos.bl'])]-=1
	args['pit']=arrpos('$id_array',$args[0])
	$args['name']=$func('get.n.p',$object_array[args['pit']],'И')
	$args['name.В']=$func('get.n.p',$object_array[args['pit']],'В')
	$args['sex']=$func('get.tag.cont',$object_array[args['pit']],'sex')
	GAME_WAR['ratch.power.'+$args[0]]=0
	$GAME_WAR['ratch.dead.'+$args[0]]=$func('base.txt','ed',$func('get.tag.cont',$object_array[args['pit']],'sex'))
	GAME_WAR['death.enemy']+=1
	if $GAME_WAR['select.enemy']=$args[0]: $GAME_WAR['select.enemy']=''
	$GAME_WAR_LOG[]=$func('base.txt','hveb',$args['name.В'])
else
	$log_error[]='Ошибка! Такого быть не должно. Бластер оказался доступен к использованию, хотя заряды отсутствовали. Сообщите разработчику.'
	$print[]=$log_error[]
end
GAME_WAR['round']+=1
gosub 'int.war.prove'
gosub 'int.war'
--- int.war.blaster ---------------------------------

QSP-Game ! локация проверки победы/поражения
# int.war.prove
killvar '$temp_id'
gosub 'get.daughter.obj',$curloc,'<ratch>','$temp_id'
if GAME_WAR['enemy.count']<=GAME_WAR['death.enemy']:
	$GAME_WAR['thiswar.'+$curloc]='victory'
elseif power['now']<1:
	$GAME_WAR['thiswar.'+$curloc]='lose'
	$GAME_VALUE['power.lose']='poweroff'
end
killvar '$temp_id'
--- int.war.prove ---------------------------------

QSP-Game ! интерпретатор боя. Основная локация для интерпретации боя, вызывается без аргументов.
# int.war
if $GAME_WAR['thiswar.'+$curloc]<>'':
	if instr($GAME_WAR['DIN.'+$curloc],'!war.round!')<>0:
		gosub 'run.dynamic.script','!war.round!','//run.this.dynamic//',$GAME_WAR['DIN.'+$curloc]
	end
end
if $GAME_WAR['thiswar.'+$curloc]='':
	gosub $curloc
	$GAME_WAR['заголовок.'+$curloc]=$lvar['заголовок']
	if $lvar['исходник']<>'':
		$GAME_WAR['исходник.'+$curloc]=$lvar['исходник']
	else
		$GAME_WAR['исходник.'+$curloc]=$strfind($maintxt,'<avs-main>([\s\S]*)<\/avs-main>',1)
	end
	$GAME_WAR['exit.'+$curloc]=$lvar['exit']
	$GAME_WAR['DIN.'+$curloc]=$lvar['динамический код']
	$GAME_WAR['thiswar.'+$curloc]='war'
	GAME_WAR['hero.fast']=lvar['штраф.ловк']
	killvar '$lvar'
	killvar '$temp_id'
	gosub 'get.daughter.obj',$curloc,'<ratch>','$temp_id'
	GAME_WAR['enemy.count']=arrsize('$temp_id')
	:full_ratch
	if arrsize('$temp_id')>0:
		$args['ratch.body']=$object_array[arrpos('$id_array',$temp_id[0])]
		GAME_WAR['ratch.power.'+$temp_id[0]]=func('get.tag.num',$args['ratch.body'],'power')
		GAME_WAR['ratch.power.max.'+$temp_id[0]]=GAME_WAR['ratch.power.'+$temp_id[0]]
		GAME_WAR['ratch.fast.'+$temp_id[0]]=func('get.tag.num',$args['ratch.body'],'fast')
		GAME_WAR['ratch.fast.max.'+$temp_id[0]]
		args['blow']=func('get.tag.num',$args['ratch.body'],'blow')
		if args['blow']=0: args['blow']=2
		GAME_WAR['ratch.blow.'+$temp_id[0]]=args['blow']
		killvar '$temp_id',0
		jump 'full_ratch'
	end
	killvar '$temp_id'
	gosub 'int.war.screen',$curloc
elseif $GAME_WAR['thiswar.'+$curloc]='war':
	gosub 'int.war.screen',$curloc
elseif $GAME_WAR['thiswar.'+$curloc]='victory':
	gosub 'int.war.screen',$curloc,"victory"
elseif $GAME_WAR['thiswar.'+$curloc]='lose':
	gosub 'int.war.screen',$curloc,"lose"
elseif $GAME_WAR['thiswar.'+$curloc]='prelose':
	gosub 'int.war.screen',$curloc,"prelose"
end
--- int.war ---------------------------------

QSP-Game ! надстройка для боевого обновления экрана
$args[0] = $args[0]
$args[1] = $args[1]	&	!	режим победа, поражение и т.д.
# int.war.screen
$args[9]=$args[9]
if instr($GAME_WAR['DIN.'+$curloc],'!war.refresh!')<>0:
	gosub 'run.dynamic.script','!war.refresh!','//run.this.dynamic//',$GAME_WAR['DIN.'+$curloc]
end
$args['на экран']=$func('int.DIN',$GAME_WAR['исходник.'+$args[0]])
if GAME_VALUE['war.log']<1:
	$args['на экран']+='<br><br>'+$func('#array.prnt#','$GAME_WAR_LOG','[only result]')+'<br>'
else
	$args['на экран']+='<br><br>'+$func('#array.prnt#','$GAME_WAR_LOG','[only result]','',arrsize('$GAME_WAR_LOG')-GAME_VALUE['war.log'])+'<br>'
end
$args['table'] = '<table width=100% cellpadding=5 cellspacing=0>'
killvar '$temp_id'
gosub 'get.daughter.obj',$curloc,'<ratch>','$temp_id'
:for
if arrsize('$temp_id')>0:
	args['pit']=arrpos('$id_array',$temp_id[0])
	$args['name']='<b>'+$func('get.n.p',$object_array[args['pit']],'И')+'</b>'
	$args['po']="Сила: <<GAME_WAR['ratch.power.'+$temp_id[0]]>>/<<GAME_WAR['ratch.power.max.'+$temp_id[0]]>>		Ловкость: <<GAME_WAR['ratch.fast.'+$temp_id[0]]>>"
	$args['fight']=''
	if GAME_WAR['ratch.power.'+$temp_id[0]]>0:
		if $GAME_WAR['select.enemy']='' or $GAME_WAR['select.enemy']=$temp_id[0]:
			$args['fight']+=$func('base.txt','attack',$temp_id[0])
		else
			$args['fight']+=$func('base.txt','eo')
		end
		$args['pos.bl']=$func('prv.obj.inBag','бластер')
		if $args['pos.bl']<>"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0 and instr($tvar['костыль.заголовок'],'<non-blaster>')=0:
			$args['fight']+='<br>'+$func('base.txt','blaster-attack',$temp_id[0])
		end
	else
		$args['po']=$GAME_WAR['ratch.dead.'+$temp_id[0]]
		$args['fight']='&nbsp;'
	end
	$args['table']+='<tr bgcolor=#d0d0d0><td width=50%>'+$args['name']+'<br><font size=-1 color=#444444>'+$args['po']+'</font></td><td align=right>'+$args['fight']+'</td></tr>'
	if $AVS_PLAYERTYPE['size']<>"MINI": $args['table']+='<tr><td width=50% height=2><img src="px.png" height=2></td><td align=right height=2><img src="px.png" height=2></td></tr>'
	killvar '$temp_id',0
	jump 'for'
end
killvar '$temp_id'
$args['table']+='</table>'
$args['список предметов']=$func('int.loc.obj',$curloc)
! в зависимости от режима генерируем таблицу победы или поражения, или предпоражения
if $args[1]='victory': $args['table']=$func('base.txt','wv',$GAME_WAR['exit.'+$curloc],$GAME_WAR['prewin.txt'])
if $args[1]='lose': $args['table']=$func('base.txt','wl') & $args['список предметов']=''
if $args[1]='prelose': $args['table']=$func('base.txt','wp',$GAME_WAR['exit.'+$curloc],$GAME_WAR['prelose.txt'])	&	$args['список предметов']=''
$args['на экран']+='<br>'+$args['table']+'<br>'
*clr
*pl $func('int.screen',$args['на экран'],$args['список предметов'],$GAME_WAR['заголовок.'+$args[0]],$GAME_VALUE['interface'])
wait 1
*pl
--- int.war.screen ---------------------------------

QSP-Game ! заряжаем или разряжаем бластер
# blast.charge
args[0] = args[0]
$args['blast']=$func('prv.obj.inBag','бластер')
args['pit']=arrpos('$id_array',$args['blast'])
if -args[0]>charge_array[]: args[0]=-charge_array[args['pit']]
charge_array[args['pit']]+=args[0]
if args[0]>0: $print_down[]=$func('base.txt','blaster.incharge',args[0])
if args[0]<0: $print_down[]=$func('base.txt','blaster.decharge',args[0])
--- blast.charge ---------------------------------

QSP-Game Возвращаем ссылку либо бросаем кубики на ловкость
$args[0]=$args[0]
args[1]=args[1]
args[2]=args[2]
# fast
$args[9]=$args[9]
if $args[0]='href':
	if tvar['cube']=0:
		$args['res']=$func('base.txt','fst.prove')
	else
		$args['res']=$func('base.txt','fst',tvar['cube'],fast['now'])+'<br><br>'
		if tvar['cube']>fast['now']:
			$args['res']+=$func('base.txt','fst.lose',args[2])
		else
			$args['res']+=$func('base.txt','fst.win',args[1])
		end
	end
	$result=$args['res']
elseif $args[0]='cube':
	tvar['cube']=rand(2,12)
	time['goto']=1
	killvar '$result'
	gosub 'true.goto'
end
--- fast ---------------------------------

QSP-Game ! наполняет флягу жидкостью
# flaga
if $args[0]='': $args[0]=$func('prv.obj.inBag','фляга')
if $args[1]='': $args[1]='вода'
if $args[0]<>'':
	args['pit']=arrpos('$id_array',$args[0])
	args['pot']=arrpos('$position_array',$args[0])
	if instr($object_array[arrpos('$id_array',$position_array[args['pit']])],'[:пояс_фляга:]')<>0: $args['outBag']='true'
	if args['pot']<>-1:
		$args['name'] = $func('get.n.p',$object_array[args['pot']],'В')
		$print[]=$func('base.txt','liquid.drop',$args['name'])
		gosub 'del.obj.id',$id_array[args['pot']]
	end
	$args['pot_']=$func('crt.obj',$args[1],'','',0,1,$args[0])
	charge_array[args['pit']]=func('get.tag.num',$object_array[args['pit']],'maxchrg')
	$args['name'] = $func('get.n.p',$object_array[arrpos('$id_array',$args['pot_'])],'Т')
	if $args['outBag']='true':
		$print[]=$func('base.txt','liquid.full',$args['name'])
	end
else
	$print[]=$func('base.txt','liquid.nopeflask')
end
if $args[2]<>'//nope.goto//':
	time['goto']=1
	gosub 'true.goto'
end
--- flaga ---------------------------------

QSP-Game Знание использованао
# knew.fin
$args[0]=$args[0]
$args['knew']=$func('prv.obj.inBag',$args[0],'<KNOWLEDGE>')
if $args['knew']<>'':
	$object_array[arrpos('$id_array',$args['knew'])]+='[выполнено]'
end
--- knew.fin ---------------------------------

QSP-Game ! локация ведёт подсчёт ловкости
args[0] = args[0]	&	!	изменение ловкости
$args[1] = $args[1]	&	!	управление
# lovk
$args[9]=$args[9]
fast['now']+=args[0]
if instr($args[1],'max')<>0: fast['start']+=args[0]
$print_down[]=$func('base.txt','lovkup',args[0])
--- lovk ---------------------------------

QSP-Game локация работы с удачей
$args[0]=$args[0]
args[1]=args[1]
args[2]=args[2]
# luck
$args[9]=$args[9]
$args['res']=$func('base.txt','vm_1')
if $args[0]='':
	$args['res']+=$func('base.txt','vm_2')
elseif arrpos('$num_luck',$args[0])<>-1:
	killvar '$num_luck',arrpos('$num_luck',$args[0])
	$num_unluck[]=$args[0]
	$args['res']+=$func('base.txt','vm_3',$args[0],args[1])
elseif arrpos('$num_unluck',$lvar['luck'])<>-1:
	$args['res']+=$func('base.txt','vm_4',$args[0],args[2])
else
	$args['res']+=$func('base.txt','vm_5')
end
$result=$args['res']
--- luck ---------------------------------

QSP-Game ! локация ведёт подсчёт силы
args[0] = args[0]	&	!	изменение силы
$args[1] = $args[1]	&	!	управление
$args[2]=$args[2]	&	!	разное
# power
$args[9]=$args[9]
if args[0]+power['now']>power['start']: args[0]=power['start']-power['now']
power['now']+=args[0]
$print_down[]=$func('base.txt','powup',args[0])
if $args[1]<>'war':
	if power['now']<1:
		$GAME_VALUE['power.lose']='poweroff'
		goto 'page.death'
	end
end
if power['now']<1: nosave=1 else nosave=0
--- power ---------------------------------

QSP-Game Локация выбрасывания рюкзака
# put.bag
args[9]=-1
if $args[0]='': $args[0]=$curloc
:for
if $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']="qSpider":
	args[9]=arrcomp('$object_array','[\s\S]*\[:место_в_рюкзаке:\][\s\S]*',args[9]+1)
else
	args[9]=arrcomp(args[9]+1,'$object_array','[\s\S]*\[:место_в_рюкзаке:\][\s\S]*')
end
if args[9]<>-1:
	$position_array[args[9]]=$args[0]
	jump 'for'
end
$print[]=$func('base.txt','bag.drop')
if $args[1]<>'//nope.goto//':
	time['goto']=1
	goto $args[0]
end
--- put.bag ---------------------------------

QSP-Game ! устанавливаем начальные характеристики
args[0] - выброшенный вариант
# set.mainsets
if args[0]=0:
	cube['start'] = rand(1,6)+rand(1,6)
else
	cube['start'] = args[0]
end
if cube['start'] = 2:
	$args['l']='p:22	f:8		s:8'
elseif cube['start'] = 3:
	$args['l']='p:20	f:10	s:6'
elseif cube['start'] = 4:
	$args['l']='p:16	f:12	s:5'
elseif cube['start'] = 5:
	$args['l']='p:18	f:9		s:8'
elseif cube['start'] = 6:
	$args['l']='p:20	f:11	s:6'
elseif cube['start'] = 7:
	$args['l']='p:20	f:9		s:7'
elseif cube['start'] = 8:
	$args['l']='p:16	f:10	s:7'
elseif cube['start'] = 9:
	$args['l']='p:24	f:8		s:7'
elseif cube['start'] = 10:
	$args['l']='p:22	f:9		s:6'
elseif cube['start'] = 11:
	$args['l']='p:18	f:10	s:7'
elseif cube['start'] = 12:
	$args['l']='p:20	f:11	s:5'
end
power['start']=func('get.tag.num',$args['l'],'p')
fast['start']=func('get.tag.num',$args['l'],'f')
social['start']=func('get.tag.num',$args['l'],'s')
power['now']=power['start']
fast['now']=fast['start']
social['now']=social['start']
killvar '$num_luck'
killvar '$num_unluck'
$num_luck[0]='1'
$num_luck[1]='2'
$num_luck[2]='3'
$num_luck[3]='4'
$num_luck[4]='5'
$num_luck[5]='6'
args[0]=0
:n
if args[0]<2:
	$args['unluck']=$str(rand(1,6))
	args['p']=arrpos('$num_luck',$args['unluck'])
	if args['p']<>-1:
		killvar '$num_luck',args['p']
		$num_unluck[]=$args['unluck']
	end
	args[0]+=1
	jump 'n'
end
--- set.mainsets ---------------------------------

QSP-Game локация выставляет настройки по умолчанию.
$args[0] — управляющая конструкция. Сюда можно передавать слово kill
	— сбрасывает все настройки, или название настройки, которую нужно сбросить.
# set.newgame
$args[9]=$args[9]
if $args[0]='kill':
	killvar '$survived_location'
	killvar '$survived_varriors'
	killvar '$GAME_VALUE'
	killvar 'fast' & killvar 'power' & killvar 'social'
	killvar '$id_array'
	killvar '$object_array'
	killvar '$position_array'
	killvar 'kolvo_array'
	killvar 'charge_array'
	killvar '$run_array'
	killvar '$num_unluck'
	killvar '$num_luck'
	killvar 'здесь_был'
	killvar 'удача_восст'
	killvar 'checkpoint'
end
if $GAME_INTERFACE['sets.refresh']='' or $args[0]<>'kill':
	! основные настройки
	if $args[0]='kill' or $args[0]='refresh': 		$GAME_INTERFACE['refresh']=''			&	!	принудительно обновить настройки интерфейса страница.сброс - сбросить к стандартным настройкам плеера
	if $args[0]='kill' or $args[0]='back.href':		$GAME_INTERFACE['back.href']='false'	&	!	кнопка отката: false - не отображается true - отображается
	if $args[0]='kill' or $args[0]='next.href': 	$GAME_INTERFACE['next.href']='false'	&	!	кнопка пролистывания: false - на экране отображаются кнопки настроек true - отображается кнопка пролистывания
	! тонкие настройки
end
--- set.newgame ---------------------------------

QSP-Game генерируем базовые объекты (предметы)
# set.presets
	gosub 'set.Screen','страница.сброс'
	GAME_VALUE['war.log']=6
	gosub 'crt.obj','','ROOF','<ROOF>',0,1,''
	gosub 'crt.obj','','INVENTORY','<INVENTORY>',0,1,'ROOF'
	gosub 'crt.obj','','KNOWLEDGE','<KNOWLEDGE>',0,1,'ROOF'
	$args['запястье']=$func('crt.obj','запястье','','<body>',0,1,'INVENTORY')
	$args['ножны']=$func('crt.obj','ножны','','<body>',0,1,'INVENTORY')
	$args['кобура']=$func('crt.obj','кобура','','<body>',0,1,'INVENTORY')
	gosub 'crt.obj','пояс','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','пояс_фляга','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','пояс_кошель','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','лицо','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','голова','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','рука_левая','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','плечи','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','шея','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','плечо','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','запястье','','<body> [hide.inInv]',0,1,'INVENTORY'
	gosub 'crt.obj','место_в_рюкзаке','','<body>',0,1,'INVENTORY'
	gosub 'crt.obj','место_в_рюкзаке','','<body>',0,1,'INVENTORY'
	gosub 'crt.obj','место_в_рюкзаке','','<body>',0,1,'INVENTORY'
	gosub 'crt.obj','место_в_рюкзаке','','<body>',0,1,'INVENTORY'
	gosub 'crt.obj','место_в_рюкзаке','','<body>',0,1,'INVENTORY'
	gosub 'crt.obj','место_в_рюкзаке','','<body>',0,1,'INVENTORY'
	gosub 'crt.obj','ворот','','[quest]',0,1,$args['запястье']
	gosub 'crt.obj','палаш','','[quest]',0,1,$args['ножны']
	gosub 'crt.obj','бластер','','[quest]',1,1,$args['кобура']
--- set.presets ---------------------------------

QSP-Game проверка обаяния
$args[0]=$args[0]	&	!	управляющая конструкция href - получаем ссылку cube - бросаем кубики
args[1]=args[1]
args[2]=args[2]
# social
$args[9]=$args[9]
if $args[0]='href':
	if tvar['cube']=0:
		$args['res']=$func('base.txt','soc.prove')
	else
		$args['res']=$func('base.txt','soc',tvar['cube'],social['now'])+'<br><br>'
		if tvar['cube']>social['now']:
			$args['res']+=$func('base.txt','soc.lose',args[2])
		else
			$args['res']+=$func('base.txt','soc.win',args[1])
		end
	end
	$result=$args['res']
elseif $args[0]='cube':
	tvar['cube']=rand(2,12)
	time['goto']=1
	killvar '$result'
	gosub 'true.goto'
end
--- social ---------------------------------

QSP-Game локация отвечает за восстановление числа в ранг удачных
$args[0] - выбранное число
# upluck.num
$args[9] = $args[9]
args[1]=arrpos('$num_unluck',$args[0])
$num_luck[]=$num_unluck[args[1]]
killvar '$num_unluck',args[1]
удача_восст[$curloc]=1
time['goto']=1
goto $curloc
--- upluck.num ---------------------------------

QSP-Game ! локация выводит гиперссылки для восстановления чисел
# upluck
$args['resu']='&nbsp;'
if удача_восст[$curloc]=0 and arrsize('$num_unluck')>0:
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['open.f']+='<span style="font-size:large;font-weight:bolder;">'
		$args['close.f']+='</span>'
	else
		$args['open.f']+='<font size=+1><b>'
		$args['close.f']+='</b></font>'
	end
	$args['resu']+=$args['open.f']
	:fuck_luck
	if args[9]<arrsize('$num_unluck') and args[9]<6:
		if args[9]<>0: $args['resu']+=',	'
		$args['resu']+='<a href="exec:gosub ''upluck.num'',''<<$num_unluck[args[9]]>>''" title="upluck" class="plain">'+$num_unluck[args[9]]+'</a>'
		args[9]+=1
		jump 'fuck_luck'
	end
	$args['resu']+=$args['close.f']
end
$result=$args['resu']
--- upluck ---------------------------------

QSP-Game локация добавляет некое знание, если оно отсутствует
# mv
args[0] = args[0]
if $func('prv.obj.inBag','мв','<KNOWLEDGE>')='':
	gosub 'crt.obj','мв','','<knew>',0,1,'KNOWLEDGE'
end
time['goto']=1
goto 'page.<<args[0]>>'
--- mv ---------------------------------

QSP-Game ! локация извлекает текущий текст из описания противника
$args[0] = $args[0]	&	!	какого рода текст нужен
$args[1] = $args[1]	&	!	идентификатор противника
$args[2] = $args[2]	&	!	поступившие параметры
# war.txt
$args[9]=$args[9]
args['pit']=arrpos('$id_array',$args[1])
$args['enemy']=$object_array[args['pit']]
$args['name']=$func('get.n.p',$args['enemy'],'И')
$args['name.Р']=$func('get.n.p',$args['enemy'],'Р')
$args['name.Д']=$func('get.n.p',$args['enemy'],'Д')
$args['name.В']=$func('get.n.p',$args['enemy'],'В')
$args['sex']=$func('get.tag.cont',$args['enemy'],'sex')
$args['enemy.sw']=$func('get.tag.cont',$args['enemy'])
$args['enemy.txt']=$func('base.ratch',$args['enemy.sw'],'','blow')
args['enemy.cube']=func('get.tag.num',$args[2],'ecube')
args['enemy.might']=func('get.tag.num',$args[2],'emight')
args['enemy.blow']=func('get.tag.num',$args[2],'eblow')
args['enemy.power']=func('get.tag.num',$args[2],'epower')
args['hero.cube']=func('get.tag.num',$args[2],'pcube')
args['hero.fast']=func('get.tag.num',$args[2],'pfast')
args['hero.bns']=func('get.tag.num',$args[2],'pfbns')
if $args[0]='eblow':
	args['num']=args['enemy.cube']
	$args['text.type']=$args[0]
	$args['color']='880000'
	$args['text.reserve']=$func('base.txt','ef',$args['name'],GAME_WAR['ratch.blow.'+$args[1]])
	$args['add.str']="<sub><font color=#440000>[<<args['hero.cube']+args['hero.fast']+args['hero.bns']>>&lt;<<args['enemy.might']>> - ваша СИЛА снижается: <<power['now']>>=<<power['now']+args['enemy.blow']>>-<<args['enemy.blow']>>]</font></sub>"
elseif $args[0]='pblow':
	args['num']=args['hero.cube']
	$args['text.type']=$args[0]
	$args['color']='008800'
	$args['text.reserve']=$func('base.txt','hf',$args['name.Д'],$args['sex'],GAME_WAR['ratch.power.'+$args[1]])
	$args['add.str']="<sub><font color=#004400>[<<args['hero.cube']+args['hero.fast']+args['hero.bns']>>&gt;<<args['enemy.might']>> - СИЛА противника снижается: <<args['enemy.power']>>=<<args['enemy.power']+2>>-<<2>>]</font></sub>"
elseif $args[0]='pblock':
	args['num']=args['hero.cube']
	$args['text.type']=$args[0]
	$args['color']='666600'
	$args['text.reserve']=$func('base.txt','eea',$args['name'],$args['sex'])
	$args['add.str']="<sub><font color=#444400>[<<args['hero.cube']+args['hero.fast']+args['hero.bns']>>&gt;=<<args['enemy.might']>> - силы равны]</font></sub>"
elseif $args[0]='eblock':
	args['num']=args['enemy.cube']
	$args['text.type']=$args[0]
	$args['color']='666600'
	$args['text.reserve']=$func('base.txt','wehn',$args['name.Р'],$args['sex'])
	$args['add.str']="<sub><font color=#444400>[<<args['hero.cube']+args['hero.fast']+args['hero.bns']>>&gt;=<<args['enemy.might']>> - силы равны]</font></sub>"
elseif $args[0]='block':
	if args['enemy.cube']>args['hero.cube']:
		args['num']=args['enemy.cube']
		$args['text.type']='pblock'
	else
		args['num']=args['hero.cube']
		$args['text.type']='eblock'
	end
	$args['text.reserve']=$func('base.txt','wehn',$args['name.Р'],$args['sex'])
	$args['color']='666600'
	$args['add.str']="<sub><font color=#444400>[<<args['hero.cube']+args['hero.fast']+args['hero.bns']>>=<<args['enemy.might']>> - силы равны]</font></sub>"
elseif $args[0]='edeath':
	$args['text']=$func('get.tag.cont',$args['enemy.txt'],$args[0])
	$args['color']='008800'
	$args['text.reserve']=$func('base.txt','hve',$args['name.В'])
	jump 'replaced'
elseif $args[0]='pdeath':
	$args['text']=$func('get.tag.cont',$args['enemy.txt'],$args[0])
	$args['color']='880000'
	jump 'replaced'	
end
$args['text.list']=$func('get.tag.cont',$args['enemy.txt'],$args['text.type'])
$args['text']=$func('get.tag.cont',$args['text.list'],$str(args['num']))
:replaced
$args['war.cubes.e']="<sub><font color=#440000>[<<args['enemy.cube']>>]</font></sub>"
$args['war.cubes.p']="<sub><font color=#004400>[<<args['hero.cube']>>]</font></sub>"
$args['text']=$replace($args['text'],'[ecube]',$args['war.cubes.e'])
$args['text']=$replace($args['text'],'[pcube]',$args['war.cubes.p'])
$args['text']=$replace($args['text'],'[eblow]',"<sub><font color=#440000>[<<args['enemy.might']>>]</font></sub>")
if args['hero.bns']>0:
	$args['+']="+<<args['hero.bns']>>"
elseif args['hero.bns']<0:
	$args['+']="<<args['hero.bns']>>"
end
$args['text']=$replace($args['text'],'[pblow]',"<sub><font color=#004400>[<<args['hero.cube']+args['hero.fast']>><<$args['+']>>]</font></sub>")
$args['text']=$replace($args['text'],'[name]',$args['name'])
$args['text']=$replace($args['text'],'[name.В]',$args['name.В'])
$args['text']=$replace($args['text'],'[name.Д]',$args['name.Д'])
$args['text']=$replace($args['text'],'[name.Р]',$args['name.Р'])
if $args['text']='': $args['text']=$args['text.reserve'] else $args['text']='<font color=#'+$args['color']+'>'+$args['text']+'</font>'
$args['text']+='<br>	'+$args['add.str']
$args['text']=$replace($args['text'],'  ',' ')
$args['text']=$replace($args['text'],' .','.')
$args['text']=$replace($args['text'],' ,',',')
$result=$args['text']
--- war.txt ---------------------------------

QSP-Game ! локация выбирает новый мир из списка оставшихся
# world.new
args[0] = args[0]
gosub 'get.daughter.obj','KNOWLEDGE','\[t:выход:t\]'
if arrsize('$temp_id')<2:
	killvar '$temp_id'
	args['res.page']=args[0]
end
:for_gate
if arrsize('$temp_id')>0:
	args['res.page']+=func('get.tag.num',$object_array[arrpos('$id_array',$temp_id[0])],'page')
	killvar '$temp_id',0
	jump 'for_gate'
end
killvar '$temp_id'
$new_world[]='178'
$new_world[]='290'
$new_world[]='345'
$new_world[]='366'
if args['res.page']=242 or args['res.page']=263 or args['res.page']=318 or args['res.page']=404:
	killvar '$new_world',arrpos('$new_world','178')
end
if args['res.page']=290 or args['res.page']=345 or args['res.page']=366 or args['res.page']=393:
	killvar '$new_world',arrpos('$new_world','178')
end
if args['res.page']=242 or args['res.page']=130 or args['res.page']=75 or args['res.page']=641:
	killvar '$new_world',arrpos('$new_world','366')
end
if args['res.page']=290 or args['res.page']=345 or args['res.page']=178 or args['res.page']=393:
	killvar '$new_world',arrpos('$new_world','366')
end
if args['res.page']=151 or args['res.page']=318 or args['res.page']=130 or args['res.page']=598:
	killvar '$new_world',arrpos('$new_world','290')
end
if args['res.page']=366 or args['res.page']=345 or args['res.page']=178 or args['res.page']=393:
	killvar '$new_world',arrpos('$new_world','290')
end
if args['res.page']=151 or args['res.page']=263 or args['res.page']=75 or args['res.page']=467:
	killvar '$new_world',arrpos('$new_world','345')
end
if args['res.page']=290 or args['res.page']=366 or args['res.page']=178 or args['res.page']=393:
	killvar '$new_world',arrpos('$new_world','345')
end
if arrsize('$new_world')<>0:
	$result = $new_world[rand(0,arrsize('$new_world')-1)]
else
	$result = $str(args['res.page'])
end
killvar '$new_world'
--- world.new ---------------------------------

QSP-Game костыль для qSpider
# -
! пока не починят разделители меню
--- - ---
QSP-Game костыль добавления листа-вонючки
# лист_вонючка
$args['empty']=$func('prv.bag','','','место_в_рюкзаке')
$args['dyn']={if $args[0]='!use.on!':
	gosub 'del.obj.id',$args[1]
	$print[]='Вы использовали Лист. Он больше ни на что не годен.'
end}
if $args['empty']<>'':
	$args['id']=$func('crt.obj','лист_вонючка','','',0,1,$args['empty'],$args['dyn'])
	$print[]=$func('base.txt','add',$args['id'])
else
	$print[]=$func('base.txt','f','место_в_рюкзаке')
end
:ext
time['goto']=1
gosub 'true.goto'
--- лист_вонючка ---------------------------------

QSP-Game ! локация получает имя объекта из указанной строки по падежу
$args[0] = $args[0]	&	!	строка содержащая подстроку типа [name:ИМЯ Кого-то:name]
$args[1] = $args[1]	&	!	падеж И Р Д В Т П
# get.n.p
$args[0] = $func('get.tag.cont',$args[0],'name')
$args[0] = $func('get.word.padez',$args[0],$args[1])
$result = $args[0]
--- get.n.p ---------------------------------

QSP-Game ! вычисляет окончание по числу.
! args[0] - число
! $args[1] - окончания в формате a|b|c
# get.word.end
if args[0]<0: args[0] = -args[0]
$args[1] = $args[1]
args[2] = args[0] mod 10
args[3] = args[0] mod 100
$args['gwenda']='gwe_error'
if args[2]=1 and args[3]<>11:
	$args['gwenda']=$func('get.word.inPos',$args[1],1)
end
if args[2]>1 and args[2]<5 and (args[3]<5 or args[3]>20):
	$args['gwenda']=$func('get.word.inPos',$args[1],2)
end
if args[2]=0 or args[2]>4 or (args[3]>10 and args[3]<21):
	$args['gwenda']=$func('get.word.inPos',$args[1],3)
end
if args[0]=0 and $func('get.word.inPos',$args[1],4)<>'' and $func('get.word.inPos',$args[1],4)<>$args['gwenda']:
	$args['gwenda']=$func('get.word.inPos',$args[1],4)
end
$result=$args['gwenda']
--- get.word.end ---------------------------------

QSP-Game ! функция получает падеж из строки вида Именительныq|Родительный|Дательный|Винительный|Творительный|Предложный
$args[0] = $args[0]	&	!	строка
$args[1] = $args[1]	&	!	падеж
# get.word.padez
if $args[1]='И' or $args[1]='':
	$args['gwp']=$func('get.word.inPos',$args[0],1)
elseif $args[1]='Р':
	$args['gwp']=$func('get.word.inPos',$args[0],2)
elseif $args[1]='Д':
	$args['gwp']=$func('get.word.inPos',$args[0],3)
elseif $args[1]='В':
	$args['gwp']=$func('get.word.inPos',$args[0],4)
elseif $args[1]='Т':
	$args['gwp']=$func('get.word.inPos',$args[0],5)
elseif $args[1]='П':
	$args['gwp']=$func('get.word.inPos',$args[0],6)
end
$result=$args['gwp']
--- get.word.padez ---------------------------------

QSP-Game Запуск динамических скриптов на предметах
$args[0] = $args[0]	&	!	управляющая конструкция
$args[1] = $args[1]	&	!	ай-ди предмета, который обрабатываем, новый предмет| включение надстройки
$args[2] = $args[2]	&	!	ай-ди предмета, который обрабатываем, старый предмет/ динамический код, который нужно выполнить
$args[3] = $args[3]	&	!	прочая информация
# run.dynamic.script
$args[9]=$args[9]
if $args[1]<>'//run.this.dynamic//':
	args['pit']=arrpos('$id_array',$args[1])
	$args['dynamic']='$args[9] = $args[9]	&	!	строка инициализирующая аргументы
'+$run_array[args['pit']]
else
	$args['dynamic']='$args[9] = $args[9]	&	!	строка инициализирующая аргументы
'+$args[2]
	$args[1]=$curloc
	$args[2]=''
end
$args['rds']=$DYNEVAL($args['dynamic'],$args[0],$args[1],$args[2],$args[3])
$result=$args['rds']
--- run.dynamic.script ---------------------------------

QSP-Game локация отвечает за добавление предмета в рюкзак
# add.obj
$args[9]=$args[9]
args['pit']=arrpos('$id_array',$args[0])
$args['pos']=$func('get.tag.cont',$object_array[args['pit']],'pos')
$args['np']=$func('get.tag.cont',$object_array[args['pit']],"np")
$args['sw']=$func('get.tag.cont',$object_array[args['pit']])
if instr($args['np'],'[монета]')<>0:
	$args['кошел']=$func('prv.obj.inBag','кошель')
	if $args['кошел']="":
		$args['пояс']=$func('prv.bag','','','пояс_кошель')
		$args['кошел']=$func('crt.obj','кошель','','[quest]',0,1,$args['пояс'])
	end
	killvar '$temp_id'
	gosub 'get.daughter.obj',$args['кошел'],'\[:'+$args['sw']+':\]'
	$print[]=$func('base.txt','get',$args[0])
	if arrsize('$temp_id')>0:
		kolvo_array[arrpos('$id_array',$temp_id[0])]+=kolvo_array[args['pit']]
		gosub 'del.obj.id',$args[0]
	else
		$position_array[args['pit']]=$args['кошел']
	end
	killvar '$temp_id'
	jump 'ext'
end
if instr($run_array[args['pit']],'!addobj.id!')<>0: $args[0]=$func('run.dynamic.script','!addobj.id!',$args[0],'',$args[1])
if instr($run_array[args['pit']],'!addobj.pos!')<>0: $args[1]=$func('run.dynamic.script','!addobj.pos!',$args[0],'',$args[1])
if $args[1] = '':
	$args[1] = $func('prv.bag','','',$args['pos'])
	if $GAME_VALUE['endlessbag']='true' and $args[1]='':
		$args[1] = $func('crt.obj','место_в_рюкзаке','','<body>',0,1,'INVENTORY')
	end
	if $args[1] = '': $print[] = $func('base.txt','f',$args['pos']) & jump 'ext'
end
args['posobjinpos']=arrpos('$position_array',$args[1])
if args['posobjinpos']<>-1:
	gosub 'put.obj',$id_array[args['posobjinpos']],'//nope.goto//'
end
$position_array[arrpos('$id_array',$args[0])]=$args[1]
$print[]=$func('base.txt','add',$args[0])
:ext
if $args[2]<>'//nope.goto//':
	time['goto']=1
	if instr($run_array[args['pit']],'!addobj.goto!')<>0: $args['goto']=$func('run.dynamic.script','!addobj.goto!',$args[0],'',$args[1])
	if $args['goto']="":
		gosub 'true.goto'
	else
		goto $args['goto']
	end
end
--- add.obj ---------------------------------
АРГУМЕНТЫ:
$args[0] = $args[0]	&	!	идентификатор предмета
$args[1] = $args[1]	&	!	место в рюкзаке, куда хотим добавить предмет (идентификатор)
$args[2] = $args[2]	&	!	управляющая конструкция

QSP-Game Локация создаёт объект в игре
# crt.obj
$args[9]=$args[9]
if args[4] = 0: args[4] = 1
if $args[0]<>'':
	if instr($args[2],'<ratch>')<>0:
		$args[2] = $func('base.ratch',$args[0],$args[2])
	elseif instr($args[2],'<knew>')<>0:
		$args[2] = $func('base.knew',$args[0],$args[2])	
	elseif instr($args[2],'<body>')<>0:
		$args[2] = $func('base.body',$args[0],$args[2])
	else
		$args[2] = $func('base.obj',$args[0],$args[2])
	end
else
	$args[2] = $args[2]
end
if $args[1]='': $id_array[]=$func('#rndstr#',8,'буквы и цифры') else $id_array[]=$args[1]
$object_array[] = $args[2]
if $args[5]<>'':$position_array[] = $args[5] else $position_array[] = $curloc
charge_array[] = args[3]
kolvo_array[] = args[4]
$run_array[] = $args[6]
$result = $id_array[]
--- crt.obj ---------------------------------
АРГУМЕНТ
$args[0] = $args[0]	&	!	короткое имя предмета (если не указано, используется полное описание
$args[1] = $args[1]	&	!	предпочтительный ай-ди (если не указано генерируется автоматически)
$args[2] = $args[2]	&	!	полное описание предмета (условные обозначения, описывающие предмет)
args[3] = args[3]	&	!	заряд
args[4]	&	!	количество
$args[5] = $args[5]	&	!	идентификатор места расположения
$args[6] = $args[6]	&	!	динамический код предмета, выполняемый в нужных местах
!"Создаётся строка в таблице:
$id_array[] - идентификатор предмета
$object_array[] - полное описание предмета
$position_array[] - расположение предмета
charge_array[] - заряд предмета
kolvo_array[] - количество предмета"
QSP-Game ! Удаляет предмет по ай-дишнику из таблицы объектов
# del.obj.id
$args[0] = $args[0]
args['pos']=arrpos('$id_array',$args[0])
killvar '$id_array',args['pos']
killvar '$object_array',args['pos']
killvar '$position_array',args['pos']
killvar 'kolvo_array',args['pos']
killvar 'charge_array',args['pos']
killvar '$run_array',args['pos']
--- del.obj.id ---------------------------------

QSP-Game ! Функция получает все дочерние объекты для данного ай-ди.
! Результатом является true - есть дочерние, false - нет дочерних
! так же заполняется массив $temp_id
! $args[0] - ай-ди родительского объекта
! $args[1] - регулярное выражение по которому производится дополнительная фильтрация
! $args[2] - массив, в который вносятся 
! $args[3] - дополнительная проверка. ! регулярное выражение по которому производится дополнительная фильтрация. Сортировка идёт по данным в массиве $run_array[]ай-ди дочерних объектов.
# get.daughter.obj
$args[9] = $args[9]
if $args[2] = '': $args[2] = '$temp_id'	
if instr($args[2],'$')<>1: $args[2] = '$'+$args[2]
$args['gdo']='false'
args['pos']=-1
:for
if $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']="qSpider":
	args['pos']=arrpos('$position_array',$args[0],args['pos']+1)
else
	args['pos']=arrpos(args['pos']+1,'$position_array',$args[0])
end
if args['pos']<>-1 and args['i']<>args['pos']:
	args['i']=args['pos']
	if $args[1]='' or $strfind($object_array[args['pos']],$args[1])<>'':
		if $args[3]='' or $strfind($run_array[args['pos']],$args[3])<>'':
			$args['gdo']='true'
			dynamic "<<$args[2]>>[arrsize('<<$args[2]>>')]=$id_array[args[0]]",args['pos']
		end
	end
	jump 'for'
end
$result=$args['gdo']
--- get.daughter.obj ---------------------------------
! ВНИМАНИЕ. Первый объект, созданный в игре,
! должен находиться вне области поиска дочерних объектов.
! Т.е. нельзя создавать первым объект, помещённый в другой объект.

QSP-Game ! уменьшает количество предмета, и удаляет его, если количество меньше 1
$args[0] = $args[0]	&	!	идентификатор
args[1] = args[1]	&	!	количество
# minus.obj
args[9]=arrpos('$id_array',$args[0])
kolvo_array[args[9]]-=args[1]
if kolvo_array[args[9]]<1: gosub 'del.obj.id',$args[0]
--- minus.obj ---------------------------------

QSP-Game ! проверка инвентаря на наличие/отсутствие предмета.
В качестве результата возвращается первый идентификатор части тела с нужным предметом
! сначала получаем список частей тела, потом проверяем их на наличие предмета
$args[0] = $args[0]	&	!	идентиффикатор/регулярное выражение/строка
$args[1] = $args[1]	&	!	"тип проверки:
id - проверяем идентификатор
regexp - проверяем тело объекта по регэкспу
regrun - проверяем содержимое run_array на регэксп
если не указан тип проверки и идентификатор, значит ищем первую пустую ячейку рюкзака"
$args[2] = $args[2]	&	!	дополнительная проверка части тела на наличие метки (короткого слова)
# prv.bag
$args[9]=$args[9]
killvar '$temp_id'
gosub 'get.daughter.obj','INVENTORY','<body>'
:for
if arrsize('$temp_id')>0:
	args['pit']=arrpos('$id_array',$temp_id[0])
	args['pos']=arrpos('$position_array',$temp_id[0])
	if $args[2] = '' or instr($object_array[args['pit']],'[:'+$args[2]+':]'):
		if $args[1]='id' and $id_array[args['pos']]=$args[0]: jump 'exit'
		if $args[1]='regexp' and $strfind($object_array[args['pos']],$args[0])<>'': jump 'exit'
		if $args[1]='regrun' and $strfind($run_array[args['pos']],$args[0])<>'': jump 'exit'
		if $args[0]='' and $args[1]='' and args['pos']=-1: jump 'exit'
	end
	killvar '$temp_id',0
	jump 'for'
end
:exit
$result=$temp_id[0]
killvar '$temp_id'
--- prv.bag ---------------------------------

QSP-Game ! локация проверяет наличие предмета в рюкзаке и выдаёт его ид
! сначала происходи поиск предмета, потом проверяется его наличие в рюкзаке
# prv.obj.inBag
$args[0]=$args[0]
if $args[1]='': $args['type']='<body>' else $args['type']=$args[1]
args['pit']=-1
:for
if $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']="qSpider":
	args['pit']=arrcomp('$object_array','[\s\S]*\[:'+$args[0]+':\][\s\S]*',args['pit']+1)
else
	args['pit']=arrcomp(args['pit']+1,'$object_array','[\s\S]*\[:'+$args[0]+':\][\s\S]*')
end
if args['pit']<>-1:
	if instr($object_array[arrpos('$id_array',$position_array[args['pit']])],$args['type'])<>0:
		$args['res']=$id_array[args['pit']]
	else
		jump 'for'
	end
end
$result=$args['res']
--- prv.obj.inBag ---------------------------------

QSP-Game ! процедура сбрасывает предмет на текущей локации
$args[0] = $args[0]	&	!	идентификатор предмета
$args[1] = $args[1]	&	!	управление
args[2]=args[2]	&	!	количество
# put.obj
$args[9]=$args[9]
$args['prove']=$func('run.dynamic.script','!putobj.prv!',$args[0])
if $args['prove']='false':
	$print[]=$func('base.txt','n')
else
	if args[2]=0:
		$position_array[arrpos('$id_array',$args[0])]=$curloc
		$print[]=$func('base.txt','put',$args[0])
	else
		$args['sw']=$func('get.tag.cont',$object_array[arrpos('$id_array',$args[0])])
		gosub 'minus.obj',$args[0],args[2]
		gosub 'crt.obj',$args['sw'],'','',0,args[2]
	end
end
if instr($args[1],'//nope.goto//')=0:
	time['goto']=1
	gosub 'true.goto'
end
--- put.obj ---------------------------------

QSP-Game ! меняет два объекта местами. полезно для сортировки
$args[0] = $args[0]	&	!	ай-ди одного объекта
$args[1] = $args[1]	&	!	ай-ди другого объекта
# rtp.obj
$args[9]=$args[9]
args['pos0'] = arrpos('$id_array',$args[0])
args['pos1'] = arrpos('$id_array',$args[1])
$args['obj0']=$object_array[args['pos0']]
$args['p0']=$position_array[args['pos0']]
$args['in0']=$include_array[args['pos0']]
args['kolvo0']=kolvo_array[args['pos0']]
args['charge0']=charge_array[args['pos0']]
$args['respawn0']=$respawn_array[args['pos0']]
$args['run0']=$run_array[args['pos0']]
$id_array[args['pos0']]=$args[1]
$object_array[args['pos0']]=$object_array[args['pos1']]
$position_array[args['pos0']]=$position_array[args['pos1']]
$include_array[args['pos0']]=$include_array[args['pos1']]
kolvo_array[args['pos0']]=kolvo_array[args['pos1']]
charge_array[args['pos0']]=charge_array[args['pos1']]
$respawn_array[args['pos0']]=$respawn_array[args['pos1']]
$run_array[args['pos0']]=$run_array[args['pos1']]
$id_array[args['pos1']]=$args[0]
$object_array[args['pos1']]=$args['obj0']
$position_array[args['pos1']]=$args['p0']
$include_array[args['pos1']]=$args['in0']
kolvo_array[args['pos1']]=args['kolvo0']
charge_array[args['pos1']]=args['charge0']
$respawn_array[args['pos1']]=$args['respawn0']
$run_array[args['pos1']]=$args['run0']
--- rtp.obj ---------------------------------

QSP-Game пункт меню покупки предмета
# menu.buy
if $args[0] = '': $args[0] = $OOC['id']
$args['m']=$func('get.daughter.obj',$args[0],'\[np:[\s\S]*\[монета\][\s\S]*:np\]')
if $args['m']='true':
	$print[]=$func('base.txt','gift',$temp_id[0])
	gosub 'put.obj',$temp_id[0],'//nope.goto//',1
else
	$print[]=$func('base.txt','gift.no')
end
killvar '$temp_id'
time['goto']=1
gosub 'true.goto'
--- menu.buy ---------------------------------

QSP-Game ! локация выполняет динамическое меню
# menu.dynamic
if $args[0] = '': $args[0] = $OOC['id']
gosub 'run.dynamic.script','!menu.run!',$args[0],'','',args[0]
:ext
time['goto']=1
gosub 'true.goto'
--- menu.dynamic ---------------------------------

QSP-Game пункт меню "съесть предмет"
# menu.eat
if $args[0] = '': $args[0] = $OOC['id']
args['sit']=arrpos('$id_array',$args[0])
$args['obj']=$object_array[args['sit']]
$args['eating']=$func('get.tag.cont',$args['obj'],'eating')
$args['np']=$func('get.tag.cont',$args['obj'],'np')
if instr($args['np'],'[еда]')<>0: kolvo_array[args['sit']]-=1
if instr($args['np'],'[напиток]')<>0:
	if charge_array[args['sit']]>0:
		charge_array[args['sit']]-=1
	else
		$print[]=$func('base.txt','empt') & jump 'ext'
	end
end
if instr($args['np'],'[лекарство]')<>0:
	if $GAME_VALUE['приём лекарства']<>'разрешён':
		$print[]=$func('base.obj','notspec') & jump 'ext'
	else
		kolvo_array[args['sit']]-=1
	end
end
dynamic $args['eating'],$args[0]
if instr($run_array[args['pit']],'!eating!')<>0: $args['eat'] = $func('run.dynamic.script','!eating!',$args[0])
if kolvo_array[args['sit']]<1: gosub 'del.obj.id',$args[0]
if charge_array[args['sit']]<1:
	args['pot']=arrpos('$position_array',$args[0])
	if args['pot']<>-1: gosub 'del.obj.id',$id_array[args['pot']]
end
:ext
time['goto']=1
gosub 'true.goto'
--- menu.eat ---------------------------------

QSP-Game пункт меню "Информация о предмете"
# menu.info
if $args[0] = '': $args[0] = $OOC['id']
$temp_mi=$args[0]
args['sit']=arrpos('$id_array',$args[0])
$args['obj']=$object_array[args['sit']]
$args['np']=$func('get.tag.cont',$args['obj'],'np')
$args['text']=$func('int.DIN',$func('get.tag.cont',$args['obj'],'text'))
if $AVS_PLAYERTYPE['size']="MINI":
	$args['c']='444499'
	$args['c2']='666699'
else
	$args['c']='000044'
	$args['c2']='222244'
end
$print[]='<font color=#'+$args['c']+'>'+$args['text']+'</font>'
if kolvo_array[args['sit']]>1: $print[]='<font color=#'+$args['c']+'>Осталось '+$str(kolvo_array[args['sit']])+' '+$func('get.word.end',kolvo_array[args['sit']],'штука|штуки|штук')+'.</font>'
if instr($args['np'],'[фляга]')!0:
	args['заряд']=charge_array[args['sit']]
	if args['заряд']>0:
		args['pot']=arrpos('$position_array',$args[0])
		$args['flaga']=$func('get.word.end',args['заряд'],'Осталось на '+$str(args['заряд'])+' глоток.|Осталось на '+$str(args['заряд'])+' глотка.|Осталось на '+$str(args['заряд'])+' глотков.|Фляжка пуста.')
		args['power']=func('get.tag.num',$object_array[args['pot']],'power')
		$args['flaga']+=' Каждый глоток восстанавливает '+$str(args['power'])+' СИЛЫ.'
	else
		$args['flaga']='Фляга пуста.'
	end
	$args['flaga']=$args['flaga']
end
gosub 'get.daughter.obj',$args[0]
:for
if arrsize('$temp_id')>0:
	args['pit']=arrpos('$id_array',$temp_id[0])
	if instr($object_array[args['pit']],'[hide]')=0:
		$args['na']=$func('get.n.p',$object_array[args['pit']],'И')
		args['k']=kolvo_array[args['pit']]
		$args['ruker']+='<hr>'+$args['na']
		if instr($object_array[args['pit']],'[hide.kolvo]')=0: $args['ruker']+=': '+$str(args['k'])+' '+$func('get.word.end',args['k'],'штука|штуки|штук')+'.'
	end
	killvar '$temp_id',0
	jump 'for'
end
$print[]='<font color=#'+$args['c2']+'>'+$args['flaga']+$args['ruker']+'</font>'
killvar '$temp_id'
killvar '$temp_mi'
time['goto']=1
gosub 'true.goto'
--- menu.info ---------------------------------

QSP-Game пункт меню сброса предмета
# menu.put
if $args[0] = '': $args[0] = $OOC['id']
if instr($tvar['костыль.заголовок'],'<putlock:')!0:
	$args['putlock']=$func('get.tag.cont',$tvar['костыль.заголовок'],'putlock')
	$args['np']=$func('get.tag.cont',$object_array[arrpos('$id_array',$args[0])],'np')
	gosub '#str.inArray#',$args['putlock'],'$temp_id','( |	)','NOTSPACE REGULAR'
	gosub '#str.inArray#',$args['np'],'$temp_mi','( |	)','NOTSPACE REGULAR'
	$args['simp']=$func('#array.simp#','$temp_id','$temp_mi','conc/se')
	killvar '$temp_id'
	killvar '$temp_mi'
	if $args['simp']='true': $args['notput']='true' & jump 'ext'
end
if instr($tvar['динамический код'],'!put.lock!')<>0:
	$args['notput']=$func('run.dynamic.script','!put.lock!','//run.this.dynamic//',$tvar['динамический код'],$args[0])
end
if instr($tvar['костыль.заголовок'],'<lock.put>')<>0:
	$args['notput']='true'
end
:ext
if  $args['notput']<>'true':
	gosub 'put.obj',$args[0]
else
	$print[]=$func('base.txt','notput')
	time['goto']=1
	gosub 'true.goto'
end
--- menu.put ---------------------------------

QSP-Game Пункт меню продажи предмета
# menu.sale
if $args[0] = '': $args[0] = $OOC['id']
$args['монеты']=$func('get.tag.cont',$tvar['костыль.заголовок'],'avs-money')
$print[]=$func('base.txt','s',$args[0])
gosub 'del.obj.id',$args[0]
$args['m']=$func('crt.obj',$args['монеты'])
gosub 'add.obj',$args['m'],'','//nope.goto//'
:ext
time['goto']=1
gosub 'true.goto'
--- menu.sale ---------------------------------

QSP-Game ! использовать предмет
# menu.use
if $args[0] = '': $args[0] = $OOC['id']
args['pit']=arrpos('$id_array',$args[0])
$args['obj']=$object_array[args['pit']]
$args['short_word']=$func('get.tag.cont',$args['obj'])
$args['name.В']=$func('get.n.p',$args['obj'],'В')
$args['np']=$func('get.tag.cont',$args['obj'],'np')
$args['useoff']=$func('get.tag.cont',$args['obj'],'useoff')
if instr($args['np'],'[очки]')<>0: $args['идентификатор типа части тела']='лицо'
if instr($args['np'],'[шлем]')<>0: $args['идентификатор типа части тела']='голова'
if $args['useoff']<>0 and instr($tvar['костыль.заголовок'],'<'+$args['useoff']+'>')=0:
	$print[]=$func('base.obj',$args['short_word'],'','notspec')
	jump 'ext'
end
$args['bag']=$func('prv.bag','','',$args['идентификатор типа части тела'])
if arrpos('$position_array',$args['bag'])<>-1:
	$print[]=$func('base.txt','f',$args['идентификатор типа части тела'])
else
	$print[]=$func('base.txt','used',$args['идентификатор типа части тела'],$args['name.В'])
	$position_array[args['pit']]=$args['bag']
end
:ext
time['goto']=1
gosub 'true.goto'
--- menu.use ---------------------------------

QSP-Game ! процедура перемещает на локацию при использовании предмета
# menu.useon
if $args[0] = '': $args[0] = $OOC['id']
args['pit']=arrpos('$id_array',$args[0])
$args['obj']=$object_array[args['pit']]
$args['np']=$func('get.tag.cont',$args['obj'],'np')
time['goto']=1
if instr($args['np'],'[заряженный]')!0:
	if charge_array[args['pit']]>0:
		charge_array[args['pit']]-=1
	else
		$print[]=$func('base.txt',"discharge")
		gosub 'true.goto'
	end
end
if instr($args['np'],'[снаряд]')!0:
	gosub 'minus.obj',$args[0],1
end
args['useon']=func('get.tag.num',$args['obj'],'useon')
if instr($run_array[args['pit']],'!use.on!')!0:
	$args['l'] = $func('run.dynamic.script','!use.on!',$args[0])
end
goto 'page.'+$str(val($strfind($curloc,'page.(\d+)',1))+args['useon'])
--- menu.useon ---------------------------------

QSP-Game 
! локация организует меню для сохраннения и загрузки состояний игры
! Меню генерится и обрабатывается только этой локацией. Реализовано за счёт того, что локации
! обрабатывающей пункт меню, передаётся аргументом номер выбранного пункта. Годится только для
! меню фиксированного размера.
# avs.save
$args['save.name']=$func('#zero#',4-len($str(save['count']+1)))+$str(save['count']+1)+'_'
$args['loc']=$strfind($curloc,'\d+')
$args['save.name']+=$func('#zero#',3-len($args['loc']))+$args['loc']
if args[0]=0:
	killvar '$temp_menu'
	$temp_menu[]="Сохранить:avs.save"
	$temp_menu[]="Загрузить:avs.save"
	$temp_menu[]='-:-'
	if $AVS_PLAYERTYPE['type']='qSpider':
		$temp_menu[]="Загрузить чекпоинт [Q+W]:avs.save"
	else
		$temp_menu[]="Загрузить чекпоинт:avs.save"
	end
	$temp_menu[]="-:-"
	if $AVS_PLAYERTYPE['type']='qSpider':
		$temp_menu[]="Быстрое сохранение [Q+S]:avs.save"
	else
		$temp_menu[]="Быстрое сохранение:avs.save"
	end
	if $AVS_PLAYERTYPE['type']='qSpider':
		$temp_menu[]="Быстрая загрузка [Q+A]:avs.save"
	else
		$temp_menu[]="Быстрая загрузка:avs.save"
	end
	menu '$temp_menu'
	killvar '$temp_menu'
elseif args[0]=1:
	if nosave=0:
		save['count']+=1
		savegame
		if $GAME_VALUE['save.reserve']<>'false': 
			if $AVS_PLAYERTYPE='': savegame 'save/'+$save['game.number']+'_'+$args['save.name']+'.sav'
		end
	else
		$print[]=$func('base.txt','nosave')
	end
elseif args[0]=2:
	opengame
elseif args[0]=4:
	if save['check']>0:
		if $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']='qSpider':
			opengame '1.sav'
		else
			opengame 'save/autosave.sav'
		end
	else
		$print[]=$func('base.txt','notchp')
	end
elseif args[0]=6:
	if nosave=0:
		save['qs']+=1
		save['count']+=1
		$save['type']='quick'
		if $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']='qSpider':
			savegame '2.sav'
		else
			savegame 'save/quicksave.sav'
			if $GAME_VALUE['save.reserve']<>'false': savegame 'save/'+$save['game.number']+'_'+$args['save.name']+'.sav'
		end
		$print[]=$func('base.txt','save')
	else
		$print[]=$func('base.txt','nosave')
	end
elseif args[0]=7:
	if save['qs']>0:
		if $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']='qSpider':
			opengame '2.sav'
		else
			opengame 'save/quicksave.sav'
		end
	else
		$print[]=$func('base.txt','notqck')
	end
elseif args[0]=999:
	if nosave=0:
		save['check']+=1
		save['count']+=1
		$save['type']='auto'
		if $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']='qSpider':
			savegame '1.sav'
		else
			savegame 'save/autosave.sav'
			if $GAME_VALUE['save.reserve']<>'false': savegame 'save/'+$save['game.number']+'_'+$args['save.name']+'.sav'
		end
	else
		$print[]=$func('base.txt','nosave')
	end
end
if args[0]<>0 and args[0]<>999:
	time['goto']=1
	gosub 'true.goto'
end
--- avs.save ---------------------------------

QSP-Game ! локация организует меню переключения настроек интерфейса и игры
# avs.sets
killvar '$temp_menu'
if args[0]=0:
	if $GAME_VALUE['save.reserve']='false':
		$temp_menu[]=$args['span']+"Создавать резервные копии сохранений"+$args['/span']+":avs.sets"
	else
		$temp_menu[]=$args['span']+"Не создавать резервные копии сохранений"+$args['/span']+":avs.sets"
	end
	menu '$temp_menu'
	killvar '$temp_menu'
elseif args[0]=1:
	if $GAME_VALUE['save.reserve']='false':
		$GAME_VALUE['save.reserve']='true'
	else
		$GAME_VALUE['save.reserve']='false'
	end
end
if args[0]<>0:
	time['goto']=1
	gosub 'true.goto'
end
--- avs.sets ---------------------------------

QSP-Game загрузка чекпоинта
# save.checkpoint.load
gosub 'avs.save',4
- save.checkpoint.load -
QSP-Game быстрая загрузка
# save.quickload
gosub 'avs.save',7
- save.quickload -
QSP-Game быстрое сохранение
# save.quicksave
gosub 'avs.save',6
- save.quicksave -
QSP-Game локация отвечает за работу кнопки отката на шаг назад
# back.varriors
$args[0] = $args[0]
args['состояние']=arrsize('$survived_location')-2
$args['переменные']=$survived_varriors[args['состояние']]
$args['локация']=$survived_location[args['состояние']]
if $args[0]='':
	time['goto']=1
	$GAME_VALUE['back.code']='back'
	goto $args['локация']
elseif $args[0]='back':
	killvar '$survived_location',arrsize('$survived_location')-1
	killvar '$survived_varriors',arrsize('$survived_varriors')-1
	killvar '$GAME_VALUE'
	killvar 'fast' & killvar 'power' & killvar 'social'
	killvar '$id_array'
	killvar '$object_array'
	killvar '$position_array'
	killvar 'kolvo_array'
	killvar 'charge_array'
	killvar '$run_array'
	killvar '$num_unluck'
	killvar '$num_luck'
	killvar 'здесь_был'
	killvar 'удача_восст'
	killvar 'checkpoint'
	dynamic $args['переменные']
end
--- back.varriors ---------------------------------

QSP-Game алгоритм, выполняющийся каждый раз при загрузке игры
# onGameLoad
if $save['type']='quick':
	$print[]=$func('base.txt','qckload')
elseif $save['type']='auto':
	$print[]=$func('base.txt','chpload')
end
killvar "$GAME_HELP"
gosub 'true.goto'
--- onGameLoad ---------------------------------

QSP-Game код данной локации выполняется непосредственно перед сохранением
# onGameSave
killvar '$print'
killvar '$print_down'
--- onGameSave ---------------------------------

QSP-Game служебная локация для обработки перехода на новую локацию
Фактически здесь исходный текст книжки превращается в выводимый на экран.
# onNewLoc
	if $id_watch[]<>$curloc:
		$id_watch[] = $curloc
		killvar '$tvar'
		$GAME_VALUE['screen.floor']=''
		if $GAME_VALUE['back.code']<>'back':
			gosub 'save.varriors'
		else
			gosub 'back.varriors','back'
		end
		IF $AVS_PLAYERTYPE['type']="QN":
			$args['controlJS']='<a name="controlJS" id="controlJS" href="#"></a>'
		END
	end
	if arrsize('$id_watch')>100: killvar '$id_watch',0
	$refresh_watch[]=$curloc
	if arrsize('$refresh_watch')>9999: killvar '$refresh_watch',0
if val($strfind($curloc,'\d+'))>0 and strcomp($curloc,'page\.\d+')<>0:
	if ($AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']="qSpider") and $GAME_HELP['QN']='':
		$GAME_HELP['QN']='yep'
		$print[] = '<span style="color:#880000;">Внимание!!! Контрольные точки сохраняются в первом слоте, быстрые сохранения - во втором.</span> <br>'
	end
end
if здесь_был[$curloc]=0:
	здесь_был[$curloc]=1
end
if $lvar['исходник']<>'':
	$args['на экран']=$func('int.DIN',$lvar['исходник'])
	$args['список предметов']=$func('int.loc.obj',$curloc)
else
	$args['на экран']='<avs-main>'+$maintxt+'</avs-main>'
end
$tvar['костыль.заголовок']=$lvar['заголовок']
if instr($lvar['заголовок'],'<avs-enemy>')<>0:$args['на экран']+=$func('base.txt','war')
if instr($lvar['заголовок'],'<avs-money:')<>0: $args['на экран']+=$func('base.txt','sell')
if instr($lvar['заголовок'],'<avs-death>')<>0 or $GAME_VALUE['power.lose']='poweroff':
	if $GAME_VALUE['power.lose']='poweroff': $args['на экран']+=$func('base.txt','off')
	$args['на экран']+=$func('base.txt','wl')
	$args['список предметов']=''
	$GAME_INTERFACE['refresh']='страница.сброс'
	$GAME_VALUE['interface']=''
	nosave=1
else
	nosave=0
end
if instr($lvar['заголовок'],'<avs-victory>')<>0:
	$args['на экран']+=$func('base.txt','go')
	$args['список предметов']=''
	$GAME_INTERFACE['refresh']='страница.сброс'
	$GAME_VALUE['interface']=''
end
if instr($lvar['заголовок'],'<avs-game:')<>0:
	$args['на экран']+=$func('int.DIN',$func('base.txt','game.enemy',$func('get.tag.cont',$lvar['заголовок'],'avs-game')))
end
$args['на экран']+=$args['controlJS']
*clr
if $GAME_INTERFACE['refresh']<>'': gosub 'set.Screen',$GAME_INTERFACE['refresh']
$args['PRINTSCREEN']=$func('int.screen',$args['на экран'],$args['список предметов'],$lvar['заголовок'],$GAME_VALUE['interface'],$lvar['колонтитул'])
*pl $args['PRINTSCREEN']
if $refresh_watch[]=$refresh_watch[arrsize('$refresh_watch')-2] and time['goto']=0:
	wait 1
	*p '&nbsp;'
end
if $refresh_watch[]<>$refresh_watch[arrsize('$refresh_watch')-2]:
	if instr($tvar['костыль.заголовок'],'<avs-enemy>')<>0:
		$GAME_VALUE['приём лекарства']='запрещён'
	elseif $GAME_VALUE['приём лекарства']='запрещён':
		$GAME_VALUE['приём лекарства']='разрешён'
	else
		$GAME_VALUE['приём лекарства']=''
	end
end
killvar '$lvar'
killvar '$GAME_WAR'
killvar '$GAME_WAR_LOG'
if instr($tvar['костыль.заголовок'],'<checkpoint>')<>0 and checkpoint[$curloc]=0:
	checkpoint[$curloc]+=1
	gosub 'avs.save',999
end
time['goto']=0
--- onNewLoc ---------------------------------
[костыль 1]
данный костыль должен позволять прокручивать страницу при повторном посещении до низу.
смысл в чём. Элемент добавляется только тогда, когда страница посещена первый раз.
Если же элемент не найден, скрипт прокрутит полосу прокрутки до низа.
[костыль 2]
данный костыль скорее всего был нужен, чтобы убить временные переменные типа lvar до автосохранения,
чтобы при загрузке чекпоинта значения этих переменных не восстанавливались.

QSP-Game локация обрабатывающая клик на предмет
# onObjClick
$args[0] = $args[0]
$OOC['id']=$args[0]
args['sit'] = arrpos('$id_array',$args[0])
$args['obj']=$object_array[args['sit']]
$args['np']=$func('get.tag.cont',$args['obj'],'np')
$args['sw']=$func('get.tag.cont',$args['obj'],'')
killvar '$OOC_menu'
$OOC_menu[]='Информация:menu.info'
	if instr($run_array[args['sit']],'!menu.add!')<>0:
		$args['menu']=$func('run.dynamic.script','!menu.add!',$args[0])
		if $args['menu']!'': $OOC_menu[]=$args['menu']
	end
if instr($args['obj'],'[useon')!0:
	$args['useof']=$func('get.tag.cont',$tvar['костыль.заголовок'],'useof')
	if instr($args['useof'],'['+$args['sw']+']')<>0:
		$OOC_menu[]='Воспользоваться:menu.useon'
	end
end
if instr($tvar['костыль.заголовок'],'<avs-money:')<>0:
	$args['mass-sale']=$func('get.tag.cont',$tvar['костыль.заголовок'],'avs-obj')
	if $args['mass-sale']!'':
		if instr($args['mass-sale'],'['+$args['sw']+']')<>0:
			$OOC_menu[]='Продать:menu.sale'
		end
		killvar '$temp_mass'
	elseif instr($args['obj'],'[quest]')=0:
		$OOC_menu[]='Продать:menu.sale'
	end
end
if instr($args['np'],'[доспех]')<>0 and instr($object_array[arrpos('$id_array',$position_array[args['sit']])],'[:место_в_рюкзаке:]')<>0: $OOC_menu[]='Надеть:menu.use'
if $GAME_WAR['thiswar.'+$curloc]<>'war' and $GAME_WAR['thiswar.'+$curloc]<>'lose' and  $GAME_WAR['thiswar.'+$curloc]<>'prelose':
	if instr($args['np'],'[еда]')<>0: $OOC_menu[]='Съесть:menu.eat'
	if instr($args['np'],'[напиток]')<>0: $OOC_menu[]='Сделать глоток:menu.eat'
	if instr($args['np'],'[лекарство]')<>0: $OOC_menu[]='Подлечиться:menu.eat'
end
if instr($args['np'],'[кошель]')<>0 and instr($tvar['костыль.заголовок'],'<avs-buy>')<>0: $OOC_menu[]='Отдать монету:menu.buy'
if instr($args['obj'],'[quest]')=0:	$OOC_menu[]='Выбросить:menu.put'
if instr($tvar['костыль.заголовок'],'<lock.obj>')<>0: killvar '$OOC_menu' 
if instr($tvar['костыль.заголовок'],'<avs-death>')=0:
	if arrsize('$OOC_menu')>1:
			menu '$OOC_menu'
	else
		gosub 'menu.info',$args[0]
	end
end
--- onObjClick ---------------------------------

QSP-Game Проверка запущенного плеера
ВНИМАНИЕ!!! На момент написания этой локации существовал только костыльный способ определить, на каком плеере запущена игра
Quest Navigator и QSP имеют одинаковую версию библиотек (5.7.0. на 27.06.2020), поэтому пользуемся этим.
способ, предложенный newsash в теме http://qsp.su/index.php?option=com_agora&task=topic&id=658&Itemid=57:
t=1
tort=0
if t _
or _
t:
	"Игра запущена на Quest Navigator"
else
	"Игра запущена на Классике"
end
Данный способ работает благодаря разнице в интерпретации однострочной команды, разбитой на несколько строк.
В классическом плеере оператору условия передаётся имя переменной tort, тогда как в Quest Navigator это выражение
t or t
, результат которого равен 1.
# player.prv
if $QSPVER < '5.8.0':
t=1
tort=0
if t _
or _
t:
	$args['result']='[QN]'
else
	$args['result']=''
end
killvar 'tort' & killvar 't'
else
	if instr($QSPVER, '(classic)'):
		$args['result']=''
	else:
		$args['result']='[qSpider]'
	end
end
$result=$args['result']
--- player.prv ---------------------------------

QSP-Game локация, сохраняющая переменные в виде динамического кода в специальный массив:
# save.varriors
args['i']=0
:numluck
if args['i']<arrsize('$num_luck'):
	$args['luck']+="$num_luck[<<args['i']>>]='<<$num_luck[args['i']]>>'
"
	args['i']+=1
	jump 'numluck'
end
args['i']=0
:unluck
if args['i']<arrsize('$num_unluck'):
	$args['unluck']+="$num_unluck[<<args['i']>>]='<<$num_unluck[args['i']]>>'
"
	args['i']+=1
	jump 'unluck'
end
args['i']=0
:pit
if args['i']<arrsize('$id_array'):
	$args['pit']+="$id_array[<<args['i']>>]='<<$id_array[args['i']]>>'
$object_array[<<args['i']>>]='"+$replace($object_array[args['i']],"'","''")+"'
kolvo_array[<<args['i']>>]=<<kolvo_array[args['i']]>>
charge_array[<<args['i']>>]=<<charge_array[args['i']]>>
$position_array[<<args['i']>>]='<<$position_array[args['i']]>>'
$run_array[<<args['i']>>]='"+$replace($run_array[args['i']],"'","''")+"'
"
	args['i']+=1
	jump 'pit'
end
$survived_varriors[]="
$GAME_VALUE['power.lose']='<<$GAME_VALUE['power.lose']>>'
$GAME_VALUE['interface']='<<$GAME_VALUE['interface']>>'
$GAME_VALUE['приём лекарства']='<<$GAME_VALUE['приём лекарства']>>'
$GAME_VALUE['endlessbag']='<<$GAME_VALUE['endlessbag']>>'
$GAME_VALUE['game.cube.result']='<<$GAME_VALUE['game.cube.result']>>'
$GAME_VALUE['obj.inGame']='<<$GAME_VALUE['obj.inGame']>>'
$GAME_VALUE['save.reserve']='<<$GAME_VALUE['save.reserve']>>'
$GAME_VALUE['фиксация страницы']='<<$GAME_VALUE['фиксация страницы']>>'
GAME_VALUE['war.log']=<<GAME_VALUE['war.log']>>
GAME_VALUE['game.cube.party']=<<GAME_VALUE['game.cube.party']>>
GAME_VALUE['page.228']=<<GAME_VALUE['page.228']>>
fast['now']=<<fast['now']>> & fast['start']=<<fast['start']>>
social['now']=<<social['now']>> & social['start']=<<social['start']>>
power['now']=<<power['now']>> & power['start']=<<power['start']>>
"+$args['luck']+$args['unluck']+$args['pit']
$survived_location[]=$curloc
--- save.varriors ---------------------------------

QSP-Game локация формирует таблицу для вывода всех объектов игры на экран
# uc.obj
$args['res.021213']='<table width=100% cellpadding=0 cellspacing=2 border=1><tr><td>№П.П.</td><td>ID</td><td>Тело объекта</td><td>расположение</td><td>Дочерний:</td><td>кол-во</td><td>заряд</td></tr>'
args['i_inputText'] = 0
:new2
$args['res.021213']=$args['res.021213']+'<tr><td>['+$str(args['i_inputText'])+']</td><td>'+$id_array[args['i_inputText']]+'</td><td>'+$replace($replace($object_array[args['i_inputText']],'<','&lt;'),'>','&gt;')+'</td><td>{'+$position_array[args['i_inputText']]+'}</td><td>^'+$include_array[args['i_inputText']]+'^</td><td>'+$str(kolvo_array[args['i_inputText']])+'</td><td>'+$str(charge_array[args['i_inputText']])+'</td></tr>'
args['i_inputText']+=1
if arrsize('$id_array')>args['i_inputText']: jump 'new2'
$args['res.021213']+='<tr><td>№П.П.</td><td>ID</td><td>Тело объекта</td><td>расположение</td><td>Дочерний:</td><td>кол-во</td><td>заряд</td></tr></table>'
$result=$args['res.021213']
--- uc.obj ---------------------------------

QSP-Game ! микро-отладчик
! "команды
	p0 - переход на страницу 0. Вместо 0 можно указать номер любой другой страницы
	log - вывод логов
	objs - вывод таблицы всех объектов игры
	имя_переменной/a - вывод содержимого массива с указанным именем (ключ записывается с латинской a)
	way - вывод всех локаций, по которым продвигался игрок
	eb - включение и выключение бесконечного рюкзака
!"
# uc
if strcomp($user_text,'p\d+')<>0:
	$GAME_VALUE['interface']='[game]'
	$args['loc']='page.'+$strfind($user_text,'\d+')
	if (loc($args['loc']))<>0:
		goto $args['loc']
	else
		*pl "Такая страница не существует"
	end
elseif $user_text='objs':
	*pl $func('uc.obj')
elseif $user_text='eb' or $user_text='endless bug':
	if $GAME_VALUE['endlessbag']<>'true':
		$GAME_VALUE['endlessbag']='true'
		*pl "Включён бесконечный рюкзак."
	else
		$GAME_VALUE['endlessbag']=''
		*pl "Бесконечный рюкзак выключен."
	end
elseif $user_text='log':
	*pl $func('#array.prnt#','$log_error')
elseif $user_text='way':
	*pl $func('#array.prnt#','$survived_location')
elseif instr($user_text,'/a')=len($user_text)-1:
	*pl $func('#array.prnt#',$trim($mid($user_text,1,len($user_text)-2)))
elseif strcomp($user_text,'o\d+')=-1:
	args[9]=$strfind($user_text,'\d+')
	$replace($replace("
	$id_array[<<args[9]>>]='<<$id_array[args[9]]>>'
	$object_array[<<args[9]>>]='<<$object_array[args[9]]>>'
	$position_array[<<args[9]>>]='<<$position_array[args[9]]>>'
	kolvo_array[<<args[9]>>]=<<kolvo_array[args[9]]>>
	charge_array[<<args[9]>>]=<<charge_array[args[9]]>>
	$run_array[<<args[9]>>]='<<$run_array[args[9]]>>'",'<','&lt;'),'>','&gt;')
else
	dynamic $user_text
end
--- uc ---------------------------------

QSP-Game
! локация обрабатывает динамическую строку вида <DIN00:dynamic_code_text:00DIN>
# int.DINCODE
args['num.sup']=val($strfind($strfind($args[0],'<DIN\d+:'),'\d+'))
$args[0]=$replace($replace($args[0],"<DIN<<args['num.sup']>>:"),":<<args['num.sup']>>DIN>")
$args['int.DIN']=$DYNEVAL($args[0])
$result=$TRIM($args['int.DIN'])
--- int.DINCODE ---------------------------------

QSP-Game ! интерпретатор строки с точным тегом
# int.DINSTR
$args[0] = $args[0]
if instr($args[0],'[cur]')=1:
	$args['t']=$replace($replace($args[0],'[cur]'),'[/cur]')
	$args[666]=$TRIM($func('get.word.inPos',$args['t'],2))
	$args['t']=$TRIM($func('get.word.inPos',$args['t'],1))
	$args['res']='<a href="exec:goto ''<<$curloc>>'',''<<$args[666]>>''" title="возврат на текущую локацию с указанием параметра сброс" class="plain">'+$args['t']+'</a>'
	if power['now']<1: $args['res']='<i>'+$args['t']+'</i>'
end
if instr($args[0],'[obj]')=1:
	$args['string']=$replace($replace($args[0],'[obj]'),'[/obj]')
	$args['id']=$TRIM($func('get.word.inPos',$args['string'],1))
	$args['onLoc']=$func('get.word.inPos',$args['string'],2)
	$args['outLoc']=$func('get.word.inPos',$args['string'],3)
	args['pit.obj']=arrpos('$id_array',$args['id'])
	if $position_array[args['pit.obj']] = $curloc and power['now']>0:
		$args['res']='<a href="exec:gosub ''add.obj'',''<<$args["id"]>>''" title="добавление предмета" class="plain">'+$args['onLoc']+'</a>'
	else
		$args['res']='<i>'+$args['outLoc']+'</i>'
	end
end
if instr($args[0],'[knew]')=1:
	$args['string']=$replace($replace($args[0],'[knew]'),'[/knew]')
	$args['id']=$TRIM($func('get.word.inPos',$args['string'],1))
	$args['onLoc']=$func('get.word.inPos',$args['string'],2)
	$args['outLoc']=$func('get.word.inPos',$args['string'],3)
	$args['pit.knew']=$func('prv.obj.inBag',$args['id'],'<KNOWLEDGE>')
	if $args['pit.knew']!'' and power['now']>0:
		$args['res']=$args['onLoc']
	else
		$args['res']=$args['outLoc']
	end
	$args['res']=$args['res']
end
if instr($args[0],'[blaster]')=1:
	$args['string']=$replace($replace($args[0],'[blaster]'),'[/blaster]')
	args['charge']=val($TRIM($func('get.word.inPos',$args['string'],1)))
	$args['blst.charge']=$func('get.word.inPos',$args['string'],2)
	$args['b.discharge']=$func('get.word.inPos',$args['string'],3)
	$args['b.halfcharg']=$func('get.word.inPos',$args['string'],4)
		$args['pos.bl']=$func('prv.obj.inBag','бластер')
		args['pit']=arrpos('$id_array',$args['pos.bl'])
		if $args['pos.bl']!"" and charge_array[args['pit']]>=args['charge']:
			$args['res']=$args['blst.charge']
		elseif $args['pos.bl']!"" and charge_array[args['pit']]<args['charge'] and charge_array[args['pit']]>0:
			$args['res']=$args['b.halfcharg']
		else
			$args['res']=$args['b.discharge']
		end
end
if instr($args[0],'[usebl]')=1:
	$args['string']=$replace($replace($args[0],'[usebl]'),'[/usebl]')
	args['charge']=val($TRIM($func('get.word.inPos',$args['string'],1)))
	args['page']=val($TRIM($func('get.word.inPos',$args['string'],2)))
	$args['b.charge']=$func('get.word.inPos',$args['string'],3)
	$args['res']='<a href="exec:gosub ''blast.charge'',-<<args["charge"]>> & time[''goto'']=1 & goto ''page.<<args["page"]>>''" class="plain">'+$args['b.charge']+'</a>'
end
if instr($args[0],'[pow]')=1:
	args['p']=val($replace($replace($args[0],'[pow]'),'[/pow]'))
	$args['res']=$func('base.txt','pow',args['p'])
end
if instr($args[0],'[lovk]')=1:
	args['p']=val($replace($replace($args[0],'[lovk]'),'[/lovk]'))
	$args['res']=$func('base.txt','lovk',args['p'])
end
if instr($args[0],'[upluck]')=1:
	$args['p']=$replace($replace($args[0],'[upluck]'),'[/upluck]')
	$args['res']=$func('upluck')
	if $args['res']!'&nbsp;': $args['res']='<br><br><br><center><font color=#004400>'+$args['p']+'</font><br>'+$args['res']+'</center><br><br>'
end
if instr($args[0],'[social]')=1:
	$args['string']=$replace($replace($args[0],'[social]'),'[/social]')
	$args['yep']=$TRIM($func('get.word.inPos',$args['string'],1))
	$args['nop']=$TRIM($func('get.word.inPos',$args['string'],2))
	$args['res']=$func('social','href',val($args['yep']),val($args['nop']))
end
if instr($args[0],'[powernow]')=1:
	$args['string']=$replace($replace($args[0],'[powernow]'),'[/powernow]')
	if power['now']>0:
		$args['res']=$TRIM($func('get.word.inPos',$args['string'],1))
	else
		$args['res']=$TRIM($func('get.word.inPos',$args['string'],2))
	end
end
if instr($args[0],'[step]')=1:
	$args['string']=$replace($replace($args[0],'[step]'),'[/step]')
	args['yep']=val($TRIM($func('get.word.inPos',$args['string'],1)))
	$args['nop']=$TRIM($func('get.word.inPos',$args['string'],2))
	$args['res']='[page='+$func('world.new',args['yep'])+']'+$args['nop']+'[/page]'
end
if instr($args[0],'[fast]')=1:
	$args['string']=$replace($replace($args[0],'[fast]'),'[/fast]')
	$args['yep']=$TRIM($func('get.word.inPos',$args['string'],1))
	$args['nop']=$TRIM($func('get.word.inPos',$args['string'],2))
	$args['res']=$func('fast','href',val($args['yep']),val($args['nop']))
end
$result=$args['res']
--- int.DINSTR ---------------------------------

QSP-Game ! генерирует из строки ссылку на страницу
# href.page
$args[0] = $args[0]
if instr($args[0],'[page=')=1:
	$args['page']=$strfind($args[0],'\[page=(\d+)\]',1)
	$args['href']=$replace($replace($args[0],'[/page]'),'[page='+$args['page']+']')
elseif instr($args[0],'<a l:href="#n_')=1:
	$args['page']=$strfind($args[0],'<a l:href="#n_(\d+)">',1)
	$args['href']=$replace($replace($args[0],'</a>'),'<a l:href="#n_'+$args['page']+'">')
end
if instr($lvar['заголовок'],'<avs-death>')=0:
	$args['res']='<a href="exec:time[''goto'']=1 & goto ''page.'+$args['page']+'''" title="переход на другую страницу" class="plain">'
	$args['res']+=$args['href']+'</a>'
else
	$args['res']=$args['href']
end
$result=$args['res']
--- href.page ---------------------------------

QSP-Game ! локация преобразующая всяческие динамические тексты в готовый текст
# int.DIN
$args[0] = $args[0]
:next_str
if $strfind($args[0],'<DIN(\d+):[\s\S]*?:\1DIN>')<>'':
	$args['sup']=$args[0]
	:still_DIN
	$args['sup']=$strfind($args['sup'],'<DIN(\d+):[\s\S]*?:\1DIN>')
	if $args['sup']<>"":
		$args['sup.mem'] = $args['sup']
		$args['sup']=$strfind($args['sup'],'<DIN(\d+):([\s\S]*?):\1DIN>',2)
		jump 'still_DIN'
	else
		$args['sup.new']=$func('int.DINCODE',$args['sup.mem'])
		$args[0] = $replace($args[0],$args['sup.mem'],$args['sup.new'])
	end
	jump 'next_str'
elseif $strfind($args[0],'\[page=\d+\][\s\S]*?\[\/page\]')<>'':
	$args['new.text'] = $strfind($args[0],'\[page=\d+\][\s\S]*?\[\/page\]')
	$args[0] = $replace($args[0],$args['new.text'],$func('href.page',$args['new.text']))
	jump 'next_str'
elseif $strfind($args[0],'\[(\D+)\][\s\S]*?\[\/\1\]')<>'':
	$args['new.text'] = $strfind($args[0],'\[(\D+)\][\s\S]*?\[\/\1\]')
	$args['tag'] = $strfind($args[0],'\[(\D+)\][\s\S]*?\[\/\1\]',1)
	$args['string']=$func('get.tag.cont',$args['new.text'],$args['tag'])
	if $strfind($args['string'],'\[(\D+)\][\s\S]*?\[\/\1\]')<>'':
		$args['new.str']=$replace($args['new.text'],$args['string'],$func('int.DIN',$args['string']))
		$args[0]=$replace($args[0],$args['new.text'],$args['new.str'])
		$args['new.text']=$args['new.str']
	end
	$args['new.string']=$func('int.DINSTR',$args['new.text'])
	$args[0] = $replace($args[0],$args['new.text'],$args['new.string'])
	jump 'next_str'
elseif $strfind($args[0],'<a l:href="#n_\d+">[\s\S]+?<\/a>')<>'':
	$args['new.text'] = $strfind($args[0],'<a l:href="#n_\d+">[\s\S]+?<\/a>')
	$args[0] = $replace($args[0],$args['new.text'],$func('href.page',$args['new.text']))
	jump 'next_str'
end
$args[0]=$replace($args[0],'     ','&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;')
$args[0]=$replace($args[0],'--','—')
$result=$args[0]
--- int.DIN ---------------------------------

QSP-Game Генератор списка ссылок на подъём предметов
Интерпретатор предметов на локации
# int.loc.obj
$args[0] = $args[0]
if $func('get.daughter.obj',$args[0],'<obj>','$temp_id')='true':
	:for
	if arrsize('$temp_id')>0:
		$args['obj']=$object_array[arrpos('$id_array',$temp_id[0])]
		$args['name'] = $func('get.word.padez',$func('get.tag.cont',$args['obj'],'name'),'В')
		if instr($args['obj'],'[hide.onloc]')=0 and $strfind($lvar['исходник'],'\[obj\]\s*'+$temp_id[0]+'\s*\|')='':
			$args['res']+='&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="exec:gosub ''add.obj'',''<<$temp_id[0]>>''" title="добавление предмета" class="plain">'
			$args['res']+='<font color=#008888>Взять '+$args['name']+'</font></a><br>'
		end
		killvar '$temp_id',0
		jump 'for'
	end
end
$result=$args['res']
--- int.loc.obj ---------------------------------

QSP-Game ! локация, выписывающая готовый текст в таблицу экрана.
# int.screen
args[9]=args[9]
:заголовок
if $args[2]='' and instr($curloc,'page')<>0:
	$args['head']=$strfind($curloc,'\d+')
else
	$args['head']=$args[2]
end
if $args[4]='' and instr($curloc,'page')<>0:
	$args['colontitle']=$strfind($curloc,'\d+')
else
	$args['colontitle']=$args[4]
end
if $args['colontitle']<>'' and $args['colontitle']<>'nope':
	$args['colontitle']='-'+$args['colontitle']+'-'
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['colontitle']='<span class="avs_text_colontitle">'+$args['colontitle']+'</span>'
	else
		$args['colontitle']='<font color=#888888 size=1>'+$args['colontitle']+'</font>'
	end
else
	$args['colontitle']=''
end
if instr($args[2],'<checkpoint>')<>0:
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['result.head']='<span class="avs_text_head_chp">'+$args['head']+'</span>'
	else
		$args['result.head']='<font color=#994400 size=6><b>'+$args['head']+'</b></font>'
	end
elseif instr($args[2],'<checkpoint>')=0:
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['result.head']='<span class="avs_text_head_smp">'+$args['head']+'</span>'
	else
		$args['result.head']='<font color=#008899 size=6><b>'+$args['head']+'</b></font>'
	end
end
:ссылка_назад
if $GAME_INTERFACE['back.href']='true':
	$args['hr.b']='<a href="exec:gosub ''back.varriors''" class="plain" id="avs_back_btn">'
	$args['hr.b.n']='Назад'
	$args['/hr.b']="</a>"
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['back.href']=$args['hr.b']+$args['hr.b.n']+$args['/hr.b']
	else
		$args['back.href']=$args['hr.b']+'<font color=#008888><b>'+$args['hr.b.n']+'</b></font>'+$args['/hr.b']
	end
else
	$args['back.href']="&nbsp;"
end
if instr($args[3],'[game]')=1:
	:статы
	$args['stat']='<table class="avs_game_stat_short">'
		$args['stat']+='<tr><td align=right>'
			$args['stat']+=$func('base.txt','table.char')
		$args['stat']+='</td></tr>'
		$args['stat']+='<tr name=numbers><td align=right>'
			$args['stat']+=$func('base.txt','table.numbers')
		$args['stat']+='</td></tr>'
		$args['stat']+='<tr name=knew><td align=right>'
			$args['stat']+=$func('base.txt','table.knew')
		$args['stat']+='</td></tr>'
	$args['stat']+='</table>'
	:предметы
	$args['objs.scroll']=$func('base.txt','table.blast')
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['objs.scroll']=$args['objs.scroll']
	else
		$args['objs.scroll']="<table cellpadding=0 cellspacing=0><tr><td>"+$args['objs.scroll']+"</td></tr></table>"
	end
	:дополнительные_тексты
	if arrsize('$print')>0 or arrsize('$print_down')>0:
		if arrsize('$print')>0: $args['r']=$func('#array.prnt#','$print','[only result]')
		if arrsize('$print_down')>0:
			if $AVS_PLAYERTYPE['size']="MINI":
				$args['print.down.log']=$func('#array.prnt#','$print_down','[only result]')
			else
				$args['r']+=$func('#array.prnt#','$print_down','[only result]')
			end
		end
		if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
			$args['r']='<span class="avs_text_infoscroll">'+$args['r']+'</span>'
		else
			$args['r']='<font color=#000088>'+$args['r']+'</font>'
		end
		$args['info.scroll']='<table cellspacing=0 width=100%>'
			$args['info.scroll']+='<tr name=printsp bgcolor=#fdfdff><td align=left>&nbsp;</td></tr>'
			$args['info.scroll']+='<tr name=printpr bgcolor=#fdfdff><td align=left>'+$args['r']+'</td></tr>'
		$args['info.scroll']+='</table>'
	else
		$args['info.scroll']='&nbsp;'
	end
	if $AVS_PLAYERTYPE['size']="MINI":
		$args['objs_n_info']='<table width=100% cellpadding=0 cellspacing=0 border=0>'
	elseif $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']='qSpider':
		$args['objs_n_info']='<table class="avs_game_objs_short">'
	else
		$args['objs_n_info']='<table cellpadding=0 cellspacing=0 border=0>'
	end
		$args['objs_n_info']+='<tr name=blast><td>'
			$args['objs_n_info']+=$args['objs.scroll']
		$args['objs_n_info']+='</td></tr>'
		$args['objs_n_info']+='<tr name=print><td>'
			$args['objs_n_info']+=$args['info.scroll']
		$args['objs_n_info']+='</td></tr>'
	$args['objs_n_info']+='</table>'
else
	$args['stat']='&nbsp;'
	$args['objs_n_info']='&nbsp;'
end
if $args['info.scroll']='&nbsp;' and $args['objs.scroll']='&nbsp;':
	$args['width.right']='width=5%'
	$args['width.center']=''
else
	$args['width.right']='width=25%'
	$args['width.center']='width=50%'
end
$args['maintxtOp']='<table width=100% border=0>'
	$args['maintxtOp']+='<tr><td name="maintxtOp">'+$args[0]+'<br><br></td></tr>'
	if $args[1]<>'':
		$args['maintxtOp']+='<tr name=objects><td bgcolor=#f0ffff>'+$func('base.txt','note.objLoc')+$args[1]+'</td></tr>'
	end
$args['maintxtOp']+='</table>'
$args[0]=$args['maintxtOp']
if $GAME_INTERFACE['next.href']='true':
	$args['hr.np']='<a href="exec:power[''now'']=power[''start''] & $GAME_VALUE[''interface'']=''[game]'' & $GAME_INTERFACE[''refresh'']=''страница.сброс'' & goto ''page.<<$str(val($strfind($curloc,"\d+"))+1)>>''" id="avs_next_btn">'
	$args['/hr.np']='</a>'
	$args['hr.np.n']="next"
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['nextpage']=$args['hr.np']+$args['hr.np.n']+$args['/hr.np']
	else
		$args['nextpage']=$args['hr.np']+'<font color=#008888>'+$args['hr.np.n']+'</font>'+$args['/hr.np']
	end
elseif (instr($args[3],'[game]')=1 or save['count']>0):
	$args['hr.np.e']='<a href="exec:gosub ''avs.sets''" class="plain" id="avs_epsilon_btn">'
	$args['hr.np.s']='<a href="exec:gosub ''avs.save''" class="plain" id="avs_septima_btn">'
	$args['/hr.np']='</a>'
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['nextpage']+=$args['hr.np.e']+"é"+$args['/hr.np']
		$args['nextpage']+='&nbsp;'
		$args['nextpage']+=$args['hr.np.s']+"S"+$args['/hr.np']
	else
		$args['nextpage']+=$args['hr.np.e']+"<font color=#008888><b>é</b></font>"+$args['/hr.np']
		$args['nextpage']+='&nbsp;'
		$args['nextpage']+=$args['hr.np.s']+"<font color=#008888><b>S</b></font>"+$args['/hr.np']
	end
else
	$args['nextpage']='&nbsp;'
end
if $AVS_PLAYERTYPE['size']<>"MINI":
	if $AVS_PLAYERTYPE['type']='' or $AVS_PLAYERTYPE='':
		$args['result']='<center><table cellpadding=10 border=0 width=100%>'
			if $args['head']<>'':
				$args['result']+='<tr name=head>'
					$args['result']+='<td width=25% align=right>'+$args['back.href']+'</td>'
					$args['result']+='<td <<$args["width.center"]>> align=center>'+$args['result.head']+'</td>'
					$args['result']+='<td <<$args["width.right"]>> >'+$args['nextpage']+'</td>'
				$args['result']+='</tr>'
			end
			$args['result']+='<tr name=centr>'
				$args['result']+='<td valign=top align=right width=25%>'+$args['stat']+'</td>'
				$args['result']+='<td <<$args["width.center"]>> valign=top>'+$args[0]+'</td>'
				$args['result']+='<td <<$args["width.right"]>> valign=top align=left>'+$args['objs_n_info']+'</td>'
			$args['result']+='</tr>'
			if $args['colontitle']<>'':
				$args['result']+='<tr>'
					$args['result']+='<td valign=top align=right width=25%>&nbsp;</td>'
					$args['result']+='<td <<$args["width.center"]>> name=btm valign=middle align=center>'+$args['colontitle']+'</td>'
					$args['result']+='<td <<$args["width.right"]>> valign=top align=left>&nbsp;</td>'
				$args['result']+='</tr>'
			end
		$args['result']+='</table></center>'
	elseif $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']="qSpider":
		if $args['stat']<>'' or $args['back.href']<>'':
			$args['result']='<div id="avs_game_left_column">'
				if $args['back.href']<>'': $args['result']+='<div id="avs_game_back">'+$args['back.href']+'</div>'
				if $args['stat']<>'': $args['result']+='<div id="avs_game_statisctics">'+$args['stat']+'</div>'
			$args['result']+='</div>'
		end
		$args['result']+='<div id="avs_game_center_column">'
			if $args['result.head']<>'': $args['result']+='<div id="avs_game_head">'+$args['result.head']+'</div>'
			$args['result']+='<div id="avs_game_opinion">'+$args[0]+'</div>'
			if $args['colontitle']<>'': $args['result']+='<div id="avs_game_colontitle">'+$args['colontitle']+'</div>'
		$args['result']+='</div>'
		$args['result']+='<div id="avs_game_right_column">'
			if $args['nextpage']<>'': $args['result']+='<div id="avs_game_sets">'+$args['nextpage']+'</div>'
			if $args['objs_n_info']<>'': $args['result']+='<div id="avs_game_objects">'+$args['objs_n_info']+'</div>'
		$args['result']+='</div>'
		if $AVS_PLAYERTYPE['type']="qSpider":
			$args['result']='<div id="avs_main_screen">'+$args['result']+'</div>'
		end
	end
else
	$args['back.to.page']='<a href="exec:$GAME_VALUE[''screen.floor'']='''' & gs ''true.goto''" id="avs_backtopage_btn">'
	$args['back.to.up']='<a href="exec:gs ''true.goto''" id="avs_backtoup_btn">'
	$args['open.stat']='<a href="exec:$GAME_VALUE[''screen.floor'']=''STATS'' & gs ''true.goto''" id="avs_openstat_btn">'
	$args['open.objs']='<a href="exec:$GAME_VALUE[''screen.floor'']=''OBJS'' & gs ''true.goto''" id="avs_openobjs_btn">'
	if $AVS_PLAYERTYPE['type']="" or $AVS_PLAYERTYPE='':
		if arrsize('$print')>0:
			$args['result']+=$args['info.scroll']
			$args['result']+='<br><font color=#0000ff>[</font>'+$args['back.to.up']+'Назад</a><font color=#0000ff>]</font><br>'		
		else
			if $args['back.href']<>"&nbsp;":
				if $GAME_VALUE['screen.floor']='STATS' or $GAME_VALUE['screen.floor']='OBJS':
					$args['tools']+='<font color=#0000ff>[</font>'+$args['back.to.page']+'Закрыть</a><font color=#0000ff>]</font> &nbsp; &nbsp; '
				else
					$args['tools']+='<font color=#0000ff>[</font>'+$args['back.href']+'<font color=#0000ff>]</font> &nbsp; &nbsp; '
				end
				if $GAME_VALUE['screen.floor']='STATS':
					$args['tools']+='<font color=#888888>[<<fast["now"]>>|<<power["now"]>>|<<social["now"]>>]</font> &nbsp; &nbsp; '
				else
					$args['tools']+='<font color=#0000ff>[</font>'+$args['open.stat']+'<<fast["now"]>>|<<power["now"]>>|<<social["now"]>></a><font color=#0000ff>]</font> &nbsp; &nbsp; '
				end
				if $GAME_VALUE['screen.floor']='OBJS':
					$args['tools']+='<font color=#888888>[Предметы]</font>'
				else
					$args['tools']+='<font color=#0000ff>[</font>'+$args['open.objs']+'Предметы</a><font color=#0000ff>]</font>'
				end
			end
			if $GAME_VALUE['screen.floor']='STATS':
				$args['result']+='<b>'+$args['tools']+'</b>'+'<br><br>'
				$args['result']+=$args['stat']
				$args['result']+='<br><br>'+'<b>'+$args['tools']+'</b>'
				$args['result']+='<h2><a href="exec:gosub ''avs.save'',6">Быстрое сохранение</a></h2>'
				$args['result']+='<h2><a href="exec:gosub ''avs.save'',7">Быстрая загрузка</a></h2>'
				$args['result']+='<h2><a href="exec:gosub ''avs.save'',4">Загрузить контрольную точку</a></h2>'
			elseif $GAME_VALUE['screen.floor']='OBJS':
				$args['result']+='<b>'+$args['tools']+'</b>'+'<br><br>'
				$args['result']+=$args['objs.scroll']
				$args['result']+='<br><br>'+'<b>'+$args['tools']+'</b>'
			else
				if $args['back.href']<>"&nbsp;":$args['result']+='<b>'+$args['tools']+'</b>'
				$args['result']+='<h2>'+$args['result.head']+'</h2>'
				$args['result']+=$args[0]
				$args['result']+=$args['print.down.log']
				$args['result']+=$args['colontitle']
				if $args['back.href']<>"&nbsp;":$args['result']+='<br>'+'<b>'+$args['tools']+'</b>'
			end
		end
	elseif $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']="qSpider":
		if arrsize('$print')>0:
			$args['result']+=$args['info.scroll']
			$args['result']+='<span class="avs_text_minibtn">['+$args['back.to.up']+'Назад</a>]</span><br>'		
		else
			if $args['back.href']<>"&nbsp;":
				if $GAME_VALUE['screen.floor']='STATS' or $GAME_VALUE['screen.floor']='OBJS':
					$args['tools']+='<span class="avs_text_minibtn">['+$args['back.to.page']+'Закрыть</a>]</span> &nbsp; &nbsp; '
				else
					$args['tools']+='<span class="avs_text_minibtn">['+$args['back.href']+']</span> &nbsp; &nbsp; '
				end
				if $GAME_VALUE['screen.floor']='STATS':
					$args['tools']+='<span class="avs_text_minibtn_disactive">[<<fast["now"]>>|<<power["now"]>>|<<social["now"]>>]</span> &nbsp; &nbsp; '
				else
					$args['tools']+='<span class="avs_text_minibtn">['+$args['open.stat']+'<<fast["now"]>>|<<power["now"]>>|<<social["now"]>></a>]</span> &nbsp; &nbsp; '
				end
				if $GAME_VALUE['screen.floor']='OBJS':
					$args['tools']+='<span class="avs_text_minibtn_disactive">[Предметы]</span>'
				else
					$args['tools']+='<span class="avs_text_minibtn">['+$args['open.objs']+'Предметы</a>]</span>'
				end
			end
			if $GAME_VALUE['screen.floor']='STATS':
				$args['result']+=$args['tools']+'<br><br>'
				$args['result']+=$args['stat']
				$args['result']+='<br><br>'+$args['tools']
				$args['result']+='<h2><a href="exec:gosub ''avs.save'',6">Быстрое сохранение</a></h2>'
				$args['result']+='<h2><a href="exec:gosub ''avs.save'',7">Быстрая загрузка</a></h2>'
				$args['result']+='<h2><a href="exec:gosub ''avs.save'',4">Загрузить контрольную точку</a></h2>'
			elseif $GAME_VALUE['screen.floor']='OBJS':
				$args['result']+=$args['tools']+'<br><br>'
				$args['result']+=$args['objs.scroll']
				$args['result']+='<br><br>'+$args['tools']
			else
				if $args['back.href']<>"&nbsp;":$args['result']+=$args['tools']
				$args['result']+='<h2>'+$args['result.head']+'</h2>'
				$args['result']+=$args[0]
				$args['result']+=$args['print.down.log']
				$args['result']+=$args['colontitle']
				if $args['back.href']<>"&nbsp;":$args['result']+='<br>'+$args['tools']
			end
		end
		if $AVS_PLAYERTYPE['type']="QN": $args['result']='<div class="avs_game_mini_all">'+$args['result']+"</div>"
	end
end
killvar '$print'
killvar '$print_down'
$result=$args['result']
--- int.screen ---------------------------------
АРГУМЕНТЫ:
$args[0] = $args[0]	&	!	текст экрана
$args[1] = $args[1]	&	!	список предметов
$args[2] = $args[2]	&	!	заголовок
$args[3] = $args[3]	&	!	управление
$args[4] = $args[4]	&	!	колонтитул

QSP-Game локация предназначена для переключения режимов настройки интерфейса (экрана)
'обложка.чёрный' — это режим начальной обложки, то есть окна лаунчера и стартового экрана
'страница.сброс' — режим всех страниц игры
# set.Screen
showacts 0
showobjs 0
showstat 0
if $args[0] = 'обложка.чёрный':
	fcolor = rgb (0,200,0)
	bcolor = rgb (15,16,17)
	lcolor = rgb (0,100,0)
	$fname = 'Comic Sans MS'
	$args["bc"]="000000"
	$args["fc"]="00C800"
	$args["lc"]="006400"
elseif $args[0] = 'страница.сброс':
	$args["bc"]="ffffff"
	$args["fc"]="000000"
	$args["lc"]="008888"
	$fname = 'Consolas'
	fcolor = rgb(0,0,0)
	bcolor = rgb(255,255,255)
	lcolor = rgb(0,136,136)
end
if (instr($AVS_PLAYERTYPE,'[QN]')<>0 or $AVS_PLAYERTYPE['type']="QN") and $args["bc"]<>'':
	EXEC('JS:document.body.style.backgroundColor="#'+$args["bc"]+'";')
	EXEC('JS:document.body.style.color="#<<$args["fc"]>>";')
end
$GAME_INTERFACE['refresh']=''
--- set.Screen ---------------------------------

# true.goto
if $GAME_WAR['thiswar.'+$curloc]='':
	goto $curloc
elseif $GAME_WAR['thiswar.'+$curloc]='war':
	gosub 'int.war.screen',$curloc
else
	gosub 'int.war.screen',$curloc,$GAME_WAR['thiswar.'+$curloc]
end
--- true.goto ---------------------------------

QSP-Game ! НЕПОСРЕДСТВЕННО НАЧАЛО ИГРЫ. ПОЛУЧАЕМ ВСЕ ОСНОВНЫЕ ХАРАКТЕРИСТИКИ И ПРЕДНАСТРОЙКИ
# page.-1
$lvar['заголовок']={Выбор характеристик}
$lvar['колонтитул']={nope}
gosub 'set.mainsets',val($args[0])
$lvar['исходник']={<p align=justify><font color=#004400><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В fb2-версии книги-игры предлагается бросить кубики для определения начальных характеристик персонажа. Здесь бросать кубики не нужно. Начальные характеристики персонажа определены случайным образом. Однако, как и в случае с бумажной книгой, никто не мешает немножко сжульничать и выбрать те значения, которые вам по душе. Выбранные значения подсвечены жёлтым цветом.</i></font></p>
<br><center>}+$func('base.txt','table.mainsets',$str(cube['start']))+{<br>
<font color=#004400><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;А это числа, которые в дальнейшем будут означать удачу, или неудачу:</i></font><br><br>}+$func('base.txt','table.numbers')+{<br><br>[page=0]Приступить к игре с текущими характеристиками[/page]</center>}
showinput 1
if здесь_был[$curloc]=0:
	gosub 'set.presets'
end
--- page.-1 ---------------------------------

# page.0
$lvar['заголовок']={ПРЕДИСЛОВИЕ}
if $args[0]='' and $GAME_VALUE['фиксация страницы']!'': $args[0]=$GAME_VALUE['фиксация страницы']
if $GAME_VALUE['back.code']='back': $args[0]='page7'
if $args[0]='':
$lvar['колонтитул']={страница 1}
$lvar['исходник']={<p align=justify>«Входите, майор, шеф ждёт вас. Опять неприятности в Лаборатории Мерфи». 

Голос секретарши шефа подозрительно мягок — значит, вас ждёт особо опасное задание. А тут ещё упоминание о Лаборатории Мерфи... 

Ох, и попортил же вам крови этот громадный — как два хороших города — научно-исследовательский центр! Там есть всё: гениальнейшие учёные, исполнительнейшие лаборанты, современнейшее исследовательское оборудование, умнейшие компьютеры, океан энергии... Нет там только одного — порядка. Не было, нет и никогда не будет!.. 

«Опять Лаборатория?» — спрашиваете вы, входя в кабинет. 

«Там произошла кража», — морщится шеф. 

«И когда у них всё будет тихо-мирно! Почему бы им не изобрести что-нибудь такое, чтобы избавиться от неприятностей и оставить в покое Патруль и полицию?» 

«Нет уж, лучше не надо! Они уже пробовали! Помнишь Супермозг, сынок?» 

Ещё бы! Такое не забывается. Супермозг, компьютер последнего поколения, немыслимой сложности устройство, был в порядке испытания брошен на административное руководство Лабораторией Мерфи. Сложность его и подвела. Супермозг перехватил обрывок трансляции художественного фильма (это был фантастический боевик), принял его как руководство к действию и объявил войну Лунной Обсерватории. Очень много шуму было. Вы как раз всё это и расхлебывали... 

[cur]«Но какое отношение Патруль имеет к краже? А полиция за что деньги получает?»|page1[/cur]</p>}
elseif $args[0]='page1':
$lvar['колонтитул']={страница 2}
$lvar['исходник']={<p align=justify>«Ты не спросил, что похищено, сынок. Опытный образец бета-аннигилятора. Кошмарная штуковина. Размером с рюкзачок, а сумеет превратить в ослепительную вспышку большой остров. А если по этому образцу построить приборчик покрупнее, можно пускать на распыл планеты...» 

«Но почему всё-таки с этим не может разобраться полиция? Или они уже не расследуют дел серьёзнее, чем угон летающих велосипедов от школьной стоянки?» 

«По двум причинам, сынок. Во-первых, удалось установить, что ворюга работает на Паука. Помнишь пиратского босса, которого ты брал на внешнем кольце Сатурна? Он потом с каторги удрал... Так что это наше дело и наш клиент. Во-вторых, негодяй исчез в Веренице Миров. Он сейчас где угодно, но не на Земле». 

Вы опускаетесь в кресло, поняв, что от задания не отбрыкаться. 

«Всё, сэр, сдаюсь и готов слушать. Сначала о клиенте...»

«Дэвид Бронсон. Всё». 

«Как это — всё?» 

«Перед тем как исчезнуть, Бронсон стёр в компьютерной памяти все данные о себе. Работал он в группе изучающей Вереницу Миров. Там сотрудники какие-то чокнутые, ничего не замечают, кроме своих записей и приборов. Возраст похитителя, рост, цвет волос, цвет глаз — все по-разному описывают. Дружно сходятся лишь в одном: у Бронсона были совершенно потрясающие уши! Как у слона! Да, вот ещё: украденный прибор находится в обычном пластиковом рюкзаке лилового цвета...» 

«Исчерпывающее описание, шеф. Остаётся протянуть руку и схватить вора за шиворот... [cur]теперь слушаю про Вереницу Миров|page3[/cur]»</p>}
elseif $args[0]='page3':
$lvar['колонтитул']={страница 3}
$lvar['исходник']={<p align=justify>«Это система мгновенного межпространственного перемещения. По какому принципу действует — не спрашивай. Я этого не пойму, даже если весь персонал Лаборатории Мерфи хором начнет объяснять. Какие-то Ворота: входишь здесь, а выходишь на другой планете. Причем где эта планета находится — пока не известно. Может, вообще не в нашей Вселенной. А может, в ближайшей солнечной системе. Поэтому все планеты, куда можно таким образом попасть, носят условные названия, например... — Шеф скашивает взгляд в записи. — ...Мир Лиловых Зорь, Мир Легенд, Мир Дружелюбных Тарантулов, Мир Камней, Мир Сновидений, Мир Роботов, Мир Грозных Призраков, Мир Стрекоз, Мир мёртвых Морей... всего девятнадцать миров. В каждом инженеры Лаборатории Мерфи установили Ворота Связи — для перехода в иные миры. Увы, Ворота подчиняются лишь одному закону — закону Мерфи. Они зашвырнут вас туда, куда сами сочтут нужным. Есть и ещё одно осложнение. Карты исследованных земель с обозначенными на них Воротами наш мерзавец Бронсон предусмотрительно захватил с собой...» 

«Поправьте меня, сэр, если я неправильно вас понял. Мне предстоит попасть на малоисследованную планету, причем в неизвестно какую её точку; выяснить, нет ли там человека, о котором известно лишь, что у него большие уши, а за плечами лиловый рюкзак; после чего перейти в другой мир и продолжить поиски. Так? О таком задании я мечтал всю жизнь! Перерыть от полюса до полюса девятнадцать планет!..»

«Не преувеличивай, сынок. Конечно, это задание повышенной паршивости, но Ворота — устройство с ограниченным радиусом действия, так что «от полюса до полюса» — это ты зря... К тому же Ворота обладают некоей, условно говоря, «памятью», и высока вероятность того, что они забросят тебя туда же, куда перед этим забросили твоего противника. Если, конечно, не вмешается закон Мерфи...» 

«А возвращение? [cur]Как вернуться на Землю?|page4[/cur]»</p>}
elseif $args[0]='page4':
$lvar['колонтитул']={страница 5}
$lvar['исходник']={<p align=justify>«О, с этим проще! Существует силовое устройство, способное выдернуть путешественника из любого Мира и вернуть на Землю». 

«Тогда почему бы не воспользоваться им, чтобы вернуть беглеца?» 

«Увы, устройство сейчас... как бы это сказать...» 

«Неисправно?» — догадываетесь вы. 

«Дорабатывается, — дипломатично говорит шеф. — Через полгода будет в полном порядке». 

Полгода! За полгода Бронсон успеет связаться с Пауком — наверняка у них это продумано заранее. И, если вы хоть что-то понимаете в пиратской душе, через полгода Паук станет повелителем Галактики... 

«Шеф, — кротко интересуетесь вы, — не слишком ли это простое поручение? Не мало ли неприятностей на мою голову?»

«Угадал! — вздыхает шеф. — В Вереницу Миров прорвался кое-кто ещё...» 

Экран над столом вспыхивает, на нём появляется лицо симпатичной кареглазой девушки с задорно вздернутым носиком и коротко остриженными каштановыми волосами. 

«[cur]Мэри Коуфорд...|page5[/cur]</p>}
elseif $args[0]='page5':
$lvar['колонтитул']={страница 6}
$lvar['исходник']={<p align=justify>
...Да-да, дочь того самого Дэна Коуфорда, что прежде был знаменитым пиратом, а теперь стал богатейшим из вольных торговцев. Хотел бы я знать, как он раздобыл помилование за былые похождения... Дочка вся в папашу. Авантюристка до мозга костей. Ненавидит Паука и всегда рада подставить ему подножку. Отличная актриса. Знает дзюдо, умело владеет чуть ли не всеми видами оружия. В случае необходимости сумеет поднять звездолет, а возможно, и проложить для него курс. Девятнадцать лет... Не хмыкай, она опасна, как пантера!» 

«Шеф, может быть, вы и невысокого мнения обо мне лично, но уж команда-то моя как-нибудь справится с девятнадцатилетней девчонкой!» 

«А вот это — последний сюрприз. Ты идёшь на задание один. Ворота не выдержат такой нагрузки — перебрасывать всю команду. Оставишь здесь и стажёров с Плутона, и своего любимого пса-мутанта, и даже, представь себе, Клушу!» 

Это и в самом деле удар! КЛУ-6, криминалистическая лабораторная установка, шестая модель... Ваш личный робот, верный соратник и незаменимый помощник!.. Правда, Клуша зачастую занудна, болтлива, чересчур заботлива, но сколько раз она спасала вас от провала операции, а то и от смерти... 

«Не переживай, сынок. Клуша будет связана с тобой телепатически. Подробности сообщит инженер, отвечающий за Ворота. Всё, инструктаж окончен». 

Встав, шеф добавляет официально: 

«[cur]Возвращайтесь с победой, майор!|page6[/cur]»</p>}
elseif $args[0]='page6':
$lvar['колонтитул']={страница 7}
$lvar['исходник']={<p align=justify>Как же, вернёшься тут с победой! Инженер, собирающий вас в дорогу, больше всего озабочен тем, чтобы вы взяли с собою как можно меньше вещей. Даже форменную бляху Патруля вам велели снять с пояса — при Переходе важен каждый грамм. 

«Это лишь при старте с Земли, — утешает вас инженер. — В следующих Воротах можете тащить за собой хоть тушу мамонта». 

«Только мамонта мне и не хватало... А бластер?! Уж не собираетесь ли вы отправить меня в этот космический лабиринт без бластера?» 

«Бластер взять можно, он лёгкий. Но не более одного заряда! Иначе произойдет детонация, и вы прибудете на место в разобранном виде... Впрочем, и это важно лишь при старте с Земли. Если в Веренице Миров вам попадутся заряды — берите хоть сотню...» 

Восхитительная перспектива! Добывать заряды для боевого линейного излучателя в Мире Развесёлых Тараканов... или как их там — Дружелюбных Тарантулов. 

Хуже всего с приборами. Оказывается, они не выдерживают Перехода и начинают барахлить. Единственное устройство, которое учёные сумели защитить от пагубного воздействия Ворот, — это наглухо запаянный на руке металлический браслет. Он выполняет три функции. Во-первых, это автопереводчик. Вы сможете общаться с любым разумным существом в Веренице Миров. Во-вторых, с помощью браслета вы будете поддерживать телепатическую связь с Клушей. Достаточно отдать мысленный приказ — и в мозгу зазвучит знакомый хрипловатый голос с въедливыми интонациями... Есть на браслете и маленький чёрный глазок. Если он замигает красным — значит, где-то поблизости аннигилятор, а при нём, надо полагать, и похититель... 

Вы скептически оглядываете лёгкий [cur]пластиковый рюкзак тёмно-синего цвета|page7[/cur].</p>}
elseif $args[0]='page7':
$lvar['колонтитул']={страница 8}
$lvar['исходник']={<p align=justify>В <DIN9:if $KOSTYL['возврат_к_предисловию']='page7': $GAME_VALUE['interface']='[game]'
if $GAME_VALUE['interface']='[game]': $KOSTYL['возврат_к_предисловию']='page7'
$GAME_VALUE['фиксация страницы']='page7':9DIN>нём могли бы поместиться шесть предметов, но вредные учёные столько взять не позволяют. Вам предлагают на выбор одну из трёх вещей, примерно равных по массе: [obj]НЧВДН_000004|инфракрасные очки «Ночное зрение»[/obj], [obj]ЗЖГЛК_000005|зажигалку[/obj] или [obj]ТЮБИК_000006|тюбик питательной пасты[/obj], которая в любой момент восстановит ваши силы до первоначального уровня (увы, пасты хватит лишь на один приём). Кроме того, у вашего пояса — обычное оружие исследователей Вереницы Миров: длинный, похожий на палаш, нож, прочный, лёгкий, с рукоятью из пластиката. 

«Хорошо, что не нужен защитный скафандр, — говорит инженер деловито. — На всех планетах атмосфера сходна с земной... кстати, у большинства обитателей Вереницы Миров и метаболизм близок к земному». 

«Это означает, что если какая-нибудь местная зверюга сожрёт меня, то у неё не будет болеть живот?» 

«Вот именно, — невозмутимо отвечает инженер. - Но многих из этих зверюг и вы сможете... э-э... употребить в пищу... Сведения о Мирах будете получать от КЛУ-6. — Инженер оборачивается к лаборанту. — Введены ли данные в память установки?» 

«Так точно, введены! — четко отвечает лаборант и вдруг, не выдержав, фыркает: — Послушайте, майор, как вы можете работать с такой занудой? К тому же у неё блок эмоций начисто забивает логические центры!» 

«Полегче! — обрывает подчинённого инженер. — Клушу проектировал я сам, ещё в молодости...» 

Вы с трудом сдерживаетесь, чтобы не спросить инженера: а нельзя ли что-нибудь у Клуши развинтить, чтоб не была такой болтливой?.. 

Наконец сборы окончены — [page=1]пора стартовать[/page]. 
 </p>}
end
$lvar['колонтитул']+={-
-<a href="exec:goto $curloc,'page7'" class="plain">пролистать</a>}
if здесь_был[$curloc]=0:
$args['динамический код предметов']={![page0.dErT]
if $args[0]='!addobj.pos!' and $curloc='page.0':
$GAME_VALUE['interface']='[game]'
$GAME_INTERFACE['refresh']='страница.сброс'
	! ищем идентификатор сумки с предметом, содержащим текущий код.
	$args['id']=$func('prv.bag','!'+'\['+'page0\.'+'dErT\]','regrun')
	! подменяем позицию
	if $args['id']!'':
		$result=$args['id']
		exit
	end
end
if $args[0]='!putobj.prv!' and $curloc!'page.0':
! если предмет сбрасывается на другой локации, нужно избавиться от динамического кода и метки [hide.onloc]
	args['pit']=arrpos('$id_array',$args[1])
	$object_array[args['pit']]=$replace($object_array[args['pit']],'[hide.onloc]')
	$args['run']=$strfind($run_array[args['pit']],'!'+'\['+'page0\.'+'dErT\]'+'[\s\S]*'+'!'+'\[\/'+'page0\.'+'dErT\]')
	$run_array[args['pit']]=$replace($run_array[args['pit']],$args['run'])
end
![/page0.dErT]
}
gosub 'crt.obj','ночное_видение',"НЧВДН_000004",'[hide.onloc]',0,1,'',$args['динамический код предметов']
gosub 'crt.obj','зажигалка',"ЗЖГЛК_000005",'[hide.onloc]',0,1,'',$args['динамический код предметов']
gosub 'crt.obj','питательная_паста',"ТЮБИК_000006",'[hide.onloc]',0,1,'',$args['динамический код предметов']
end
--- page.0 ---------------------------------

# page.999
! протонная граната +60
! антигравитатор +80
! рог +96
! подводная маска -40
! плод -176
! фиолетовый плод +204
! огнетушитель -100
! семена +160
! кольцо +40
! зеркало -268
! пояс -60
! чёрный луч 100
! виброотмычка +172
! лист вонючка -140
! жидкость -80
$lvar['заголовок']={Все предметы}
$lvar['исходник']={Внимание!!! Данная локация предназначена для облегчения тестирования игры, или если у вас возникли проблемы с прохождением.
<font size=0><table border=0 cellpadding=0 width=100%><tr><td><a href="exec:gosub 'crt.obj','ворот' & goto $curloc" class="plain">Создать ворот</a></td><td><a href="exec:gosub 'crt.obj','палаш' & goto $curloc" class="plain">Создать палаш</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','бластер' & goto $curloc" class="plain">Создать бластер</a></td><td><a href="exec:gosub 'crt.obj','ночное_видение' & goto $curloc" class="plain">Создать Ночное Зрение</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','зажигалка' & goto $curloc" class="plain">Создать зажигалку</a></td><td><a href="exec:gosub 'crt.obj','питательная_паста' & goto $curloc" class="plain">Создать питательную пасту</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','протонная_граната' & goto $curloc" class="plain">Создать протонную гранату</a></td><td><a href="exec:gosub 'crt.obj','свеча' & goto $curloc" class="plain">Создать свечу</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','антигравитатор' & goto $curloc" class="plain">Создать антигравитатор</a></td><td><a href="exec:gosub 'crt.obj','рог' & goto $curloc" class="plain">Создать рог</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','кольцо' & goto $curloc" class="plain">Создать кольцо-антиграв</a></td><td><a href="exec:gosub 'crt.obj','подводная_маска' & goto $curloc" class="plain">Создать подводную маску</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','зеркало' & goto $curloc" class="plain">Создать зеркало</a></td><td><a href="exec:gosub 'crt.obj','кошель' & goto $curloc" class="plain">Создать кошель</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','шлем' & goto $curloc" class="plain">Создать шлем</a></td><td><a href="exec:gosub 'crt.obj','короны_розы' & goto $curloc" class="plain">Создать Короны-Розы</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','шар' & goto $curloc" class="plain">Создать шар</a></td><td><a href="exec:gosub 'crt.obj','бант_оранжевый' & goto $curloc" class="plain">Создать оранжевый бант</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','лист_вонючка' & goto $curloc" class="plain">Создать лист-вонючку</a></td><td><a href="exec:gosub 'crt.obj','фляга' & goto $curloc" class="plain">Создать флягу</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','жидкость' & goto $curloc" class="plain">Создать жидкость</a></td><td><a href="exec:gosub 'crt.obj','шкура' & goto $curloc" class="plain">Создать шкуру</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','перчатка' & goto $curloc" class="plain">Создать перчатку</a></td><td><a href="exec:gosub 'crt.obj','смола' & goto $curloc" class="plain">Создать смолу</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','маска_кроко' & goto $curloc" class="plain">Создать маску зверя</a></td><td><a href="exec:gosub 'crt.obj','плюмаж' & goto $curloc" class="plain">Создать плюмаж</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','рыбка' & goto $curloc" class="plain">Создать рыбку</a></td><td><a href="exec:gosub 'crt.obj','плод' & goto $curloc" class="plain">Создать плод</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','деревянный_кинжал' & goto $curloc" class="plain">Создать деревянный кинжал</a></td><td><a href="exec:gosub 'crt.obj','меорвин' & goto $curloc" class="plain">Создать меорвин</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','птица' & goto $curloc" class="plain">Создать жаркое</a></td><td><a href="exec:gosub 'crt.obj','огнетушитель','','',1,1 & goto $curloc" class="plain">Создать огнетушитель</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','пояс' & goto $curloc" class="plain">Создать пояс</a></td><td><a href="exec:gosub 'crt.obj','семена' & goto $curloc" class="plain">Создать семечко сорняка</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','консервы' & goto $curloc" class="plain">Создать Консервы</a></td><td><a href="exec:gosub 'crt.obj','плащ' & goto $curloc" class="plain">Создать плащ</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','ягода' & goto $curloc" class="plain">Создать мясистую ягоду</a></td><td><a href="exec:gosub 'crt.obj','вервь' & goto $curloc" class="plain">Создать верёвку</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','клык' & goto $curloc" class="plain">Создать амулет Клык</a></td><td><a href="exec:gosub 'crt.obj','чл' & goto $curloc" class="plain">Создать Чёрный луч</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','мясо' & goto $curloc" class="plain">Создать Мясо</a></td><td><a href="exec:gosub 'crt.obj','плод_фиолетовый' & goto $curloc" class="plain">Создать Фиолетовый Плод</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','во' & goto $curloc" class="plain">Создать Виброотмычку</a></td><td><a href="exec:gosub 'crt.obj','ракетка' & goto $curloc" class="plain">Создать Ракетку</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','лечебная_паста' & goto $curloc" class="plain">Создать заживляющую пасту</a></td><td><a href="exec:gosub 'crt.obj','мясо1' & goto $curloc" class="plain">Создать Кусочек мяса</a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','аннигилятор' & goto $curloc" class="plain">Создать Аннигилятор</a></td><td><a href="exec:gosub 'crt.obj','защитник_служанок','','<knew>',0,1,'KNOWLEDGE' & $print[]='Защита Служанки выполнена.' & goto $curloc" class="plain"><font color=#004400>Отметить событие Защита служанки</font></a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','выход_27','','<knew>',0,1,'KNOWLEDGE' & goto $curloc" class="plain"><font color=#004400>Запись о воротах №27</font></a></td><td><a href="exec:gosub 'crt.obj','выход_48','','<knew>',0,1,'KNOWLEDGE'  & goto $curloc" class="plain"><font color=#004400>Запись о воротах №48</font></a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','выход_103','','<knew>',0,1,'KNOWLEDGE' & goto $curloc" class="plain"><font color=#004400>Запись о воротах №103</font></a></td><td><a href="exec:gosub 'crt.obj','выход_215','','<knew>',0,1,'KNOWLEDGE'  & goto $curloc" class="plain"><font color=#004400>Запись о воротах №215</font></a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','тюрьма','','<knew>',0,1,'KNOWLEDGE' & goto $curloc" class="plain"><font color=#004400>Узнать, как выбраться из тюрьмы</font></a></td><td><a href="exec:gosub 'crt.obj','лапа_дракона','','<knew>',0,1,'KNOWLEDGE'  & goto $curloc" class="plain"><font color=#004400>Узнать, что сказать грабителям</font></a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'crt.obj','великое_древо','','<knew>',0,1,'KNOWLEDGE' & goto $curloc" class="plain"><font color=#004400>Узнать, куда идти от Великого Древа</font></a></td><td><a href="exec:gosub 'crt.obj','бертольд','','<knew>',0,1,'KNOWLEDGE'  & goto $curloc" class="plain"><font color=#004400>Узнать, что сказать Бертольду</font></a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'blast.charge',-1 & goto $curloc" class="plain"><font color=#884400>-1 заряд бластеру</font></a></td><td><a href="exec:gosub 'blast.charge',1 & goto $curloc" class="plain"><font color=#884400>+1 заряд к бластеру</font></a></td></tr>}
$lvar['исходник']+={<tr><td><a href="exec:gosub 'flaga','','вода'" class="plain"><font color=#880088>Наполнить флягу водой</font></a></td><td><a href="exec:gosub 'flaga','','нектар'" class="plain"><font color=#880088>Наполнить флягу нектаром</font></a></td></tr></table></font>}
--- page.999 ---------------------------------

# page.death
$lvar['заголовок']+='<avs-death>'
--- page.death ---------------------------------

# page.1
$lvar['заголовок']={Лаборатория Мерфи}
$lvar['исходник']={<p align=justify>     Ворота выглядят не так, как вы их себе представляли. У ваших ног — большая металлическая чаша. Вторая чаша — перевернутая — куполом нависает над первой на высоте в полтора человеческих роста. А между ними — столб тёплого золотого света. 
     Вы уже приготовились вступить в световой поток, как вдруг инженер кладет руку вам на плечо. 
     «Ещё одна просьба. Из-за подлого Бронсона у нас перепутаны все сведения в банке данных... Обратите внимание — над каждыми Воротами обозначен их кодовый номер. Будем признательны, если запишете для нас номера всех Ворот, через которые вам придётся пройти». 
     «Ладно, это нетрудно. Но я же вижу, что вы ещё что-то хотите сказать!» 
     «Да, — хмуро кивает инженер, — должен предупредить. Если вы вторично попадёте в Мир, где недавно уже побывали, произойдет перегрузка основного контура, и вас зашвырнет неизвестно куда, в любую точку Вселенной... Вселенной... или даже за её пределы. Это непредсказуемо!» 
     «Это как раз то, что мне хотелось услышать для поднятия духа», — мрачно отвечаете вы и <DIN1:cube=rand(1,4)
if cube=1:
	$result='[page=366]делаете шаг вперёд[/page]'
elseif cube=2:
	$result='[page=290]делаете шаг вперёд[/page]'
elseif cube=3:
	$result='[page=345]делаете шаг вперёд[/page]'
else
	$result='[page=178]делаете шаг вперёд[/page]'
end:1DIN>...
 </p>}
$log_this+="tvar.qn.help:"+str(tvar['QN.help'])+"<br>"
$GAME_VALUE['interface']='[game]'
$GAME_INTERFACE['refresh']='страница.сброс'
$GAME_INTERFACE['back.href']='true'
--- page.1 ---------------------------------

# page.2
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],454,262):1DIN>"
--- page.2 ---------------------------------

# page.3
$lvar['заголовок']={Мир Стрекоз<avs-enemy>}
$lvar['исходник']={<center><font size=+1>КУСТ-ХИЩНИК

ЛОВКОСТЬ 9     СИЛА 10</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.411'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','куст_хищник','КУСТХ_010101','<ratch>'
end
--- page.3 ---------------------------------

# page.4
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ваши следы остаются на осыпавшейся со стен подъезда штукатурке. На первом этаже лишь одна [page=624]дверь[/page]. Зайдёте туда или попытаетесь подняться на [page=352]второй этаж[/page] по расшатанной, разбитой лестнице?</p>}
--- page.4 ---------------------------------

# page.5
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Звери убиты, но сюда может пожаловать ещё кто-нибудь из их стаи... Вы решаете быть начеку и, прислонившись спиной к толстому корявому стволу, ожидаете рассвета. Это было бы нетрудно, но, увы, Клуша, которую приводит в ужас мысль, что вы можете уснуть и оказаться беззащитным, решает развлечь вас беседой. Параграф за параграфом она цитирует вам «Права и обязанности офицера Космического Патруля» — а тот, кто сочинил сей бесконечный устав, был ещё зануднее Клуши! Как тут бороться со сном? Все попытки отключить связь бесполезны: Клуша выжидает несколько минут и снова проверяет, спите вы или нет... Утомительная выдалась ночка! (<i><font color=#004400>СИЛА уменьшилась на единицу...</font></i>)<avs-insert></avs-insert>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d']," Вы радуетесь рассвету, как спасению, и, вскинув рюкзак за плечи, [page=401]продолжаете путь[/page]")
--- page.5 ---------------------------------

# page.6
$lvar['заголовок']={Мир Камней}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
if cube=1 or cube=2 or cube=3:
	args['page']=258
else
	args['page']=466
end
$lvar['исходник']="<p align=justify>[knew]мв|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Да. Переход мог забросить вас [page=<<args['page']>>]куда угодно[/page], но в любом случае вы бы оказались рядом с пещерами, ведь Ворота... -- как это назвал шеф? -- «имеют ограниченный радиус действия».|"+$func('base.txt','vm',args['page'])+"[/knew]</p>"
:о модификаторе
--- page.6 ---------------------------------

# page.7
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорожка становится всё уже, приходится ломиться сквозь кусты. В тот миг, когда вы решаете, что она никуда не ведёт, кустарник расступается. Вы оказываетесь на обочине другой дороги — более широкой, хотя тоже весьма заброшенной. А совсем неподалёку — [page=145]деревня[/page].</p>}
--- page.7 ---------------------------------

# page.8
$lvar['заголовок']={Мир Роботов<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Мощный взрыв сотрясает улицу: вход в особняк был заминирован! Дом превращается в груду битого камня, а во что превращаетесь вы, майор, — и подумать страшно...</p>}
--- page.8 ---------------------------------

# page.9
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Местность мирная, можно сказать — идиллическая. Вы на пригорке, на обочине проселочной дороги. Над вами склоняет ветви могучее дерево. По левую руку дорога, сбегая с пригорка, исчезает в шумящей чаще. Справа видны вспаханные поля, а за ними мелькают в зелени деревьев крыши домиков, над которыми возвышается церковная колоколенка. Тишина, спокойствие и мир. Ваши напряженные, как струны, нервы, невольно расслабляются. А неплохо было бы поселиться в такой уютной деревеньке и заняться землепашеством, вместо того чтобы мотаться по космосу и общаться с неприятными личностями вроде пиратов, контрабандистов, террористов... Здесь, наверное, и люди живут особенные — кроткие, мирные, незлобивые и... 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Шеф, опасность!» — врывается в ваши мысли тревожный голос Клуши. И тут же вы замечаете, как со стороны деревни на дорогу выплескивается толпа, что-то яростно орущая и возмущенно размахивающая какими-то примитивными орудиями труда... вилы, лопаты, что у них там ещё... некоторые, кажется, вооружены камнями... 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;И со всеми этими предметами толпа движется в вашу сторону! 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Шеф, — тревожно хрипит Клуша, — данный коллектив находится в настроении, мало подходящем для межпланетного контакта!» 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Я тоже так считаю, — говорите вы, подтянувшись на ветке дерева и укрывшись в листве. — Люди чем-то заняты, не будем им мешать...» 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Толпа уже близко. Теперь видно, что она преследует невысокого человечка в коричневом балахоне и с мешком за спиной. Человечек скачет, как заяц, уворачиваясь от летящих в него камней... 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[page=441]Попытаетесь ему помочь[/page]? Или [page=601]не станете вмешиваться[/page] во внутренние дела жителей планеты?</p>}
--- page.9 ---------------------------------

# page.10
$lvar['заголовок']={Мир Камней<avs-enemy>}
$lvar['исходник']={<center><font size=+1>ЗМЕЯ

ЛОВКОСТЬ 12     СИЛА 12</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.162'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','змея','ЗМЕЯХ_020202','<ratch>'
end
--- page.10 ---------------------------------

# page.11
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Посреди полянки растут заботливо огороженные кем-то высокие — метра в три — травянистые растения вроде колокольчиков. Оранжевые цветочные купола нависают над вашей головой. С толстых пестиков время от времени срываются большие капли и падают на вскопанную, взрыхленную возле корней землю. От капель сладко пахнет мёдом и увядающей травой. Рискнёте [page=199]попробовать[/page] этот странный нектар или [page=295]оставите поляну[/page]?</p>}
--- page.11 ---------------------------------

# page.12
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В какой тоннель вы повернёте? В тот, что [page=388]слева[/page]? Или в тот, что [page=148]по правую руку[/page]?</p>}
--- page.12 ---------------------------------

# page.13
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Здравый смысл и Клуша наперебой подсказывают, что отсюда пора уносить ноги. Спеша убраться от опасности, вы напролом пробиваетесь сквозь кустарник, влетаете в болотце, пытаетесь обойти его и вскоре сбиваетесь с направления. Высокие зелёные кроны закрывают солнце, мешая ориентироваться. Наконец, махнув рукой на бесполезные попытки найти какую-нибудь дорогу, вы бредёте куда глаза глядят — и выходите на маленькую круглую [page=329]полянку[/page].</p>}
--- page.13 ---------------------------------

# page.14
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<DIN1:$args['шлем']=$func('prv.bag','\[плащ\]','regexp')
if $args['шлем']!'':
	$result='Поскольку на вас серый плащ с капюшоном, дело оборачивается [page=402]так[/page].'
else
	$result='К сожалению на вас нет серого плаща с капюшоном, а значит дело оборачивается  [page=166]так[/page]'
end
$result= '<font color=#004400>'+$result+'</font>':1DIN>.</p>}
--- page.14 ---------------------------------

# page.15
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Морской житель цепкой лапкой жадно хватает плод и камнем уходит на дно. Вы устраиваетесь на карнизе и выжидательно глядите на море. Но его поверхность неподвижна, как зеркало. Похоже, вас надули... и что же теперь [page=275]будет[/page]?</p>}
--- page.15 ---------------------------------

# page.16
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Великолепная реакция, выработанная долгими тренировками, не подвела. Вы успеваете [page=208]увернуться[/page] от падающих на вас увесистых кусков штукатурки.</p>}
--- page.16 ---------------------------------

# page.17
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Толпа слуг растаскивает вас и вашего противника. Но, похоже, неприятности вам не грозят. Зрители восторженно орут, а побеждённый повар, бессильно рухнув на порог кухни, бранится словами, которые вам не попадались ни в одном историческом романе. 
     Это неплохо, но [page=409]что дальше[/page]?</p>}
--- page.17 ---------------------------------

# page.18
$lvar['заголовок']={Мир Камней<avs_source src="[useof:[кольцо]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы замираете, вцепившись в холодный камень. На усеянной громадными валунами чёрной равнине стоит звездолет. 
     «Узнаете, шеф?» — напряженно спрашивает Клуша. 
     «Конечно. Боевой линейный крейсер типа «Звездный сокол», оборудован гиперпространственным двигателем, ориентировочная боевая мощь...» 
     «Не продолжайте, шеф. Это «Ядовитый Коготь»...» 
     Вы присвистываете, но не ставите под сомнение слова Клуши. Ваш робот своё дело знает. В кибернетической памяти зафиксировано детальнейшее описание всех известных Космическому Патрулю звездолетов Галактики. И если Клуша утверждает, что перед вами флагманский корабль пиратской эскадры Паука — значит, надо быть готовым к любым неприятностям. 
     До звездолета, увы, не добраться, даже если бы вы умели летать. Вокруг «Ядовитого Когтя» кольцо света прожекторов... и, надо думать, крепкая охрана. Разумнее будет идти [page=474]дальше по тоннелю[/page]. 
     А может быть, вы всё-таки знаете, как спуститься к звездолету? И хотите рискнуть? Но учтите: Клуша против риска!</p>}
--- page.18 ---------------------------------

# page.19
$lvar['заголовок']={Мир Стрекоз<avs-enemy>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вам удаётся освободить левую руку, и вы выхватываете оружие. Но драться левой рукой неудобно, поэтому на время боя <font color=#004400><i>ЛОВКОСТЬ уменьшается на 1</i></font>. 
</p><center><font size=+1>1-Й МУРАВЕЙ 
 
ЛОВКОСТЬ 8     СИЛА 10 
 
2-Й МУРАВЕЙ 
 
ЛОВКОСТЬ 8 СИЛА 8</font></center>
<p align=justify>
     <font color=#004400><i>Если они снизят вашу СИЛУ до 2, то, увы ...</i></font></p>}
lvar['штраф.ловк']=-1
$lvar['exit']='page.343'
$lvar['динамический код']={if $args[0]='!war.powerdown!':
	if power['now']<3:
		$GAME_WAR['thiswar.'+$curloc]='prelose'
		$GAME_WAR['exit.'+$curloc]='page.635'
		$GAME_WAR['prelose.txt']='Ваша сила снизилась до 2-х. Увы...'
	end
end
}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','муравей1','МУРВЙ_030303','<ratch>'
	gosub 'crt.obj','муравей2','МУРВЙ_040404','<ratch>'
end
--- page.19 ---------------------------------

# page.20
$lvar['заголовок']={Мир Роботов<avs_source src="[useof:[кольцо] [антигравитатор]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Найти-то вы их нашли, но как туда добраться? Вы стоите на краю высокой платформы. Когда-то между платформой и стеной, на которой сейчас светятся Ворота, блестела колея монорельсового пути. А теперь, взглянув вниз, вы видите слой чёрной массы непонятного происхождения. Вряд ли это грязь — больше похоже на жидкую смолу. Да ещё пузырится, пакость такая... словом, переходить её вброд вам не хочется. И Клуша вас усиленно от этого отговаривает. 
     <DIN1:$args['вервь']=$func('prv.obj.inBag','вервь')
if $args['вервь']!'':
	$result='У вас есть верёвка, а значит [page=640]проблема решается легко[/page]'
else
	$result='Если бы у вас была верёвка, проблема бы решилась легко'
end:1DIN>. Или вы знаете способ без верёвки перебраться в нишу? Если нет, то [page=428]дело плохо[/page].</p>}
--- page.20 ---------------------------------

# page.21
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Подлесок здесь очень густой, за одежду цепляются растения с крючковатыми крепкими шипами на мясистых листьях. Вы исцарапались в кровь (<font color=#004400><i>СИЛА уменьшается на 1</i></font>)<avs-insert>.</avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],", но в конце концов проламываете дорогу к большой круглой [page=625]поляне[/page].")
--- page.21 ---------------------------------

# page.22
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Опустившись на одно колено, вы рассматриваете скелет в черно-серебристой форме астронавта. Череп у существа явно не человеческий: вытянутый, с клыками, похожий на волчий. Вам ясно, что это абориген Кровавой планеты. Её жители известны как неустрашимые воины, их охотно нанимают в качестве телохранителей, они сражаются в рядах наемных армий множества миров... Ну, и различные преступные организации часто пользуются их услугами. 
     Кем бы ни был этот бедолага, на этой планете он принял свой последний бой и забился умирать в пещерку. 
     В откинутой кисти руки скелета вы замечаете что-то чёрное. Протонная граната! Зачем приготовил её умирающий воин? Возможно, он сжимал её на случай, если враги последуют за ним, чтобы не попасть живым в плен и прихватить с собою как можно больше неприятелей Сильное оружие. Если хотите взять гранату с собою, помните: не во всякой ситуации её можно использовать. Надо, чтобы рядом было какое-нибудь укрытие. <!-- Но если всё-таки решите её бросить — прибавьте 60 к номеру параграфа, на котором будете находиться. -->
     А сейчас осторожно выбирайтесь назад и [page=502]идите дальше по коридору[/page]</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','протонная_граната',"",'',0,1
end
--- page.22 ---------------------------------

# page.23
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[knew]мв|Бронсон вполне мог скрыться|Модификатор вероятностей был бы очень кстати в подобных ситуациях. Нажал кнопку, и -- вуаля! -- ты уже держишь в руках похищенный прибор.
     Клуша замечает, что модификатор работает не так (он не может изменить прошедшее событие), и -- он у вас есть.
     Вы тут же бросаете взгляд на браслет. Действительно! Если смотреть под определённым углом, видны слабо светящиеся цифры красного и зелёного цветов. Господа учёные второпях забыли сообщить о столь полезном приборе.
     «Это новая модель, - гордо объявляет Клуша, - Модификатор реагирует на мыслеприказ, концентрирует до шести благоприятных исходов, анализирует удачу и...»
     «...отнимает шансы на успех в будущем!» - нетерпеливо заканчиваете вы.
     «...и позволяет восстанавливать исходные вероятностные потоки к благоприятному состоянию в случае наиболее успешного течения событий» - невозмутимо заканчивает КЛУ-6.
     «В случае успешного течения событий...» Но стоит ли полагаться на случай? Иногда нужно подумать логически.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Бронсон наверняка скрывается[/knew] в малоисследованной местности... Не обращая внимания на отчаянные протесты Клуши, вы решительно направляетесь <a href="exec:gosub 'mv',147" class="plain">в сторону гор</a>.</p>}
--- page.23 ---------------------------------

# page.24
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Мостовая приближается гораздо быстрее, чем вам хотелось бы, и вы врезаетесь в неё с изяществом мешка с песком (<font color=#004400><i>СИЛА уменьшается на 2</i></font>).<avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],"
     Жаль, что попытка полёта истрачена... Что ж, пора [page=592]уходить отсюда[/page].")
--- page.24 ---------------------------------

# page.25
$lvar['заголовок']={Мир Легенд<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;И вот за вами захлопывается массивная, окованная железом дверь. Глаза понемногу привыкают к темноте. Мрачные стены, сложенные из больших камней... крошечное, с ладонь, оконце под потолком... брошенная в угол охапка сомы... Для полноты картины не хватает только скелета в цепях. Но и без скелета у вас на душе очень весело. 
     «Клуша, — говорите вы деланно беззаботным тоном, — Поройся-ка в своей электронной памяти. Что там есть насчет побегов из заточения?» 
     Тут же спохватываетесь, что неверно поставили вопрос. Но исправлять что-то уже поздно. Клуша гордится своим запасом информации и обожает его демонстрировать. На вас обрушивается водопад фактов — реальных и вымышленных, литературных. Запеченные в пироге лестницы, спрятанные в каблуке сапога пилки, верёвки из простыней, верные сообщники на воле... Слушать про всё это сейчас тошно. Наконец вам удаётся прервать свою кибернетическую помощницу на описании подкопа, который аббат Фариа рыл в замке Иф. Вы сухо напоминаете Клуше старинную венерианскую поговорку: «Лучше умный враг, чем друг-дурак», — и отключаете связь. 
     Видимо, рассчитывать придётся только на себя. Припомните: может быть, [knew]тюрьма|[page=117]вам точно известно[/page]|вам точно известно[/knew], как отсюда удрать? Тогда действуйте! Иначе придётся пораскинуть мозгами, измышляя план побега. 
     Про окно лучше сразу забыть: оно хоть и без решетки, но такое узкое, что и голова не пролезет. Стены не возьмешь и динамитом. Остаётся дверь. Толстая, из очень крепкого дерева, окованная железом. Выломать её немыслимо. В двери есть окошко, через которое подают еду. Внимательно его осмотрев, понимаете: вам от него толку не будет. С наружной стороны двери (как вы успели заметить, входя в темницу) массивный засов. Даже будь у вас отмычка, она бы не помогла. <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='Можно попробовать <a href="exec:charge_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=1 & time[''goto'']=1 & goto ''page.185''" class="plain">выжечь засов</a>, если, конечно, бластер заряжен. Иначе'
		else
			$result='<font color=#004400><i>Можно было бы  попробовать выжечь засов, вот только бластер разряжен</i></font>. Так что'
		end:1DIN> придётся [page=529]сидеть и ждать[/page], пока его светлость соизволит вспомнить о вас.</p>}
--- page.25 ---------------------------------

# page.26
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор уводит вас всё дальше. Слева видите отверстие, ведущее в другой тоннель, но он такой крутой и с таким скользким полом, что вы быстро отказываетесь от мысли свернуть туда и продолжаете [page=510]идти дальше[/page].</p>}
--- page.26 ---------------------------------

# page.27
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Штука, которую вы держите в руках, очень похожа на яблоко, но ярко-фиолетового цвета. Вы пытаетесь надрезать её, но с таким же успехом могли бы резать камень. <!-- Если когда-нибудь придумаете применение этому странному «плоду», прибавьте 204 к номеру параграфа, на котором будете находиться.--> Возьмите с собой этот странный «Плод», если считаете, что он когда-нибудь вам пригодится.
     А теперь пора [page=447]идти дальше[/page].</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','плод_фиолетовый'
end
--- page.27 ---------------------------------

# page.28
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы ожидали кромешной темноты, поэтому слабенький свет вделанной в стену аварийной лампочки бьёт по глазам и по нервам. Хотя удивляться нечему: вы знаете подобные системы. Такие лампочки светят жиденько, но могут не гаснуть годами.
     Вероятно, эта комнатушка была когда-то подсобным помещением. Мебели в ней немного: стол, табурет, пустой шкаф с сорванными с петель дверцами. Но в первую очередь замечаете не это, а мертвого человека, который сидит за столом, положив голову на руки. Мертв он давно... неприятное зрелище! Вы поворачиваетесь, чтобы уйти, но Клуша обращает ваше внимание на длинный огарок свечи, который лежит на столе возле руки мертвеца. Вероятно, бедняга вошел со свечой и уронил её, когда рука ослабела.
     Решайте, нужна ли вам в дороге свеча, а затем [page=380]покиньте комнату[/page].</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','свеча'
end
--- page.28 ---------------------------------

# page.29
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Возрадуйся душой своей, о рыцарь! — восклицает Владычица Древнего Леса. — Великий подвиг ждёт тебя! Тропа сия ведёт к логову ужасного огнедышащего дракона! Срази его — и много сотен лет менестрели будут слагать о тебе песни! Без страха иди вперёд и рази! 
     Вы невольно останавливаетесь. Девочка, конечно, симпатичная, но она же вас не на танцы приглашает! Да и Клуша яростным шепотом напоминает, что в ваше задание отнюдь не входит истребление редких форм местной фауны... 
     Вероятно, можно заметить, что вы не «возрадовались душой!» По поводу драки с чудищем, и прекрасная незнакомка решает «поднажать». 
     «Это тот самый дракон, — говорит она значительно, — что стережет Заклятое Место — воздвигнутые грозными чародеями чаши медные и столб света меж ними... убей дракона и сними заклятия колдовские!»
     Да, тут есть о чем [page=161]призадуматься[/page].</p>}
--- page.29 ---------------------------------

# page.30
$lvar['заголовок']={Мир Камней<avs-enemy>}
$lvar['исходник']={<center><font size=+1>ШАР-ХИЩНИК

ЛОВКОСТЬ 10     СИЛА 6</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.150'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','шар_хищник','','<ratch>'
end
--- page.30 ---------------------------------

# page.31
$lvar['заголовок']={Мир Стрекоз<avs_source src="[useof:[антигравитатор] [кольцо]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорожка выводит на поляну, вокруг которой теснятся деревья, усеянные чёрными, фиолетовыми и оранжевыми плодами. Ветви сплелись так плотно, что трудно определить, какие плоды на каком дереве растут. Заинтересуетесь и [page=653]попытаетесь добраться до плодов[/page]? Или [page=415]пойдёте по дорожке дальше[/page], оставив поляну за спиной? А может, вы знаете способ подняться к вершине любого дерева?</p>}
--- page.31 ---------------------------------

# page.32
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Старуха понемногу успокаивается. Сначала она отвечает коротко и односложно, затем, убедившись, что опасности нет, понемногу становится разговорчивее. Да, люди в городе ещё есть. Живут тем, что грабят довоенные склады. Они вооружены, сбились в небольшие банды, и от них лучше держаться подальше... И есть ещё бедняги, чей рассудок не выдержал ужасов войны. Одного такого старуха видела вчера. Смешной длинноухий человек с таким же ранцем, как у вас, только лилового цвета. Представляете — спрашивал, как пройти к ближайшей станции метро! Как будто не знает, что метро не действует с первых лет войны, а теперь и вовсе его затопили подземные воды! 
     Вы, разумеется, тут же спрашиваете, как пройти к ближайшей станции метро. Старуха смотрит на вас, как на придурка, и снова начинает талдычить насчет подземных вод. Лишь с четвертой попытки выясняете вы, что станция «Единорог» — отсюда налево по Зеленой улице. 
     Вы [page=360]покидаете подвал[/page] через окно, оставив старуху в уверенности, что нормальных людей в городе уже не осталось. 
 </p>}
--- page.32 ---------------------------------

# page.33
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Что вы ответите? Назоветесь [page=277]бродячим торговцем[/page]? Или [page=341]менестрелем[/page]? Ничего другого вы в эту минуту придумать не можете...</p>}
--- page.33 ---------------------------------

# page.34
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор всё круче ведёт вниз, превращаясь в скользкую горку. По ней вы мягко съезжаете в другой, более широкий [page=510]тоннель[/page], ведущий примерно в том же направлении — всё глубже в толщу скалы.</p>}
--- page.34 ---------------------------------

# page.35
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Спуск по каменным выступам, как по ступенькам, проходит благополучно, и вот уже море лежит у ваших ног, а за спиной — хаос изломанных скал. Клуша комментирует обстановку: 
     «Данная геологическая формация наводит на мысль о недавнем катаклизме... Землетрясение здесь было, шеф!» 
     Видимо, она права... 
     Внезапно вы настораживаетесь: внизу, в воде мелькнуло что-то живое! 
     Вы ложитесь на живот и вглядываетесь в воду. Ветер улегся, море совершенно неподвижно. Вода так чиста, что вы различаете валуны на дне. Но не обманывайтесь на этот счет — здесь страшная глубина! 
     И тут вы замечаете, что подводные скалы источают странное свечение. Вам ли не узнать этот тёплый золотой поток света! Ворота! Они были воздвигнуты на берегу, а теперь землетрясение утащило их вниз и укрыло в подводной пещере. Исправны ли они? И как до них добраться? Вы не заблуждаетесь на свой счет: никакое умение плавать не поможет вам нырнуть так глубоко.
     Что же [page=631]делать[/page]?</p>}
--- page.35 ---------------------------------

# page.36
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Разбойники держат слово: забрав рюкзак, отпускают вас восвояси, а на прощание советуют держаться подальше от проезжих дорог: в здешних краях шныряют охотники за людьми, которые любой ценой стремятся добыть побольше рук для каменоломни сэра Кириаса Многоземельного. 
     Можно беспрепятственно [page=247]продолжать путь.[/page]</p>}
if здесь_был[$curloc]=0:
	gosub 'put.bag',$curloc,'//nope.goto//'
end
--- page.36 ---------------------------------

# page.37
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Чтобы сбить погоню со следа, некоторое время бредёте по лесу и лишь потом выходите на [page=381]дорогу[/page], ведущую из замка на север.</p>}
--- page.37 ---------------------------------

# page.38
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По правую руку от вас в стене коридора чернеет отверстие бокового хода. [page=659]Свернёте[/page] в него или предпочтёте [page=502]идти прежним путём[/page]?</p>}
--- page.38 ---------------------------------

# page.39
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Перешагнув через убитого хищника, собираетесь идти дальше, но Клуша останавливает вас. Оказывается, зверь вполне съедобен. <DIN1:if $func('prv.obj.inBag','зажигалка')!'':
	$result=' <font color=#004400><i>У вас есть зажигалка, а значит можно задержаться здесь, [page=587]развести костёр[/page] и зажарить добычу. Можно, конечно, сразу [page=623]идти дальше[/page]</i></font>.'
else
	$result=' <font color=#004400><i>Если бы у вас была зажигалка, можно было б задержаться здесь, развести костёр и зажарить добычу. Но зажигалки нет, а значит придётся [page=623]идти дальше[/page]: сырое мясо в пищу не годится</i></font>.'
end:1DIN></p>}
--- page.39 ---------------------------------

# page.40
$lvar['заголовок']={Исследовательская станция<avs-enemy>}
$lvar['исходник']={&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Шлем - металлический, он неплохо экранирует излучение. А без своих телепатических штучек враг становится не таким уж и опасным.

<center><font size=+1>СОРОКОНОЖКА

ЛОВКОСТЬ 7     СИЛА 6</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.144'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','сороконожка','','<ratch>'
end
--- page.40 ---------------------------------

# page.41
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Пошумев немного, толпа возвращается в деревню. Когда они отходят достаточно далеко, спасенный вами незнакомец белкой спрыгивает с дерева. 
     «Плебеи! — кричит он, грозя кулаком вслед ушедшим крестьянам. — Тупая чернь! Деревенщина! Что они понимают в высоком искусстве магии!» 
     Вы тоже спускаетесь с дерева и хотите представиться человечку, но он, обернувшись к вам, с жаром продолжает: 
     «Сударь, эти земляные жуки наняли меня, чтобы я своим магическим мастерством приманил тучу на их поля, страдающие от засухи. И я приманил её! Пусть посмеют сказать, что не приманил! А если туча оказалась с молнией и градом... так ошибки бывают и у величайших чародеев. Но вы, о благородный незнакомец!.. Вы посланы мне судьбой, чтобы я не разочаровался окончательно в людях. Умоляю принять на память что-нибудь из удивительных, неповторимых, уникальных волшебных предметов моей работы!» 
     Чародей начинает развязывать мешок. Вспомнив про тучу с молнией и градом, вы вежливо интересуетесь, вполне ли надежны его волшебные предметы. 
     Маг явно разрывается между честолюбием и честностью. 
     «Они очень сильны, но... не совсем доработаны...» 
     Что-то подозрительно знакомое слышится в этих словах. 
     «Скажите, — невольно вырывается у вас, — ваша фамилия случайно не Мерфи?» 
     Чародей выпрямляется во весь свой невеликий росточек. 
     «Так вы слышали обо мне, сударь? Эргенгард Мерфи — к вашим услугам!» 
     Вежливо [page=101]откажетесь[/page] от его услуг, пока не поздно? Или [page=637]решите взглянуть[/page] на колдовские вещицы? 
 </p>}
--- page.41 ---------------------------------

# page.42
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Самый неосторожный, самый нелепый поступок — подставить спину разъяренному хищнику! Зверь серебристой тенью прыгает на плечи и одним ударом могучих клыков ломает вам шейные позвонки...</p>}
--- page.42 ---------------------------------

# page.43
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы прощаетесь с любезной хозяйкой, но стрекоза настаивает на том, чтобы проводить вас. 
     «Нет-нет, не на тропинку! впереди болотце, а вы такой тяжёлый... Идите сюда... а теперь сюда...» 
     Вскоре вы оказываетесь на тропке — гораздо севернее того места, где свернули с неё. 
     «Удачи! — желает стрекоза. — И будьте осторожнее — здесь много хищных пауков!» 
     Махнув стрекозе рукой, отправляетесь [page=155]дальше на север[/page].</p>}
--- page.43 ---------------------------------

# page.44
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тоннель расширяется, превращаясь в подземный зал. Это депо! Сюда ведут ещё несколько коридоров, но они либо завалены взрывом, либо перегорожены баррикадами. На всех рельсовых путях стоят поезда — серебристо-голубые, с овальными вагонами. Двери вагонов распахнуты. 
     Вы делаете шаг вперёд... и тут откуда-то из полумрака гремит [page=628]выстрел[/page].</p>}
--- page.44 ---------------------------------

# page.45
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Ты неплохо дерешься! — утешает вас противник, помогая подняться на ноги. — Не огорчайся, что моя взяла. Думаешь, зря меня прозвали Драконьей Лапой?» 
     Он отправляет своё оружие в ножны. 
     «Эх, крепко я тебя отделал! Даже хочется сделать для тебя что-нибудь хорошее... Хочешь совет? Ты вроде бы на север шел... Зачем – не спрашиваю, не мое это дело. Но запомни: если завтра выйдешь к озеру — постарайся переправиться водой. По берегу не обходи, опасные там места». 
     Вместе с хозяином таверны он помогает вам добраться до [page=240]комнаты[/page], которая предназначена для ночлега.</p>}
--- page.45 ---------------------------------

# page.46
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Через несколько шагов вы останавливаетесь. Стены коридора покрыты ковром извивающихся щупалец. Сперва кажется, что они растут прямо из стен, но, приглядевшись, вы различаете плоских, похожих на плохо надутые пузыри тварей, распластавшихся по камням. И все щупальца дружно тянутся в вашу сторону, как бы ища добычу. 
     Но, может быть, они безобидны? Вы спрашиваете совета у Клуши — и сразу жалеете об этом. Если выражение «закатить истерику» применимо к роботу, то Клуша именно закатывает истерику. Нет, она не знает, что это за чудища! И не желает знать! Она хочет только одного: чтобы её хозяин и близко не совался к подобной мерзости! 
     Отключив связь, вы задумываетесь. Идти [page=138]вперёд[/page]? Или вернуться к развилке и пойти [page=602]другой дорогой[/page]?</p>}
--- page.46 ---------------------------------

# page.47
$lvar['заголовок']={Мир Стрекоз<avs-enemy>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вам трудно драться левой рукой (в правую вцепились прочные клейкие листья), поэтому на время боя <font color=#004400><i>ЛОВКОСТЬ уменьшается на 1</i></font>. 

</p><center><font size=+1> «РОСЯНКА» 
 
 ЛОВКОСТЬ 7     СИЛА 8</font></center>
<p align=justify>
     <font color=#004400><i>Удастся ли вам победить?</i></font>
</p>}
lvar['штраф.ловк']=-1
$lvar['exit']='page.207'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','росянка','РСНКХ_070707','<ratch>'
end
--- page.47 ---------------------------------

# page.48
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Загадка таинственного здания разрешается очень быстро: это театр. Полукруглая сцена, ряды длинных скамей полукольцом вокруг неё и тяжёлый занавес, покрытый пылью и грязью до такой степени, что нельзя понять, какого он цвета. [page=116]Заглянете[/page] за этот занавес или оставите театр и [page=596]продолжите свой путь[/page]?</p>}
--- page.48 ---------------------------------

# page.49
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы неплохо помните внутреннюю планировку кораблей типа «Ковчег» и, выйдя из лифта, быстро находите командную рубку. Из всего, что там можно обнаружить, для вас имеют самое большое значение сейфы с оружием, к которым имели доступ лишь капитан и первый помощник. 
     «Не обольщайтесь, шеф, — предупреждает Клуша. — Легенды гласят, что всё оружие было торжественно уничтожено как подлое и не соответствующее духу истинного рыцарства». 
     Она оказывается права. Серые металлические дверцы не заперты, но за ними — пустота. Без особой надежды отворяете их одну за другой — и восхищенно присвистываете. В последнем сейфе что-то есть! Во-первых, небольшая пластиковая обойма с двумя зарядами для бластера. Во-вторых, протонная граната. Конечно, такую серьезную штуковину где попало в дело не пустишь, её рекомендуется швырять из укрытия. <!-- Если когда-нибудь решите сделать это, прибавьте 60 к номеру параграфа, на котором будете находиться. -->
     Вам повезло... но что будет [page=457]дальше[/page]?</p>}
if здесь_был[$curloc]=0:
	gosub 'blast.charge',2
	gosub 'crt.obj','протонная_граната'
end
--- page.49 ---------------------------------

# page.50
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Меткость не изменила вам. Взмахнув руками, без единого вскрика незнакомец падает к вашим ногам. Вы переворачиваете труп — и присвистываете. На рукаве незнакомца — эмблема «Ядовитого Когтя», флагманского корабля эскадры Паука. Вот как, здесь пираты?.. 
     Жаль, что бластер противника, видимо, упал в какую-то трещину, да и фонарь разбился. Зато вам досталась другая добыча — металлический пояс-антигравитатор. Чтобы трофей не занимал места в рюкзаке, можете надеть его. Только не включайте зря: судя по миганию зелёного индикатора на пряжке, пояс давно нуждается в подзарядке. <!--Если захотите взлететь, прибавьте 80 к номеру параграфа, на котором будете находиться.-->
     А теперь [page=502]продолжайте путь[/page].</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','антигравитатор','','',1,1
end
--- page.50 ---------------------------------

# page.100
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы включаете антигравитатор и легко перелетаете <a l:href="#n_532">на мраморную площадку</a> рядом с воротами. Увы, на этом запас энергии иссякает, а подзарядить пояс негде. Больше он не поднимет вас в воздух.</p>}
--- page.100 ---------------------------------

# page.51
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорога становится всё уже, превращается в тропу, петляющую среди деревьев, а потом и вовсе исчезает куда-то. Пытаясь отыскать её, вы ломитесь через подлесок — и внезапно оказываетесь на опушке.
     Вы стоите у подножия невысокого холма. Мимо него с юга на север бежит дорога — но явно не та, которую вы недавно потеряли. А на холме величественно высится серый замок. <a l:href="#n_105">Подойдете к воротам</a> (учитывая, что вечереет и пора подумать о ночлеге)? Или не станете заходить в замок и <a l:href="#n_585">заночуете в лесу</a>?</p>}
--- page.51 ---------------------------------

# page.52
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Поединок заканчивается быстрее, чем вы ожидали. Раздается сухой треск, и рог одного из бойцов летит в траву. Обезоруженный жук бросается наутек, противник преследует его по пятам. Дождавшись, пока оба скроются с глаз, вы оставляете своё укрытие. Обойдя изрытую поляну, вы подбираете обломок рога. Тяжёлый чёрный крюк, очень прочный, гладкий, на изломе шероховатый... Если в рюкзаке есть место, можете взять рог с собой. <!--Когда придумаете, чем он может быть вам полезен, прибавьте 96 к номеру параграфа, на котором будете находиться.-->
     А затем продолжайте путь <a l:href="#n_427">по тропинке</a> — на северо-запад.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','рог'
end
--- page.52 ---------------------------------

# page.53
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Рассвет наполняет лес брызгами света в каплях росы и странным, непривычным для слуха пением птиц — если, конечно, это птицы, а не насекомые вроде кузнечиков... Приятный уголок, но вам надо идти дальше... а куда?
     Вокруг ни души, лишь ветер колышет ветви высоченного дерева на восточном конце просеки. Ни запаха дыма, ни звука человеческой речи, ни тропинки среди синих цветов...
     [knew]великое_древо|А вы ведь знаете, как отсюда выбраться! Можете [page=89]воспользоваться советом[/page], а можете [page=321]пойти наугад[/page].|Эх, если бы вы только знали как отсюда выбраться, но увы, придётся [page=321]идти наугад[/page].[/knew]</p>}
--- page.53 ---------------------------------

# page.54
$lvar['заголовок']={Мир Камней}
if здесь_был[$curloc]=0:
	cube=rand(2,12)
end
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубики брошены. Задевшие вас пиратские пули уменьшили вашу СИЛУ на }+str(cube)+{.</i></font><avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-cube
end
$lvar['исходник']+={ <font color=#004400><i>Тем не менее вы живы, а значит вам [page=202]удалось[/page] перелететь пещеру.</i></font>}
--- page.54 ---------------------------------

# page.55
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Самое время осмотреть побережье, на которое забросила вас судьба. Вокруг голые скалы, заметенные песком камни. Длинные высохшие водоросли хрустят под ногами. Берег обрывистый, изломанный. Внизу, метрах в десяти, вдоль воды тянется широкий каменный карниз. Спуститесь, чтобы <a l:href="#n_35">осмотреть его внимательнее</a>? Или не станете карабкаться по скалам <a l:href="#n_103">и пойдёте дальше</a> берегом?</p>}
--- page.55 ---------------------------------

# page.56
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Лестница порядком покорежена, со стен отбиты плитки мозаики, которая, насколько можно разглядеть, изображает грифонов, похожих на того, что украшает крышу. Внизу подземный зал, разрезанный пополам полосой монорельсовой дороги, выбегающей из одного тоннеля и скрывающейся в другом. Хотите <a l:href="#n_332">исследовать тоннели</a> или вернётесь наверх, <a l:href="#n_436">на улицу</a>?</p>}
--- page.56 ---------------------------------

# page.57
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вблизи деревня выглядит ещё более странной. На улицах ни души, в маленьких окнах не мелькают человеческие лица... Но всё же деревня явно обитаема: от домов тянет печным дымком, во дворах разгуливают толстые большие птицы явно домашнего вида.
     Возле одной из хижин видите женщину, неподвижно сидящую под навесом и глядящую перед собой. Это старуха в чёрном платье, с морщинистым лицом, с крючковатым носом; руки её похожи на лапы хищной птицы... Ух, настоящая ведьма!
     <a l:href="#n_473">Пройдёте мимо</a>, стараясь, чтобы она вас не заметила, и, оставив деревню позади, пойдёте дальше по дороге? Или <a l:href="#n_113">заговорите со старухой</a>?</p>}
--- page.57 ---------------------------------

# page.58
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;И напрасно вы не послушались своего робота! Правда, кольцо-антигравитатор не подводит вас и мягко поднимает в воздух. Но, увы, в полете вы — прекрасная мишень, а пиратский крейсер охраняют бывалые вояки, отличные стрелки...</p>}
--- page.58 ---------------------------------

# page.59
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тёплый плащ защитит от пронизывающего морского ветра, и эту <a l:href="#n_571">ночь вы проведёте спокойно</a> (<font color=#004400><i>Ваша СИЛА увеличивается на 1</i></font>).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',1
end
--- page.59 ---------------------------------

# page.60
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ощущая идущее от кольца тепло, легко перелетаете через широкую чёрную полосу и мягко приземляетесь на узкой мраморной площадке <a l:href="#n_532">у самых Ворот</a>.
     И тут же кольцо становится холодным, как лед. Больше оно никогда не поднимет вас в воздух.</p>}
--- page.60 ---------------------------------

# page.61
$lvar['заголовок']={Мир Легенд<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Молоденькая служанка несёт мимо вас на кухню большой глиняный кувшин. Споткнувшись о порог, она роняет свою ношу. Кувшин разлетается вдребезги, и зеленоватая жидкость, пахнущая сеном, расплескивается по земле. Тут же из клубов кухонного пара и чада возникает здоровенный тип в фартуке и поварском колпаке. Мгновенно оценив ситуацию, он без долгих слов отвешивает служанке такую затрещину, что девчонка отлетает к стене.
     Похоже, повар не намерен на этом останавливаться. <a href="exec:gosub 'crt.obj','защитник_служанок','','<knew>',0,1,'KNOWLEDGE' & time['goto']=1 & goto 'page.153'" class="plain">Заступитесь за девушку</a>? Или <a l:href="#n_309">не станете вмешиваться?</a></p>}
--- page.61 ---------------------------------

# page.62
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Незнакомец с бластером удалился в ту сторону, откуда вы только что пришли. Вы видели достаточно, чтобы убедиться: это не Бронсон. Да и «глазок» на браслете остаётся чёрным... Значит, остаётся <a l:href="#n_502">двигаться вперёд</a> в поисках Ворот — по возможности тихо и незаметно.</p>}
--- page.62 ---------------------------------

# page.63
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Яйцо не только съедобное, но и очень питательное — ваша СИЛА восстанавливается до первоначального уровня. А теперь <a l:href="#n_239">идите дальше</a>.</p>}
if здесь_был[$curloc]=0:
	if power['start']>power['now']: args['y']=power['start']-power['now']
	gosub 'power',args['y']
end
--- page.63 ---------------------------------

# page.64
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тьма сразу отступает, и вы <a l:href="#n_220">увереннее идёте</a> по хлюпающему месиву, выступившему поверх рельсового пути. Время от времени вы замечаете большие белые пузыри, свисающие со стен и потолков. Стены пузырей растягиваются, будто резиновые. Там явно копошится что-то живое. Один раз удаётся увидеть, как из такого пузыря высовывается острая усатая мордочка, принюхивается... и наружу выскакивает зверек, похожий на крупную крысу, но с перепонками на лапках. Не обращая на вас внимания, зверек деловито шлепает по грязи и скрывается в какой-то норе. Похоже, пузырь — это гнездо.</p>}
--- page.64 ---------------------------------

# page.65
$lvar['заголовок']={Мир Легенд<avs-enemy>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Сэр Палеандр прерывает бой и грозно спрашивает, согласны ли вы признать Берегонду Аргианскую венцом творения. <a l:href="#n_651">Согласитесь с требованиями</a> этого головореза? Если из упрямства не захотите сдаваться — бой продолжится, уже до вашей гибели или победы.</p>}
$lvar['динамический код']={
if $args[0]='!war.refresh!':
	if $tvar['refresh']='':
		gosub 'get.daughter.obj',$curloc,'\[:палеандр:\]','$temp_id'
		GAME_WAR['ratch.power.'+$temp_id[0]]=func('get.tag.num',$object_array[arrpos('$id_array',$temp_id[0])],'pownow')
		$tvar['refresh']='refresh'
		killvar '$temp_id'
	end
end}
$lvar['exit']='page.265'
--- page.65 ---------------------------------

# page.66
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тоннель врезается в толщу горы. Он уходит всё круче и круче вниз, пол становится скользким, и вскоре вы понимаете, что вернуться этой дорогой назад уже не сумеете.
     Подземный коридор обрывается у круглого грота, залитого чёрной водой. С потолка чуть ли не до самой воды свисают корявые сосульки сталактитов — даже существо с крыльями не смогло бы перелететь через грот.
     Озерцо невелико, вы могли бы переплыть его. Но заботливая Клуша обращает ваше внимание на странные круговые волны, беспорядочно и в полном безветрии возникающие на поверхности озерка. Клуша советует: если не хотите познакомиться с обитателями озера, лучше <a l:href="#n_458">обойти грот</a> по узкому каменному карнизу вдоль стены. Последуете её совету или всё же решите <a l:href="#n_610">плыть</a>?</p>}
--- page.66 ---------------------------------

# page.67
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Помня слова Клуши о хищных растениях, идёте осторожно, не доверяя спокойной красоте всех этих кустиков-цветочков. И оказываетесь правы. На небольшой поляне перед вами разворачивается довольно жестокая картинка: высокий куст тонкими ветвями-щупальцами душит метровую стрекозу. Стрекоза уже не подает признаков жизни... а ведь она, если верить Клуше, разумное существо! <a l:href="#n_223">Вмешаетесь</a> или <a l:href="#n_367">пройдёте мимо</a>?</p>}
--- page.67 ---------------------------------

# page.68
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Войдя в подъезд, обнаруживаете дверь в квартиру. Она лишь одна на площадке. На второй этаж ведёт крутая лестница.
     Дверь заперта. Хотите её <a l:href="#n_336">выломать</a> или <a l:href="#n_128">подниметесь наверх</a>?</p>}
--- page.68 ---------------------------------

# page.69
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Остановившись на лесной опушке, задумываетесь: какую роль вы намерены играть в этом странном мире? Торговец? Разбойник? Бродячий артист? Рыцарь?.. Кстати, Клуша говорила, что отличительным признаком рыцарского сословия является шлем. <DIN1:$args['pos.bl']=$func('prv.obj.inBag','шлем')
		! проверяем заряды
		if $args['pos.bl']!"":
			$result='Если вы хотите, чтобы вас принимали за рыцаря, наденьте шлем прямо сейчас.
     Затем вы'
		else
			$result='
     Вы'
		end:1DIN> отправляетесь в путь — по дороге, убегающей в лесную чащу.
     Постепенно дорога забирает всё правее, на северо-восток. Вскоре вы замечаете по левую руку еле заметную полузаросшую тропку на северо-запад. <a l:href="#n_501">Свернёте</a> на неё или <a l:href="#n_461">продолжите путь по дороге</a>?</p>}
--- page.69 ---------------------------------

# page.70
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор неширокий, но с высоким сводом. Наверху, над головой, сгустилась тьма.
     Недоброе предчувствие пронизывает вас — и тотчас же вы видите идущую навстречу гигантскую фигуру, напоминающую человеческую, но с искаженными пропорциями. На боку у чудовища — странного вида оружие.
     Не раздумывая, выхватываете из ножен клинок. Гигант повторяет ваш жест — и в руке его оказывается ужасный меч, больше вас размером. Ясно, что ближний бой не сулит ничего хорошего. <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='Так как ваш бластер заряжен — можете <a href="exec:time[''goto'']=1 & goto ''page.646''" class="plain">пустить его в ход</a>. Иначе '
		else
			$result='<font color=#004400><i>Ваш бластер разряжен, и вы не можете пустить его в ход</i></font>. Так что'
		end:1DIN> придётся <a l:href="#n_230">убегать</a>.</p>}
--- page.70 ---------------------------------

# page.71
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По руке от кольца волной проходит тепло. Взмыв вверх и поравнявшись с густой пышной кроной, тянетесь к ближайшему плоду — и тут чувствуете, что кольцо резко холодеет. Тело наливается свинцовой тяжестью, и вы пикируете в мягкий дерн полянки ([pow]-1[/pow]).<avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],' Ладно, а <a l:href="#n_407">что же дальше</a>?')
--- page.71 ---------------------------------

# page.72
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Уже темнеет, когда вы выходите на скалистое морское побережье. Здесь холодно, дует пронизывающий ветер, но вам удаётся заметить, что одну из скал рассекает глубокая расщелина. Завалив вход в неё грудой сухих водорослей, вы уютно устраиваетесь там и засыпаете ([pow]1[/pow]).
     Утром покидаете своё убежище и уже собираетесь продолжать путь, как вдруг замечаете у себя над головой чёрное пятно пещеры. Хотите <a l:href="#n_108">взглянуть на неё поближе</a> или <a l:href="#n_55">не станете карабкаться</a> по скалам?</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
--- page.72 ---------------------------------

# page.73
$lvar['заголовок']={Мир Легенд<avs-enemy>}
$lvar['исходник']={<center><font size=+1>РЫЦАРЬ

ЛОВКОСТЬ 10     СИЛА 12</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?

В любой момент боя вы можете попытаться <a l:href="#n_557">сбежать</a>.

</center>}
$lvar['exit']='page.265'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','рыцарь','РЫЦАР_080808','<ratch>'
end
--- page.73 ---------------------------------

# page.74
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Идти по пустому коридору скучно, и вы начинаете спорить с Клушей о том, кто создал эти переходы — природа или давно ушедшая раса разумных существ? При этом так увлекаетесь, что не сразу замечаете опасность...
     Они тучами облепили пол и стены — чёрные лохматые пауки размером с кошку, с горящими красными глазами, вытянутыми хищными жвалами. Ни звука не издают они, но от них веет холодной враждебностью. Добычу ждут, негодяи!
     Свернёте <a l:href="#n_158">обратно</a> или будете <a l:href="#n_570">прорываться вперёд</a>?</p>}
--- page.74 ---------------------------------

# page.76
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы и так слишком долго находились в этом унылом месте... Выбравшись наверх, полной грудью вдыхаете воздух и <a l:href="#n_232">продолжаете путь</a> по улице.</p>}
--- page.76 ---------------------------------

# page.77
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Ты что, сдурел?! — рявкает барон. — Как смеешь оскорблять подозрениями рыцаря, который победил самого Палеандра Неукротимого? Подать сюда эту злокозненную девицу!.. Ах, исчезла? Правильно сделала! Я приказал бы её высечь! Сэр Майор, умоляю тебя простить этого дурня! Буду рад, если ты подольше погостишь в моём замке!»
     Вы благодарите барона, но от приглашения отказываетесь: данный вами обет велит собираться в путь...
     Покинув замок, вы <a l:href="#n_381">идёте по дороге</a>, ведущей от ворот на север.</p>}
--- page.77 ---------------------------------

# page.78
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вжавшись в глубокую расщелину, вы с напряжением вглядываетесь вперёд. На серебристом фоне вырисовывается силуэт человека с бластером. Он идёт, осторожно осматриваясь, явно ожидая, что вот-вот на него прыгнет какой-нибудь хищник...
     <a l:href="#n_142">Наброситесь на пирата</a>, когда он окажется рядом с вами? Или <a l:href="#n_378">пропустите его</a>, надеясь, что он не заметит вас? <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='А может быть, хотите <a href="exec:charge_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=1 & time[''goto'']=1 & goto ''page.206''" class="plain">выстрелить</a>?'
		else
			$result='<font color=#004400><i>Вы могли бы даже застрелить его, если б бластер был заряжен.</i></font>.'
		end:1DIN></p>}
--- page.78 ---------------------------------

# page.79
$lvar['заголовок']={Мир Стрекоз<avs-enemy>}
$lvar['исходник']={<center><font size=+1>ЖУК

ЛОВКОСТЬ 9     СИЛА 9</font>

<font color=#004400><i>Если вам удастся разобраться с ним, можно будет спокойно выбраться из воронки и идти дальше, огибая стену колючего кустарника.</i></font></center>}
$lvar['exit']='page.131'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','жук','ЖУККК_090909','<ratch>'
end
--- page.79 ---------------------------------

# page.80
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;За дверью — комната, полупустая и давно заброшенная. В ней даже мебели почти нет. И всё же можно сказать кое-что о человеке, который жил здесь. Стены от пола до потолка оклеены большими цветными фотографиями подводного мира — странные водные существа среди разноцветных водорослей. На гвоздике висит забытая маска для подводного плавания с трубкой, к которой прикреплен баллончик сжатого кислорода. «Барахло, — комментирует Клуша. — Игрушка. Минут на пятнадцать хватит, не больше!» Если всё же хотите прихватить маску с собой, не забудьте: чтобы ею воспользоваться, надо вычесть 40 из номера параграфа, на котором будете находиться...
     Больше в комнате нет ничего интересного, и вы её покидаете. Куда теперь направитесь: <a l:href="#n_584">на улицу</a> или по лестнице <a l:href="#n_352">на второй этаж</a>?</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','подводная_маска',"",'',1,1
end
--- page.80 ---------------------------------

# page.81
$lvar['заголовок']={Мир Легенд<avs_source src="[putlock:[оружие] [снаряжение]:putlock]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Эй, парень! — окликает вас незнакомец. — Не хочешь ли сыграть со мною в кости?»
     Вежливо, но твердо вы отказываетесь. Ничуть не смутившись, незнакомец встает и, перейдя комнату, сидится за стол рядом с вами.
     «Я слышал, о чем ты болтал с хозяином, — заявляет он. — Могу кое-что об этом рассказать. Давай так: ставь любой заклад. Выиграешь — узнаешь то, что хотел узнать».
     Вещь против информации? Если такой вариант кажется вам заманчивым, то <DIN2:gosub 'get.daughter.obj',$curloc
if arrsize('$temp_id')>0:
	$result='<a l:href="#n_579">играйте</a><lock.put>'
	$GAME_VALUE['obj.inGame']=$temp_id[0]
else
	$result='играйте'
end
killvar '$temp_id':2DIN>. (Разумеется, вы не будете настолько легкомысленны, чтобы ставить на кон оружие и боеприпасы!)
     Если играть вам не на что или просто не хочется — откажитесь и <a l:href="#n_240">ступайте спать</a>.

     <DIN3:gosub 'get.daughter.obj',$curloc
if arrsize('$temp_id')=0:
	$result=$func('base.txt','help.putobj')
else
	$result=''
end
killvar '$temp_id':3DIN></p>}
--- page.81 ---------------------------------

# page.82
$lvar['заголовок']={Мир Камней<avs_source src="[useof:[антигравитатор] [кольцо]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Похоже, вы угодили в колодец. Выбраться отсюда невозможно, даже если есть верёвка — к чему вы её привяжете? Если знаете способ выбраться отсюда — самое время вспомнить о нем. Иначе вашим приключениям конец...</p>}
if здесь_был[$curloc]=0:
	$args['кольцо']=$func('prv.obj.inBag','кольцо')
	if $args['кольцо']!'': args['ch.1']=charge_array[arrpos('$id_array',$args['кольцо'])]
	$args['антиграв']=$func('prv.obj.inBag','антигравитатор')
	if $args['антиграв']!'': args['ch.2']=charge_array[arrpos('$id_array',$args['антиграв'])]
	if args['ch.1']=0 and args['ch.2']=0: $lvar['заголовок']+='<avs-death>'
end
--- page.82 ---------------------------------

# page.83
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Упав на землю, откатываетесь в сторону. В воздухе свистит вторая петля, но вы уже наготове и вовремя уворачиваетесь. Выхватив оружие, ожидаете нападения. Но вокруг тихо. Странные бочкообразные деревья с большими мясистыми листьями безмолвны, как враг в засаде. Петли мёртвыми змеями лежат в траве. У вас мелькает мысль, что верёвка не помешает в дороге, но материал, из которого свиты петли, так противно липнет к рукам, что вы раздумываете брать добычу с собой...
      <a l:href="#n_423">Вперёд</a> — туда, где уже слышен шум прибоя!</p>}
--- page.83 ---------------------------------

# page.84
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<qhtml><p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Осторожно, стараясь не делать резких движений, освобождаетесь от лямок рюкзака и роняете его в чёрную жидкую грязь. Грабители кидаются к добыче, не обращая на вас больше никакого внимания.
     На душе паршиво, зато <a l:href="#n_456">путь вперёд</a> свободен. Хорошо, что у вас не отобрали оружие...</p></qhtml>}
if здесь_был[$curloc]=0:
	gosub 'put.bag',$curloc,'//nope.goto//'
end
--- page.84 ---------------------------------

# page.85
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;То ли вы и впрямь спели неплохо, то ли баронесса — невзыскательная слушательница, но она остаётся довольна и вознаграждает вас большой серебряной монетой, на которой отчеканены корона и роза.
     А теперь пора прощаться с любезной хозяйкой. Старая служанка выводит вас из башни. По пути <a l:href="#n_433">к месту ночлега</a> вы размышляете: а не подумать ли вам о перемене профессии? Вдруг в вас артистический талант пропадает?</p>}
if здесь_был[$curloc]=0:
	$args[0]=$func('crt.obj','короны_розы')
	gosub 'add.obj',$args[0],'','//nope.goto//'
end
--- page.85 ---------------------------------

# page.86
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор расширяется, каменный свод над головой становится более гулким — вероятно, поблизости большая пещера.
     Внезапно путь вам преграждает спрыгнувший откуда-то сверху зверь. Он очень похож на небольшого леопарда, отличается лишь громадными глазами да блестящей серебристой шкурой. Зверь прижимается к каменному полу и яростно шипит — он готов атаковать!
     Попытаетесь <a l:href="#n_42">спастись бегством</a> или примете <a l:href="#n_622">бой</a>?</p>}
--- page.86 ---------------------------------

# page.87
$lvar['заголовок']={Мир Легенд<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Одно ваше резкое движение — и стрела, с пением сорвавшись с тетивы, пробивает вашу грудь...</p>}
--- page.87 ---------------------------------

# page.88
$lvar['заголовок']={Мир Роботов<avs_source src="[useof:[чл]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Из полузасыпанного обломками подъезда вываливается и ковыляет навстречу вам какое-то невообразимое устройство. При виде этой нелепой человекообразной конструкции Клуша негромко охает. И в самом деле, такое впечатление, будто этот механизм собран в свободное время сторожем свалки утиля, страдающим белой горячкой. Это чудо инженерной мысли приближается к вам с явно враждебными целями. И его правая конечность заканчивается бешено вращающимся диском пилы!
     Если есть «Чёрный луч», пустите его в дело. Иначе придётся <a l:href="#n_248">драться</a>.</p>}
--- page.88 ---------------------------------

# page.89
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропка обнаруживается там, где вы и ожидали найти её, и бежит она <a l:href="#n_533">на восток</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'knew.fin','великое_древо'
end
--- page.89 ---------------------------------

# page.90
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Таскать камни — работа не из легких ([pow]-3[/pow])... <avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-3
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],"Но наконец путь расчищен. Теперь вы можете идти дальше [page=630]по коридору[/page].")
--- page.90 ---------------------------------

# page.91
$lvar['заголовок']={Мир Стрекоз<avs-enemy>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Заостренные палки действительно оказываются оружием — и совсем неплохим! 
</p><center><font size=+1>1-Й МУРАВЕЙ 
 
ЛОВКОСТЬ 9     СИЛА 10 
 
 
2-Й МУРАВЕЙ 
 
ЛОВКОСТЬ 9     СИЛА 8 
 
 
3-Й МУРАВЕЙ 
 
ЛОВКОСТЬ 9     СИЛА 9</font>


     <font color=#004400><i>Если они снизят вашу СИЛУ до 2, то, увы ...</i></font></center>}
lvar['штраф.ловк']=-1
$lvar['exit']='page.343'
$lvar['динамический код']={if $args[0]='!war.powerdown!':
	if power['now']<3:
		$GAME_WAR['thiswar.'+$curloc]='prelose'
		$GAME_WAR['exit.'+$curloc]='page.635'
		$GAME_WAR['prelose.txt']='<font size=+1>Ваша сила снизилась до 2-х. Увы...</font>'
	end
end
}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','муравей3','МУРВЙ_101010','<ratch>'
	gosub 'crt.obj','муравей4','МУРВЙ_111111','<ratch>'
	gosub 'crt.obj','муравей5','МУРВЙ_121212','<ratch>'
end
--- page.91 ---------------------------------

# page.92
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;На пороге неестественно скорчилось тело радиста. Лицо искажено ужасной гримасой. Похоже, бедняга умер от страха. Но вам не до него — скорее к приборам! Главный передатчик вам не поможет — он связан с бортовым компьютером и заблокирован. Но есть ещё аварийный передатчик, автономный, настроенный на определенную волну. Длинное сообщение он передать не сможет, а вот древний сигнал SOS...
     Вы сделали всё, что могли. Чувствуя себя усталым и опустошенным, покидаете центр связи. Спасательный звездолет должен быть всегда наготове, а гиперпереход занимает не так уж много времени. Они обязаны успеть...
     И они успели! Мощный корабль, вынырнув из гиперпространства, зависает над гибнущей станцией и, точно когтями, вцепляется в неё стыковочными захватами. А через переходной шлюз на борт станции врывается спасательная команда.
     А ещё через сутки по земному времени поисковая группа, высадившаяся на поверхность планеты, находит измученных, отчаявшихся, но живых и невредимых учёных.
     Всё, операция закончена. Пора домой, <a l:href="#n_664">на Землю</a>...</p>}
--- page.92 ---------------------------------

# page.93
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Теперь можно без помех взобраться на дерево. Увы, это труднее, чем казалось. Ветви, на вид такие прочные, опасно гнутся под вашей тяжестью. Высоко залезть не удаётся, и, с трудом удерживаясь на пружинящей ветке, вы успеваете лишь заметить, что на севере лес разрезает река, а на востоке в чаще приютилось покосившееся серое здание с крестом на крыше — старая церквушка или полуразвалившаяся часовенка...
     Спустившись, решаете, куда идти: на север, <a l:href="#n_477">к реке</a>? Или напролом, сквозь чащобу, <a l:href="#n_21">к загадочному зданию</a>?</p>}
--- page.93 ---------------------------------

# page.94
$lvar['заголовок']={Мир Камней<avs-enemy>}
$lvar['исходник']={<center><font size=+1>РАКОСКОРПИОН

ЛОВКОСТЬ 9     СИЛА 9</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.170'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','ракоскорпион','СКРПН_131313','<ratch>'
end
--- page.94 ---------------------------------

# page.95
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тонкий луч ударяет в середину куста — и тот вспыхивает, как кучка пороха. Острые коготки отпускают вас. Вскоре от куста остаётся лишь горстка сизого пепла. Можно идти дальше — <a l:href="#n_475">на северо-запад</a>.</p>}
--- page.95 ---------------------------------

# page.96
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Что верно, то верно: кусты колючие. И жесткие, как проволока. Шипы изодрали вам в кровь лицо и руки ([pow]-1[/pow]).</p><avs-insert></avs-insert>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],"<DIN1:$result=$func('luck',$lvar['luck'],661,540):1DIN>")
--- page.96 ---------------------------------

# page.97
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вас выволакивают во двор, где ожидают ещё несколько стражников с арбалетами, и без объяснений ведут в большой зал, уставленный широкими столами. Похоже, недавно здесь был пир.
     Вскоре сюда выходит и сам барон — громадный, широкоплечий человек лет сорока. Он морщится спросонья и потирает круглую, лысую, как биллиардный шар, голову.
     «Ваша светлость, — почтительно объясняет один из стражников, — только что в ворота постучалась некая юная девица. Она сказала, что в замке под видом путника скрывается сам Грэм Драконья Лапа, атаман шайки разбойников. И в том девица поклялась клинком и эфесом Небесного Меча...»
     «Где она? Почему не повторит свои обвинения?»
     «Скрылась. Говорит, что боится мести разбойников. А сама девица — пришлая, никто здесь её не знает. Пригожая такая, кареглазая...»
     «Грэм Драконья Лапа, да? — заинтересованно тянет барон. — А ты что скажешь, молодец?»
</p>
<center><font color=#339900>ПРОВЕРЬТЕ СВОЁ ОБАЯНИЕ.</font>

Выглядите ли вы искренним? Или нет?


[social]397|269[/social]</center>}
--- page.97 ---------------------------------

# page.98
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Да, вы очень внимательно смотрите по сторонам. И всё же не успеваете заметить, откуда он выкатился на вас — этот большой грязно-серый шар, покрытый густой, жесткой и длинной щетиной. Из щетины вылетают в вашу сторону тонкие гибкие лапы с острыми когтями. Вылетают — и сразу прячутся, точно втягиваются в шар... Ни глаз, ни других органов чувств не удаётся разглядеть, но шар уверенно и бесстрашно движется прямо на вас. Он намерен <a l:href="#n_30">атаковать</a>!</p>}
--- page.98 ---------------------------------

# page.99
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорога широкая, по ней явно часто ходят... но впереди, за поворотом, перекликаются странные голоса — не то звериные, не то человеческие... Пойдёте <a l:href="#n_163">по дороге</a>, не опасаясь неприятной встречи? Или для пущей осторожности свернёте в придорожные кусты и двинетесь на север <a l:href="#n_551">лесом</a>?</p>}
--- page.99 ---------------------------------

# page.101
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Маг совсем не огорчен вашим отказом: ведь его сокровища остались при нём. А вы спрашиваете, нет ли поблизости жилья: уже начинает темнеть, а в деревню как-то не тянет.
     Маг полностью с вами согласен и добавляет несколько слов в адрес здешних крестьян.
     «Идите лучше, мой благородный друг, по этой дорожке через лес, не сворачивая, и до темноты, придёте к замку барона Брайта Могучего. Он известен своим гостеприимством, и путники любого звания и сословия могут найти у него ночлег и ужин».
     «Вы, вероятно, тоже направляетесь туда?»
     Маг заметно смущён.
     «Нет, мне туда нельзя. Видите ли, я там уже гостил. Продал барону бальзам против облысения. А бальзам подействовал... э-э... наоборот... Кстати, если, упаси небеса, попадёте в подземную тюрьму замка, имейте в виду: шестой нижний камень — если считать от двери — сдвигается. За ним — подземный ход. Узкий, но всё же... И представьте себе, я вырыл его без помощи магии!»<!--
     (Если злая судьба и Закон Мерфи заставят вас искать этот ход, прибавьте 92 к номеру параграфа, на котором будете находиться...)-->
     «А вы-то куда сейчас, сударь?»
     «О, не беспокойтесь! — смеется маг. — Я не пропаду!»
     И, махнув рукой, скрывается в придорожных кустах. Похоже, и впрямь не пропадёт. Человек бывалый...
     Что ж, дальше вам предстоит <a l:href="#n_69">идти</a> одному.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','тюрьма','','<knew>',0,1,'KNOWLEDGE'
end
--- page.101 ---------------------------------

# page.102
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Осторожно, шаг за шагом продвигаетесь вы по узкому карнизу. Внезапно камень выворачивается из-под ноги, и вы с криком летите в чёрную вонючую <a l:href="#n_610">воду</a>...</p>}
--- page.102 ---------------------------------

# page.103
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы бредёте берегом. Внезапно слышится странный цокот и скрежет, и на вас волной накатывается стая гигантских муравьёв. Вы пытаетесь отбиваться, но врагов слишком много. В мгновение ока вы скручены по рукам и ногам, вас волокут в гигантский, похожий на замок, <a l:href="#n_523">муравейник</a>.</p>}
--- page.103 ---------------------------------

# page.104
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы на улочке, стиснутой длинными одноэтажными домами. Судя по уцелевшим колоннам и лепным узорам вокруг выбитых окон, здесь был не самый бедный район...
     Пойдёте прямо <a l:href="#n_392">по улочке</a>? Или захотите свернуть <a l:href="#n_256">в соседний переулок</a>, ведущий направо? А может быть, решите заглянуть <a l:href="#n_424">в подъезд</a> ближайшего дома?</p>}
--- page.104 ---------------------------------

# page.105
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Под высокой серой стеной, у опущенного через ров подъёмного моста дежурит стражник в кожаной куртке и без шлема, в руках у него алебарда.
     <DIN1:$args['шлем']=$func('prv.bag','\[шлем\]','regexp')
if $args['шлем']!'' and instr($object_array[arrpos('$id_array',$args['шлем'])],'[:голова:]')!0:
	$result='У вас на голове есть шлем, а это значит, что вас встретят <a l:href="#n_589">так</a>'
else
	$result='У вас на голове нет шлема, а значит вас встретят <a l:href="#n_237">так</a>'
end:1DIN>.</p>}
--- page.105 ---------------------------------

# page.106
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор уводит всё дальше от входа в пещеру. Вы уже прикидываете, не вернуться ли, как вдруг видите новую развилку. Какой тоннель выберете на этот раз: <a l:href="#n_398">левый</a> или <a l:href="#n_422">правый</a>?</p>}
--- page.106 ---------------------------------

# page.107
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В высокой траве замечаете бегущую на север тропинку — очень узкую, но вполне заметную. Заинтересовавшись, идёте по ней, но вскоре обнаруживаете, что она раздваивается. На какую из тропок вы свернёте: на <a l:href="#n_67">левую</a> или на <a l:href="#n_527">правую</a>?</p>}
--- page.107 ---------------------------------

# page.108
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Карабкаясь по острым выступам, кое-как добираетесь до темнеющего узкого отверстия и протискиваетесь <a l:href="#n_324">внутрь</a>.</p>}
--- page.108 ---------------------------------

# page.109
$lvar['заголовок']={Мир Легенд<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;После безуспешных поисков вы уже хотите уйти напролом сквозь чащу, как вдруг вас осеняет: дерево! С его вершины можно разглядеть всю округу!
     Но тут вы замечаете, что вы не один на прогалине. На толстой ветви сидит шестирукая, похожая на паука обезьяна и пристально смотрит на вас. Зелено-коричневая шерсть делает зверюгу почти невидимкой.
     Всё же <a l:href="#n_394">полезете на дерево</a>, уповая на то, что зверь не из опасных? Или откажетесь от этой затеи и <a l:href="#n_477">покинете поляну</a>?</p>}
--- page.109 ---------------------------------

# page.110
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Бластер яростной вспышкой разрывает полумрак — и тут же перед вами точно встает огненная стена. Встает и гаснет...
     Не веря своим глазам, подходите к оплавленной стене и касаетесь остывающего камня. Тупик! Стена, отполированная подземными водами и превращенная в зеркало... гигантское зеркало! Вы потратили драгоценный заряд, стреляя в собственное искаженное отражение!..
     Плюнув, возвращаетесь в напрасно оставленный <a l:href="#n_542">коридор</a>. Клуша, которая во время поединка вела себя тихо, как мышь, теперь приободрилась и нахально бубнит что-то о людях, которых при рождении плохо запрограммировали, а они туда же — берутся за опасные спецзадания...</p>}
--- page.110 ---------------------------------

# page.111
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы взлетаете к кроне и протягиваете руку к первому попавшемуся плоду. И тут, как нарочно, зелёный огонек на пряжке угасает — энергия антигравитатора иссякла. Вы грузно <a l:href="#n_407">плюхаетесь вниз</a>. Хорошо, что земля под деревом мягкая — падение <font color=#004400><i>снижает вашу СИЛУ только на 1</i></font>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
--- page.111 ---------------------------------

# page.112
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы сидите на мягком ворсистом полу, прислонясь к пластиковой обшивке стены. Неяркий свет озаряет коридор с чёткими прямоугольниками дверей. Где вы уже видели такие плавно закругленные повороты коридора, такие потолки с утопленными в них светильниками? Конечно же, это жилой ярус орбитальной исследовательской станции! Такие станции сотнями разбросаны по космосу — кружат вокруг какой-нибудь планеты, а потом, когда сворачиваются исследования, космический буксир отводит станцию на новое место работы. Станции строятся по типовому проекту: в центре — компьютер и обслуживающие механизмы, а вокруг, кольцо за кольцом, — лаборатории, ремонтные мастерские, оранжереи, жилые помещения.
     Но почему здесь так тихо и безлюдно? Ладно, это тоже предстоит выяснить. Но главное — найти Бронсона и аннигилятор.
     Неуверенно поднимаетесь на ноги. Кажется, идти вы сможете... но куда? <a l:href="#n_192">Влево</a> или <a l:href="#n_312">вправо</a>?</p>}
--- page.112 ---------------------------------

# page.113
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы окликаете женщину, и она, встрепенувшись, приветливо отвечает вам. С чего вы взяли, что она ведьма? Старуха как старуха... Соскучившись в одиночестве, она охотно вступает в разговор. Оказывается, здесь живут лесорубы. Деревня почти заброшена, лишь несколько семей сражаются с нуждой и опасностями. Сейчас почти все в лесу: мужчины валят деревья, женщины обрубают сучья. А она, старая, сидит тут на солнышке да присматривает за единственной в деревне лавкой...
     Под навесом и впрямь разложены различные предметы крестьянской утвари. Вас они не интересуют, но одна вещь всё же привлекает ваше внимание. Это длинный светло-серый плащ с капюшоном — судя по всему, прочный, лёгкий и тёплый. Старуха перехватывает ваш взгляд и объявляет, что это — самый дорогой товар в лавке. Этот плащ она отдаст лишь за серебряную монету с короной и розой...
     <DIN1:$args['pos.bl']=$func('prv.obj.inBag','короны_розы','[:кошель:]')
		! проверяем заряды
		if $args['pos.bl']!"" and kolvo_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='У вас в кармане лежит как-раз такая монета, вы можете <a href="exec:kolvo_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=1 & time[''goto'']=1 & goto ''page.273''" class="plain">купить</a> плащ. Если желания'
		else
			$result='<font color=#004400><i>К сожалению такой монеты у вас</i></font>'
		end:1DIN> <a l:href="#n_525">нет</a>, объясните женщине, что вы ничего не собираетесь покупать.</p>}
--- page.113 ---------------------------------

# page.114
$lvar['заголовок']={Мир Камней<avs_source src="[useof:[кольцо]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы идёте по тоннелю до тех пор, пока он не упирается в высокую каменную стену. Тупик? Не совсем: наверху, метрах в пяти, чернеет отверстие. Пещера? Или продолжение коридора? Недавно здесь был обвал: возле стены — груда каменных обломков. При некотором везении по ним, как по лестнице, можно вскарабкаться наверх. <a l:href="#n_2">Рискнёте</a>? Или вернётесь к развилке и свернёте <a l:href="#n_66">в другую сторону</a>? А может быть, хотите подняться наверх каким-нибудь другим способом?</p>}
--- page.114 ---------------------------------

# page.115
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<qhtml><p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стрекоза цепкими лапками срывает сухой плод, похожий на небольшую бутылочку, и бросает вам на колени. Затем она спускается, неся тоненькую лиану. Миг — и бутылочка обвязана лианой.
     «Приспособление для транспортировки жидкости! — гордо объявляет стрекоза. — Мое изобретение!»</qhtml>
     <DIN1:$args['pos.bl']=$func('prv.obj.inBag','фляга')
	if $args['pos.bl']='':
		$result='У вас ещё нет фляги - [obj]ФЛЯГА_000013|возьмите подарок[/obj].'
	else
		$result='У вас уже [page=451]есть фляга[/page], стрекоза сейчас её заметит.'
	end:1DIN>
</p>}
if здесь_был[$curloc]=0:
$args['динамический код предметов']={![page115.uiOp]
if $args[0]='!addobj.goto!':
	! удаляем динамический код
	args['pit']=arrpos('$id_array',$args[1])
	$args['семена']=$func('prv.obj.inBag','семена')
	if $args['семена']!'': gosub 'minus.obj',$args['семена'],1 & $print[]='<font color=#884400>Вы отдали cемечко сорняка.</font>'
	$args['run']=$strfind($run_array[args['pit']],'!'+'\['+'page115\.'+'uiOp\]'+'[\s\S]*'+'!'+'\[\/'+'page115\.'+'uiOp\]')
	$object_array[args['pit']]=$replace($object_array[args['pit']],'[hide.onloc]')
	$run_array[args['pit']]=$replace($run_array[args['pit']],$args['run'])
	$result='page.575'
end
![/page115.uiOp]
}
$args['a']=$func('crt.obj','фляга',"ФЛЯГА_000013",'[hide.onloc] [подарок стрекозы]',2,1,'',$args['динамический код предметов'])
gosub 'flaga',$args['a'],'вода','//nope.goto//'
end
--- page.115 ---------------------------------

# page.116
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы оказываетесь в переплетении металлических балок, деревянных лестниц, свисающих откуда-то сверху канатов, размалеванных фанерных щитов... Не очень-то вы разбираетесь в хитроумных технических секретах, которые используют театральные режиссеры. Да и печально смотреть на этот брошенный, забытый людьми мирок...
     Вы уже поворачиваетесь, чтобы уйти, как вдруг в ваше горло вцепляется сильная рука, а спину обжигает боль ([pow]-2[/pow]).<avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d']," [page=468]Кто это[/page]?")
{}
--- page.116 ---------------------------------

# page.117
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Отодвинуть камень не так уж сложно, зато подземный ход оказывается таким узким... как только выбирался по нему бедняга маг?
     Однако в конце концов выбираетесь и вы, чуть не задохнувшись, ободравшись о древесные корни... ладно, это позади. А сейчас вы находитесь у подножия холма, на котором стоит замок. От часовых на стене вас отделяет кустарник, но всё же лучше уносить отсюда ноги... Пробравшись лесом подальше от серых стен, выходите на дорогу и идёте по ней <a l:href="#n_381">на север</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'knew.fin','тюрьма'
end
--- page.117 ---------------------------------

# page.118
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В яйце — чёрный змееныш, крохотный, но вполне жизнеспособный. И очень злой — тут же вцепляется вам в руку. С воплем отбрасываете вы гадёныша прочь, но его яд <font color=#004400><i>понижает вашу СИЛУ на 3</i></font>. <avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-3
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d']," В этот раз, к счастью, ваш тренированный организм справляется с ядом, и вы можете [page=502]идти дальше[/page].")
--- page.118 ---------------------------------

# page.119
$lvar['заголовок']={Мир Легенд<avs_source src="[avs-game:311|439:avs-game]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Что ж, рискните ещё раз. Выиграете или проиграете?</p>}
--- page.119 ---------------------------------

# page.120
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хитрюга прячется в колючих зарослях. Его хитиновым покровам колючки нипочем, а вот вы, сгоряча бросившись вслед, крепко ободрались ([pow]-1[/pow])... <avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d']," Что ж, придётся прекратить погоню и идти [page=447]дальше[/page].")
--- page.120 ---------------------------------

# page.121
$lvar['заголовок']={Мир Легенд<avs-enemy><avs-dark>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ночь тёплая, вам не грозит опасность замерзнуть. Но всё же вы сожалеете, что сидите не у огня: меж деревьями сверкают недобрые зелёные глаза, они всё ближе... На мгновение разрывается над головой завеса облаков, громадная — больше земной — белая луна заливает светом поляну, и вы можете разглядеть своих противников. Это два зверя, чёрные, похожие на земных волков, но с тремя парами лап и с длинными гибкими телами.
     Тьма вновь смыкается над поляной, и звери бросаются в атаку.</p>
     
<center><font size=+1>1-Й ЗВЕРЬ

ЛОВКОСТЬ 9     СИЛА 10


2-Й ЗВЕРЬ

ЛОВКОСТЬ 9     СИЛА 8</font></center>

<p align=justify>     Они прекрасно видят темноте, чего не скажешь о вас. Поэтому во время боя придётся вычесть 1 из вашей ЛОВКОСТИ. Впрочем, если у вас есть очки «Ночное зрение», наденьте их — и ЛОВКОСТЬ не снизится.</p>

<center><font color=#004400><i>Победите ли вы хищников?</i></font></center>}
$lvar['динамический код']={
if $args[0]='!war.refresh!':
	! найти очки ночного видения в инвентаре !
	$args['очки']=$func('prv.bag','\[:ночное_видение:\]','regexp')
	if instr($object_array[arrpos('$id_array',$args['очки'])],'[:лицо:]')=0:
		$print_down[]='На вас не надеты инфракрасные очки, а значит ЛОВКОСТЬ снижается.'
		GAME_WAR['hero.fast']=-1
	else
		GAME_WAR['hero.fast']=0
	end
end}
$lvar['exit']='page.5'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','зверь1','ЗВЕРЬ_141414','<ratch>'
	gosub 'crt.obj','зверь2','ЗВЕРЬ_151515','<ratch>'
end
--- page.121 ---------------------------------

# page.122
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Без особой надежды надеваете кольцо — и чувствуете, что оно становится всё теплее... вот уже такое горячее, что рука с трудом терпит его... Точно мягкая волна подхватывает вас и, подбросив кверху, опускает на край колодца. И тут же кольцо становится холодным. Оно прекрасно сработало — и стало простой безделушкой... А вы возвращаетесь к развилке и сворачиваете <a l:href="#n_422">в другой тоннель</a>.</p>}
--- page.122 ---------------------------------

# page.123
$lvar['заголовок']={Мир Стрекоз<avs-enemy>}
$lvar['исходник']={<center><font size=+1>«КУЗНЕЧИК»

ЛОВКОСТЬ 10     СИЛА 10</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.39'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','кузнечик','','<ratch>'
end
--- page.123 ---------------------------------

# page.124
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы наугад шагаете по чёрной, невидимой под ногами грязи, пока не упираетесь лицом во что-то упругое и тяжёлое, похожее на воздушный шар, наполненный водой. За эластичными стенками копошится и попискивает что-то живое. Делаете шаг в сторону, чтобы обойти препятствие, но от вашего неосторожного движения пузырь лопается. И тут же в темноте чьи-то острые зубки вцепляются в вас. Вы пытаетесь разбросать атакующих, но живые свирепые комки вновь и вновь кидаются в бой ([pow]-4[/pow]). <avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-4
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d']," Гнездо, что ли, вы нечаянно разорили? Выход из этого дурацкого положения только один — [page=576]бегство[/page]. Вы прибавляете шагу, и вскоре таинственные зверьки отвязываются от вас.")
--- page.124 ---------------------------------

# page.125
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Внезапно резкий свист останавливает вас. На пути вырастают двое верзил — в траве они, что ли, лежали? Без околичностей сообщают они, что дальше вам придётся идти без своих вещичек. Впрочем, они так любезны, что обещают оставить вам оружие, если вы не станете, как они выражаются, «трепыхаться».
     <a l:href="#n_36">Отдадите им рюкзак</a>, чтобы избежать драки? <a l:href="#n_657">Возьметесь за оружие</a>? Или попытаетесь [knew]лапа_дракона|[page=325]договориться с бандитами по-хорошему[/page]|договориться с бандитами по-хорошему[/knew]?</p>}
--- page.125 ---------------------------------

# page.126
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Красивая шкура у этой зверюги — мягкая, переливчатая, к тому же снимается легко, как чулок (видимо, зверь время от времени, как змея, меняет кожу). Если хотите, можете взять шкуру с собой. А затем <a l:href="#n_502">продолжайте путь</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','шкура'   
end
--- page.126 ---------------------------------

# page.127
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;На ладони у вас — круглый, размером с яблоко, плод бледно-оранжевого цвета. Съедобен он или ядовит? Рискнёте <a l:href="#n_555">проверить</a> это? Или, как советует Клуша, зашвырнете добычу в кусты и <a l:href="#n_415">пойдёте дальше</a>?</p>}
--- page.127 ---------------------------------

# page.128
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;На площадке второго этажа — лишь одна дверь. Положив руку на массивное дверное кольцо, распахиваете её и входите <a l:href="#n_516">в комнату</a>.</p>}
--- page.128 ---------------------------------

# page.129
$lvar['заголовок']={Мир Легенд<avs_source src="[useof:[кольцо] [антигравитатор]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы на стене, и отсюда надо поскорее убираться. Сейчас вас может выручить <DIN1:
		$args['шлем']=$func('prv.obj.inBag','вервь')
		if $args['шлем']!'':
			$result='<a l:href="#n_449">верёвка</a>'
		else
			$result='верёвка'
		end:1DIN>.
     А что делать, если верёвки нет? Раз не можете летать, как птица, придётся просто <a l:href="#n_357">прыгать вниз</a>. Только скорее, пока погоня не настигла вас!</p>}
--- page.129 ---------------------------------

# page.131
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре колючие заросли остаются позади. Вы находите в траве что-то похожее на дорожку и идёте по ней <a l:href="#n_292">на север</a>.</p>}
--- page.131 ---------------------------------

# page.132
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы опускаетесь на подоконник — и вовремя! Тело резко наливается тяжестью. Приходится вцепиться в резной карниз, чтобы не упасть. На полёт больше рассчитывать не приходится. Что ж, пора выяснить, <a l:href="#n_516">куда вы попали</a>...</p>}
--- page.132 ---------------------------------

# page.133
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<qhtml><p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Конечно! — обрадовано говорит баронесса, услышав о металлических чашах и столбе света меж ними. — Кто же не слыхал о чуде в Затерянной Часовне? Так ты совершаешь паломничество туда, путник? Благая цель! Я никогда не верила болтовне, будто эти чаши — дело грязных лап дьявола. Жаль, я не знаю дороги туда, да и мало кто знает... где-то на севере, в лесу... Но я могу помочь тебе, паломник!»
     Госпожа Горфрида откалывает от рукава своего платья оранжевый бант.
     «Затерянную Часовню охраняет рыцарь Бертольд из Соргейля. Он поклялся, что ни один смертный не приблизится к священному месту... Передай рыцарю эту ленту и скажи, что тебя послала его Прекрасная Дама. Уверена, сэр Бертольд допустит тебя в часовню!»
<!--     (Если когда-нибудь воспользуетесь подарком баронессы, вычтите 48 из номера параграфа, на котором будете находиться.) -->«Но все же, — любопытствует ее светлость, — <a l:href="#n_33">кто ты</a>, паломник?»</qhtml>}
--- page.133 ---

# page.134
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],294,590):1DIN>"
--- page.134 ---------------------------------

# page.135
$lvar['заголовок']={Мир Стрекоз}
$lvar['luck'] = $args[0]
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы идёте дальше по тропинке. Внезапно с неба обрушивается сверкающий поток, словно лавина солнечных зайчиков пляшет вокруг вас. Глаз мгновенно слепнут. Вы падаете наземь и отползаете с тропинки в кусты...</p>}
$lvar['исходник']+="<DIN1:$result=$func('luck',$lvar['luck'],539,255):1DIN>"
--- page.135 ---------------------------------

# page.136
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Да разве в этой жидкой грязи что-нибудь отыщешь? Провозившись минут десять, бросаете это занятие и <a l:href="#n_576">идёте дальше</a>.</p>}
--- page.136 ---------------------------------

# page.137
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Люк отыскивается не сразу. Он так зарос, что приходится выкорчевывать цепкие колючие кусты... Наконец вы расчистили щит управления шлюзовой камеры. Система знакомая, отпереть люк — пара пустяков... если, конечно, хозяева корабля не установили какую-нибудь ловушку для непрошенных гостей. Клуша, само собой, не забывает напомнить вам о такой возможности.
     Всё же решитесь <a l:href="#n_361">открыть люк</a> или, пока не поздно, <a l:href="#n_541">поспешите прочь</a>?</p>}
--- page.137 ---------------------------------

# page.138
$lvar['заголовок']={Мир Камней<avs_source src="[useof:[протонная_граната]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Через мгновение вас обвивают десятки колючих гибких щупалец. Кажется, они ещё и ядовиты: там, где они дотронулись, тело жжет как огнём ([pow]-5[/pow]). <avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-5
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],"С трудом вырываетесь вы из этих объятий и отступаете на безопасное расстояние. Да здесь этой дряни столько, что и бластером не выкосишь! Хотите расчистить путь протонной гранатой (если, конечно, у вас она есть)? Иначе придётся возвратиться к развилке и выбрать [page=602]другую дорогу[/page].")
--- page.138 ---------------------------------

# page.139
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Меж корней могучего дерева, на мягкой траве, уютно и тепло, не нужен и костёр. Сон восстановит вашу СИЛУ на 1. А утром выходите на дорогу (чуть дальше таверны) и идите <a l:href="#n_517">на север</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',1
end
--- page.139 ---------------------------------

# page.140
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропинку вы не находите, зато обнаруживаете родничок, весело выбегающий из-под розоватого валуна и ручейком исчезающий в кустах. От воды исходит необычный, но очень приятный аромат. Хотите <a l:href="#n_464">пить</a>? Или не станете рисковать? (Клуша, кстати, настоятельно советует вам не корчить из себя лабораторного кролика и не ставить на себе эксперименты с неизвестными жидкостями.) В таком случае идите дальше. Но куда? На <a l:href="#n_287">север</a>? На <a l:href="#n_375">северо-восток</a>? Или на <a l:href="#n_568">северо-запад</a>?</p>}
--- page.140 ---------------------------------

# page.141
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Крестьяне теряют к вам интерес и удаляются в сторону деревни, уводя связанного пленника. Что-то вам не хочется идти следом... пожалуй, лучше повернуть в <a l:href="#n_69">другом направлении.</a></p>}
--- page.141 ---------------------------------

# page.142
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Оттолкнувшись от стены, вы <a l:href="#n_434">обрушиваетесь на пирата</a>. Бандит падает, выронив бластер, а вы вцепляетесь в горло противника.</p>}
--- page.142 ---------------------------------

# page.143
$lvar['заголовок']={Мир Легенд<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Через полгода сотрудники Лаборатории Мерфи налаживают силовую установку и выручают вас из плена.  Но возвращение на Землю получается невеселым: задание с треском провалено! Утешает лишь то, что и Паук не завладел чудовищным оружием. Шеф сухо сообщает вам, что неизвестные лица ведут переговоры о выкупе бета-аннигилятора за громадную сумму. Видимо, придётся заплатить. Кто стоит за этой операцией — можно догадаться, но доказать, увы, ничего нельзя. Семейка Коуфордов неплохо наживется на вашем поражении.</p>}
--- page.143 ---------------------------------

# page.144
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тварь, конечно, опасная, но ведь не от неё же бежали сотрудники станции в полном составе!
     Вы спешите в капитанскую рубку. Первый взгляд — на потолок, на карту звездного неба, по которой, посверкивая, движется искорка орбитальной станции. Разобравшись в созвездиях, присвистываете: глухомань галактическая! Ни одной трассы рядом, ни одной земной колонии поблизости.
     Копия бортжурнала оказывается на месте. Вы перематываете запись назад и внимательно вслушиваетесь в сухие строки рапортов. Вскоре <a l:href="#n_180">всё становится ясно</a>.</p>}
--- page.144 ---------------------------------

# page.145
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Деревушка невелика — около десятка лачужек. Поблизости не видно вспаханных полей... да и людей не видно... Да и вообще она какая-то странная, эта деревня. Рискнёте идти <a l:href="#n_57">дальше по дороге</a>, бегущей меж домов? Или <a l:href="#n_549">обойдёте деревушку лесом</a>?</p>}
--- page.145 ---------------------------------

# page.146
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ужасно хочется пить, в горле пересохло, но эти мысли приходится гнать, ведь неизвестно, есть ли на этой планете вода. Стараетесь думать о чем-нибудь другом, но перед глазами одна картина: высокий прозрачный стакан, до краев наполненный чистой холодной водой... И зачем вы связались с космосом! Остались бы на Земле, работали бы продавцом газировки... или инструктором по плаванию — столько воды кругом...
     А это что за журчание? Неужели слуховая галлюцинация?
     Нет, не галлюцинация. По стене широкой полосой сбегает струя и исчезает в какой-то трещине. Рискнёте <a l:href="#n_418">сделать несколько глотков</a>? Или, не задерживаясь, <a l:href="#n_386">пойдёте дальше</a>?</p>}
--- page.146 ---------------------------------

# page.147
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Горный склон не очень крут и вполне удобен для подъема. Буйная растительность осталась у подножия, и среди камней и песка торчат лишь чахлые кустики. Почва вокруг изрыта норами вроде кроличьих. Вы пытаетесь сообразить, какое животное их вырыло. И тут из нор начинают дружно выползать... змеи, как показалось сначала... нет, это корни растений, гибкие, жесткие, толщиной в руку. Их много, они оплетают вас коконом... <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='Однако у вас под рукой заряженный бластер - <a href="exec:charge_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=1 & time[''goto'']=1 & goto ''page.487''" class="plain">стреляйте</a>!'
		else
			$result='<font color=#004400><i>К несчастью ваш бластер разряжен. </i></font>[page=639]Дело плохо[/page]...'
		end:1DIN></p>}
--- page.147 ---------------------------------

# page.148
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Здесь не очень темно: кое-где горят аварийные лампочки. Под ногами шмыгают зверьки, похожие на крыс, но с перепонками на лапках. Вы идёте по шпалам, пока тоннель перед вами не раздваивается. Одна монорельсовая колея убегает <a l:href="#n_44">налево</a>, другая — <a l:href="#n_524">направо</a>. По какой из них вы пойдёте?</p>}
--- page.148 ---------------------------------

# page.149
if здесь_был[$curloc]=0:
	gosub 'crt.obj','выход_27','','<knew>',0,1,'KNOWLEDGE'
end
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Теперь ничто не мешает отворить замшелую, тяжелую дверь...
     Перед вашими глазами мягко струится от чаши к чаше столб золотого света. Ворота![upluck]<font color=#000000>На браслете замерцали числа. Модификатор вероятностей готов к восстановлению вероятностных потоков к исходному состоянию.</font>
     
УДАЧА: ВОССТАНОВИТЕ 1 ЦИФРУ.[/upluck]
     Над Воротами — кодовый номер: 27. Вы тут же его записываете!
     <DIN2:$args['шлем']=$func('prv.bag','\[шлем\]','regexp')
	if $args['шлем']!'' and instr($object_array[arrpos('$id_array',$args['шлем'])],'[:голова:]')!0:
		$result='Сейчас самое время снять шлем: в других Мирах он может выглядеть нелепо. Можете положить его в рюкзак (вдруг пригодится!) или оставить здесь.</i></font>'
	else
		$result='А теперь остаётся лишь [step]641|сделать шаг вперёд[/step]...'
	end:2DIN></p>}
--- page.149 ---------------------------------

# page.150
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы склоняетесь над поверженным хищником, чтобы получше разглядеть его... и вдруг ваш взгляд падает на светящееся марево, колышущееся на стене коридора. Вы видите четко обрисованный силуэт человека с бластером на изготовку.
     Даже если ваше оружие заряжено — вы уже не успеете вскинуть его. Тренированное тело само делает единственное, что можно предпринять в такой ситуации: вы перекатываетесь к стене и <a l:href="#n_382">замираете</a>, вжавшись в пол коридора. Может быть, этот человек не заметит вас? Ведь он наверняка из команды «Ядовитого Когтя»...</p>}
--- page.150 ---------------------------------

# page.152
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Старуха не сводит с вас остекленевших от ужаса глаз. Кажется, она даже не понимает, что вы говорите. Осторожно, шаг за шагом отодвигается она в сторону — и вдруг, рванувшись, исчезает в широкой щели, которую вы в полумраке и не заметили. Кирпичная стена от бомбёжек расселась, получился «чёрный ход», которым и воспользовалась старуха. Для неё щель достаточно широка, а вот <a l:href="#n_528">пролезете ли вы следом</a>? Хотите попробовать? Или выберетесь из подвала через окно и пойдёте дальше <a l:href="#n_360">по переулку</a>?</p>}
--- page.152 ---------------------------------

# page.153
$lvar['заголовок']={Мир Легенд<avs-enemy><non-blaster>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Повар ещё раз замахивается на девушку, но вы перехватываете его руку и заламываете её за спину. Девчонка моментально исчезает в толпе слуг, которые сгрудились вокруг и глазеют на происходящее. Полагая, что дело кончено, выпускаете руку повара. Но верзила отнюдь не укрощен. С яростным рычанием он хватается за нож и клянется, что сейчас же пустит вас на щепки для растопки печи!
     Этот тип силен как бык, но техника боя у него бедновата.

<center><font size=+1>ПОВАР

ЛОВКОСТЬ 8     СИЛА 12</font>

<font color=#004400><i>Если вы снизите его СИЛУ до 2, то ура!
Но если ваша СИЛА снизится до 2, то увы...</i></font></center>
     
     Разумеется, пускать в ход бластер нельзя.</p>}
$lvar['exit']='page.17'
$lvar['динамический код']={
if $args[0]='!war.powerdown!':
	if power['now']<3:
		$GAME_WAR['thiswar.'+$curloc]='prelose'
		$GAME_WAR['prelose.txt']='Ваша сила снизилась до 2-х. Увы...'
		$GAME_WAR['exit.'+$curloc]='page.373'
	end
end
if $args[0]='!war.ratchdown!':
	if GAME_WAR['ratch.power.'+$temp_id[0]]<3:
		$GAME_WAR['thiswar.'+$curloc]='victory'
		$GAME_WAR['prewin.txt']='Его сила упала до двух! Ура!!!'
		$GAME_WAR['exit.'+$curloc]='page.17'
	end
end
}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','повар','','<ratch>'
end
--- page.153 ---------------------------------

# page.154
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы легко взлетаете <a l:href="#n_534">к краю каменного карниза</a>. Хорошая вещь это кольцо. Жаль, что его можно использовать только один раз...</p>}
--- page.154 ---------------------------------

# page.155
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Что за аромат пропитал всё вокруг? Как будто кусты и деревья обрызганы дорогими духами! Не удержавшись, задаете вопрос Клуше, и та советует взглянуть наверх.
     Над головой, свисая с ветвей, сухо шуршат длинные плоские ленты. Подпрыгнув, дотягиваетесь до одной из них и срываете её. Тонкая, коричневая, на ощупь напоминающая мягкую пластмассу, лента источает восхитительный запах. Клуша объясняет, что это потеки ароматической смолы, год за годом сочащейся из ветвей и застывающей на воздухе. Учёные из Лаборатории Мерфи собираются предложить её парфюмерной промышленности.
     Ладно, а вам эта полоска зачем? Хотите — возьмите её с собой, хотите — забросьте в кусты. И <a l:href="#n_607">идите дальше</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','смола'
end
--- page.155 ---------------------------------

# page.156
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В жидкой грязи что-то поблескивает. Вы наклоняетесь — и по позвоночнику пробегает холод. Проволока! Тоненькая, едва заметная, как змейка, но куда более опасная... Тоннель заминирован! Пока не поздно, надо возвращаться.
     Повернете в <a l:href="#n_500">другой тоннель</a>? Или решите, что <a l:href="#n_436">хватит</a> с вас подземных исследований?</p>}
--- page.156 ---------------------------------

# page.157
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Сэр Палеандр вскидывает руку, останавливая бой.
     «Довольно! Ты сильнее меня. Я готов сдаться и признать тебя победителем, если это не будет связано с умалением достоинства моей Прекрасной Дамы. Иначе продолжим сражение!»
     Вам надо думать о своем задании, а не о лихих рыцарских поединках. Поэтому вы великодушно соглашаетесь признать, что Берегонда Аргианская и Клуша Космопатрульная равны по красоте.
     «Твое благородство так же высоко, как и твое боевое искусство, — говорит рыцарь и отвязывает от своего шлема темно-красный плюмаж. — Возьми! Укрепи его на своем шлеме! Люди будут знать, что ты — победитель Палеандра Неукротимого!»
     Пока возитесь с плюмажем, расспрашиваете рыцаря о том, где поблизости можно заночевать.
     «Там, — небрежно кивает на юг сэр Палеандр, — проживает сэр Зигмунд Мрачный. Не ходи туда! Он захватывает в плен прохожих рыцарей и томит в темнице ради выкупа. Меня-то он примет иначе, я его родич... На севере — развилка. Пойдешь налево — придешь к замку барона Брайта Могучего, рыцаря щедрого и хлебосольного. Я как раз иду оттуда. Правая дорога ведёт, говорят, к какой-то таверне. Не знаю, я там ни разу не был».
     Пойдёте на <a l:href="#n_364">север</a> или всё же рискнёте двинуться на <a l:href="#n_633">юг</a>?</p>}
! плюмаж необходимо прикрепить к шлему
if здесь_был[$curloc]=0:
	$args['dyn']={! ищем шлем
$args[9]=$func('prv.bag','\[np:[\s\S]*\[шлем\][\s\S]*:np\]','regexp')
! если шлем есть
if $args[9]!'':
	if $args[0]='!menu.add!': $result='Прикрепить плюмаж к шлему:menu.dynamic'
	if $args[0]='!menu.run!':
		args[8]=arrpos('$position_array',$args[9])
		! присваиваем позиции плюмажа идентификатор шлема
		$position_array[arrpos('$id_array',$args[1])]=$id_array[args[8]]
	end
end}
	$args[1]=$func('crt.obj','плюмаж','','',0,1,'',$args['dyn'])
	! находим шлем в инвентаре
	$args[9]=$func('prv.bag','\[np:[\s\S]*\[шлем\][\s\S]*:np\]','regexp')
	! если шлем найден
	if $args[9]!'':
		! находим позицию шлема
		args[8]=arrpos('$position_array',$args[9])
		! присваиваем позиции плюмажа идентификатор шлема
		$position_array[arrpos('$id_array',$args[1])]=$id_array[args[8]]
	end
end
--- page.157 ---------------------------------

# page.158
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Поздно! За вашей спиной тоже горят красные угольки паучьих глаз. Да здесь этих тварей ещё больше, даже на потолке расселись! Пожалуй, больше шансов пробиться <a l:href="#n_570">вперёд</a>.</p>}
--- page.158 ---------------------------------

# page.159
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Добыча оказывается чёрным шаром размером с яблоко. Он так твёрд, что нож не оставляет на нём ни царапины. Если вы считаете, что этот странный плод сможет вам пригодиться, возьмите его с собой. <!--Когда придумаете, как пустить его в дело, вычтите 176 из номера параграфа, на котором будете находиться.-->
     А <a l:href="#n_55">что дальше</a>?</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','плод'
end
--- page.159 ---------------------------------

# page.160
$lvar['заголовок']={Мир Роботов<avs-enemy>}
$lvar['исходник']={<center><font size=+1>1-Й ГРАБИТЕЛЬ 
 
 ЛОВКОСТЬ 9     СИЛА 10 
 
 
 2-Й ГРАБИТЕЛЬ 
 
 ЛОВКОСТЬ 9     СИЛА 11 
 
 
 3-Й ГРАБИТЕЛЬ 
 
 ЛОВКОСТЬ 8     СИЛА 12</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.564'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','грабитель3','','<ratch>'
	gosub 'crt.obj','грабитель4','','<ratch>'
	gosub 'crt.obj','грабитель5','','<ratch>'
end
--- page.160 ---------------------------------

# page.161
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;С этими словами она исчезает меж деревьев, оставив вас в растерянности. Конечно, встреча с драконом вам ни к чему, но... Ворота?! Решитесь <a l:href="#n_521">идти вперёд</a>? Или <a l:href="#n_13">свернёте в чащу</a>, решив исследовать эти места позже, когда дракон отлучится куда-нибудь (скажем, за добычей)?</p>}
--- page.161 ---------------------------------

# page.162
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;И вновь ваши шаги гулко отдаются в подземном коридоре. По правую руку замечаете в стене широкую трещину. Хотите <a l:href="#n_250">заглянуть</a>, куда она сможет вас вывести? Или пройдёте <a l:href="#n_558">мимо</a>?</p>}
--- page.162 ---------------------------------

# page.163
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы долго и без приключений <a l:href="#n_477">идёте по дороге</a>. Кстати, вам удаётся выяснить, кто издавал эти странные звуки. На ветвях сидят большие птицы, напоминающие глухарей, и самозабвенно перекликаются, не обращая на вас ни малейшего внимания.</p>}
--- page.163 ---------------------------------

# page.164
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тяжёлая работа <font color=#004400>уменьшит вашу СИЛУ на 3</font>, пока <avs-insert><font color=#004400><i>вы наконец не падаете без чувств полностью истощённый</i></font>.</avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-3
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],"до вас наконец не дойдет, что это не баррикада, а завал, уходящий глубоко в тоннель... Разогнув спину, решаете: [page=420]осмотреть второй вход[/page] в тоннель или просто [page=76]махнуть рукой на все эти подземные тайны[/page]?")
--- page.164 ---------------------------------

# page.165
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Пир продолжается далеко за полночь. Наконец гости разбредаются на ночлег. Многие не могут встать из-за стола (или из-под стола), и их растаскивают по постелям слуги.
     Вас провожают в каморку с низкой деревянной кроватью. Вы ныряете под лохматую чёрную шкуру какого-то зверя и сладко <a l:href="#n_349">засыпаете</a>.</p>}
--- page.165 ---------------------------------

# page.166
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стены светятся мягким неярким светом. Ваша темная фигура четко вырисовывается на этом фоне. Пиратам не нужно команды, чтобы схватиться за оружие. А оружием эти убийцы владеют умело...</p>}
--- page.166 ---------------------------------

# page.167
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;С трудом дотягиваетесь вы до зажигалки. Узенький язычок пламени касается прозрачной ветви — и тут же весь куст занимается костром. Он сгорает за несколько минут, превращаясь в горстку сизого пепла. Больше ничто не преграждает вам <a l:href="#n_475">путь</a>.</p>}
--- page.167 ---------------------------------

# page.168
$lvar['заголовок']={Мир Роботов<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ядовитый дым врывается в горло, рвёт в клочья легкие. Задыхаясь от боли, падаете вы на булыжную мостовую. Здесь и кончается ваше путешествие...</p>}
--- page.168 ---------------------------------

# page.169
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Кольцо согревает вам палец — и, соскользнув со стены, вы плавно опускаетесь <a l:href="#n_37">к подножию холма</a>, на котором стоит замок. В ту минуту, как ваши ноги касаются земли, кольцо становится холодным. Больше оно не сможет помочь вам.</p>}
--- page.169 ---------------------------------

# page.170
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Зверь издыхает у ваших ног. Вы небрежно осматриваете его логово — и присвистываете: на полу валяются обрывки ткани, в которой лишь наметанный глаз может признать клочья формы астронавта. Такую одежду носят в торговом космофлоте... ну, и пираты зачастую тоже. Кого же сожрала эта зверюга? Надо быть осторожнее...
     Вы нагибаетесь и внимательнее изучаете впадину. Вот обрывок портупеи, вот пряжка пояса без опознавательной бляхи... а это что?
     В руке у вас — тонкая пластиковая трубочка с зелёным шариком внутри. Клуша моментально определяет, что это такое:
     «Меорвин. Сильнейший тонизатор... и реакцию улучшает. Одного такого шарика хватит на две недели...»
     Если проглотите шарик, можете прибавить 1 к ЛОВКОСТИ... А затем выбирайтесь из логова ракоскорпиона и <a l:href="#n_34">идите дальше</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','меорвин'
end
--- page.170 ---------------------------------

# page.171
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Есть люди, — говорит незнакомец медленно и отчетливо, ни к кому не обращаясь, — которые цепляют себе на голову кухонный горшок и считают, что все должны скулить от страха при встрече с ними. Ры-ца-ри!.. Меч у пояса, железо на лбу — и норовят вышибить мозги всем встречным-поперечным. А у самих зачастую храбрости — как у земляной пыхтелки! А умения сражаться — как у болотного хлипуна! А благородства — как у ползучего проглота!»
     «Клуша, — мысленно спрашиваете вы, — вероятно, по здешним обычаям я должен прищемить язык этому нахалу?»
     «Да, — очень неохотно отзывается Клуша. — Правила хорошего тона требуют, чтобы вы искрошили наглеца уже на второй фразе... Но, шеф, не станете же вы рисковать жизнью из-за местных варварских порядков!..»
     Что будете делать? <a l:href="#n_499">Поставите грубияна на место</a>? Или <a l:href="#n_654">не станете обращать внимания</a> на явно провокационные слова?</p>}
--- page.171 ---------------------------------

# page.172
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Укрывшись за грудой битого зелёного камня, бывшего когда-то стеной дома, выжидаете, когда проедет колонна. Автоматные очереди не дают поднять голову. Что-то больно упирается в ребра. Осторожно откатившись в сторону, обнаруживаете, что лежали на небольшом металлическом цилиндрике, раскрашенном красными и белыми полосами. Да это же огнетушитель! Маленький, одноразового действия... Хотите взять его с собой (если, конечно, в рюкзаке найдется место)? <!--Тогда имейте в виду: когда вы захотите его использовать, вычтите 100 из номера параграфа, на котором будете находиться...-->
     Решайте, пока <a l:href="#n_212">продолжаете ждать</a>...</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','огнетушитель','','',1,1
end
--- page.172 ---------------------------------

# page.173
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Кроны лесных великанов смыкаются над головой, мешая определить направление по солнцу. Кажется, вы идёте на север, но уверенности в этом нет. Блуждание наобум продолжается до вечера. Солнце уже скрывается за верхушками деревьев, когда вы напролом, сквозь кусты, выходите на длинную прогалину, густо усыпанную громадными темно-синими цветами. Сейчас они складывают лепестки, засыпая. Пора и вам подумать о ночлеге, а эта прогалина — место не хуже прочих. Вы опускаетесь в мягкую теплую траву и спокойно <a l:href="#n_53">засыпаете</a> ([pow]1[/pow])...</p>}
if здесь_был[$curloc]=0:
	gosub 'power',1
end
--- page.173 ---------------------------------

# page.174
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Чудом удаётся вам пробежать через пылающий коридор. Ожоги <font color=#004400>уменьшают вашу СИЛУ на 6</font>. <avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-6
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],"Тем не менее вы живы — можете [page=210]идти дальше[/page]")
--- page.174 ---------------------------------

# page.175
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Досадно, что вы так и не успели сорвать ни одного плода... Сердито махнув рукой, <a l:href="#n_415">покидаете поляну</a>.</p>}
--- page.175 ---------------------------------

# page.176
$lvar['заголовок']={Мир Роботов}
$lvar['сброс_176']=$args[0]
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<avs-insert>Вы долго и упорно старались выбить дверь, пока вконец не обессилели...</avs-insert></p>}
if $lvar['сброс_176']='сброс':
	cube['176.1']=rand(1,6)
	cube['176.2']=rand(1,6)
	gosub 'power',-1
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$args["текст-замена"]={Дверь оказывается крепче, чем вы думали, придётся высаживать её плечом...

     Бросайте кубик по два раза до тех пор, пока оба раза не выпадут одинаковые цифры. За каждый двойной бросок СИЛА будет уменьшаться на 1. Конечно, в любую минуту вы можете оставить дверь в покое, <a l:href="#n_584">выйти из подъезда</a> или <a l:href="#n_352">подняться на второй этаж</a>. Но если всё же удастся выломать дверь — можете <DIN2:if $lvar['сброс_176']='сброс' and cube['176.1']=cube['176.2']: $result+='<a l:href="#n_80">войти в комнату</a>' else $result='войти в комнату':2DIN>.


<center><DIN3:if ($lvar['сброс_176']='сброс' and cube['176.1']!cube['176.2']) or $lvar['сброс_176']!'сброс':$result='[cur]Бросить кубик два раза (<font color=#004400>СИЛА уменьшится на 1</font>)|сброс[/cur]':3DIN>

<DIN1:if $lvar['сброс_176']="сброс":
	$result="Выпали числа <<cube['176.1']>> и <<cube['176.2']>>."
	if cube['176.1']=cube['176.2']:$result+=' Вам удалось выломать дверь.
	
<a l:href="#n_80">Войдите в комнату</a>'
end:1DIN></center>}
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],$args["текст-замена"])
--- page.176 ---------------------------------

# page.177
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы интересуетесь, что это за семена. Маг выглядит смущенным.
     «Пожалуй, это моя неудача... Я мечтал создать растение, которое прорастало бы мгновенно, едва семечко коснётся земли, и так же быстро давало бы плоды. И мне это удалось! Но я не ожидал, что вырастет такой ужасный сорняк! Он убивает все растения вокруг себя, а потом засыхает сам. У меня было около десятка таких семян, но осталось только два... после испытаний в саду одного невежественного и ограниченного сельского жителя. Собственно говоря, мне пришлось очень быстро удалиться оттуда... Если ты, благородный путник, считаешь, что семена эти пригодятся тебе в странствиях, — они твои!»
     Если решите, что такой подарок вам ни к чему, вежливо <a l:href="#n_101">откажитесь</a>. Но если [obj]СЕМЕН_000014|возьмёте[/obj] мешочек, он займет 1 место в рюкзаке. <!--Когда захотите использовать одно из семян, прибавьте 160 к номеру параграфа, на котором будете находиться.--></p>}
if здесь_был[$curloc]=0:
$args['динамический код предметов']={![page177.кенни]
if $args[0]='!addobj.goto!':
	! удаляем динамический код
	args['pit']=arrpos('$id_array',$args[1])
	$args['run']=$strfind($run_array[args['pit']],'!'+'\['+'page177\.'+'кенни\]'+'[\s\S]*'+'!'+'\[\/'+'page177\.'+'кенни\]')
	$object_array[args['pit']]=$replace($object_array[args['pit']],'[hide.onloc]')
	$run_array[args['pit']]=$replace($run_array[args['pit']],$args['run'])
	$result='page.481'
end
![/page177.кенни]
}
gosub 'crt.obj','семена',"СЕМЕН_000014",'[hide.onloc]',0,2,'',$args['динамический код предметов']
end
:[СЕМЕНА]
--- page.177 ---------------------------------

# page.178
$lvar['заголовок']={Мир Роботов<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Голова начинает кружиться так сильно, что вы ничего не видите вокруг. Стараясь удержаться на ногах, жадно глотаете воздух. Вас оглушает рёв снарядов, треск пулемётных очередей, свист пуль. Прижавшись к подножию полуразрушенной стены и зажмурившись, чтобы преодолеть головокружение, слушаете рапорт Клуши:
     «Мир Роботов. Планета земного типа. Ещё недавно на ней существовала цивилизация, по уровню развития примерно соответствующая концу 20 века цивилизации Земли. Существа гуманоидного типа, возможно — потомки земных колонистов Эпохи Великого Переселения. Тогда многие из заселенных планет остались неучтенными... Продолжительная война стала для цивилизации катастрофой. Используемые обеими враждующими сторонами боевые механизмы истребили практически всех людей и теперь воюют между собой, попутно воспроизводя себе подобных из подручных материалов. За годы битв оба враждующих лагеря перемешались, цель войны давно забыта, каждый боевой робот сражается сам за себя...»
     Да, не самое уютное местечко во Вселенной... Вы осторожно открываете глаза и сразу смотрите на браслет. Индикатор остаётся чёрным.
     Кажется, стрельба переместилась чуть в сторону. Теперь можно осторожно <a l:href="#n_304">осмотреться</a>: куда же закинул вас переход?</p>}
--- page.178 ---------------------------------

# page.179
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стрекоза потрясена. Растение, убивающее другие растения! Зелёный сторож, охранник с корнями! Почему эта мысль не пришла ей в голову раньше? Она умоляет дать ей хоть одно семечко... разумеется, не даром! Ей есть чем отплатить за такую драгоценность!
     Стрекоза взвивается над занавесом из вьюнков. Раздвинув тяжелые гибкие плети, вы шагаете следом.
     Перед вами сад стрекозы. Глаза разбегаются — столько тут деревьев, кустов, цветов странных форм и невероятных расцветок. Стрекоза по-хозяйски порхает среди них.
     «Нет-нет, это не пригодится... это тоже... А вот это можно взять... и это... и это...»
     Что выберете? Продолговатый, напоминающий маленькую тыкву <a l:href="#n_115">коричневый плод</a>? Тяжелую <a l:href="#n_299">гроздь</a>, напоминающую виноград ярко-алого цвета? Круглую, мясистую <a l:href="#n_323">зеленую ягоду</a> размером с кулак? Длинную тонкую [obj]ВЕРВЬ_000015|лиану[/obj]? Или <a l:href="#n_43">не согласитесь</a> на обмен?</p>}
if здесь_был[$curloc]=0:
$args['динамический код предметов']={![page179.картман]
if $args[0]='!addobj.goto!':
	! удаляем динамический код
	args['pit']=arrpos('$id_array',$args[1])
	$args['run']=$strfind($run_array[args['pit']],'!'+'\['+'page179\.'+'картман\]'+'[\s\S]*'+'!'+'\[\/'+'page179\.'+'картман\]')
	$args['семена']=$func('prv.obj.inBag','семена')
	if $args['семена']!'': gosub 'minus.obj',$args['семена'],1 & $print[]='<font color=#884400>Вы отдали cемечко сорняка.</font>'
	$object_array[args['pit']]=$replace($object_array[args['pit']],'[hide.onloc]')
	$run_array[args['pit']]=$replace($run_array[args['pit']],$args['run'])
	$result='page.491'
end
![/page179.картман]
}
gosub 'crt.obj','вервь',"ВЕРВЬ_000015",'[hide.onloc] [подарок стрекозы]',0,2,'',$args['динамический код предметов']
end
--- page.179 ---------------------------------

# page.180
! С П180 МОЖНО ПЕРЕЙТИ НА П544, ЕСЛИ У ВАС ЕСТЬ ЗАРЯД БЛАСТЕРА. ЕСЛИ ЖЕ ЗАРЯДА НЕТ - ПЕРЕХОДИТЕ НА П620.
$lvar['заголовок']={Исследовательская станция<avs_source src="[useof:[чл]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Причиной трагедии послужило то, что биолог экспедиции привез из вылазки на поверхность планеты местное животное — сороконожку размером с крупного пса. Ничего особенного в этом не было, так поступали и учёные, работавшие в прежних сменах. Сороконожки, шустрые всеядные зверушки, легко приручались и своими забавными трюками скрашивали досуг сотрудников станции. Увы, биолог не знал, что среди сороконожек встречаются мутанты (или особый подвид), обладающие мощными телепатическими способностями... Волна ужаса захлестнула станцию. Конечно, люди справились бы с хищником, но, увы, первыми его жертвами стали капитан и радист — оба сошли с ума от телепатических ударов. Радист заперся в центре связи, включив систему защиты, и больше не подавал признаков жизни. А обезумевший капитан (в сейфе которого, кстати, было заперто всё оружие) вообразил, что станция во власти некоей неодолимой силы, враждебной человеку, и избавиться от неё можно лишь одним способом — уничтожив станцию. Капитан приказал бортовому компьютеру изменить орбиту, после чего заблокировал доступ к пульту управления. Теперь с каждым витком станция чуть-чуть приближается к поверхности планеты...
     Сотрудники гибнущей экспедиции, не сумев исправить положение, приняли решение — эвакуироваться на планету. Это они и сделали, на всякий случай оставив последнюю запись в бортжурнале. На борту станции остались лишь двое — безумец и чудовище. И судьба капитана известна, вероятно, только сороконожке...
     Но вас сейчас интересует не судьба капитана. Перед глазами встает картина: громадная станция, с разгона врезающаяся в поверхность планеты... Да, это будет похлеще Тунгусского метеорита, пропахавшего когда-то сибирскую тайгу... Единственный шанс уцелеть — срочно дать сигнал на Землю. Скорее в центр связи!..
     Но дверь туда и в самом деле заблокирована. Над ней посверкивает гнездо слежения. Только протяните руку — и на вас обрушится ливень лазерных ударов!
     Если есть «Чёрный луч», систему можно вывести из строя. <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!'' and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='Вы можете попытаться <a href="exec:charge_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=1 & time[''goto'']=1 & goto ''page.544''" class="plain">уничтожить гнездо слежения</a> лучом бластера.'
		else
			$result='<font color=#004400><i>Вы могли бы уничтожить систему слежения выстрелом из бластера, но он</i></font> [page=620]разряжен[/page].'
		end:1DIN></p>}
--- page.180 ---------------------------------

# page.181
$lvar['заголовок']={Мир Легенд<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вам удаётся узнать, кто такие ядозубки. Но рассказать об этом вы никому не сможете. Клуша телепатически воспринимает ваш пронзительный вопль — и всё смолкает...</p>}
--- page.181 ---------------------------------

# page.182
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы идёте мрачным коридором, прислушиваясь к эху своих шагов... и внезапно останавливаетесь. Показалось вам или нет, что впереди звенит по камням уже не эхо? Кто там?.. Вы замедляете шаги — и вдруг сверху лавиной обрушиваются камни.</p>
<DIN1:$result=$func('luck',$lvar['luck'],614,234):1DIN>}
--- page.182 ---------------------------------

# page.183
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Делаете несколько шагов, раздвигая перед собой жёсткую траву... и обнаруживаете узенькую дорожку, выложенную плоскими белыми камешками. Здесь явно поработали разумные существа! Заинтересовавшись, идёте по дорожке и доходите до развилки. Куда свернёте: <a l:href="#n_31">налево</a> или <a l:href="#n_231">направо</a>?</p>}
--- page.183 ---------------------------------

# page.184
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Пожалуй, пора подняться наверх. По обломкам лестницы — вдоль бронзовых перил — через массивные двери с выбитыми стеклами — и на улицу. Оставив здание станции за спиной, <a l:href="#n_232">идёте дальше</a>.</p>}
--- page.184 ---------------------------------

# page.185
$lvar['заголовок']={Мир Легенд<avs-enemy>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хватает одного заряда, чтобы аккуратным полукругом вырезать засов. Дверь открывается мягко и беззвучно. К счастью, вы прекрасно помните дорогу, по которой вас вели, и быстро выходите к воротам. И тут ваше везение кончается. У ворот дежурит стражник — один из тех, кто отводил вас в темницу. Он хватается за оружие.</p>

<center><font size=+1>СТРАЖНИК

ЛОВКОСТЬ 8     СИЛА 8</font>


<font color=#004400><i>Если вы убьёте его за 4 раунда, то путь через ворота будет свободен. Если схватка затянется, то уйти будет сложнее.</i></font></center>}
$lvar['exit']='page.37'
$lvar['динамический код']={
if $args[0]='!war.round!':
	if GAME_WAR['round']>3 and $GAME_WAR['thiswar.'+$curloc]='war':
		$GAME_WAR['thiswar.'+$curloc]='prelose'
		$lvar['exit']='page.369'
		$GAME_WAR['prelose.txt']='Вы не успели убить стражника за четыре раунда...'
	end
end
}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','стражник','','<ratch>'
end
--- page.185 ---------------------------------

# page.186
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Подтянувшись на руках, различаете в дальнем конце ниши небольшой пластмассовый ящик. Добравшись до своей находки, <a l:href="#n_586">сбиваете с ящика крышку</a>...</p>}
--- page.186 ---------------------------------

# page.187
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стрекоза прощается и исчезает за деревьями. Полет её тяжел и неровен, она словно ныряет в воздухе. Может быть, вы зря отказались от приглашения? Возможно, бедняжке трудно добраться домой после такой передряги?.. Впрочем, что сделано, то сделано, остаётся только идти по дорожке <a l:href="#n_367">дальше</a>.</p>}
--- page.187 ---------------------------------

# page.188
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Одно нажатие кнопки на чёрном пенале — и несуразный робот брякается наземь. Он беспорядочно дергается, пытаясь встать. Дисковая пила высекает искры из мостовой.
     «Удручающее зрелище, шеф, — говорит Клуша. — <a l:href="#n_384">Пойдёмте скорее отсюда</a>!»</p>}
--- page.188 ---------------------------------

# page.189
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не взглянув в вашу сторону, рыцарь гордо шествует мимо. Попытаетесь <a l:href="#n_509">заговорить</a> с ним, чтобы узнать, куда вы попали? Или <a l:href="#n_662">не станете связываться</a> с этим надутым типом?</p>}
--- page.189 ---------------------------------

# page.190
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],354,270):1DIN>"
--- page.190 ---------------------------------

# page.191
$lvar['заголовок']={Мир Стрекоз<avs_source src="[useof:[плод] [плод_фиолетовый]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы заговариваете с неизвестным существом, оно охотно отвечает вам. Оказывается, морской житель всплыл на ваш свист и готов торговать с вами.
     Вы интересуетесь, не может ли морской житель помочь вам добраться до подводной пещеры. Оказывается, это проще простого. Взамен ваш новый знакомый требует Плод Жизни. И ни на какие уступки не соглашается.
     У вас есть что-нибудь, что может сойти за Плод Жизни? Дайте этому типу. Иначе он <a l:href="#n_643">будет огорчен</a>.</p>}
--- page.191 ---------------------------------

# page.192
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Чем дальше идёте, тем тяжелее становится на душе. Распахнутые двери, разгромленные комнаты, изломанная мебель, разнесенная в клочья утварь... Что за безумец орудовал здесь? И куда, в конце концов, исчезли люди?
     Вы подходите к лифту. Он не работает, но рядом с шахтой снята панель обшивки, видны скобы аварийной лестницы. Бронсон был здесь совсем недавно, вы идёте по горячему следу! Скорее наверх, <a l:href="#n_504">на второй ярус</a>!</p>}
--- page.192 ---------------------------------

# page.193
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Да, не удалось вам блеснуть вокальными данными! Баронесса недовольно кривит губы и приказывает старой служанке <a l:href="#n_433">увести вас из горницы</a>.</p>}
--- page.193 ---------------------------------

# page.194
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Чем дальше идёте, тем глубже и ветвистее становятся трещины на стенах. Вы уже хотите повернуть, но внезапно в толще каменных стен раздается странный гул. Видимо, эхо ваших шагов нарушило хрупкое равновесие — и грянул обвал!</p>
<DIN1:$result=$func('luck',$lvar['luck'],278,566):1DIN>}
--- page.194 ---------------------------------

# page.195
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Противник не преследует вас. Когда «поле боя» исчезает за высоким кустарником, вы останавливаетесь и замечаете у ног тропу, ведущую на север. Это явно не та тропа, которую вы недавно потеряли, но лучше <a l:href="#n_607">идти по ней</a>, чем ломиться сквозь кусты.</p>}
--- page.195 ---------------------------------

# page.196
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы перешагиваете порог — и тут же где-то на улице тяжело ухает бомба. Взрывная волна врывается в комнату, сметая уцелевшие оконные стекла. Стены содрогаются, и вы видите, как над вашей головой от потолка к косяку начинает змеиться трещина...</p>
<DIN1:$result=$func('luck',$lvar['luck'],16,600):1DIN>}
--- page.196 ---------------------------------

# page.197
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Барон властным жестом останавливает поединок.
     «Достаточно! Сэр Майор, твоя честь восстановлена. Я прикажу своим людям изловить клеветницу и высечь её!»
     Вы благодарите барона, но с сожалением думаете, что баронским стражникам вряд ли удастся изловить эту проныру...
     Дружески распрощавшись с бароном и с потрёпанным сэром Эйнаром, покидаете замок и отправляетесь по дороге, ведущей <a l:href="#n_381">на север</a>.</p>}
--- page.197 ---------------------------------

# page.198
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Укрывшись в глубокой трещине стены, бросаете гранату. Грохот, яркая вспышка, порыв раскаленного воздуха — и всё стихает.
     Вы осторожно выглядываете. Мёртвые твари буквально прикипели к стенам. Путь свободен.
     Но... Пройдя совсем немного, обнаруживаете, что впереди глухой тупик. Стоило тратить гранату! Всё равно придётся поворачивать к развилке и идти <a l:href="#n_602">другим путём</a>...</p>}
--- page.198 ---------------------------------

# page.199
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы надолго задерживаетесь на полянке, ловя в ладони тяжёлые медовые капли. Когда вы с неохотой отрываетесь от этого чудесного напитка, то обнаруживаете, что ваша СИЛА восстановилась до первоначального уровня. <DIN1:
$args['pos.bl']=$func('prv.obj.inBag','фляга')
if $args['pos.bl']!'':
	$result='Имеет смысл <a href="exec:gosub ''flaga'',''<<$args["pos.bl"]>>'',''нектар''" class="plain">наполнить</a> флягу вместо воды нектаром. Тогда каждый глоток будет увеличивать СИЛУ не на 2, а на 4.'
else
	$result='Если бы у вас была фляга, можно было бы наполнить её нектаром.'
end
$result='<font color=#004400><i>'+$result+'</i></font>':1DIN>

     Это хорошо, а <a l:href="#n_295">что дальше</a>?</p>}
if здесь_был[$curloc]=0:
	if power['now']<power['start']:
		gosub 'power',power['start']-power['now']
	end
end
--- page.199 ---------------------------------

# page.200
$lvar['заголовок']={Мир Роботов<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Нет, вы этого так не оставите! Необходимо разобраться с негодяем, который решил палить в вас из засады!..
     Вы решительно идёте меж голубых рядов вагонов — и внезапно останавливаетесь от шороха впереди. Такое впечатление, будто кто-то, не поднимая шума, отступил перед вами.
     За открытой дверью одного из вагонов подрагивает огонек. <a l:href="#n_412">Зайдёте</a> взглянуть, что там такое? Или <a l:href="#n_612">пойдёте дальше</a>, чтобы изловить загадочного стрелка? А может быть, предпочтёте отступить, вернуться к развилке и пойти <a l:href="#n_524">другим путём</a>?</p>}
--- page.200 ---------------------------------

# page.201
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Да, люди здесь и впрямь давно не ходили, но ведь раньше дорога куда-то вела! Даже телеги здесь ездили... куда же?
     Словно в ответ на ваш вопрос, стена леса расступается. Вы видите широкий круглый холм, густо заросший кустарником с мелкими веточками. Вы собираетесь обогнуть холм, но замечаете среди кустов тусклый металлический блеск. Да ведь это же не холм! Это...
     «Точно! — подтверждает Клуша. — Грузопассажирский звездолет типа «Ковчег», название и реестровый номер определить не представляется возможным: корабль под действием собственной тяжести на треть погрузился в грунт, к тому же кустики выросли на слое нанесенной ветрами почвы. Рискну определить время пребывания корабля на поляне: приблизительно четыре столетия...»
     «Рискнешь определить, фокусница? — фыркаете вы. — Ты же сама говорила, что земляне прилетели на эту планету четыреста лет назад! А корабль, вероятно, бросили, они же не собирались возвращаться!»
     Хотите <a l:href="#n_137">отыскать люк</a> и попробовать проникнуть в брошенный корабль? Или обогнёте холм и <a l:href="#n_541">пойдёте дальше</a>?</p>}
--- page.201 ---------------------------------

# page.202
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;И вот перед вами знакомый золотистый поток струится из чаши в чашу. Вы нашли Ворота![upluck]<font color=#000000>На браслете замерцали числа. Модификатор вероятностей готов к восстановлению вероятностных потоков к исходному состоянию.</font>
     
УДАЧА: ВОССТАНОВИТЕ 1 ЦИФРУ.[/upluck]
     Над Воротами в скале выбит кодовый номер: 103. Вы не забыли, что обещали записывать номера всех Ворот?
     Разумеется, оставаться здесь опасно, и вы, не колеблясь, [step]598|шагаете[/step] в световой столб.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','выход_103','','<knew>',0,1,'KNOWLEDGE'
end
--- page.202 ---------------------------------

# page.203
$lvar['заголовок']={Мир Стрекоз<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Луч разрубает существо — и тут же морская гладь вокруг вас вскипает. На поверхность тучей всплывают собратья убитого. Вы пытаетесь убежать, но сотни мокрых лапок вцепляются в вас и утаскивают на дно — навсегда...</p>}
--- page.203 ---------------------------------

# page.204
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Бластер в умелых руках — не только убийства, но и надёжный инструмент. Отрегулировав луч на минимальную мощность, плавным движением <a l:href="#n_92">вырезаете замок</a>...</p>}
--- page.204 ---------------------------------

# page.205
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы объясняете, что всего-навсего заблудились и не намеревались посягать на святыни.
     «Ступай туда! — говорит рыцарь, указывая на север. — Выйдешь к реке — встретишь людей...»
     Поблагодарив, вы <a l:href="#n_477">уходите</a>.</p>}
--- page.205 ---------------------------------

# page.206
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Беззвучная вспышка распарывает грудь вашего противника. Выронив свой бластер, он <a l:href="#n_326">падает</a>.</p>}
--- page.206 ---------------------------------

# page.207
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы идёте по тропе — и вдруг замечаете справа среди густой листвы странные гибкие движения и игру красок, словно там, за деревьями, пляшут, извиваясь, разноцветные змеи. Хотите <a l:href="#n_463">взглянуть</a>, что это такое? Или <a l:href="#n_303">не станете сворачивать</a> с тропинки?</p>}
--- page.207 ---------------------------------

# page.208
$lvar['заголовок']={Мир Роботов<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Отряхивая с одежды известковую пыль, вы осматриваетесь. Обломки стены завалили выход, но, к счастью, в комнате есть окно. Путь к отступлению обеспечен, и вы начинаете обследовать комнату.
     Когда-то здесь жила женщина — из мебели уцелело высокое, покрытое трещинками трюмо. На подзеркальнике лежит изящный веер на резной ручке. Тут же валяется покрытый узорами серебряный сосудик на цепочке. Судя по легкому аромату, здесь когда-то хранились духи. Густой слой пыли покрывает трюмо и безделушки на нём. Вам становится грустно при мысли о бывшей хозяйке комнаты... И зачем люди развязали эту бессмысленную войну, погубившую цивилизацию?
     Что ж, пора идти дальше. Если хотите, возьмите что-нибудь на память. Кстати, серебряный сосуд можно использовать как фляжку. В него поместится всего 2 глотка воды, но каждый глоток в пути увеличит вашу СИЛУ на 2. (Правда, воду предстоит ещё найти.) Класть фляжку в рюкзак не стоит — удобнее прикрепить цепочку к поясу.
     А теперь <a l:href="#n_368">покиньте комнату</a> через окно.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','фляга',"",'[сосуд из под духов]'
end
--- page.208 ---------------------------------

# page.209
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы плавно опускаетесь <a l:href="#n_37">к подножию стены</a>. Увы, полет исчерпал энергию антигравитатора. Зелёный «глазок» на пряжке погас, больше пояс вам не пригодится. Жаль...</p>}
--- page.209 ---------------------------------

# page.210
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре вы замечаете на левой стороне тоннеля чёрное отверстие. Хотите <a l:href="#n_306">свернуть</a> в боковой коридор? Или <a l:href="#n_502">пойдёте дальше</a>?</p>}
--- page.210 ---------------------------------

# page.211
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Проклятый закон Мерфи выводит вас на поляну, заросшую совершенно непролазной травой, спутанной в какие-то неимоверные петли. Пока вы безуспешно пытаетесь выдраться из этих петель, первый из муравьёв догоняет вас и яростно кусает ([pow]-2[/pow]).<avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],"
     Теперь придётся [page=91]сражаться[/page].")
--- page.211 ---------------------------------

# page.212
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Наконец звуки сирены затихают вдали. Покинув своё убежище, идёте дальше по улице — и вскоре видите красивое приземистое здание, на крыше которого стоит белая фигура единорога с позолоченным витым рогом. Дверь здания распахнута настежь. Заглянув внутрь, вы догадываетесь, что это вход в метро.
     <a l:href="#n_376">Спуститесь</a>, чтобы обследовать метро? Или, оставив здание позади, продолжите путь <a l:href="#n_232">по улице</a>?</p>}
--- page.212 ---------------------------------

# page.213
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Сообщник!» — вопит толпа. На вас обрушивается град ударов ([pow]-6[/pow]).<avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-6
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],"
     Без сознания вы пробыли совсем недолго, но за это время толпа успела уйти далеко по дороге в деревню, уводя за собой связанного пленника.
     Придя в себя, [page=69]продолжайте путь[/page]... конечно, в противоположную от деревни сторону — к лесу...")
--- page.213 ---------------------------------

# page.214
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Немного не рассчитав прыжок, вы падаете прямо на мерзкую тварь — и она тут же наносит удар ([pow]-2[/pow]).<avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d']," 
     Придётся [page=94]драться[/page].")
--- page.214 ---------------------------------

# page.215
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Красивый захват, резкий взмах — и нож незнакомца со звоном летит на пол. Ваш противник ожидает последнего удара, даже не пытаясь взмолиться о пощаде. В глазах его — отчаяние и гордый вызов, которые сменяются удивлением. Наконец до него доходит, что вы не собираетесь добивать безоружного.
     «Слушай, ты дерёшься, как полтора чёрта! — восхищенно говорит он, подбирая своё оружие. — Со мной уже много лет никто не может сладить, а ты меня так лихо отделал! Но ещё удивительнее то, что ты оставил меня в живых...»
     И, помолчав, добавляет:
     «Будет обидно, если такой мастер клинка погибнет от стрелы, пущенной в спину из придорожных кустов... Слушай, рыцарь, и запоминай! Если выйдет у тебя неприятная встреча... ну, прямо будем говорить: если тебя соберутся грабить... скажи этим людям: «У дракона тяжёлая лапа». И никто тебя не тронет...»<!--
     (Если когда-нибудь решите воспользоваться этим советом, прибавьте 200 к номеру параграфа, на котором будете находиться...)-->
     Хозяин таверны кидается перевязывать раны вашему противнику, а вы <a l:href="#n_240">идёте спать</a>. Тяжёлый выдался денёк...</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','лапа_дракона','','<knew>',0,1,'KNOWLEDGE'
end
:[лапа_дракона]
--- page.215 ---------------------------------

# page.216
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Рядом гулко бухает взрыв, и вы плашмя растягиваетесь на булыжной мостовой. К счастью, это по соседству, не здесь... А где, собственно, «здесь»?
     Вы поднимаете голову. Вокруг высятся каменные дома, местами разрушенные бомбежкой. Дом по левую руку от вас зияет дырами на фасаде, но дверь подъезда гостеприимно распахнута. Попробуете <a l:href="#n_68">укрыться там</a>, пока не прекратится обстрел? Или <a l:href="#n_652">не станете задерживаться</a>?</p>}
--- page.216 ---------------------------------

# page.217
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Меткая рука и верный глаз не подводят вас. Ослепительный тонкий луч аккуратно <a l:href="#n_257">перерезает чудовищу шею</a>. Обезглавленное тело с грохотом падает на поляну.</p>}
--- page.217 ---------------------------------

# page.218
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Неровное пламя свечи очерчивает вокруг вас пляшущий круг света. Вы идёте осторожно, пытаясь разглядеть в игре теней затаившегося врага... и резко останавливаетесь. Прямо у ног чернеет провал. А за ним, насколько можно судить, поднимается стена... Тупик! Придётся вернуться на развилку и выбрать <a l:href="#n_422">другой путь</a>. И погасите свечу, пока не догорела: она вам ещё пригодится, а дорогу вы уже знаете...</p>}
--- page.218 ---------------------------------

# page.219
$lvar['заголовок']={Мир Стрекоз<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Проходит около часа. Почти всё это время вы катаетесь по земле, тщетно пытаясь порвать путы. В конце концов, обессилев, откидываетесь на спину и внезапно замечаете, что за вами внимательно наблюдают странные существа — двое больших, в полтора метра ростом, муравьёв, стоящих вертикально на задней паре... э-э... конечностей. Существа вооружены короткими заостренными палками.
     Обнаружив, что они замечены, муравьи приближаются и щелкающими голосами требуют, чтобы вы следовали за ними в муравейник. Для этого они перекусывают путы на ваших ногах, оставляя руки связанными. <a l:href="#n_523">Пойдёте</a> без споров за ними или <a l:href="#n_19">попытаетесь оказать сопротивление</a>?</p>}
--- page.219 ---------------------------------

# page.220
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Нога скользнула по чему-то твердому: вы наступили на какой-то небольшой предмет. Даже очки вряд ли помогут вам отыскать эту мелкую штучку. Тут требуется везение... Хотите <a l:href="#n_396">попытать счастья</a> или пойдёте <a l:href="#n_576">дальше</a>?</p>}
--- page.220 ---------------------------------

# page.221
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы сопровождаете подарок витиеватым комплиментом, смысл которого сводится к тому, что зеркало должно быть счастливо отражать столь неземную красоту. Баронесса восхищена невиданной вещью. Воспользуйтесь удачной минутой, чтобы узнать что-нибудь полезное... О чем вы спросите её светлость? О <a l:href="#n_605">Бронсоне</a> или о <a l:href="#n_133">Воротах</a>?</p>}
if здесь_был[$curloc]=0:
! отдаём баронессе зеркало. Для этого:
	! ищем в рюкзаке
	$args['зеркало']=$func('prv.obj.inBag','зеркало')
	! выбрасываем
	gosub 'put.obj',$args['зеркало'],'//nope.goto//'
	! удаляем
	gosub 'del.obj.id',$args['зеркало']
end
--- page.221 ---------------------------------

# page.222
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Справа от вас что-то слабо светится. В неглубокой нише раскачиваются длинные клейкие полосы, покрытые чем-то вроде зеленоватой фосфоресцирующей икры. Клуша тут же сообщает, что это и есть икра местных рептилий. Исследователи Вереницы Миров не без успеха пробовали употреблять её в пищу... Надо же, а на вид ужасная гадость... Рискнёте <a l:href="#n_374">отведать</a> «деликатес» или <a l:href="#n_26">пройдёте мимо</a>?</p>}
--- page.222 ---------------------------------

# page.223
$lvar['заголовок']={Мир Стрекоз<avs_source src="[useof:[семена]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Раздвинув щупальца-ветви, выхватываете неподвижную стрекозу, отшвыриваете её в сторону — и куст тут же вцепляется в вас. Похоже, он ничуть не возражает против такой замены... <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='Если хотите срезать мерзкое растение под корень залпом бластера, то <a href="exec:charge_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=1 & time[''goto'']=1 & goto ''page.411''" class="plain">стреляйте</a>.'
		else
			$result='<font color=#004400><i>Вы могли бы срезать мерзкое растение залпом из бластера, но он разряжен</i></font>.'
		end:1DIN> Если у вас есть хоть одно из «семян-убийц» и вы хотите применить его — не теряйте зря времени. Если ничего этого вы сделать не можете, придётся попросту <a l:href="#n_3">драться</a>.</p>}
--- page.223 ---------------------------------

# page.224
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Жаль, что пришлось убить беднягу. Тем более что, оглядевшись, вы понимаете: он защищал своё <a l:href="#n_320">логово</a>.</p>}
--- page.224 ---------------------------------

# page.225
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Внезапно из густой листвы, облаком нависшей над вашей головой, доносится окрик:
     «Стой! Моя стрела смотрит тебе в сердце, путник! Положи-ка на землю своё добро. И деньги не забудь, если есть! Потом можешь идти своей дорогой...»
     Вас грабят! Если вы знаете, что [knew]лапа_дракона|[page=425]сказать[/page]|сказать[/knew] этому труженику большой дороги, сделайте это. Если же на языке у вас вертится лишь бессвязная ругань, придётся выбирать: <a l:href="#n_271">подчиниться</a> приказу или попытаться <a l:href="#n_87">сопротивляться</a>.</p>}
--- page.225 ---------------------------------

# page.226
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Незнакомец, клацая по камням магнитными подковками, проходит мимо, а вы, немного подождав, выбираетесь из своего укрытия и <a l:href="#n_38">идёте дальше</a> по коридору.</p>}
--- page.226 ---------------------------------

# page.227
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы с удивлением разглядываете чёрный, как сажа, и твердый, как камень, плод. Его невозможно даже разрезать! Хотите всё же взять его с собой? В таком случае, если вы решите, что плод может как-то пригодиться вам, берите... А теперь <a l:href="#n_415">идите дальше</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','плод'
end
--- page.227 ---------------------------------

# page.228
$lvar['заголовок']={Мир Стрекоз<avs-enemy>}
$lvar['исходник']={<p align=justify>     В нескольких шагах от вас стоит странное существо, похожее на грязный мешок с песком, повисший меж мохнатых членистых лап. «Мешок» опоясан полосой вращающихся шаров-глаз. Одна из лап поднята вверх, ею паук — как вы окрестили это существо — крутит над собой белую петлю, как заправский ковбой — лассо.</p>


<center><font size=+1>ПАУК 
 
 ЛОВКОСТЬ 9     СИЛА 8</font>


В любой момент боя вы можете <a l:href="#n_494">бежать</a>.

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.438'
lvar['штраф.ловк']=GAME_VALUE['page.228']
if здесь_был[$curloc]=0:
	gosub 'crt.obj','паук','','<ratch>'
end
--- page.228 ---------------------------------

# page.229
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стоящий в двух шагах молодой менестрель что-то тонко выводит, аккомпанируя себе на лютне. Сквозь гам его плохо слышно, но вас это не особенно огорчает — вы с аппетитом ужинаете. Внезапно обрывок строфы, долетевший сквозь шум, заставляет вас собраться и вновь ощутить себя офицером Космического Патруля, выполняющим боевое задание. Перегнувшись через стол, напряженно вслушиваетесь.
     Менестрель поёт о старой часовне, стоящей в лесу. Люди давно забросили часовню, меж плитами пола проросла трава, за алтарем нашли приют змеи... Но свершилось чудо. Кто сотворил его — неведомо. Велением Вышних Сил или чёрным колдовством — но возникли посреди часовни две огромные чаши, заструился из одной в другую поток золотого света. Бежит и не иссякает. Смельчак, шагнувший в этот поток, навек покидает сей мир. Куда покидает он? В рай? В ад? Неизвестно... Никто не вернулся... Никто...
     Вы подзываете менестреля и начитаете расспрашивать о часовне. Паренек неловко пожимает худыми плечами. Ничего он не знает. Всего лишь поёт чужую, не им сложенную песню...
     А <a l:href="#n_165">пир продолжается</a>...</p>}
--- page.229 ---------------------------------

# page.230
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Кем бы ни было это существо, оно вас не преследует. Вы беспрепятственно добираетесь до оставленного вами тоннеля и <a l:href="#n_542">идёте по нему дальше</a>.</p>}
--- page.230 ---------------------------------

# page.231
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре вы вновь оказываетесь на развилке. Какую дорожку выберете на этот раз: <a l:href="#n_267">левую</a> или <a l:href="#n_479">правую</a>?</p>}
--- page.231 ---------------------------------

# page.232
$lvar['заголовок']={Мир Роботов<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Внезапно на мостовую падает широкая тень. Полнеба тучей закрывают летающие устройства, похожие на дирижабли. С них на крошечных парашютиках градом сыплются небольшие, с ладонь, механизмы, ощетинившиеся бешено вращающимися зазубренными дисками. Эти маленькие воинственные «циркулярные пилы» усеивают район, атакуя всё, что движется... в том числе, увы, и вас...</p>}
--- page.232 ---------------------------------

# page.233
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Всю ночь вы воюете с крылатой нечистью, которая зудит точь-в-точь как земные комары, но кусается куда больнее ([pow]-4[/pow]). <avs-insert>К утру они закусывают вас до смерти.</avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-4
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d']," А наутро забрасываете рюкзак за плечи и идёте по дороге прочь от замка [page=381]на север[/page].")
--- page.233 ---------------------------------

# page.234
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Каменный водопад сбивает вас с ног ([pow]-5[/pow]). <avs-insert>Подняться вы уже не можете.</avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-5
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'Вы ещё <a l:href="#n_338">живы</a>?')
--- page.234 ---------------------------------

# page.235
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<center><font color=#339900>ПРОВЕРЬТЕ СВОЮ ЛОВКОСТЬ</font>.


[fast]435|507[/fast]</center>}
--- page.235 ---------------------------------

# page.236
$lvar['заголовок']={Мир Роботов<avs_source src="[useof:[кольцо] [антигравитатор]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Что ж, попробуйте <a l:href="#n_560">ринуться сквозь залпы</a>. Или вы знаете способ, не рискуя, пересечь опасную зону?</p>}
--- page.236 ---------------------------------

# page.237
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Что, ночевать негде? — снисходительно бросает стражник. — Ладно, заходи. Его светлость барон Брайт Могучий никому не откажет в крыше над головой на ночь глядя. Иди через двор — и на кухню, там тебе накормят...»
     Двор полон суетящихся слуг. Неподалёку от распахнутых дверей кухни пылает костёр, на котором жарится целая туша громадного шестиногого зверя. В кухню невозможно войти — такие клубы ароматного пара вырываются оттуда. Вы пристраиваетесь <a l:href="#n_61">у костра</a>. Вас даже не спрашивают, кто вы такой, а просто суют в руки кусок жареного мяса и кружку вина ([pow]5[/pow]).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',5
end
--- page.237 ---------------------------------

# page.238
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Светло-серый длинный плащ оказывается идеальной маскировкой в этих волнах серебристого живого света. Вы <a l:href="#n_526">лежите неподвижно</a>, превратившись почти в невидимку...</p>}
--- page.238 ---------------------------------

# page.239
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре выходите на тропинку. Правда, это не та тропа, которая незадолго до этого исчезла у вас прямо из-под ног, но не идти же напролом сквозь кусты... И вы направляетесь по новой тропе — <a l:href="#n_607">на север</a>.</p>}
--- page.239 ---------------------------------

# page.240
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Сон на деревянной лежанке, под мягкой, лохматой чёрной шкурой прибавляет 2 к вашей СИЛЕ. А утром вы оставляете таверну и идёте по дороге дальше — <a l:href="#n_517">на север</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',2
end
--- page.240 ---------------------------------

# page.241
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы покинули поляну, но довольно быстро <a l:href="#n_173">потеряли тропинку</a> — ведь она была такая старая, так пряталась в траве!.. Попытки найти её приводят лишь к тому, что вы окончательно перестаёте ориентироваться на местности.</p>}
--- page.241 ---------------------------------

# page.243
$lvar['заголовок']={Мир Стрекоз<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы ежеминутно ожидаете опасности и не удивляетесь, услышав громкий хруст и треск. Высоко взвиваясь над кустами, сминая в падении их верхушки и снова взвиваясь ввысь, к вам приближается грозного вида существо, напоминающее громадного бурого кузнечика. Его кривые чёрные жвала похожи на зазубренные ножи, лапы заканчиваются кривыми когтями. Ясно, что это хищник на охоте. А кто дичь — догадаться несложно... <a l:href="#n_503">Броситесь бежать</a> или <a l:href="#n_123">примете бой</a>?</p>}
--- page.243 ---------------------------------

# page.244
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы бросаетесь наутек, но один из негодяев — тот, что со стальным прутом — резко взмахивает рукой. Прут летит, как копье, и с силой бьёт вас под лопатку ([pow]-2[/pow]). Вы спотыкаетесь на бегу, <avs-insert><font color=#004400><i>и падаете. В ту же секунду тяжёлый удар обрушивается на вашу многострадальную голову. Встать уже не получится.</i></font></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'но не останавливаетесь, пока, свернув за поворот, не видите, что <a l:href="#n_456">погони нет</a>: троица не стала вас преследовать.')
--- page.244 ---------------------------------

# page.245
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[knew]защитник_служанок|Этим вечером вы заступились за служанку перед поваром, а значит события развернутся <a l:href="#n_317">так</a>.|Этим вечером вы предпочли не ввязываться в разборки местной прислуги, а значит события развернутся <a l:href="#n_469">так</a>.[/knew]</p>}
--- page.245 ---------------------------------

# page.246
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ослепительная вспышка разрезает полумрак. Пауки в панике забиваются в трещины, а те, что не успели убежать от луча, превращаются в безобразные комки. <a l:href="#n_386">Путь свободен</a>!</p>}
--- page.246 ---------------------------------

# page.247
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре, обойдя озеро, вы выходите на дорогу, ведущую <a l:href="#n_99">на север</a>.</p>}
--- page.247 ---------------------------------

# page.248
$lvar['заголовок']={Мир Роботов<avs-enemy>}
$lvar['исходник']={<p align=justify>     Корпус неуклюжего чучела сделан из дрянного пластика, поддающегося вашему ножу. Но дисковая пила — орудие серьёзное, каждое её прикосновение вычтет 3 из СИЛЫ.</p>

<center><font size=+1>РОБОТ

ЛОВКОСТЬ 8     СИЛА 8</font>

<font color=#004400><i>Если разделаетесь с ним, можете идти дальше.</i></font></center>}
$lvar['exit']='page.384'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','робот','','<ratch>'
end
--- page.248 ---------------------------------

# page.249
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Внимательно осмотрев полянку, обнаруживаете заметную, натоптанную тропу. Вероятно, сюда кто-то ходит по воду — а значит, тропа выведет к людям!
     И верно: вскоре над кронами поднимается лёгкий дымок, а меж стволами начинают мелькать кособокие <a l:href="#n_145">домишки</a>.</p>}
--- page.249 ---------------------------------

# page.250
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Расщелина становится всё уже, острые края камней царапают вас в кровь ([pow]-1[/pow]). <avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'Хотите вернуться и пойти <a l:href="#n_558">прежним путём</a>? Или всё же попытаетесь исследовать расщелину <a l:href="#n_322">до конца</a>?')
--- page.250 ---------------------------------

# page.251
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Кусты оказываются ещё более цепкими, чем казались со стороны. Колючки вцепляются в одежду и тело так, словно дали клятву не пропустить вас дальше ([pow]-2[/pow])...<avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','зажигалка'
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],' 
     Вы продолжаете упрямо ломиться вперёд... и вдруг замечаете на одной из ветвей обрывок ткани! Присев на корточки, рассматриваете свою находку. Это клок форменной куртки исследователей Вереницы Миров. Можно, конечно, идти дальше, усмехаясь при мысли, что не только у вас хватило ума забраться в такие непроходимые заросли. Но вы, точно повинуясь чьей-то подсказке, начинаете внимательно осматривать землю вокруг. И ваши усилия не пропадают зря: среди узловатых тонких корней лежала маленькая легкая зажигалка — точь-в-точь такая же, как та, которую вам предложили перед отбытием на задание. Вероятно, оставшийся на ветке клок был вырван из кармана...

     Что ж, можно <a l:href="#n_131">идти дальше</a>.')
--- page.251 ---------------------------------

# page.252
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы пытаетесь уйти, но рыцарь, взмахнув мечом, наносит вам удар ([pow]-2[/pow]). <avs-insert><font color=#004400><i>И этот удар оказался смертельным!</i></font></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'
     «Трус! — кричит Палеандр. — Ты недостоин называться рыцарем! Ты покрываешь позором свой шлем и своё имя! Сражайся — или, клянусь Небесным Клинком, я убью тебя, как жалкого болотного хлипуна!»
     Выяснять, кто такой хлипун, сейчас явно не время. Этот псих и впрямь Неукротимый... Придётся <a l:href="#n_493">драться</a>.')
--- page.252 ---------------------------------

# page.253
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Вы сделали чудесный выбор! — гордо заявляет маг. — Этот предмет позволит вам взлететь на зависть птицам... но лишь один раз!
     Антигравитатор, вот как? Вам приходилось видеть подобные приборы, но те были гораздо больше... И Клуша, уже успевшая произвести расчеты, быстро предупреждает: поле, созданное таким маленьким антигравитатором, не может быть стабильным.
     Точно услышав её слова, маг признается:
     «Такие кольца действуют не очень хорошо, могут и подвести... причем даже в момент полёта... Повторяю, поможет оно лишь раз... если захочет...»
     Понятно. Опять закон Мерфи...
     Если не хотите связываться с сомнительным устройством — <a l:href="#n_101">откажитесь</a>. Но если думаете когда-нибудь воспользоваться им, [obj]КОЛЦО_000016|бросьте кольцо в свой рюкзак[/obj]. Потом достанете, в подходящее время.</p>}
if здесь_был[$curloc]=0:
$args['динамический код предметов']={![page253.vf]
if $args[0]='!addobj.goto!':
	! удаляем динамический код
	args['pit']=arrpos('$id_array',$args[1])
	$args['run']=$strfind($run_array[args['pit']],'!'+'\['+'page253\.'+'vf\]'+'[\s\S]*'+'!'+'\[\/'+'page253\.'+'vf\]')
	$object_array[args['pit']]=$replace($object_array[args['pit']],'[hide.onloc]')
	$run_array[args['pit']]=$replace($run_array[args['pit']],$args['run'])
	$result='page.481'
end
![/page253.vf]
}
gosub 'crt.obj','кольцо',"КОЛЦО_000016",'[hide.onloc]',1,1,'',$args['динамический код предметов']
end
:[СЕМЕНА]
--- page.253 ---------------------------------

# page.254
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Пройдя немного по извилистому коридору, вы обнаруживаете, что это тупик. Можно, конечно, повернуть обратно, но... В одной из стен, чуть выше уровня глаз, чернеет пятно ниши. Хотите <a l:href="#n_186">осмотреть</a> её или сразу <a l:href="#n_538">вернётесь</a>?</p>}
--- page.254 ---------------------------------

# page.255
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы всё ещё ничего не можете разглядеть в сверкании вокруг... Чьи-то когти впиваются вам в плечи, спину обжигает боль, словно от сильного укола... и вы <a l:href="#n_649">теряете сознание</a>.</p>}
--- page.255 ---------------------------------

# page.256
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В переулке довольно тихо, но ещё недавно тут, похоже, шли ожесточенные бои. Дома сильно повреждены, под ногами хрустят битые кирпичи и осколки стекол...
     Вы внимательно оглядываетесь, в любую минуту ожидая нападения... Стоп! Показалось вам или нет, что в подвальном окошке мелькнуло лицо?
     <a l:href="#n_440">Подойдете ближе</a>, чтобы это проверить? Или двинетесь <a l:href="#n_360">дальше</a>?</p>}
--- page.256 ---------------------------------

# page.257
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Всё, пора уходить из Патруля! На Землю! Смотрителем в Музей динозавров! Там ящеры тихие, не плюются огнём, ведут себя прилично. Стоят себе в витринах и...
     Стоп, а что это желтеет там, в кустах, запутавшись в колючих ветвях?..
     Парик. Золотистый парик с двумя растрепавшимися косами... Глуша в горле ругательства, вспоминаете лицо на экране в кабинете шефа. Если мысленно надеть на эту головку парик... а на глаза — синие контактные линзы... Ах, паршивка! Уши ей оборвать мало! Хорошо она вас подставила. Значит, Ворот здесь нет...
     На всякий случай осматриваете поляну и разочарованно покидаете её. Отсюда ведёт широкая тропа... нет, скорее это заброшенная, заросшая травой просёлочная дорога. Можно даже разглядеть следы тележных колес. Вероятно, дракон отбил у людей желание появляться в этих местах. Интересно, куда вела дорога раньше?
     И тут вы замечаете развилку. Куда направитесь: на <a l:href="#n_201">север</a> или на <a l:href="#n_621">северо-восток</a>?</p>}
--- page.257 ---------------------------------

# page.258
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В пещере оказывается куда светлее, чем снаружи, потому что стены усеяны копошащимися фосфоресцирующими жуками. В их свете вы различаете ведущий в толщу скалы тоннель. Отважно направляетесь вы по нему, но почти сразу тоннель раздваивается. Куда вы свернёте: <a l:href="#n_106">налево</a> или <a l:href="#n_506">направо</a>?</p>}
--- page.258 ---------------------------------

# page.259
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Уютная полянка с востока и севера огорожена кустами; на южной стороне деревья перевиты вьющимися растениями так густо, что это похоже на занавес. Западная сторона открыта, и вы видите деревья, стоящие такими стройными рядами, что нет никаких сомнений: это сад.
     Вы сидите в густой траве и с большого твердого листа поглощаете красновато-бурую волокнистую массу, которую хозяйка называет поэтически: «Песня волны». Водоросли. Очень вкусно, между прочим. ([pow]3[/pow]).
     Оказывается, водоросли (и многое другое) стрекозы выменивают у жителей моря. Гостеприимная хозяйка вспархивает к древесной кроне и, сорвав плод, похожий на чёрное яблоко, бросает вам на колени.
     «Вот на это и вымениваем. Если окажетесь на берегу моря, сделайте так...»
     Чуть изогнув крылья, она поворачивает их ребром к ветру — раздается протяжный свистящий звук.
     «Вот так! Морские жители услышат... За Плод Жизни они сделают всё, что угодно...»
     И тут же стрекоза огорченно спохватывается:
     «Но вы же не сможете их позвать! У вас нет крыльев!»
     Усмехнувшись, вы начинаете насвистывать. Стрекоза в восхищении.<!--     Если захотите когда-нибудь обменять на что-то чёрный плод у загадочных местных жителей, вычтите 176 из номера параграфа, на котором будете находиться.-->
     А беседа [page=611]продолжается[/page]}
if здесь_был[$curloc]=0:
	gosub 'power',3
	gosub 'crt.obj','плод'
end
act 'Действие':
	goto 'page.611'
end
--- page.259 ---------------------------------

# page.260
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Перед вами необычный цветок — громадный, круглый, блестящий. Не удержавшись, срезаете его у стебля — и вот в руке полуметровое зеркало в форме астры, тонкое, прочное и такое гибкое, что его можно скатать в трубку. Занятная вещица, но зачем она вам?.. <!--Если всё же когда-нибудь решите воспользоваться зеркалом, вычтите 268 из номера параграфа, на котором будете находиться.-->
     А сейчас <a l:href="#n_72">продолжайте путь</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','зеркало','','[цветок]'
end
--- page.260 ---------------------------------

# page.261
$lvar['заголовок']={Мир Легенд<avs-enemy><non-blaster>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вслед за сэром Эйнаром выходите во двор, на ходу оценивая оружие противника. Меч выглядит внушительно, но, пожалуй, он не длиннее вашего ножа. Вы понимаете, конечно, что бластер в ход пускать нельзя.

<center><font size=+1>ЭЙНАР ЧЁРНЫЙ ЩИТ

ЛОВКОСТЬ 10     СИЛА 12</font>

<font color=#004400><i>Если вы снизите его СИЛУ до 2, то ура!
Но если ваша СИЛА снизится до 2, то увы...</i></font></center></p>}
$lvar['exit']='page.197'
$lvar['динамический код']={
if $args[0]='!war.powerdown!':
	if power['now']<3:
		$GAME_WAR['thiswar.'+$curloc]='prelose'
		$GAME_WAR['prelose.txt']='Ваша сила снизилась до 2-х. Увы...'
		$GAME_WAR['exit.'+$curloc]='page.301'
	end
end
if $args[0]='!war.ratchdown!':
	if GAME_WAR['ratch.power.'+$temp_id[0]]<3:
		$GAME_WAR['thiswar.'+$curloc]='victory'
		$GAME_WAR['prewin.txt']='Его сила упала до двух! Ура!!!'
		$GAME_WAR['exit.'+$curloc]='page.197'
	end
end
}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','эйнар','','<ratch>'
end
--- page.261 ---------------------------------

# page.262
$lvar['заголовок']={Мир Камней<avs_source src="[useof:[кольцо]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Каменная «лестница» рассыпается, вы кувырком летите вниз и <avs-insert>ушибаетесь насмерть ([pow]-2[/pow]).</avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'крепко ушибаетесь ([pow]-2[/pow]). Пожалуй, надо возвращаться к развилке и идти <a l:href="#n_66">другой дорогой</a>... если, конечно, не знаете иного способа подняться наверх.')
--- page.262 ---------------------------------

# page.264
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;С разбега вы почти долетаете до цели — и, ударившись об остатки разбитой статуи, срываетесь в хлюпающую черноту. В последнюю секунду успеваете ухватиться за острый мраморный осколок<avs-insert><font color=#004400><i>, распарывающий ладонь ([pow]-2[/pow]). Брызнувшая кровь прилипает к камню, рука соскальзывает, и вы уноситесь вниз.</i></font></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],' и выбираетесь на узкую каменную площадку — бывший постамент статуи. Болит порезанная о камень ладонь ([pow]-2[/pow]). Но <a l:href="#n_532">Ворота — рядом</a>!')
--- page.264 ---------------------------------

# page.265
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Жаль вояку, но он сам виноват... Можете взять его шлем. Увы, темно-красные метелки плюмажа слетели во время боя, ветер унес их в придорожные кусты. Но и без плюмажа шлем выглядит красиво и приходится вам впору. Если до сих пор шлема у вас не было, а вы не прочь были бы выдать себя за рыцаря, то теперь можете это сделать. Если шлем у вас уже есть (или вы не считаете нужным в нем щеголять) — уберите добычу в рюкзак, вдруг да пригодится...
     Тело рыцаря вытянулось поперек дороги, будто преграждая вам путь. Стремясь отделаться от неприятного чувства, поспешно идёте прочь — <a l:href="#n_364">на север</a>, как вы определяете по солнцу.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','шлем'
end
--- page.265 ---------------------------------

# page.266
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Как ни стараетесь вы вжаться в камень, незнакомец замечает вас. Он явно не собирается выяснять, кто вы такой и откуда взялись. Режущая вспышка — последнее, что вы видите в жизни...</p>}
--- page.266 ---------------------------------

# page.267
$lvar['заголовок']={Мир Стрекоз<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Навстречу по дорожке топает странное существо: огромный, почти с вас ростом, муравей, идущий на задней паре лапок. Передней парой он вцепился в сетку, сплетенную из лиан и набитую чем-то похожим на биллиардные шары разного цвета, средняя пара лап держит заостренную палку — видимо, оружие. Муравей совершенно спокоен — видимо, зрение у него хуже вашего, он вас ещё не заметил.
     Спрячетесь, пока не поздно, в кусты и <a l:href="#n_335">дадите ему пройти</a>? Или пойдёте прямо ему <a l:href="#n_399">навстречу</a>?</p>}
--- page.267 ---------------------------------

# page.268
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре вершина муравейника исчезает в колышущейся позади зелени. Вы выходите на широкую лужайку, покрытую мягкой травой. И тут же резкий свист заставляет вас обернуться. Это шумит в воздухе петля, летящая в вашу сторону...</p>
<center><font color=#339900>ПРОВЕРЬТЕ СВОЮ ЛОВКОСТЬ</font>.
   
[fast]410|358[/fast]</center>}
--- page.268 ---------------------------------

# page.269
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Презрительно скривив губы, барон выслушивает ваши бессвязные объяснения.
     «Может, этот парень и не Драконья Лапа, — решает он наконец, — но прохвост он первостатейный... В темницу его! Да в кандалы!»
     Вас отводят в мрачное подземелье и приковывают к стене толстой цепью. Оружие и вещи у вас отбирают. Даже если вы знаете, как выйти из темницы, это не поможет: цепь-то не снять!
     Еду и воду приносят каждый день, но <a l:href="#n_143">решение вашей участи затягивается</a>: Брайт Могучий забыл о вас.</p>}
$GAME_VALUE['interface']=''
--- page.269 ---------------------------------

# page.270
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы делаете шаг — и тотчас пещера оживает. По стенам пробегает мягкая дрожь, сталактиты и сталагмиты начинают медленно сближаться... С ужасом понимаете вы, что это клыки! Вы попали в пасть огромного хищника и вот-вот погибнете...
     <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='Ваш бластер заряжен, попробуйте <a href="exec:charge_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=1 & time[''goto'']=1 & goto ''page.490''" class="plain">выстрелить</a> в нёбо чудовищу. Или вы <a l:href="#n_554">не хотите этого делать</a>?'
		else
			$result='<font color=#004400><i>Если бы только ваш бластер был заряжен, вы могли бы выстрелить в нёбо чудовищу, но</i></font> вы <a l:href="#n_554">не можете этого сделать</a>.'
		end:1DIN></p>}
--- page.270 ---------------------------------

# page.271
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы бросаете рюкзак на землю. Оружие остаётся у вас на поясе. То ли рассеянность, то ли остатки совести заставляют разбойника промолчать об этом, и вы <a l:href="#n_551">идёте дальше</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'put.bag',$curloc,'//nope.goto//'
end
--- page.271 ---------------------------------

# page.272
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Верхний ярус так же безмолвен и безлюден, как и нижние. Но почему-то тревога, давящая на сердце, стала острее, она стискивает вас жесткими челюстями. И не таким уж важным кажется то, что вы добыли аннигилятор... Мысли кружатся чёрным вихрем, всё труднее становится вспомнить собственное имя. Вы пытаетесь сообразить, где находится капитанская рубка... и замечаете, что уже идёте по коридору. Ноги сами несут вас туда, откуда доносятся звуки журчащей воды и чистые, свежие запахи зелёной листвы.
     Оранжерея невелика — путаница прозрачных пластиковых труб, по которым бежит жидкость. Трубы почти закрыты широкими мясистыми листьями растений, тянущихся из гнезд в трубах. Живая фабрика кислорода! Вам всегда нравилось это зрелище. Отчего же сейчас страшно видеть всё это и хочется бежать, а ноги не слушаются, сердце бьется в горле, — точно перед вами встала смерть...
     Впереди что-то шевелится. От одной из труб отделяется существо, похожее на гигантскую сороконожку с громадной круглой головой. Выпуклые глаза пристально следят за вами. Существо делает резкое движение — и страшная боль раскалывает ваш мозг! Мускулы словно стягивает в тугой узел, вы падаете на колени ([pow]-2[/pow]). <avs-insert></avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$args['p']={Эта тварь наносит телепатические удары! <DIN1:$args[бомбёжек]=$func('prv.bag','\[шлем\]','regexp')
if $args['шлем']='': $result='Ах, как вам сейчас пригодилась бы металлическая каска или шлем! Но у вас с собой нет ничего подобного, а значит придётся выдержать [page=632]тяжёлое испытание[/page].':1DIN><DIN2:$args['шлем']=$func('prv.bag','\[шлем\]','regexp')
if $args['шлем']!'':
	if instr($object_array[arrpos('$id_array',$args['шлем'])],'[:голова:]')!0:
		$result='<br><br>     <font color=#004400><i>Хвала Великому Случаю, у вас нашлось, чем [page=40]прикрыть голову[/page]!</i></font>'
	else
		$result='Вам бы сейчас пригодилась металлическая каска или шлем! Если найдется что-нибудь в этом роде, немедленно наденьте! Иначе придётся выдержать <a l:href="#n_632">тяжёлое испытание</a>.'
	end
end:2DIN>}
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],$args['p'])
--- page.272 ---------------------------------

# page.273
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Плащ и в самом деле очень лёгкий и совсем не сковывает движений. Можете накинуть его на плечи, чтобы не занимал места в рюкзаке.
     Вы спрашиваете старуху, хорошо ли она знает здешние края. Да, конечно, и она охотно о них расскажет за серебряную монету. Или, в крайнем случае, за две какие-нибудь вещи из вашей красивой сумы...
     <DIN1:$args['pos.bl']=$func('prv.obj.inBag','короны_розы','[:кошель:]')
		! проверяем заряды
		if $args['pos.bl']!"" and kolvo_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='<font color=#004400><i>У вас в кармане есть ещё монета. Вы можете <a href="exec:kolvo_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=1 & time[''goto'']=1 & goto ''page.305''" class="plain">отдать</a> её за информацию.</i></font>'
		else
			$result='<font color=#004400><i>Монет у вас больше нет.</i></font>'
		end:1DIN>

     <DIN2:gosub 'get.daughter.obj',$curloc,'<obj>'
		if arrsize('$temp_id')>1:
		! количество сброшенных на локации предметов больше одного
			$result='[page=305]Обменять предметы на информацию[/page].'
		else
			$result='<font color=#004400><i>[Если вы хотите обменять на информацию два ненужных предмета, просто выбросьте их из рюкзака.]</i></font>'
		end
		killvar '$temp_id':2DIN>

     Может быть вы [page=525]не хотите меняться[/page], или у вас [page=525]нет[/page] ничего на обмен?</p>}
if здесь_был[$curloc]=0:
	$args['плащ']=$func('crt.obj','плащ','','[старуха]')
	gosub 'add.obj',$args['плащ'],'','//nope.goto//'
end
--- page.273 ---------------------------------

# page.274
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Очень осторожно, удвоив бдительность, идёте по коридору — и останавливаетесь перед развилкой. Куда свернёте: <a l:href="#n_98">налево</a> или <a l:href="#n_626">направо</a>?</p>}
--- page.274 ---------------------------------

# page.275
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Внезапно море вскипает: на поверхность пузырями взлетают десятка два морских жителей. В лапках они тащат что-то легкое, белое, воздушное... В волнении поднимаетесь вы на ноги. Перед вами ткань, сплетенная из водоотталкивающей паутины. Морские жители встряхивают её — она превращается в белый шар. Отличный водолазный колокол! Он поможет вам <a l:href="#n_315">добраться до пещеры</a>, где скрыты Ворота.</p>}
--- page.275 ---------------------------------

# page.276
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Кольцо быстро нагревается на пальце — и мягкая волна поднимает вас над булыжной мостовой, над хлещущими пулемётными очередями... Вы уже собираетесь опуститься, как вдруг видите, что в конце улицы, куда направляете вы свой полет, клубятся густые облака багрового дыма. Рискнёте приземлиться <a l:href="#n_168">в самую его гущу</a>? Или нырнёте <a l:href="#n_132">в открытое окно</a> второго этажа?</p>}
--- page.276 ---------------------------------

# page.277
$lvar['заголовок']={Мир Легенд<avs_source src="[avs-money:короны_розы:avs-money][avs-obj:[шкура] [смола] [веер]:avs-obj]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Раз назвались торговцем — придётся показать товары. Ну-ка, что у вас в рюкзаке? Имейте в виду: из всего, что вы сможете предложить, баронессу Горфриду заинтересуют только веер, полоска ароматической смолы и мягкая серебристая шкура неизвестного ей зверя. За каждую из этих вещей её светлость выложит по тяжелой серебряной монете с короной на аверсе и розой на реверсе.
     А теперь — состоялся торг или не состоялся — откланяйтесь и ступайте за старой служанкой <a l:href="#n_433">к месту ночлега</a>.</p>}
--- page.277 ---------------------------------

# page.278
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы отчаянно вжимаетесь в стену. Потолок коридора обрушивается вниз каменным дождем. Укрыться от камнепада негде. Боль обжигает тело, заставляет потерять сознание ([pow]-6[/pow]).[powernow]
     После этого вы <a l:href="#n_486">ещё живы</a>?|[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-6
end
--- page.278 ---------------------------------

# page.279
$lvar['заголовок']={Мир Стрекоз<avs-enemy>}
$lvar['исходник']={<center><font size=+1>КУСТ-ВАМПИР

ЛОВКОСТЬ 11     СИЛА 8</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.475'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','куст_вампир','','<ratch>'
end
--- page.279 ---------------------------------

# page.280
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы нажимаете кнопку — и посверкивание над вашей головой становится неритмичным, сбивчивым, а затем угасает совсем. Вы смело протягиваете руку к двери — и ничего ужасного не происходит. <a l:href="#n_416">Система защиты обезврежена</a>.</p>}
--- page.280 ---------------------------------

# page.281
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Мне везет! — бурно радуется ваш противник. — Сыграем ещё раз?»
     Хотите <DIN2:gosub 'get.daughter.obj',$curloc
if arrsize('$temp_id')>0:
	$result='<a l:href="#n_543">снова рискнуть</a><lock.put>'
	$GAME_VALUE['obj.inGame']=$temp_id[0]
else
	$result='снова рискнуть'
end
killvar '$temp_id':2DIN>? Если считаете, что пора бросить эту затею (или вам больше нечего поставить на кон), то проститесь с партнером и <a l:href="#n_240">идите спать</a>.
     
     <DIN3:gosub 'get.daughter.obj',$curloc
if arrsize('$temp_id')=0:
	$result=$func('base.txt','help.putobj')
else
	$result=''
end
killvar '$temp_id':3DIN></p>}   
--- page.281 ---------------------------------

# page.282
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Незнакомец оборачивается к вам, и его бластер сверкает смертельной вспышкой...</p>}
--- page.282 ---------------------------------

# page.283
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ладно, пора отсюда исчезать... Пещера низкая, приходится ползти на четвереньках, ориентируясь по сквозному ветерку. Под ладонь попадает что-то жёсткое — какие-то шары рассыпаны по полу пещеры. Наверное, любящая мамаша обеспечила будущее потомство самой разнообразной пищей. Если хотите, можете прихватить с собой один из шаров, но не больше, потому что одна рука должна быть свободна для <a l:href="#n_319">спуска со скалы</a>, а положить добычу в мешок в такой тесноте невозможно.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','шар','','[quest] [pos:рука_левая:pos]'
end
--- page.283 ---------------------------------

# page.284
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В тоннеле сыро и темно, приходится очень внимательно глядеть под ноги...</p>
<DIN1:$result=$func('luck',$lvar['luck'],156,460):1DIN>}
--- page.284 ---------------------------------

# page.285
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Поравнявшись с вами, рыцарь выхватывает меч из ножен.
     «Остановись, сэр рыцарь! — восклицает он. — Остановись и прими мой вызов! Ибо я, Палеандр Неукротимый, чьё имя, несомненно, доходило до твоего слуха, дал обет — сразиться в честь благородной Берегонды Аргианской с тридцатью тремя встреченными рыцарями, дабы клинком своим заставить их признать мою даму прекраснейшей из всех живущих на свете женщин! Назови имя своей дамы и бейся со мной!»
     <a l:href="#n_493">Примете вызов</a> этого ненормального? Или <a l:href="#n_252">откажетесь драться</a> и пойдёте прочь?</p>}
--- page.285 ---------------------------------

# page.286
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Напрасно шарите вы по камням — пальцы не находят ничего, кроме липкой плесени. Вскоре это бесполезное занятие надоедает вам. Спрыгнув вниз, возвращаетесь в коридор, который только что оставили, и идёте по нему <a l:href="#n_502">дальше</a>.</p>}
--- page.286 ---------------------------------

# page.287
$lvar['заголовок']={Мир Стрекоз<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы идёте до тех пор, пока путь не преграждают заросли колючих высоких кустов. Пойдёте через них <a l:href="#n_251">напролом</a> или попробуете обойти кустарник? В таком случае — <a l:href="#n_658">с запада</a> или <a l:href="#n_391">с востока</a>?</p>}
--- page.287 ---------------------------------

# page.288
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы уже почти спустились на первый этаж, как вдруг где-то рядом грохает взрыв. Дом содрогается от фундамента до крыши. На площадку первого этажа оседают потолок и стены подъезда, штукатурка взвивается белым облаком... <avs-insert>К несчастью, вас зацепил упавший сверху кусок лестничного пролета ([pow]-3[/pow])</avs-insert>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-3
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'К счастью, вас лишь слегка зацепил упавший сверху кусок лестничного пролета ([pow]-3[/pow]).
     С трудом пробираетесь вы к двери, ведущей из подъезда <a l:href="#n_400">на улицу</a>.')
--- page.288 ---------------------------------

# page.289
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Девушка явно не верит вам ни на грош.
     «Ладно, не мое это дело. Ты за меня вчера заступился — я тебя сегодня предупредила. К воротам не суйся — пропадешь. Лучше поднимайся на стену — вон там, справа, ступеньки. И попробуй как-нибудь на ту сторону спуститься. Если ты такой лихой парень, как про тебя в песнях поют, то и просто спрыгнуть не побоишься!»
     Сверкнув белозубой улыбкой, девчонка исчезает. А вы спешите <a l:href="#n_129">последовать её совету</a>.</p>}
--- page.289 ---------------------------------

# page.290
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Головокружение мутной волной захлестывает вас, смывая зрение и слух. Вы боретесь с тошнотой, слушая голос Клуши, которая, разумеется, сориентировалась быстрее вас:
     «Мир Камней. Разумной жизни нет. Растительности тоже нет, кроме лишайника, встречающегося редкими островками. Фауна малоизученная, предположительно все виды — хищники. — Голос Клуши делается менее официальным. — Так что, шеф, стреляйте во всё, что движется. Не ошибетесь...»
     Весёлое дело! Да где же набрать столько зарядов для бластера?..
     Зрение понемногу возвращается к вам. Вокруг тьма, чуть пронизанная слабым светом двух небольших спутников, плывущих по чёрному небу. В их призрачном мерцании вы с трудом различаете нагромождение скал, на их круглых склонах чернеют пятна пещер.
     Быстрый взгляд на браслет — «глазок» остаётся чёрным.
     «Шеф, — предупреждает Клуша, — здесь часты метеоритные дожди. Чтобы не угодить под камнепад, местная живность укрывается в пещерах. Советую и вам сделать это, пока не поздно!»
     Совет разумен ещё и потому, что инженеры Лаборатории не стали бы устраивать Ворота на открытом месте, под каменной бомбежкой. Конечно, надо <a l:href="#n_6">осмотреть пещеры</a>, начиная с ближайшей.</p>}
--- page.290 ---------------------------------

# page.291
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Перевозчик работает веслами, оживленно болтая:
     «Сейчас причалим, а там неподалёку — дорога, она прямо к лесу выведет. Но ты, путник, лучше лесом иди. Дороги сейчас опасные, кто только там ни бродит... Вот сэр Кириас Многоземельный строит себе новый замок — в каменоломнях рабочие руки нужны. Смотри, чтоб и тебя не схватили...»
     Тут лодка мягко толкается в берег. Вы прощаетесь со стариком, <a l:href="#n_99">выходите на берег</a> — и сразу же видите дорогу.</p>}
--- page.291 ---------------------------------

# page.292
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ветер несёт вам в лицо соленые брызги. Где-то впереди, за скалами, море. А солнце уже почти опустилось за горизонт.
     «Можно заночевать на берегу, — размышляете вы вслух. — Голые камни, растительности нет, никакое голодное дерево в тебя не вцепится. Правда, тут водятся и хищные насекомые...»
     «Нет, сэр, — дает справку Клуша. — Здесь насекомые не будут вас тревожить. Взгляните-ка...»
     В трещинах меж камней растут низенькие бурые растеньица. Они так сливаются по цвету со скалами, что в сумраке вы их не заметили. Толстые, с мясистыми листьями, покрытыми безобразными наростами...
     «Их запах отпугивает насекомых, — сообщает Клуша. — Исследователи Вереницы Миров часто этим пользуются...»
     Можете <a href="exec:gosub 'лист_вонючка'" class="plain">отломить</a> столько широких сочных листьев, сколько захотите. Каждый лист займет в рюкзаке 1 место и пригодится лишь раз. Когда захотите разогнать насекомых — разотрите лист в ладонях<!-- (и вычтите 140 из номера параграфа, на котором будете находиться)-->. Использованные листья придётся выбросить...
     А теперь идите вниз, <a l:href="#n_419">к берегу</a>.</p>}
$args['l']=$func('get.daughter.obj',$curloc,'\[:лист_вонючка:\]')
if $args['l']='true':
	:fordel
	if arrsize('$temp_id')>0:
		gosub 'del.obj.id',$temp_id[0]
		killvar '$temp_id',0
		jump 'fordel'
	end
end
killvar '$temp_id'
--- page.292 ---------------------------------

# page.293
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропка выглядит всё более заброшенной и заросшей. Вы уже прикидываете, не вернуться ли. Внезапно вас окликает женский голос.
     Навстречу по тропе идёт, подобрав подол длинного платья, синеглазая девушка с растрепавшимися золотыми косами. Её наряд выглядит в этой чаще странно, он был бы куда уместнее на балу или в тронном зале дворца.
     Резким взмахом руки девушка останавливает вас.
     «Ни с места! — звонко говорит она. — Ни с места, смертный! Перед тобою Владычица Древнего леса!»
     <DIN1:$args['шлем']=$func('prv.bag','\[шлем\]','regexp')
if $args['шлем']='': $result='Будь у вас на голове шлем, можно было бы попробовать прикинуться рыцарем. Но шлема <a l:href="#n_629">нет</a>.'
if $args['шлем']!'':
	if instr($object_array[arrpos('$id_array',$args['шлем'])],'[:голова:]')!0:
		$result='Как удачно, что у вас на голове <a l:href="#n_29">шлем</a>.'
	else
		$result='Эх, будь у вас на голове шлем, можно было бы сойти за рыцаря. Но теперь <a l:href="#n_629">переоблачаться поздно</a>.'
	end
end:1DIN></p>}
--- page.293 ---------------------------------

# page.294
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ужом извиваясь меж неровных, шероховатых, потрескавшихся стен лаза, вы медленно продвигаетесь вперёд — и вот лаз расширяется, превращаясь в небольшую <a l:href="#n_22">пещерку</a>, в которой лежит что-то, похожее на кучу мусора...</p>}
--- page.294 ---------------------------------

# page.295
$lvar['заголовок']={Мир Стрекоз<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;С полянки ведёт даже не тропа, а настоящая дорожка, вымощенная плоскими белыми камешками. Вы раздумываете: кто же по ней ходит? И тут же получаете ответ на свой вопрос. Навстречу семенят трое существ, похожих на полутораметровых муравьёв, вставших на задние лапки. В передних лапках они держат заостренные палки, весьма похожие на оружие. Ваше появление не удивляет муравьёв — вероятно, они уже встречали исследователей Вереницы Миров. По-хозяйски приблизившись, муравьи щелкающими голосами требуют, чтобы вы последовали за ними в муравейник.
     <a l:href="#n_523">Подчинитесь</a>? Будете <a l:href="#n_91">драться</a>? Попытаетесь предложить муравьям <a l:href="#n_339">подарок</a>, чтобы они от вас отвязались? А может быть, попробуете <a l:href="#n_431">убежать</a>?</p>}
--- page.295 ---------------------------------

# page.296
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Выждав момент, когда пулемёт замолкает, бросаетесь вперёд — и пересекаете линию огня. За спиной пулемёт тарахтит снова, но вам он уже не опасен — можно <a l:href="#n_592">идти дальше</a>.</p>}
--- page.296 ---------------------------------

# page.297
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы медленно проходите мимо длинных штабелей плоских металлических ящиков, опутанных проводами. Ничего интересного. Камеры глубокого охлаждения, в которых перевозили пассажиров во время дальних рейсов. Гиперпространственного двигателя на этой допотопной посудине нет, поэтому пассажиры дожидались высадки в состоянии анабиоза, а команда работала, сменяя друг друга у пультов и снова возвращаясь в «морозильники». Хорошо, что уже не осталось таких кораблей...
     А это, надо полагать, медицинский отсек. Отсюда велось наблюдение за состоянием находящихся в анабиозе людей. Приборы мертвы, аптечный сейф распахнут и пуст... А что это валятся на полу возле входа?
     Нагнувшись, поднимаете полураздавленную пластиковую трубочку. В ней зелёный шарик. Конечно, это меорвин, великолепное средство для повышения реакции! Клуша заверяет, что таблетки эти совершенно не портятся от времени. Если вы проглотите шарик, ваша ловкость повысится на 1 и останется такой примерно пару недель.
     А теперь можно <a l:href="#n_457">продолжить осмотр корабля</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','меорвин'
end
--- page.297 ---------------------------------

# page.298
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор становится выше, потолок теряется во мраке. Внезапно впереди слышится тихий звон. Вы мгновенно вжимаетесь в трещину, располосовавшую стену. Этот звон вы не спутаете ни с чем: звук работающего антигравитатора! И действительно, впереди, приближаясь к вам, медленно летит человек в форме астронавта. В руках у него бластер, на голове — обруч с фонариком, освещающим тоннель. Вас он вряд ли заметит: по стенам пляшет вереница изломанных теней... <a l:href="#n_502">Пропустите</a> этого типа и пойдёте дальше? <a l:href="#n_282">Окликнете</a> его? <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='<a href="exec:charge_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=1 & time[''goto'']=1 & goto ''page.50''" class="plain">Срежете выстрелом</a> из бластера?'
		end:1DIN> Попробуете <a l:href="#n_562">метнуть в него нож</a>?</p>}
--- page.298 ---------------------------------

# page.299
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Это надо съесть сейчас же! — предупреждает стрекоза. — Ягоды быстро портятся!»
     Вы <a l:href="#n_43">поступаете так, как она советует</a>, и не жалеете об этом — ягоды прибавляют 1 к вашей ЛОВКОСТИ.</p>}
if здесь_был[$curloc]=0:
	fast['now']+=1
	$print[]='ЛОВКОСТЬ увеличилась на 1'
	$args['семена']=$func('prv.obj.inBag','семена')
	if $args['семена']!'': gosub 'minus.obj',$args['семена'],1 & $print[]='<font color=#884400>Вы отдали cемечко сорняка.</font>'
end
--- page.299 ---------------------------------

# page.300
if здесь_был[$curloc]=0:
	gosub 'crt.obj','выход_215','','<knew>',0,1,'KNOWLEDGE'
end
$lvar['заголовок']={Мир Роботов<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Свет становится всё ярче, и тоннель выводит вас в большой зал. Стены его украшены мозаикой, изображающей резвящихся в волнах русалок. Вдоль стен в нишах — мраморные статуи русалок, плетущих венки из странных растений.
     Вы так увлечены разглядыванием статуй, что забываете об источнике света. И вдруг обнаруживаете его прямо перед собой. В одной из ниш нет статуи. Вместо неё между металлическими чашами струится знакомый золотистый поток. <a l:href="#n_20">Ворота</a>!
     [upluck]<font color=#000000>На браслете замерцали числа. Модификатор вероятностей готов к восстановлению вероятностных потоков к исходному состоянию.</font>
     
УДАЧА: ВОССТАНОВИТЕ 1 ЦИФРУ.[/upluck]
     На стене — кодовый номер: 215. Вы не забыли, что должны записать его?</p>}
--- page.300 ---------------------------------

# page.301
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Противник вскидывает меч для последнего удара. Вы пытаетесь парировать, но, ослабев от потери крови, не можете удержать оружия. Ваш клинок, выбитый умелой рукой рыцаря, звенит на камнях у ног барона, следившего за поединком.
     «Что ж, — задумчиво тянет Брайт Могучий, — Суд Божий свершился. Эй, стража! Отвести этого человека <a l:href="#n_25">в темницу</a>! Потом я разберусь, кто он таков...»
     Трое дюжих стражников с арбалетами мрачно ждут, когда вы возьмёте рюкзак. Вам не мешают даже подобрать своё злополучное оружие — видимо, не считают, что вы опасны.</p>}
--- page.301 ---------------------------------

# page.302
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Кольцо на пальце становится всё теплее — и вот вы плавно взмываете в воздух и приземляетесь <a l:href="#n_534">на каменном карнизе</a>. Кольцо тут же остывает. Больше оно вам не пригодится.</p>}
--- page.302 ---------------------------------

# page.303
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Без приключений доходите вы до места, где тропка раздваивается. Пойдёте дальше на <a l:href="#n_243">север</a> или свернёте на <a l:href="#n_595">северо-запад</a>?</p>}
--- page.303 ---------------------------------

# page.304
$lvar['заголовок']={Мир Роботов}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
if cube=1 or cube=2 or cube=3:
	args['page']=104
else
	args['page']=216
end
$lvar['исходник']="<p align=justify>[knew]мв|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вряд ли вы очень далеко от Ворот - шеф что-то такое говорил про ограниченный радиус действия. Но [page=<<args['page']>>]где именно[/page], понять не так уж просто. Недобрым словом памятуете вы Дэвида Бронсона. Сейчас бы ох как пригодилась хоть какая-нибудь карта...|"+$func('base.txt','vm',args['page'])+"[/knew]</p>"
:о модификаторе
--- page.304 ---------------------------------

# page.305
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<qhtml><p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Старуха оживляется, она готова отвечать на любые вопросы. Вы описываете Бронсона, но, увы, такой человек ей не встречался... Без особой надежды спрашиваете вы о Воротах.
     «Столб света меж двумя чашами? — ахает старуха. — Так ты — паломник к Затерянной Часовне? Люди давно уже туда не ходят, а теперь, когда там появилось это наваждение, и вовсе позабыли дорогу в те края!»
     Оказывается, в лесу стоит полуразрушенная часовня. Недавно о ней стали расползаться странные слухи: мол, те, кто входит в часовню, исчезают безвозвратно...
     «Иди на север, — объясняет старуха. — Рано или поздно наткнешься в лесу на длинную прогалину, заросшую синими цветами. На восточном её конце растет Великое Древо — говорят, ему поклоняются дикие обезьянопауки. От корней начинается тропка. Ищи хорошенько, она совсем заросла...»
<!--     (Если когда-нибудь окажетесь у Великого Древа и захотите найти тропку, прибавьте 36 к номеру параграфа, на котором будете находиться.)--><a l:href="#n_473">На прощание</a> старуха напутствует вас:«Будь осторожен, щедрый господин мой! Говорят, некий рыцарь дал обет своим мечом защищать подступы к Затерянной часовне!»</p></qhtml>}
--- page.305 ---------------------------------

# page.306
$lvar['заголовок']={Мир Камней<avs-dark>}
$lvar['исходник']={<qhtml><p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Почему-то здесь на стенах нет ни одного светящегося жука. Темнота непроглядная, как в колодце. <DIN1:$result=''
$args['pos.bl']=$func('prv.obj.inBag','зажигалка')
$args['pos.sv']=$func('prv.obj.inBag','свеча')
if $args['pos.bl']!'' and $args['pos.sv']!'':
	$result+='У вас есть зажигалка и свеча: можете [page=522]осветить себе дорогу[/page]. '
elseif $args['pos.bl']!'':
	$result+='У вас, конечно, есть зажигалка, но далеко ли вы с ней уйдёте! '
elseif $args['pos.sv']!'':
	$result+='У вас есть свеча, но зажечь её нечем. '
end
$args['очки']=$func('prv.bag','\[:ночное_видение:\]','regexp')
if $args['очки']!'':
	if instr($object_array[arrpos('$id_array',$args['очки'])],'[:лицо:]')=0:
		$result+='В рюкзаке лежат очки «Ночное зрение», можете надеть их. '
	else
		time['goto']=1
		goto 'page.342'
	end
elseif $args['pos.bl']='' or $args['pos.sv']='':
	$result+='Сейчас вам могли бы пригодиться очки «Ночное зрение». '
end
if $args['pos.bl']='' and $args['pos.sv']='' and $args['очки']='':
	$result='У вас нет ничего, что могло бы осветить вам путь. А значит придётся'
elseif ($args['pos.bl']='' or $args['pos.sv']='') and $args['очки']='':
	$result+='К сожалению того, что у вас есть, недостаточно, чтоб освещать путь. А значит придётся'
else
	$result+='Но если вы не хотите воспользоваться ими, придётся'
end:1DIN> либо <a l:href="#n_446">идти в кромешном мраке</a>, либо отказаться от намерения исследовать этот коридор. В таком случае — <a l:href="#n_502">идите прежним путём</a>.</p></qhtml>}
:[dark]
--- page.306 ---------------------------------

# page.307
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Инстинкт самосохранения подсказывает верное решение: вы ныряете в кусты и растягиваетесь меж корней. Зверь растерянно пыхтит где-то рядом. Он потерял вас из виду, а обоняние у него, похоже, слабое. Неуверенно потоптавшись на месте, хищник скачками уносится прочь, а вы, немного выждав, встаете и идёте дальше <a l:href="#n_623">на север</a>.</p>}
--- page.307 ---------------------------------

# page.308
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Проклятая жидкость точно взрывается в желудке. На миг вам кажется, что вы умираете... к счастью, лишь на миг. А вот ЛОВКОСТЬ понижается на 1... Тем не менее жидкость в самом деле дает возможность дышать под водой. Вы плывете сквозь непроглядную, густую от грязи жижу, пока путь не преграждает сеть, сплетенная из железных тросов. Кому понадобилось перекрывать тоннель?.. Придётся <a l:href="#n_636">возвращаться на станцию</a>. Жаль напрасно потраченной магической жидкости, но что поделаешь...</p>}
if здесь_был[$curloc]=0:
	gosub 'lovk',-1
end
--- page.308 ---------------------------------

# page.309
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Нырнув под занесенную руку повара, служанка со всех ног удирает прочь. Повар, гневно рявкнув что-то неразборчивое, исчезает на кухне. Конфликт исчерпан, и вы с облегчением <a l:href="#n_409">возвращаетесь к прерванному ужину</a>.</p>}
--- page.309 ---------------------------------

# page.310
$lvar['заголовок']={Мир Камней<checkpoint><avs_source src="[useof:[протонная_граната] [антигравитатор] [кольцо]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;А как вы собираетесь добраться до Ворот? Хорошо бы, конечно, перелететь пещеру над головами пиратов, которые ничего подобного не ожидают... Но раз вы не можете этого сделать, попробуйте по каменному «балкончику» <a l:href="#n_14">обогнуть пещеру вдоль стены</a>, уповая на то, что вас не заметят. <DIN1:$args['pos.bl']=$func('prv.obj.inBag','протонная_граната')
		! проверяем заряды
		if $args['pos.bl']!"":
			$result='Или — тоже хорошая мысль — швырните в этих головорезов протонную гранату.'
		else
			$result='Была бы у вас протонная граната, вы могли бы попробовать швырнуть её в этих головорезов. Но, к сожалению, протонной гранаты у вас нет.'
		end:1DIN></p>}
--- page.310 ---------------------------------

# page.311
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Ну и везет же тебе! — восклицает ваш противник, выкладывая монету на стол. — Нет, отыгрываться не стану. Третью партию подряд играть — вконец удачу потерять. Слыхал про такую примету?»
     Весело насвистывая, он направляется к дверям, небрежно кивнув хозяину таверны, который низко ему кланяется.
     Куда это он направился по такой темноте? Что за ночная пташка с вами играла?
     Впрочем, какое вам дело до него? Вам <a l:href="#n_240">спать пора</a>...</p>}
if здесь_был[$curloc]=0:
	$args[0]=$func('crt.obj','короны_розы')
end
--- page.311 ---------------------------------

# page.312
! С П312 ПЕРЕХОД НА П604.
$lvar['заголовок']={Исследовательская станция<avs_source src="[useof:[во]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Первая же дверь, мимо которой вы проходите, отперта. Вы заглядываете в комнату — и замираете на пороге. Комната разгромлена. На полу кучей свалены обломки мебели, клочья ткани, изорванные книги. Из мягкого зеленовато-голубого ковра на полу выдраны лоскуты... Что же здесь произошло?
     Осторожно прикрыв дверь, идёте дальше, но тут же останавливаетесь. Из-за следующей двери звучит музыка — лёгкий, весёлый перезвон колокольчиков. Вы трогаете дверь, но она заперта. Если у вас есть вибромагнитная отмычка, вы сможете войти в комнату. Если отмычки нет, придётся [page=604]идти дальше[/page].</p>}
--- page.312 ---------------------------------

# page.313
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В кувшинчике что-то плещется. «Там жидкость, глоток которой позволит дышать под водой... недолго, примерно четверть часа... — объясняет маг и, помявшись, честно добавляет: — Но это очень вредно для здоровья!»
     Вы охотно этому верите. Конечно, вредно! Жидкость, изменяющая обмен веществ... приготовленная в таких варварских условиях...
     Вы считаете, что <a l:href="#n_101">ни к чему</a> таскать с собою всякую отраву?
     Если же [obj]ЖДКСТ_000017|возьмёте кувшинчик[/obj], имейте в виду: жидкости хватит лишь на один глоток. <!--Когда вы рискнёте её выпить, вычтите 80 из номера параграфа, на котором будете находиться.--></p>}
if здесь_был[$curloc]=0:
$args['динамический код предметов']={![page313.фмы]
if $args[0]='!addobj.goto!':
	! удаляем динамический код
	args['pit']=arrpos('$id_array',$args[1])
	$args['run']=$strfind($run_array[args['pit']],'!'+'\['+'page313\.'+'фмы\]'+'[\s\S]*'+'!'+'\[\/'+'page313\.'+'фмы\]')
	$object_array[args['pit']]=$replace($object_array[args['pit']],'[hide.onloc]')
	$run_array[args['pit']]=$replace($run_array[args['pit']],$args['run'])
	$result='page.481'
end
![/page313.фмы]
}
gosub 'crt.obj','жидкость',"ЖДКСТ_000017",'[hide.onloc]',1,1,'',$args['динамический код предметов']
end
--- page.313 ---------------------------------

# page.314
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Проклятые лохматые твари, прокусывая одежду, вцепляются в тело. Вы стряхиваете их, но они вновь и вновь бросаются в атаку ([pow]-6[/pow])<avs-insert>. Вам так и не удаётся преодолеть опасную часть коридора...</avs-insert></p>}
if здесь_был[$curloc]=0:
	gosub 'power',-6
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'... Наконец <a l:href="#n_386">удаётся миновать опасный участок коридора</a>. Почему-то пауки не преследуют вас. Может быть, они всего лишь охраняют свою территорию?')
--- page.314 ---------------------------------

# page.315
if здесь_был[$curloc]=0:
	gosub 'crt.obj','выход_48','','<knew>',0,1,'KNOWLEDGE'
end
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;И вот вы рядом с золотистым столбом света, только руку протянуть...[upluck]<font color=#000000>На браслете замерцали числа. Модификатор вероятностей готов к восстановлению вероятностных потоков к исходному состоянию.</font>

УДАЧА: ВОССТАНОВИТЕ 1 ЦИФРУ.[/upluck]
     На скале рядом с Воротами можно, хотя и с трудом, прочесть их кодовый номер: 48. Не забудьте эту цифру!
     Коротко вздохнув, вы медленно [step]467|вплываете в световой поток[/step]...</p>}
--- page.315 ---------------------------------

# page.316
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Лёгкое прикосновение к пряжке — и вы взмываете над пулемётными очередями.
     Внезапно замечаете, что внизу — как раз там, где вы собирались приземлиться — из щелей и окон клубами выползает багровый дым и плотным туманом окутывает улицу. А тут, как нарочно, начинает мигать зелёный огонек на пряжке: энергия пояса-антигравитатора иссякает... Опуститесь <a l:href="#n_168">на мостовую</a>? Или нырнёте <a l:href="#n_132">в распахнутое окно</a> второго этажа?</p>}
--- page.316 ---------------------------------

# page.317
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Проснись! — звенит над вами испуганный женский голос. — Скорее!»
     Вас тормошит та самая служанка, из-за которой вечером вы ввязались в драку.
     «Уходи! — шепчет она. — Сейчас здесь будут стражники!»
     Реакция у вас хорошая, просыпаетесь вы быстро. Девица и договорить не успела, а вы уже на ногах, рюкзак за плечами, оружие наготове. Разбираться будете после, а сейчас тихо спускаетесь с сеновала и идёте за девушкой.
     У ворот суматоха: шум, беготня, факелы. Светает, но тень под замковой стеной пока ещё надежно укрывает вас.
     «К воротам явилась какая-то девица, — торопливо объясняет служанка. — Клянется, будто ты — Грэм Драконья Лапа, атаман разбойничьей шайки...»
     Служанка на миг умолкает, пристально смотрит вам в глаза:
     «Это правда? Ты разбойник?»</p>
     <center><font color=#339900>ПРОВЕРЬТЕ СВОЁ ОБАЯНИЕ.</font>

Удастся доказать, что вас оклеветали, или нет?

[social]537|289[/social]</center>}
--- page.317 ---------------------------------

# page.319
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Осторожно выбираетесь по узкой расщелине из пещеры. В глаза вам бьёт утренний свет. Меж высоких скал сереет спокойное море.
     <DIN1:$args['g']=$func('prv.bag','\[:шар:\]','regexp')
if $args['g']!'':
	$result='Вы кое-что прихватили в пещере. Теперь можете <a l:href="#n_567">осмотреть свою добычу</a>.'
else
	$result='Теперь <a l:href="#n_55">идите дальше</a>.'
end:1DIN></p>}
--- page.319 ---------------------------------

# page.320
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В углу сдвинуты вместе два обшарпанных фанерных щита — декорации, изображающие, кажется, морское побережье. Сюда несчастный умалишенный натащил всякий театральный хлам: красную кожаную перчатку, маску зверя, напоминающего крокодила; серебристый рыцарский шлем из тонкого металла; картонную рыбку с глазками-бусинками; деревянный кинжал... Если хотите, можете взять что-нибудь на память об этом невеселом приключении... А затем оставьте театр, где больше нет ничего интересного для вас, и идите <a l:href="#n_596">дальше по улице</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','перчатка'
	gosub 'crt.obj','маска_кроко'
	gosub 'crt.obj','шлем'
	gosub 'crt.obj','рыбка'
	gosub 'crt.obj','деревянный_кинжал'
end
--- page.320 ---------------------------------

# page.321
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=center>Вы тщательно осматриваете прогалину и кусты вокруг неё...</p>
<DIN1:$result=$func('luck',$lvar['luck'],609,109):1DIN>}
--- page.321 ---------------------------------

# page.322
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Подземный коридор расширяется. Делаете несколько шагов — и в руки и лицо впиваются липкие, едкие нити. Пытаетесь вырваться, но лишь крепче запутываетесь в ядовитой паутине. А сверху за вами холодно наблюдают три желтых глаза. Какая-то тварь терпеливо дожидается, когда жизнь оставит добычу и можно будет пообедать...</p>}
--- page.322 ---------------------------------

# page.323
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ягода <a l:href="#n_43">увеличит вашу</a> СИЛУ на 5. Если не голодны — можете взять её с собой (если, конечно, в рюкзаке найдется место)...</p>}
if здесь_был[$curloc]=0:
	$args['семена']=$func('prv.obj.inBag','семена')
	if $args['семена']!'': gosub 'minus.obj',$args['семена'],1 & $print[]='<font color=#884400>Вы отдали cемечко сорняка.</font>'
	gosub 'crt.obj','ягода'
end
--- page.323 ---------------------------------

# page.324
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Здесь темно, каменный потолок нависает так низко, что нельзя распрямиться. Воздух здесь чистый, пол устлан сухими водорослями. Клуша встревожено сообщает, что, судя по всему, вы попали <a l:href="#n_283">в логово страшного хищника — зеркальной осы</a>. В таких пещерах она откладывает свои яйца, а для будущих личинок запасает пищу — главным образом насекомых, парализованных ударом её ядовитого жала. Звучит это довольно неприятно, Как бы не столкнуться с этой свирепой особой!</p>}
--- page.324 ---------------------------------

# page.325
! С П325 ПЕРЕХОД НА П247.
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы произносите пароль — и ситуация резко изменяется. Разбойники не только убирают оружие в ножны, но и приглашают вас к своему костру — перекусить. Над огнём на прутиках жарятся какие-то птички. Одну из них, горячую, истекающую жиром, подносят вам. Еда прибавит 3 к вашей СИЛЕ. Если не хотите есть сейчас, заверните птичку в листья и возьмите с собой.
     <a l:href="#n_247">На прощание</a> новые знакомые дают вам совет: «Если выйдешь на дорогу — держись от неё подальше, лучше иди лесом. Здесь шляются люди похуже нашего брата разбойника. От них атамановым словом не отговоришься...»</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','птица'
	gosub 'knew.fin','лапа_дракона'
end
--- page.325 ---------------------------------

# page.326
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Покончив с негодяем, вы поднимаете его оружие, отлетевшее далеко по дну тоннеля. Ну и крепко же бластер грохнулся о камни! Корпус пересекает трещина, затвор покорежен. Хорошо, что зарядник, хоть и с трудом, но открывается...
     Какая досада! Этот светлой памяти болван даже не позаботился о полном боезапасе: в бластере только один заряд. Конечно, вы можете взять его себе. А затем <a l:href="#n_38">идите дальше</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'blast.charge',1
end
--- page.326 ---------------------------------

# page.327
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Да, эти насекомые — родня земным осам! И вы в этом сию же минуту убеждаетесь!     
     К тому времени, когда крылатая, свирепо гудящая армия соблаговолит <avs-insert>оставить вас в покое, ваша СИЛА уменьшится на 5, но вы уже не сможете подняться.</avs-insert>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-5
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'<a l:href="#n_7">оставить вас в покое</a>, ваша СИЛА уменьшится на 5.')
--- page.327 ---------------------------------

# page.328
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Подворотня оказывается сквозным проходом на соседнюю улицу. Странная улица: все дома из зелёного камня, мостовая тоже зелёная...
     Не успеваете осмотреться, как слышите вой сирены и обнаруживаете, что прямо на вас движется колонна небольших броневиков. Поспешите <a l:href="#n_88">вернуться</a> тем же проходом на прежнюю улицу и продолжите путь по ней? Или <a l:href="#n_172">укроетесь в развалинах</a> на левой стороне Зеленой улицы и переждёте, пока колонна проедет?</p>}
--- page.328 ---------------------------------

# page.329
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Посреди полянки — маленький весёлый родничок. При взгляде на него вы чувствуете, как сводит губы от жажды. Но Клуша тревожно напоминает, что на чужой планете опасно пить воду без предварительных химических анализов. <a l:href="#n_249">Послушаетесь</a> её или <a l:href="#n_617">рискнёте</a> напиться прямо из родника?</p>}
--- page.329 ---------------------------------

# page.330
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;У самой стены нашариваете небольшой ящичек. Спрыгнув на пол, направляетесь к входу в коридор, где светлее, и, сбив с ящичка крышку, начинаете изучать свою <a l:href="#n_586">добычу</a>.</p>}
--- page.330 ---------------------------------

# page.331
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Полоса примятой травы бежит на северо-восток и упирается в заросли колючих высоких кустов. Пойдёте через них <a l:href="#n_251">напролом</a> или попробуете обойти кустарник? В таком случае — с <a l:href="#n_658">запада</a> или с <a l:href="#n_391">востока</a>?</p>}
--- page.331 ---------------------------------

# page.332
$lvar['заголовок']={Мир Роботов<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Какой тоннель вы хотите осмотреть: <a l:href="#n_500">левый</a> или <a l:href="#n_284">правый</a>?</p>}
--- page.332 ---------------------------------

# page.333
$lvar['заголовок']={Мир Легенд<avs-enemy>}
$lvar['исходник']={<center><font size=+1>БЕРТОЛЬД ИЗ СОРГЕЙЛЯ

ЛОВКОСТЬ 10     СИЛА 10</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.663'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','бертольд','','<ratch>'
end
--- page.333 ---------------------------------

# page.334
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не такой уж сильный аромат идёт от разломленного листа, но шершни тут же <a l:href="#n_274">исчезают</a>. Некоторое время вас сопровождает басовитое гудение, но вскоре оно стихает позади.</p>}
--- page.334 ---------------------------------

# page.335
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Затаившись в кустах, выжидаете, пока муравей пройдет мимо, а затем <a l:href="#n_447">идёте дальше</a>.</p>}
--- page.335 ---------------------------------

# page.336
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы изо всех сил врезаетесь в дверь плечом ([pow]-1[/pow]). <avs-insert></avs-insert>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'Сухо хрустнув, <a l:href="#n_556">дверь подается</a>...')
--- page.336 ---------------------------------

# page.337
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Она уже рядом — эта распахнутая пасть размером в хорошую калитку! Меж громадных зазубренных клыков пляшет алое пламя...
     Но офицера Космического Патруля так просто не сожрешь! Ваши руки срывают предохранитель огнетушителя — и в глотку чудовища хлещет мощная белопенная струя!
     Промахнувшись, дракон шлепается наземь. С ним явно ещё никто не обращался подобным образом. Зверь мотает головой, пытаясь увернуться от струи, но вы продолжаете поливать его до тех пор, пока насмерть перепуганный ящер не <a l:href="#n_257">обращается в паническое бегство</a>.</p>}
--- page.337 ---------------------------------

# page.338
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Теперь дорогу преграждает высокий завал. При взгляде на него у вас невольно вырывается яростное восклицание — и тут же вам отвечает молодой задорный смех по ту сторону баррикады. Женщина? Здесь?! Это может быть только... Прильнув к камням, вы настороженно вслушиваетесь в легкие шаги, удаляющиеся прочь, а перед мысленным взором стоит девичье лицо, которое вы видели на экране в кабинете шефа. Интересно, это Мэри Коуфорд подстроила обвал? Или ваша встреча — лишь случайность?.. Впрочем, какой смысл гадать об этом! Надо решать, что делать дальше. <a l:href="#n_406">Вернуться на развилку</a> и пойти другой дорогой? Или попытаться <a l:href="#n_90">разобрать завал</a>?</p>}
--- page.338 ---------------------------------

# page.339
$lvar['заголовок']={Мир Стрекоз<avs_source src="[putlock:[оружие] [снаряжение]:putlock]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы сделали удачный ход: муравьи не возражают против подарков. Один из них тянет тонкую лапку к вашему бластеру.
     «Размечтался! — одергиваете вы его. — Может, тебе ещё нужен концертный рояль? Или живой бегемот?»
     Бластер, даже без зарядов, отдавать нельзя. За утерю личного табельного оружия шеф вас наизнанку вывернет и в бантик завяжет. Нож отдавать попросту глупо: вы останетесь с голыми руками, и у шестилапых разбойников может возникнуть соблазн обобрать вас дочиста. Протонную гранату (если она у вас есть) тоже оставьте себе: существует закон, воспрещающий передавать представителям иных цивилизаций вооружение, превосходящее уровень военной технологии упомянутой цивилизации.
     Может быть, подберёте для подарков какие-нибудь вещицы? <DIN1:
! нахоим любое место рюкзака
$args['d']=$func('prv.bag','','','место_в_рюкзаке')
if $args['d']!'':
	$result='Если одного предмета не хватает, можете <a href="exec:gosub ''put.bag''" class="plain">отдать рюкзак</a> (<font color=#004400><i>Если вы отдадите рюкзак, назад его не вернуть</i></font>). Но тогда в будущем некуда будет складывать находки...'
end:1DIN>
     
     <DIN2:$args['4']=$func('get.daughter.obj','page.339')
if $args['4']='true':
	$result='Теперь вы можете <a l:href="#n_135">отдать это муравьям</a>, и они оставят вас в покое. '
else
	$result='<font color=#004400><i>Чтобы отдать муравьям предмет, просто щёлкните по его названию и выберите во всплывающем меню пункт "Выбросить".</i></font>'
end
killvar '$temp_id':2DIN>

     А так же вы всегда можете <a l:href="#n_523">подчиниться их требованиям</a>, либо <a l:href="#n_91">драться</a>. Или, попытаетесь <a l:href="#n_431">сбежать</a>?</p>}
--- page.339 ---------------------------------

# page.340
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В ваших руках — непонятный предмет чёрного цвета. Он похож на яблоко, однако нож не оставляет на нём даже царапины.<!-- Если вы возьмёте находку с собой и когда-нибудь решите, что она может быть вам полезна, вычтите 176 из номера параграфа, на котором будете находиться.-->
     А теперь можете <a l:href="#n_447">продолжать путь</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','плод'
end
--- page.340 ---------------------------------

# page.341
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Баронесса рада, как маленькая девочка, даже в ладоши захлопала. И лютня, как нарочно, в комнате отыскалась! Вы быстро припоминаете песенку попроще (не исполнять же здесь Гимн Космического Патруля)!
     <font color=#339900>ПРОВЕРЬТЕ СВОЁ ОБАЯНИЕ.</font> Удастся сойти за профессионального певца или нет?</p>

<center>[social]85|193[/social]</center>}
--- page.341 ---------------------------------

# page.342
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Совсем другое дело! Вы, как днем, видите каждый камешек уходящего в скалу извилистого <a l:href="#n_254">коридора</a>...</p>}
--- page.342 ---------------------------------

# page.343
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы одержали победу, но оставаться здесь глупо: могут нагрянуть другие муравьи. С трудом вы стаскиваете с себя липкие верёвки и идёте <a l:href="#n_423">на север</a>, туда, где слышен шум волн, бьющих о скалы.</p>}
--- page.343 ---------------------------------

# page.344
$lvar['заголовок']={Мир Легенд<avs-buy>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;За переправу старик требует серебряную монету, а если денег нет — две любые вещи из вашего рюкзака. <DIN1:
! нахоим любое место рюкзака
$args['d']=$func('prv.bag','','','место_в_рюкзаке')
if $args['d']!'':
	$result='(Если одной вещи не хватает, можно <a href="exec:gosub ''put.bag''" class="plain">отдать рюкзак</a>, но тогда в дальнейшем некуда будет класть находки. <font color=#004400><i>Если вы отдадите рюкзак, назад его не вернуть</i></font>).'
end:1DIN> Лодочник предусмотрительно ведёт переговоры с безопасного расстояния, оттолкнувшись веслом от берега. Видно, путники здесь бродят не только мирные...
     Озеро не так уж и широко, можно переплыть... Заметив оценивающий взгляд, который вы бросаете на противоположный берег, старик небрежно сообщает, что ядозубки сегодня что-то разыгрались — к дождю, должно быть... Вы не знаете, кто такие ядозубки, но упоминание о них вам очень не нравится.
     Рискнёте пересечь озеро <a l:href="#n_181">вплавь</a> или обойдёте его по берегу? В таком случае — <a l:href="#n_471">справа</a> или <a l:href="#n_173">слева</a>? А может быть, расщедритесь на <DIN2:$args['o']=$func('get.daughter.obj',$curloc)
     $args['m']=$func('get.daughter.obj',$curloc,'\[np:[\s\S]*\[монета\][\s\S]*:np\]','$temp_mi')
if arrsize('$temp_id')>1 or $args['m']='true':
	$result='<a l:href="#n_291">плату перевозчику</a>?

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Теперь перевозчик согласен вас перевезти. Если вы передумали, не забудьте забрать вещи назад.</i></font>'
else
	$result='плату перевозчику?

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Чтобы отдать вещь, щёлкните по её названию и во всплывающем меню выберите пункт «Выбросить». Две сброшенные вещи сделают доступной ссылку с возможностью оплатить путь.
     Чтобы отдать серебрянную монету, щёлкните по предмету "Карман" и во всплывающем меню выберите соответствующий пункт.</i></font>'
end
killvar '$temp_id'
killvar '$temp_mi':2DIN></p>}
:[autosave]
--- page.344 ---------------------------------

# page.345
$lvar['заголовок']={Мир Стрекоз<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тошнота и головокружение чуть не валят вас с ног. Кажется, вы уже в каком-то другом месте, но уверенности в этом нет: вы почти ничего не видите, в ушах стоит гулкий звон. В мозг пробивается голос Клуши:
     «Мир стрекоз. Планета земного типа. Населена преимущественно насекомыми. Известны три разумных вида: стрекозы, муравьи и малоизученные морские жители — предположительно водяные пауки. Имеются и неразумные животные, в том числе и хищные. Флора богата и разнообразна, много хищных растений разных видов...»
     Головокружение проходит. Глубоко вдохнув свежий, пахнущий мёдом воздух, оглядываетесь по сторонам.
     Вы словно попали на картинку из детской книжки! Всё вокруг напоминает Землю, но небо здесь ярче, трава зеленее, а громадные цветы, разбросанные вокруг, сияют чистыми, сочными красками. На юге (как вы определяете по солнцу) протянулся невысокий, но очень длинный горный хребет. Клуша тут же сообщает что это — так называемые Горы Чёрных Тайн, откуда не вернулся ни один исследовательский отряд. Местность к северу от гор более-менее изучена. К сожалению, карты похищены Бронсоном, но известно, что на севере находится морское побережье, а где-то к северо-востоку — колония воинственных муравьёв...
     Куда двинетесь? <a l:href="#n_23">На юг</a>, к горам? Или <a l:href="#n_603">на север</a>, к морю?</p>}
--- page.345 ---------------------------------

# page.346
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;И опять коридор раздваивается. Два тоннеля бегут рядом, их разделяет лишь неширокая каменная перемычка. В какой тоннель вы свернёте: в <a l:href="#n_74">левый</a> или в <a l:href="#n_146">правый</a>?</p>}
--- page.346 ---------------------------------

# page.347
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Наконец опасность позади. Можно замедлить шаг и оглядеться — <a l:href="#n_107">куда же вы попали</a>?</p>}
--- page.347 ---------------------------------

# page.348
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Грязная, непроглядно мутная вода смыкается вокруг вас. В тоннеле и так было темно, но здесь, на глубине... Вы медленно плывете вперёд, пока не налетаете на толстую железную сеть, протянутую кем-то поперек тоннеля. Что там, за сетью — вам узнать не суждено, так как все попытки прорваться сквозь препятствие безрезультатны.
     Вернувшись <a l:href="#n_636">к началу тоннеля</a> и вынырнув на поверхность, обнаруживаете, что запас воздуха в маленьком баллончике иссяк. Теперь маска уже ни на что не пригодна.</p>}
--- page.348 ---------------------------------

# page.349
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;На рассвете вы открываете глаза, почувствовав рядом чьё-то присутствие.
     У изголовья стоит старый мажордом. Вид у него очень серьёзный и даже испуганный.
     «Прошу вас, сэр... Необходимо, чтобы вы переговорили с его светлостью...»
     Прихватив свои вещи и оружие, идёте за мажордомом в пиршественный зал, где слуги уже успели убрать все следы вчерашней попойки. Барон уже в зале. Он страдальчески морщится и трет громадной лапой свою похожую на биллиардный шар голову. Видимо, вчера перестарался, проявляя гостеприимство.
     «Ну? — обрушивается он на мажордома. — За каким дьяволом меня разбудили?»
     «Неприятная история, ваша светлость. Только что в замок пришла некая юная особа. Она поклялась Клинком и эфесом Небесного Меча, что гость, именующий себя сэром Майором, на самом деле — знаменитый разбойничий атаман Грэм Драконья Лапа. И не рыцарь, а самозванец...»
     «Дьявол меня разбери... Какая ещё девица, где она?!»
     «Исчезла. Неизвестная девица. Юная, пригожая собой, с карими глазами...»
     Да, ничего себе ситуация! Сейчас будет иметь значение, <DIN1:$args['часть тела']=$func('prv.bag','\[шлем\]','regexp')
! вычисляем строку части тела
args['pot']=arrpos('$id_array',$args['часть тела'])
! вычисляем строку шлема
args['pit']=arrpos('$position_array',$id_array[args['pot']])
! вычисляем строку плюмажа
args['rot']=arrpos('$position_array',$id_array[args['pit']])
! позиция, в которой лежит шлем, соответствует части тела. Ищем идентификатор части тела в таблице и проверяем голова ли это
! так же проверяем присутствует ли в таблице дочерний шлему объект - плюмаж.
if instr($object_array[args['pot']],'[:голова:]')!0 and instr($object_array[args['rot']],'[:плюмаж:]')!0:
	$result='<a l:href="#n_77">добыли</a> вы во время путешешествия себе на шлем темно-красный плюмаж или нет...'
else
	$result='добыли вы во время путешешествия себе на шлем темно-красный плюмаж или <a l:href="#n_553">нет</a>...
	
<font color=#004400><i>Если у вас есть шлем, но вы его ещё не одели, есть плюмаж, но вы не прикрепили его к шлему, самое время сделать это.</i></font>'
end:1DIN></p>}
--- page.349 ---------------------------------

# page.350
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Кольцо нагревается на руке — и какая-то сила поднимает вас в воздух. Но летите вы медленно и невысоко, и пираты успевают заметить вас...</p>
<DIN1:$result=$func('luck',$lvar['luck'],606,54):1DIN>}
--- page.350 ---------------------------------

# page.351
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Победа явно на вашей стороне, но муравей, отшвырнув оружие, подхватывает свою сетку и бросается бежать. Показалось вам или нет, что из сетки выпало и укатилось в колючие кусты что-то круглое?..
     <a l:href="#n_120">Кинетесь в погоню</a> за муравьём? Попробуете <a l:href="#n_96">поискать</a> в кустах то, что он обронил? Или просто <a l:href="#n_447">пойдёте дальше</a>?</p>}
--- page.351 ---------------------------------

# page.352
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы почти добрались до второго этажа, как вдруг лестница подламывается под вами. Со всего маху грохаетесь вниз, а сверху грудой обрушиваются обломки ступеней ([pow]-6[/pow]). <avs-insert></avs-insert>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-6
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],'Если вы в состоянии встать, выбирайтесь на улицу и <a l:href="#n_584">идите дальше</a>.')
--- page.352 ---------------------------------

# page.353
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Маг вертит пояс в руках.
     «Не помню, — говорит он задумчиво. — Ну, совсем из головы вон! Какими же силами я его наделил? Вроде бы что-то связанное с драконами и крупными змеями... Он обращает драконов в бегство? Или наоборот — дразнит и заставляет вступать в бой? Помнится, некий рыцарь заказывал мне талисман, разъяряющий драконов...»
     Этому можно поверить. При виде такой жуткой расцветочки любой дракон либо полезет в драку, либо удерёт, поджав хвост...
     «Не носите пояс на себе, — предупреждает маг. — Сила ослабнет. Положите в суму».
     Предупреждение совершенно излишнее. Даже под угрозой увольнения из Космического Патруля вы не стали бы разгуливать в этой аляповатой шёлковой тряпке. Может вообще её <a l:href="#n_101">не брать</a>? Но если есть желание, [obj]ПОЯСХ_000018|возьмите[/obj], вдруг представится случай её испытать. Тогда и узнаете, для чего пояс должен служить...</p>}
if здесь_был[$curloc]=0:
$args['динамический код предметов']={![page353.bnbn]
if $args[0]='!addobj.goto!':
	! удаляем динамический код
	args['pit']=arrpos('$id_array',$args[1])
	$args['run']=$strfind($run_array[args['pit']],'!'+'\['+'page353\.'+'bnbn\]'+'[\s\S]*'+'!'+'\[\/'+'page353\.'+'bnbn\]')
	$object_array[args['pit']]=$replace($object_array[args['pit']],'[hide.onloc]')
	$run_array[args['pit']]=$replace($run_array[args['pit']],$args['run'])
	$result='page.481'
end
![/page353.bnbn]
}
gosub 'crt.obj','пояс',"ПОЯСХ_000018",'[hide.onloc]',1,1,'',$args['динамический код предметов']
end
--- page.353 ---------------------------------

# page.354
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы поспешно покидаете это омерзительное место, возвращаетесь в оставленный тоннель и <a l:href="#n_502">идёте прежней дорогой</a>.</p>}
--- page.354 ---------------------------------

# page.355
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Водоросли и впрямь оказываются отличным топливом: горят долго, ровно, дают ровный жар. Вы спокойно <a l:href="#n_571">засыпаете</a> у огня ([pow]1[/pow]).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',1
end
--- page.355 ---------------------------------

# page.356
! ВНИМАНИЕ ЗАЛОЧЕННАЯ ЛОКАЦИЯ
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хотите пойти вперёд и [page=200]выяснить[/page], кто это палит в вас? Или не станете рисковать, отступите к развилке и [page=524]пойдёте другим тоннелем[/page]?</p>}
--- page.356 ---------------------------------

# page.357
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[powernow]Вы умеете группироваться в падении и лишь поэтому не сворачиваете себе шею. Но <a l:href="#n_37">плечо вы всё-таки-таки повредили</a>|Хотя вы и умеете групироваться при падении, резкий удар в плечо выбивает сустав, и вы теряете сознание[/powernow] ([pow]-2[/pow], a <font color=#004400><i>ЛОВКОСТЬ уменьшается на 1</i></font>). [powernow]|С этой травмой вашему истощённому организму не справиться.[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
	gosub 'lovk',-1
end
--- page.357 ---------------------------------

# page.358
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Липкая белая петля обвивает вам шею и правое предплечье. Вы пытаетесь стряхнуть петлю, но эта мерзость так и вцепилась в одежду! Поэтому на время боя вам придётся вычитать 1 из своей ЛОВКОСТИ. А [page=228]бой[/page] вас ждёт, причем сию минуту!</p>}
GAME_VALUE['page.228']=-1
--- page.358 ---------------------------------

# page.359
$lvar['заголовок']={Мир Легенд<avs_source src="[putlock:[оружие] [снаряжение]:putlock]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хозяин отнюдь не обескуражен отсутствием у вас денег. Оказывается, не так уж много встречалось ему постояльцев со звонкой монетой. Здесь в полном ходу меновая торговля. За ужин и ночлег можно заплатить любой вещицей...
     Если вас устраивает цена, <DIN2:gosub 'get.daughter.obj',$curloc
if arrsize('$temp_id')>0:
	$result='<a l:href="#n_597">платите и оставайтесь</a>'
else
	$result='платите и оставайтесь'
end
killvar '$temp_id':2DIN>. (Разумеется, вы не можете расплачиваться за постой ни оружием, ни боеприпасами. <DIN1:
! нахоим любое место рюкзака
$args['d']=$func('prv.bag','','','место_в_рюкзаке')
if $args['d']!'':
	$result='Если вещей нет, можете <a href="exec:gosub ''put.bag''" class="plain">расстаться с рюкзаком</a>, но тогда в дальнейшем некуда будет класть находки (<font color=#004400><i>Если вы отдадите рюкзак, назад его не вернуть</i></font>).'
end:1DIN> Если у вас на голове шлем, не вздумайте отдать его: вас неправильно поймут. Но если шлем лежал в рюкзаке, тогда другое дело: хозяин не заинтересуется, как попала к вам эта вещь.)
     А если у вас нет ничего лишнего, придётся <a l:href="#n_139">покинуть таверну</a> и ночевать где-нибудь поблизости в лесу.

	<DIN3:gosub 'get.daughter.obj',$curloc
if arrsize('$temp_id')=0:
	$result=$func('base.txt','help.putobj')
else
	$result=''
end
killvar '$temp_id':3DIN><DIN5:if $tvar['динамический код']="":
$tvar['динамический код']="!проверка наличия шлема на голове
if $args[0]='!put.lock!':
	$args['часть тела']=$func('prv.bag','\[шлем\]','regexp')
	! вычисляем строку части тела
	args['pot']=arrpos('$id_array',$args['часть тела'])
	! вычисляем строку шлема
	args['pit']=arrpos('$position_array',$id_array[args['pot']])
	if instr($object_array[args['pot']],'[:голова:]')!0 and $id_array[args['pit']]=$args[3]:
		$result='true'
	end
end"
end:5DIN></p>}
--- page.359 ---------------------------------

# page.360
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Переулок выводит на улицу, все дома которой сложены из зелёного камня разных оттенков. По правую руку от вас булыжную мостовую превращают в щебень аккуратные пулемётные очереди. Пулемет установлен на подоконнике одного из домов справа и время от времени полосует улицу — просто так, без всякой видимой цели.
     Повернете <a l:href="#n_592">налево</a>, туда, где спокойнее и тише? Или рискнёте свернуть <a l:href="#n_236">направо</a> и проскочить между очередями огня?</p>}
--- page.360 ---------------------------------

# page.361
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Люк открывается легко, словно не было четырех веков бездействия. Шлюзовая камера тоже гостеприимно распахивается перед вами, как только вы набираете на панели управления код «Атмосфера земного типа».
     За шлюзовой камерой вас ожидает корабельный лифт. Когда вы входите в него, загорается свет — все системы функционируют исправно. На панели лифта три кнопки, соответствующие трем уровням корабля. Какой уровень вы хотите посетить сначала: <a l:href="#n_49">первый</a>, <a l:href="#n_297">второй</a> или <a l:href="#n_581">третий</a>?</p>}
--- page.361 ---------------------------------

# page.362
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Змея уже приготовилась атаковать (причем её голова возвышается над вами чуть ли не на метр). Торопясь, завязываете вы пояс... ура, подействовало! Чёрное чудовище в панике скользит прочь и исчезает в той же трещине, откуда появилось.
     Спрятав пояс в рюкзак, <a l:href="#n_162">продолжаете путь</a>.</p>}
--- page.362 ---------------------------------

# page.363
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Похоже, здесь ничего сделать нельзя. Надо выбираться наверх, на берег, и поискать какой-нибудь способ добраться до Ворот.
     <a l:href="#n_103">Так вы и поступаете</a>.</p>}
--- page.363 ---------------------------------

# page.364
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре выходите к развилке. Куда свернёте: налево, на <a l:href="#n_51">северо-запад</a>? Или направо, на <a l:href="#n_465">северо-восток</a>?</p>}
--- page.364 ---------------------------------

# page.365
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Еда великолепна (ваша СИЛА восстанавливается до первоначального уровня). За всё время обеда в кают-компанию никто не входит.
     Наконец мелодия меняется, в стене вновь открывается щель, манипуляторы сгребают туда тарелки с нетронутыми порциями... Что же произошло с персоналом станции?
     Покинув кают-компанию, идёте дальше <a l:href="#n_604">по коридору</a>. Ваша тревога растёт...</p>}
if здесь_был[$curloc]=0:
	gosub 'power',power['start']-power['now']
end
--- page.365 ---------------------------------

# page.366
$lvar['заголовок']={Мир Легенд<checkpoint>}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
if cube=2 or cube=4 or cube=6:
	$args[9]='9'
else
	$args[9]='405'
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Головокружение наваливается с такой силой, что вы, на время оглохнув, думаете об одном: как бы не упасть. Хорошо, что обстановку уже оценила верная Клуша:
     «Мир Легенд. Планета земного типа, колонизирована переселенцами с Земли. Анализируя легенды и сказания, удалось установить, что четыре столетия назад здесь приземлились три корабля типа «Ковчег». Колонисты устали от технократической цивилизации и поклялись восстановить на новой планете... цитирую... «уют и романтику средневековья, а также истинный дух рыцарства...» Это фраза из Золотой Хартии, подписанной сэром Артуром, Первым Королем. С тех пор они и застряли в этом средневековье».
     «Так, — говорите вы, не открывая глаз, чтобы окончательно побороть головокружение. — Стало быть, здесь всюду шастают всадники в сверкающих латах и ищут великанов и людоедов, чтобы с ними сразиться?
     «Примерно так, шеф, только земные лошади здесь не прижились. Рыцари странствуют пешком, поэтому не носят и лат. Единственным отличительным признаком рыцаря является шлем».
     «Так просто? Нацепил шлем — и ты рыцарь? Тут, наверное, полным-полно самозванцев. Любой, кому надоело пасти землю...»
     «Любой, кому надоело жить! В замках ежемесячно устраиваются турниры, и участие в них по плечу лишь тому, кто с детства учился владеть оружием. К тому же по малейшему подозрению в самозванстве рыцаря подвергают жесточайшему экзамену на профессиональное мастерство. Это называется Суд Божий мечом...»
     Что ж, вы бывали в местах и похуже... А сейчас пора открыть глаза. Первый взгляд — на браслет. «Глазок» остаётся чёрным.
     Вы обводите взглядом [page=<<$args[9]>>]местность вокруг[/page]...</p>"
--- page.366 ---------------------------------

# page.367
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропка ведёт на север, оставляет по левую руку от вас стену высоких кустов и выбегает на крошечную полянку, покрытую влажным мхом. На противоположной стороне полянки тропка появляется вновь и исчезает в зарослях. Раз так — бояться нечего! Вы храбро ступаете на слой мха — и тут же оказываетесь по грудь в болоте. Видимо, те, кто ходит этой тропкой, гораздо легче вас...
     Болотце невелико, [powernow]но выбраться из него тяжеловато ([pow]-2[/pow]). Наконец вы перебираетесь через коварную поляну и, отряхнув с одежды грязь и тину, <a l:href="#n_155">идёте дальше</a>.|но вы слишком слабы, чтобы бороться с трясиной. Последние силы уходят на безуспешные попытки выбраться ([pow]-2[/pow]).[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
--- page.367 ---------------------------------

# page.368
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Перемахнув высокий подоконник, оказываетесь на странной улице: все дома сложены из зелёного камня. Даже булыжная мостовая — и та салатного цвета. Это довольно красиво, но любоваться некогда: слева рявкают одна за другой пулемётные очереди — без цели, прямо по мостовой. Но гораздо хуже то, что справа, из окон и дверей соседнего дома, выползают струи багрового дыма. Газовая атака! Только этого не хватало! Обратно в дом не вернуться — окно слишком высоко... Хорошо бы, конечно, перелететь опасную зону! Но раз вы этого не можете сделать, попытайтесь проскочить <a l:href="#n_644">под прицелом пулемёта</a> в те короткие мгновения, когда он замолкает. А может быть, невзирая на отчаянные протесты Клуши, рискнёте пробежать <a l:href="#n_168">сквозь клубящийся багровый дым</a>?</p>}
--- page.368 ---------------------------------

# page.369
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы слишком долго сражались, и на смену вашему погибшему противнику несутся другие стражники. Две стрелы ударяют в землю у ваших ног. Путь через ворота отрезан, и вы отступаете по каменным ступеням <a l:href="#n_129">на замковую стену</a> — там стрелы не достанут вас.</p>}
--- page.369 ---------------------------------

# page.370
! С П370 Я ЗАБЫЛА ДАТЬ ПЕРЕХОД НА П202.
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Грохот взрыва эхом раскатывается в коридоре и переходах. Огненный смерч, как метлой, выметает пещеру. Все кончено за несколько секунд. Вы поспешно [page=202]пересекаете пещеру[/page], пока не появились сообщники погибших пиратов. И огорчает вас лишь одно: за миг до того, как бросить гранату, вы успели заметить, что Паук вышел из пещеры через боковой коридор. Жив остался, негодяй. Жаль...</p>}
--- page.370 ---------------------------------

# page.371
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],407,175):1DIN>"
--- page.371 ---------------------------------

# page.372
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хоть вы и настороже, а всё-таки не заметили, откуда появились трое верзил в лохмотьях. Будто отделились в полумраке от стен тоннеля... В руках у одного из них обрезок свинцовой трубы, у другого — стальной прут, у третьего — что-то вроде велосипедной цепи. И со всем этим металлоломом в лапах они идут к вам, чтобы пообщаться. Впрочем, они согласны отпустить вас живым, если вы без сопротивления отдадите свои вещи вместе с рюкзаком.
     <a href="exec:gosub 'put.bag','page.84'" class="plain">Подчинитесь</a> этому наглому требованию? Будете <a l:href="#n_160">драться</a>? А может быть, <a l:href="#n_244">броситесь наутёк</a>?</p>}
--- page.372 ---------------------------------

# page.373
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;С трудом поднимаетесь вы с земли. Ох, и силен же этот тип! И зачем вы с ним связались?
     И тут откуда-то возникает чистенькая старушка в белом переднике и кружевном накрахмаленном чепце.
     «Моя госпожа, баронесса Горфрида, желает видеть путника, который...» — начинает она... и, не закончив фразы, ахает. Да и как не ахнуть при виде того, что сделал из вас повар! Пожалуй, теперь даже зеркалу будет больно отражать вашу физиономию.
     «Но это же невозможно! — гневно восклицает старушка. — В таком виде ты не можешь предстать перед её светлостью! Я скажу госпоже, что усталый путник <a l:href="#n_565">уже уснул</a>...»</p>}
--- page.373 ---------------------------------

# page.374
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Икра не отличается приятным вкусом, но вполне съедобна ([pow]1[/pow]). А теперь <a l:href="#n_26">идите дальше</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',1
end
--- page.374 ---------------------------------

# page.375
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Через некоторое время обнаруживаете тропинку. Конечно, это не та тропа, по которой вы шли раньше, но она бежит на север. Идти по ней удобнее, чем по цепляющейся за ноги высокой траве.
     Не успеваете вы отойти далеко, как замечаете в траве странный блеск. Хотите <a l:href="#n_260">взглянуть</a>, что там? Или пойдёте <a l:href="#n_72">дальше</a> не задерживаясь?</p>}
--- page.375 ---------------------------------

# page.376
! неверный переход!!!! Не на 72 страницу а скорее всего на 76!!!!
! СПРОСИТЬ У ГОЛОТВИНОЙ
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Внизу холодно и сыро. На мраморных плитах, которыми отделаны стены, расплылись мерзкие пятна плесени. Декоративные светильники в виде головы единорога давно бездействуют, многие из них разбиты. Полумрак мешает вам рассмотреть станцию во всех подробностях, но тем страшнее зияют перед вами две чёрные пещеры, которые соединяет, тускло поблескивая, полотно монорельсовой дороги. Хотите <a l:href="#n_572">исследовать тоннель</a> или <a l:href="#n_76">не станете этого делать</a>?</p>}
--- page.376 ---------------------------------

# page.377
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Чувствуя себя полным идиотом, быстро завязываете шёлковый пояс на своей талии. Результат оказывается потрясающим. Дракон, снижавшийся прямо на вас, в последний момент сворачивает в сторону и врезается головой в бревно. Сев на жилистые задние лапы, он передней лапой по-щенячьи трет ушибленный нос, а затем, хлопая перепончатыми крыльями, тяжело взмывает в воздух. При этом у него такой обиженный вид, что вас невольно разбирает смех. Что ж, <a l:href="#n_257">да здравствует магия</a>!</p>}
--- page.377 ---------------------------------

# page.378
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],226,574):1DIN>"
--- page.378 ---------------------------------

# page.379
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стоит вам сделать несколько шагов, как жуки замечают вас и, прекратив поединок, яростно бросаются на вас. <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>1:
			$result='В бластере есть два заряда — <a href="exec:charge_array[<<arrpos("$id_array",$args["pos.bl"])>>]-=2 & time[''goto'']=1 & goto ''page.515''" class="plain">стреляйте</a>, не раздумывая.'
		elseif $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]=1:
			$result='<font color=#004400><i>В вашем бластере недостаточно зарядов, а это значит - вы обречены: даже если застрелите одного из противников, другой уничтожит вас.</i></font>'
			$lvar['заголовок']+='<avs-death>'
		else
			$result='<font color=#004400><i>Ваш бластер разряжен, а это значит - вы обречены.</i></font>'
			$lvar['заголовок']+='<avs-death>'
		end:1DIN> Нож не поможет в схватке с бронированным чудовищем.</p>}
--- page.379 ---------------------------------

# page.380
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Впереди слабо брезжит свет. Вы идёте в том направлении, попутно замечая на стенах чёрные пятна коридоров: в ваш тоннель вливаются боковые линии. Очевидно, впереди большой <a l:href="#n_300">пересадочный узел</a>.</p>}
--- page.380 ---------------------------------

# page.381
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорога здесь не такая широкая. Видно, что ходят по ней редко. Вы бредёте долго, солнце уже переваливает за полдень, а по обочинам дороги все тот же лес, похожий на земной. Но вот дорога взбегает на пригорок, с его вершины вы видите впереди <a l:href="#n_145">деревушку</a>.</p>}
--- page.381 ---------------------------------

# page.382
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<DIN1:if $tvar['шлем']="":
		$args['шлем']=$func('prv.bag','\[плащ\]','regexp')
		if $args['шлем']!'' and instr($object_array[arrpos('$id_array',$args['шлем'])],'[:плечи:]')!0:
			$tvar['шлем']='К счастью на вас <a l:href="#n_238">надет</a> серый плащ с капюшоном.'
		else
			$tvar['шлем']='Эх, если бы у вас был плащ с капюшоном, можно было бы попробовать укрыться меж камней, но плаща <a l:href="#n_414">нет</a>.'
		end
		if $args['шлем']!'' and instr($object_array[arrpos('$id_array',$args['шлем'])],'[:плечи:]')=0:
			$tvar['шлем']+=' (<font color=#004400><i>Если плащ лежит в рюкзаке, то, конечно, доставать и надевать его некогда.</i></font>)'
		end
	end
	$result=$tvar['шлем']:1DIN></p>}
--- page.382 ---------------------------------

# page.383
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Потрясающее зрелище! Едва семя касается земли, как из него струей ударяет вверх росток... вот он всё выше, всё толще... дробится на дюжину ветвей, которые вцепляются в хищный куст, оплетают его, врезаются в кору и, кажется, даже вытягивают из земли с корнями. Через несколько минут <a l:href="#n_411">всё кончено</a>, куст-хищник буквально разорван в клочья, но и сорняк-победитель засыхает на глазах. На верхушке его начинает было формироваться шишечка-семя, но вражеская ветвь последним усилием обламывает верхушку. Нового «семечка-убийцы» взамен утраченного у вас не будет.</p>}
--- page.383 ---------------------------------

# page.384
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По правую руку, невольно притягивая взгляд, возвышается массивное здание в форме полукруга. Громадные двери от взрывов почти сорваны, косо болтаются на петлях. <a l:href="#n_48">Заглянете внутрь</a> или <a l:href="#n_596">пройдёте мимо</a>?</p>}
--- page.384 ---------------------------------

# page.385
$lvar['заголовок']={Мир Легенд<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорога упирается в берег озера. Слева и справа стеной стоят заросли высоких — вам по плечо — кустов, меж которыми кое-где поднимаются могучие, с плотной кроной деревья. А прямо перед вами — прогнивший, расшатанный дощатый причал, о который трется бортом небольшая лодочка. В лодке сидит старик-перевозчик.
     <a l:href="#n_344">Попросите перевезти</a> вас? Или решите обойти озеро? В таком случае — <a l:href="#n_530">слева</a> или <a l:href="#n_471">справа</a>?</p>}
--- page.385 ---------------------------------

# page.386
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Быстро идёте дальше — и внезапно замечаете, что коридор становится шире... Нет, это исчезла перемычка, и <a l:href="#n_578">два тоннеля снова слились в один</a>...</p>}
--- page.386 ---------------------------------

# page.387
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы бодро шагаете по дорожке — и вдруг останавливаетесь в недоумении. Навстречу медленно движется... вам сначала показалось — живое существо. Нет, это куст! Он, как на лапах, стоит на длинных корнях, вылезших из земли. Вытащит один из корней, забросит его вперёд, вопьется в землю — и подвинется «на шаг». Выглядит куст очень непривычно: он будто составлен из стеклянных, мутно-прозрачных трубок разной толщины.
     Клуша сообщает, что такое растение ещё не попадалось исследователям.
     А куст уже рядом. Вы заинтересованно касаетесь одной из ветвей — и тут же ветка вцепляется в вас. Она сплошь усеяна мелкими крючочками, которые больно впиваются в кожу. И тут же ветка, которая вас держит, начинает краснеть. Это поднимается по тончайшим трубочкам кровь, которую куст вытягивает из вашего тела...
     Вы начинаете отчаянно отбиваться, но куст-вампир только выглядит хрупким!
   
     <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='Ваш бластер заряжен - <a href="exec:gosub ''blast.charge'',-1 & time[''goto'']=1 & goto ''page.95''" class="plain">можете пустить его в дело</a>.&nbsp;'
			$lvar['t']='blast'
		else
			$result=''
		end:1DIN><DIN2:$args['pos.bl']=$func('prv.obj.inBag','зажигалка')
		if $args['pos.bl']!"":
			if $lvar['t']='blast': $result='Так же у' else $result='У'
			$result+=' вас есть <a l:href="#n_167">зажигалка</a>, попробуйте подпалить этого растительного вурдалака.&nbsp;'
			$lvar['t']='blast'
		else
			$result=''
		end:2DIN><DIN3:$args['pos.bl']=$func('prv.obj.inBag','семена')
		if $args['pos.bl']!"":
			if $lvar['t']='blast': $result='А может быть,' else $result='Не'
			$result+=' хотите опробовать одно из семян-убийц?&nbsp;'
			$lvar['t']='blast'
		else
			$result=''
		end:3DIN><DIN4:if $lvar['t']='blast': $result='Иначе' else $result='У вас нет ничего, что помогло бы справиться с этим монстром, а значит':4DIN> вам предстоит тяжёлый <a l:href="#n_279">бой</a>.</p>}
--- page.387 ---------------------------------

# page.388
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тоннель ведёт куда-то вниз. Вскоре под ногами начинает хлюпать вода. Она поднимается все выше: по колено, по пояс... и вот вы видите, что дальше идти нельзя. Нельзя и плыть: впереди уровень воды доходит до потолка. Если бы у вас была водолазная маска... или если бы вы знали другой способ дышать под водой... Иначе придётся <a l:href="#n_636">повернуть обратно</a>.</p>}
--- page.388 ---------------------------------

# page.389
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Проиграл — надо платить, — весело признает ваш партнер. — Парень, о котором ты расспрашивал нашего хозяина, проходил вчера по этой дороге на север. Вряд ли ошибаюсь, он приметный такой: уши, как у болотного хлипуна, и сума за спиной вроде твоей, только лиловая... А что до места, которое ты ищешь, так это тебе надо в Потерянную Часовню. На севере, в лесу, есть длинная прогалина. Красивая такая, вся синими цветами поросла. На её восточном конце — очень большое дерево, его называют Великим Древом. От его корней ведёт тропинка. Заросла совсем, но если хорошенько поискать — найдёшь. Она тебя выведет, куда нужно».
     (Чтобы разыскать тропинку, ведущую от Великого Древа, придётся прибавить 36 к номеру параграфа, на котором будете находиться.)
     Вы сыграли только <DIN1:
if GAME_VALUE['game.cube.party']<2:
	$result='<a l:href="#n_660">одну</a> партию или испытали своё везение дважды'
else
	$result='одну партию или испытали своё везение <a l:href="#n_439">дважды</a>'
end:1DIN>?</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','великое_древо','','<knew>',0,1,'KNOWLEDGE'
end
--- page.389 ---------------------------------

# page.390
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ваша добыча оказывается очень полезной. Легче птицы <a l:href="#n_202">перелетаете вы пещеру</a> над головами пиратов, которые ничего и не замечают... Но, приземлившись, обнаруживаете, что зелёный огонек на пряжке погас. Всё, энергия иссякла. Больше антигравитатором пользоваться нельзя.</p>}
--- page.390 ---------------------------------

# page.391
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Трава под ногами сменяется сыпучим песком. Вы шаг за шагом продвигаетесь вперёд, с трудом вытаскивая увязающие по щиколотку ноги.
     Внезапно песок скользит вниз, вы съезжаете по жёлтому склону в неглубокую воронку, которая разверзлась у вас под ногами.
     Песок на дне воронки шевелится, и на свет выползает громадный — <font color=#004400><i>с вас</i></font> размером — жук определенно хищного вида. Ясно, что он поджидал добычу.
     Будете <a l:href="#n_79">драться</a> с ним или попытаетесь <a l:href="#n_235">бежать</a>?</p>}
--- page.391 ---------------------------------

# page.392
$lvar['заголовок']={Мир Роботов<checkpoint><avs_source src="[useof:[кольцо] [антигравитатор] [чл] [протонная_граната]:useof]">}
$lvar['исходник']={<qhtml><p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Путь преграждает немыслимая конструкция — помесь танка с ветряной мельницей. Бронированная махина медленно движется в вашу сторону, бешено вращая перед собой крестовину из острых лезвий. Время от времени она разражается короткими автоматными очередями.
     Если есть «Чёрный луч», нетрудно будет управиться с этой нелепой конструкцией. Если есть граната — можно расчистить себе путь... Нет? Тогда можно пустить в ход <DIN1:$args['pos.bl']=$func('prv.obj.inBag','бластер')
		! проверяем заряды
		if $args['pos.bl']!"" and charge_array[arrpos('$id_array',$args['pos.bl'])]>0:
			$result='(если остался заряд)<a href="exec:gosub ''blast.charge'',-1 & time[''goto'']=1 & goto ''page.608''" class="plain">бластер</a>.'
		else
			$result='бластер (<font color=#004400><i>О нет! Зарядов не осталось</i></font>).'
		end:1DIN> Иначе придётся либо укрыться <a l:href="#n_8">в парадном подъезде</a> большого особняка с колоннами у входа, либо как можно скорее свернуть <a l:href="#n_256">в переулок</a>. Не рубиться же с этим броневиком! Да и перелететь через него вы не сможете, не так ли?</p></qhtml>}
--- page.392 ---------------------------------

# page.393
$lvar['заголовок']={Где-то}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Головокружение обрушивается на вас — ещё страшнее, ещё мучительнее, чем при прежних переходах. Перед глазами вспыхивает ослепительный свет, вы теряете сознание.
     Очнувшись, не можете понять, где вы находитесь. Мысленно снова и снова вызываете Клушу, но ответа нет. Телепатическая связь оборвалась. Мозг обжигает ужасная мысль: случилось то, о чем предупреждал инженер! Перегрузка основного контура!
     Да, если неприятность может случиться, она обязательно... но куда же забросил вас проклятый закон Мерфи?
     По привычке бросаете взгляд на браслет — и вздрагиваете. «Глазок» пылает, как рубиновая звезда. Похищенный аннигилятор где-то <a l:href="#n_112">неподалёку</a>!</p>}
--- page.393 ---------------------------------

# page.394
$lvar['заголовок']={Мир Легенд<avs-enemy>}
$lvar['исходник']={<p align=justify>     Стоит вам дотронуться до ствола, как зверь спрыгивает с дерева. Из пасти выползают кривые клыки, и чудовище бросается в атаку.</p><center><font size=+1>ОБЕЗЬЯНОПАУК

ЛОВКОСТЬ 10     СИЛА 10</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.93'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','обезьянопаук',"",'<ratch>'
end
--- page.394 ---------------------------------

# page.395
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы протягиваете плод морскому жителю, но он, чуть ли не вдвое раздувшись, оглушает вас потоком гневных воплей. Суть их сводится к тому, что вы пытались подло обмануть его: вместо Плода Жизни всучить <a l:href="#n_483">Плод Смерти</a>.</p>}
--- page.395 ---------------------------------

# page.396
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],476,136):1DIN>"
--- page.396 ---------------------------------

# page.397
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Чёрт его знает... — колеблется барон. — Не похож этот парень на разбойника... Ладно, отведите его пока <a l:href="#n_25">в темницу</a>, потом я с ним разберусь!»</p>}
--- page.397 ---------------------------------

# page.398
$lvar['заголовок']={Мир Камней<avs-dark><checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Здесь гораздо темнее, светящихся жуков на стенах почти нет. <DIN1:$result=''
$args['очки']=$func('prv.bag','\[:ночное_видение:\]','regexp')
if $args['очки']!'':
	if instr($object_array[arrpos('$id_array',$args['очки'])],'[:лицо:]')=0:
		$result+='В рюкзаке лежат очки «Ночное зрение», можете надеть их. '
	else
		time['goto']=1
		goto 'page.482'
	end
elseif $args['pos.bl']='' or $args['pos.sv']='':
	$result+='Сейчас вам могли бы пригодиться очки «Ночное зрение». '
end
$args['pos.bl']=$func('prv.obj.inBag','зажигалка')
$args['pos.sv']=$func('prv.obj.inBag','свеча')
if $args['pos.bl']!'' and $args['pos.sv']!'':
	$result+='У вас есть зажигалка и свеча: можете [page=218]осветить себе дорогу[/page]. '
elseif $args['pos.bl']!'':
	$result+='У вас есть зажигалка, но от одной зажигалки света будет слишком мало.'
elseif $args['pos.sv']!'':
	$result+='У вас есть свеча, но зажечь её нечем. '
end
if $args['pos.bl']='' and $args['pos.sv']='' and $args['очки']='':
	$result='У вас <a l:href="#n_518">нет</a> ничего, что могло бы осветить вам путь.'
elseif ($args['pos.bl']='' or $args['pos.sv']='') and $args['очки']='':
	$result+='К сожалению того, что у вас есть, <a l:href="#n_518">недостаточно</a>, чтоб освещать путь. А значит придётся'
else
	$result+='Но может быть вы и <a l:href="#n_518">не хотите</a> пользоваться ими?'
end:1DIN></p>}
--- page.398 ---------------------------------

# page.399
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Приблизившись к муравью, вы заговариваете с ним. Но абориген, явно перепуганный, подхватывает поудобнее свою сетку и бросается бежать. Попробуете <a l:href="#n_583">догнать его</a> и объясниться или, махнув рукой, <a l:href="#n_447">пойдёте дальше</a>?</p>}
--- page.399 ---------------------------------

# page.400
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы выходите из подъезда. По правую руку от вас улица загромождена глыбами битого камня. Остаётся одно — повернуть <a l:href="#n_480">налево</a>.</p>}
--- page.400 ---------------------------------

# page.401
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре находите потерянную вечером тропку. Она бежит теперь, как вы определяете по солнцу, на север.
     Но вскоре вы замечаете, что от неё круто ответвляется другая тропка, бегущая на северо-восток. <a l:href="#n_561">Свернёте</a> на неё или <a l:href="#n_293">продолжите прежний путь</a>?</p>}
--- page.401 ---------------------------------

# page.402
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Какая это великолепная маскировка: светло-серый длинный плащ на фоне серебристых стен, покрытых светящимися жуками! Вы проскальзываете по узкому карнизу, опасаясь лишь, чтобы какой-нибудь камешек не выскользнул из-под ног. Но всё обходится благополучно, и вот вы уже <a l:href="#n_202">на другом конце подземного зала</a>. Никто из пиратов даже <font color=#004400><i>ухом</i></font> не повёл в вашу сторону.</p>}
--- page.402 ---------------------------------

# page.403
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Да, тут есть чем гордиться, это даже Клуша признает. В одиночку управиться с троими головорезами!.. Вы уже собираетесь <a l:href="#n_247">уходить</a>, но замечаете у одного из лежащих на земле врагов моток верёвки на плече. Похоже, этой верёвкой вас собирались связать... Если в рюкзаке есть место, можете прихватить трофей с собой.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','вервь','','[путы]'
end
--- page.403 ---------------------------------

# page.405
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>[knew]мв|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы на обочине|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ну почему господа учёные не снабдили вас модификатором вероятностей! Насколько всё было бы проще: нажал на кнопку - и ты уже у Ворот. Клуша тут же замечает, что опрометчиво было бы использовать модификатор при Переходе, и что тем не менее он у вас есть. Вы сразу подносите к глазам браслет. А ведь верно! Если присмотреться, можно увидеть слабосветящиеся разноцветные цифры.
     «Это новая модель, - гордо объявляет Клуша, - Он реагирует на мысленный приказ, концентрирует до шести благоприятных исходов...»
     Клуша говорит ещё много и долго, выдавая научные выкладки пачками, а вы тем временем внимательно осматриваете место, в которое вас зашвырнул Переход.
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Это обочина[/knew] лесной дороги. До чего же всё вокруг напоминает вашу родную планету! Большие, похожие на дубы деревья свесили ветви чуть ли не до земли, а в кронах посвистывает и цокает какая-то весёлая мелкая живность. Вокруг безлюдно, что вас вполне устраивает: ведь вы ещё не решили, какую роль будете играть в этом странном мире.
     Если у вас в рюкзаке лежит шлем, лучше надеть его сейчас (конечно, если вы хотите выдать себя за рыцаря).
     А теперь, пожалуй, пора поглядеть, <a href="exec:gosub 'mv',569" class="plain">куда лучше направиться</a>.</p>}
:о модификаторе
--- page.405 ---------------------------------

# page.406
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В неверном серебристом свете замечаете в полу, возле самой стены, углубление, выстланное чем-то вроде влажных перьев. В углублении уютно лежат три крупных тёмных яйца. Интересно, кто их отложил? И съедобны ли они?
     <a l:href="#n_118">Рискнёте попробовать</a> или <a l:href="#n_502">пройдёте мимо</a>?</p>}
--- page.406 ---------------------------------

# page.407
$lvar['заголовок']={Мир Стрекоз}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хорошо, что вы успели сорвать какой-то плод. Теперь самое время взглянуть, что зажато у вас в ладони.

     <font color=#004400><i>Кубик брошен, выпало <<cube>>, а значит вам досталось <DIN1:if cube=1 or cube=4:
	$result='[page=127]это[/page]'
elseif cube=2 or cube=5:
	$result='[page=227]это[/page]'
else
	$result='[page=495]это[/page]'
end:1DIN>.</i></font></p>"
--- page.407 ---------------------------------

# page.408
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;От перстня струится тепло — и, взмыв над мостовой, вы видите улицу сверху. Поблизости идут бои — сверкают вспышки бластеров, грохочут взрывы, трещат выстрелы, над одним из домов на соседней улице взметнулся столб пламени...
     Внезапно кольцо холодеет, а полет ваш становится неровным, неуверенным. Нырнёте в открытое <a l:href="#n_132">окно второго этажа</a>? Или постараетесь приземлиться <a l:href="#n_24">на мостовой</a> — подальше от зоны действия пулемёта?</p>}
--- page.408 ---------------------------------

# page.409
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тут к костру подходит аккуратно одетая старушка в кружевном чепце и белом переднике. Она строго заявляет:
     «Моя госпожа, баронесса Горфрида, желает видеть путника, попросившего о ночлеге в замке!»
     <a l:href="#n_489">Пойдёте</a> за старушкой? Или попросите её сказать госпоже баронессе, что путник, уставший с дороги, <a l:href="#n_565">уже уснул</a>?</p>}
--- page.409 ---------------------------------

# page.410
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не раздумывая, привычным движением тренированного воина вы бросаетесь в сторону и, перекатившись по земле, <a l:href="#n_228">выхватываете оружие</a>.</p>}
--- page.410 ---------------------------------

# page.411
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Останки хищного куста агонизируют на земле, а вы, убрав оружие, пытаетесь привести в чувство стрекозу... а, собственно говоря, как их приводят в чувство? Как оказывают первую помощь существу примерно в метр длиной, с гибким членистым туловищем, овальной грудью, громадными прозрачными крыльями, и круглой изящной головкой, украшенной выпуклыми фасеточными глазами?
     К счастью, ваша подопечная сама приходит в сознание, расправляет тонкие крылья и перепархивает к вам на плечо. Вы чувствуете себя не слишком уютно, когда цепкие лапки впиваются вам в кожу, а у самого лица начинают покачиваться жуткого вида жвала, похожие на кривые ножи.
     Но неприятное ощущение проходит, когда стрекоза начинает шуршать крыльями и поскрипывать жвалами. Звуки эти складываются в странную мелодию. И тут же начинает работать автопереводчик — оказывается, вас благодарят за спасение!
     Стрекоза отнюдь не удивлена вашим видом. Ей уже приходилось встречаться с людьми, и она сохранила о них теплые воспоминания. (Вы догадываетесь, что речь идёт об исследователях из Лаборатории Мерфи.)
     Спасенная предлагает вам свернуть с дороги и погостить немного у неё. <a l:href="#n_535">Согласитесь</a> или <a l:href="#n_187">откажетесь</a> (памятуя о том, что на Земле стрекозы — ненасытные хищницы)?</p>}
--- page.411 ---------------------------------

# page.412
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В вагоне, прямо на металлическом полу, горит высокая свеча. В углу лежит тряпье, служившее кому-то постелью. Тут же валяется груда пустых консервных банок... впрочем, нет, одна из них полная. Можете её взять, в любую минуту мясные консервы прибавят 5 к вашей СИЛЕ. Если хотите, можете погасить свечу и захватить её с собой.
     А теперь куда? <a l:href="#n_612">В погоню</a> за неизвестным стрелком? Или удовлетворитесь тем, что обратили его в бегство, вернётесь к развилке и свернёте <a l:href="#n_524">в другой тоннель</a>?</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','консервы'
	gosub 'crt.obj','свеча'
end
--- page.412 ---------------------------------

# page.413
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Незнакомец встает из-за стола.
     «Нет, третью партию подряд не играю. Примета плохая...»
     Несколько секунд он колеблется, глядя на вас.
     «Конечно, свинство, что я не даю тебе, парень, отыграться. Ладно, возьми хоть это... Пусть никто не говорит, что Драконья Лапа — скупердяй!»
     Он отстегивает пряжку у горла — и серый плащ падает перед вами на стол. А незнакомец, оставшись в бархатном коричневом камзоле, весело машет рукой вам и хозяину и исчезает за порогом, в ночной черноте.
     Странный человек... Ладно, а с плащом что делать? Мягкий, тёплый, к тому же, как вы сразу заметили, не сковывает движений... Если захотите взять его себе, можете не класть в мешок, а просто надеть — ЛОВКОСТЬ ваша не изменится.
     А теперь, пожалуй, и <a l:href="#n_240">спать пора</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','плащ'
end
--- page.413 ---------------------------------

# page.414
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],526,266):1DIN>"
--- page.414 ---------------------------------

# page.415
$lvar['заголовок']={Мир Стрекоз<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорожка, выложенная белыми камешками, бежит на северо-запад. Справа замечаете меж кустов полосу примятой травы, как будто здесь тоже кто-то часто ходит... <a l:href="#n_331">Свернёте по этой полосе на северо-восток</a> или <a l:href="#n_387">продолжите путь по дорожке</a>?</p>}
--- page.415 ---------------------------------

# page.416
$lvar['заголовок']={Исследовательская станция<avs_source src="[useof:[во]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;А как вы собираетесь открыть двери? Если есть вибромагнитная отмычка, воспользуйтесь ею. Если ваш бластер все ещё заряжен, аккуратно [blaster]1|[usebl]1|204|вырежьте замок лучом[/usebl]|вырежьте замок лучом[/blaster]. Или вы <a l:href="#n_620">не можете</a> сделать ни того, ни другого?</p>}
--- page.416 ---------------------------------

# page.417
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В таверне неожиданно чисто и уютно. Пол усыпан мелкими ветвями, от которых исходит пряный аромат. Два длинных массивных стола выскоблены до белизны. За столами почти никого нет, только в углу сидит, положив голову на руки, человек в длинном сером плаще с капюшоном.
     Вас приветствует хозяин — остролицый человек, похожий на мышонка.
     <DIN1:if $tvar['плюмаж']='':
	$args['часть тела']=$func('prv.bag','\[шлем\]','regexp')
	! вычисляем строку части тела
	args['pot']=arrpos('$id_array',$args['часть тела'])
	! вычисляем строку шлема
	args['pit']=arrpos('$position_array',$id_array[args['pot']])
	! вычисляем строку плюмажа
	args['rot']=arrpos('$position_array',$id_array[args['pit']])
	! позиция, в которой лежит шлем, соответствует части тела. Ищем идентификатор части тела в таблице и проверяем голова ли это
	! так же проверяем присутствует ли в таблице дочерний шлему объект - плюмаж.
	if instr($object_array[args['pot']],'[:голова:]')!0 and instr($object_array[args['rot']],'[:плюмаж:]')!0:
		$tvar['плюмаж']='Ваш головной убор украшен тёмно-красным плюмажем, а значит вас ожидает <a l:href="#n_505">следующее</a>...'
	else
		$tvar['плюмаж']='Возможно, если бы у вас на головном уборе был тёмно-красный плюмаж, к вам бы отнеслись по-другому, а <a l:href="#n_359">так</a>... '
	end
end
$result=$tvar['плюмаж']:1DIN></p>}
--- page.417 ---------------------------------

# page.418
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вода чуточку горчит, но вполне годится для питья ([pow]3[/pow]). <DIN1:$args['pos.bl']=$func('prv.obj.inBag','фляга')
if $args['pos.bl']!'' and $tvar['water']!'true':
	$result='Если хотите, можете <a href="exec:$tvar[''water'']=''true'' & gosub ''flaga'',''<<$args["pos.bl"]>>'',''вода''" class="plain">наполнить</a> флягу. А затем'
elseif $args['pos.bl']='':
	$result='Если бы у вас была фляга, можно было бы наполнить её водой. Но: чего нет, того нет, -'
else
	$result='Вы наполнили флягу. Теперь'
end
$result='<font color=#004400><i>'+$result+'</i></font>':1DIN> <a l:href="#n_386">продолжайте путь</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',3
end
--- page.418 ---------------------------------

# page.419
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропка теряется среди камней и песка: вы вышли на побережье. Здесь довольно сильный ветер, холодно... а пора уже устраиваться на ночлег: вокруг сгущаются сумерки. К счастью, здесь много крупных валунов, вам удаётся соорудить из них что-то вроде стенки, защищающей от порывов ветра. Если у вас есть зажигалка, никто не мешает вам <DIN1:$args['зажигалка']=$func('prv.obj.inBag','зажигалка')
if $args['зажигалка']!'':
	$result='<a l:href="#n_355">разжечь костёр</a>'
else
	$result='разжечь костёр'
end:1DIN> (на песке много сухих водорослей, которые годятся на топливо). Но, может быть, вы <a l:href="#n_455">не можете или не хотите</a> разводить огонь?</p>}
--- page.419 ---------------------------------

# page.420
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тоннель ведёт куда-то вниз. Под ногами начинает противно хлюпать грязь. Почвенные воды подмыли, расшатали полотно монорельсовой дороги, поэтому идти трудно. Становится темнее, но всё же можно разглядеть дорогу, хотя на всякий случай вы придерживаетесь рукой за стену.
     Внезапно рука наткнулась на дверную ручку. В стене — дверь. Хотите <a l:href="#n_28">посмотреть</a>, что за ней находится? Или <a l:href="#n_380">пойдёте дальше</a>?</p>}
--- page.420 ---------------------------------

# page.421
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ягоды оказываются такими нежными и сочными, что лопаются в пальцах, и их приходится снимать губами прямо с ветки. Зато их терпкий пряный сок прибавит 10 к вашей СИЛЕ. Жаль, что нельзя захватить хоть немного ягод с собой... Впрочем, если есть фляга, можете <DIN1:$args['pos.bl']=$func('prv.obj.inBag','фляга')
if $args['pos.bl']!'' and $tvar['water']!'true':
	$result='<a href="exec:$tvar[''water'']=''true'' & gosub ''flaga'',''<<$args["pos.bl"]>>'',''сок''" class="plain">наполнить</a>'
else
	$result='наполнить'
end:1DIN> её вместо воды соком. Тогда каждый глоток будет увеличивать СИЛУ на 4...
     А теперь <a l:href="#n_241">продолжайте путь</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',10
end
--- page.421 ---------------------------------

# page.422
$lvar['заголовок']={Мир Камней<avs_source src="[useof:[пояс]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Идти приходится долго. Унылый коридор, в котором мрачным эхом отдаются шаги, нагоняет тоскливые мысли. Одиночество и сумрак почти физически давят на вас. Ну и профессию вы себе выбрали! Лучше бы остаться на Земле и заняться чем-нибудь таким, чтобы вокруг было побольше людей, света, смеха... Билеты в цирк продавать, вот что! Музыка! Радостно визжащие детишки со стаканчиками мороженого! Клоуны, акробаты! Тигры, слоны, удавы... удавы... удавы...
     Из трещины в стене гибкой струей выливается угольно-чёрное змеиное тело толщиной с бревно. Маленькая плоская головка двумя огненно-красными глазами словно притягивает вас к себе. Вы как-то сразу понимаете: <a l:href="#n_10">боя не избежать</a>.
     Но, может быть, у вас есть какая-нибудь вещь, действующая на крупных змей — крылатых и бескрылых?</p>}
--- page.422 ---------------------------------

# page.423
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Когда вы выходите к морю, солнце опускается за скалы по левую руку от вас. Глупо и неосторожно сидеть в потемках, об этом вам и Клуша напоминает. Можно устроиться и на ночлег среди скал, но, увы, здесь не развести костёр (даже если бы вы могли добыть огонь)... <DIN1:$args['плащ']=$func('prv.obj.inBag','плащ')
if $args['плащ']!"":
	$result='К счастью у вас <a l:href="#n_59">есть</a> плащ с капюшоном.'
else
	$result='Был бы у вас плащ с капюшоном, вы могли бы укутаться в него, но плаща <a l:href="#n_615">нет</a>.'
end:1DIN></p>}
--- page.423 ---------------------------------

# page.424
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вид заброшенного дома повергает в уныние. Перевернутая мебель, обсыпанная обвалившейся штукатуркой, выбитые окна в противоположной от входа стене... А ведь когда-то здесь жили люди!
     Вряд ли в этом холодном мрачном холле вы найдете что-нибудь интересное для себя. Пройдёте <a l:href="#n_196">в соседнюю комнату</a> или покинете дом? В таком случае — как? <a l:href="#n_552">Через дверь</a> или (чтобы попасть на другую улицу) <a l:href="#n_368">через окно</a>?</p>}
--- page.424 ---------------------------------

# page.425
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Подняв голову, вы со злорадным удовольствием говорите:
     «Ты, птичка-на-веточке! Имей в виду: у дракона лапа тяжёлая. И длинная. Надо будет — и на дереве тебя достанет!»
     В кроне слышится возня, а затем голос сверху смущённо отвечает:
     «Так бы сразу и сказал... <a l:href="#n_551">Проходи!</a>»</p>}
if здесь_был[$curloc]=0:
	gosub 'knew.fin','лапа_дракона'
end
--- page.425 ---------------------------------

# page.426
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Даже в полутьме видны змеистые трещины, избороздившие стены. <a l:href="#n_194">Пойдёте дальше</a> или на всякий случай повернёте обратно к развилке и <a l:href="#n_346">выберете другой путь</a>?</p>}
--- page.426 ---------------------------------

# page.427
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропка куда-то исчезла. Вы пытаетесь придерживаться прежнего направления, идёте напролом сквозь кусты — и оказываетесь на круглой <a l:href="#n_11">полянке</a>.</p>}
--- page.427 ---------------------------------

# page.428
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Как же попасть к Воротам? Перепрыгнуть через эту отвратительную черноту? Нет, не хочется: расстояние очень серьёзное. Разумнее вернуться и поискать верёвку. Вы так и собираетесь поступить, но тут подземная тишина взрывается выстрелами. В тоннелях кипит сражение, оно катится сюда... раздумывать некогда. Разбежавшись, вы прыгаете...</p>
<DIN1:$result=$func('luck',$lvar['luck'],264,512):1DIN>}
--- page.428 ---------------------------------

# page.429
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Добро пожаловать, сэр Майор! — громогласно восклицает хозяин замка. — Окажи нам честь — раздели нашу трапезу! Эй, друзья, потеснитесь!»
     Двое захмелевших гостей на другом конце стола подвигаются, освобождая место, и вы, не заставляя себя упрашивать, втискиваетесь между ними. Вокруг отчаянный гам, каждый рассказывает что-то своё, не особенно заботясь, слушают ли его. Тощий молодой менестрель с лютней, стоя перед бароном, что-то поёт, но до вас не доносится ни слова — всё заглушает пьяная болтовня.
     Зато жареное мясо превосходно, вино восхитительно, и <a l:href="#n_165">к концу трапезы</a> ваша СИЛА восстанавливается до первоначального уровня.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',power['start']-power['now']
end
--- page.429 ---------------------------------

# page.430
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы надламываете плотный лист. В коридоре веет тонким пряным ароматом — и тут же пауки обращаются в паническое бегство. Можно спокойно <a l:href="#n_386">идти дальше</a>.</p>}
--- page.430 ---------------------------------

# page.431
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],591,211):1DIN>"
--- page.431 ---------------------------------

# page.432
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы поднимаетесь над мостовой. Увы, летите вы тяжело, с трудом переваливаете через бронированную махину. При этом лезвие вращающейся крестовины задевает вашу ногу ([pow]-2[/pow]).
     [powernow]Вы приземляетесь. «Черепаха» продолжает ползти своим путём, а вы, прихрамывая, <a l:href="#n_520">идёте дальше</a> по улице. Кольцо, конечно, вам больше не пригодится.|Вы падаете прямо на спину железного монстра.[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
--- page.432 ---------------------------------

# page.433
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ночевать приходится на сеновале, в мягком, чуть-чуть не по-земному пахнущем сене. Мелькает мысль: «А зачем в замке сено, лошадей-то здесь нет...» И вы проваливаетесь в <a l:href="#n_245">сон</a> ([pow]2[/pow]).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',2
end
--- page.433 ---------------------------------

# page.434
$lvar['заголовок']={Мир Камней<avs-enemy>}
$lvar['исходник']={<center><font size=+1>ПИРАТ

ЛОВКОСТЬ 9     СИЛА 9</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.326'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','пират','','<ratch>'
end
--- page.434 ---------------------------------

# page.435
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Подниматься по осыпающимся стенкам воронки очень трудно, однако инстинкт самосохранения заставляет вас взлететь наверх, как по лестнице. Жук вдогонку не бросается, и вы <a l:href="#n_131">идёте дальше</a>, огибая стоящие стеной колючие заросли.</p>}
--- page.435 ---------------------------------

# page.436
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Пожалуй, не стоит лезть в эту сырую, хлюпающую темноту... Вы поднимаетесь по мраморной лестнице, выходите из здания станции и продолжаете путь <a l:href="#n_232">по улице</a>.</p>}
--- page.436 ---------------------------------

# page.437
$lvar['заголовок']={Мир Легенд<avs_source src="[useof:[протонная_граната] [огнетушитель] [пояс]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не успеваете вы как следует осмотреться, как на поляну падает широкая тень. Взглянув наверх, вы замираете: на вас пикирует громадное бурое чудовище. Он не похож на дракона из детских сказок, этот ящер с кожистыми крыльями и обвисшими складками чешуйчатой шкуры. Перед пастью его завивается прозрачно-алая струя огня.
     Вы моментально понимаете, что этот птеродактиль с огнеметом — не тот зверь, на которого можно напасть с ножом. Его остановит разве что [blaster]1|[usebl]1|217|бластер[/usebl]|бластер[/blaster] (если, конечно, он заряжен). Возможно, у вас найдется и более мощное оружие — например, протонная граната или какое-нибудь специальное средство борьбы с драконами... А может — совсем уж шальная мысль — пустить в ход огнетушитель?
     Иначе придётся <a l:href="#n_573">бежать</a>, спасая свою жизнь.</p>}
--- page.437 ---------------------------------

# page.438
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ну и зверюгу вы одолели!
     Приведя в порядок одежду, собираетесь <a l:href="#n_470">идти дальше</a>, но Клуша останавливает вас.
     «Шеф, — говорит она неуверенно, — один из исследователей Вереницы Миров выдвинул гипотезу, согласно которой клыки хищных пауков являются природными устройствами для фокусирования биоэнергии... и что при непосредственном контакте клыка с телом индивидуума повышаются физические характеристики данного индивидуума...»
     «Проще излагать можешь? — рявкаете вы. — Ты что, советуешь мне из клыка амулет сделать?»
     Оказывается, именно это она и имела в виду...
     Чувствуя себя ужасно глупо, сплетаете из длинных травинок тонкую веревочку и подвешиваете себе на шею короткий изогнутый клык. Выглядите вы, надо полагать, сущим дикарем, но, как ни странно, ваша ЛОВКОСТЬ повышается на 1...</p>}
if здесь_был[$curloc]=0:
	$args[0]=$func('crt.obj','клык','','[quest]')
	gosub 'add.obj',$args[0],'','//nope.goto//'
	gosub 'lovk',1,'max'
end
--- page.438 ---------------------------------

# page.439
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Третью игру подряд не играю, — твердо говорит незнакомец. — Плохая примета. Да и квиты мы с тобой...»
     Махнув рукой хозяину, незнакомец направляется к двери. Странно, разве он не собирался ночевать здесь? Ведь уже темно... Ладно, это его дело. А вот вам пора <a l:href="#n_240">спать</a>.</p>}
--- page.439 ---------------------------------

# page.440
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Склонившись над подвальным окном, замечаете в глубине темного пустого помещения силуэт старухи в лохмотьях. Значит, в городе остались люди! Вы пробуете окликнуть старуху, но она то ли не слышит вас, то ли не желает слышать... Хорошо бы проникнуть в подвал, но на окне железная решетка. Впрочем, выглядит она хлипкой. Хотите <a l:href="#n_580">выломать её</a> и спуститься в подвал через окно? Или, махнув на эту идею рукой, <a l:href="#n_360">пойдёте дальше</a>?</p>}
--- page.440 ---------------------------------

# page.441
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Когда человечек пробегает под деревом, вы свешиваете руку вниз и, поймав его за шиворот, рывком втаскиваете на ветку. Слабо пискнув, человечек пытается сопротивляться, но тут же затихает, сообразив, в чем дело. Вы оба, затаившись в кроне, наблюдаете сквозь листву за толпой, которая, сгрудившись на пригорке, обозревает окрестности. Из неразборчивых воплей ваш автопереводчик выхватывает слово «колдовство». Да, наверное, так это и выглядит со стороны: человечек взмахнул руками, взмыл вверх и исчез... Интересно, преследователи останутся в заблуждении или наберутся смелости и внимательнее осмотрят место, где свершилось «чудо»?</p>
<DIN1:$result=$func('luck',$lvar['luck'],41,545):1DIN>}
--- page.441 ---------------------------------

# page.442
$lvar['заголовок']={Мир Камней<avs-dark>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Здесь темно, как в колодце. Откуда-то тянет сильный воздушный поток — настолько сильный, что без труда погасит огонь, даже если вы сможете его зажечь. <DIN1:$args['очки']=$func('prv.bag','\[:ночное_видение:\]','regexp')
if $args['очки']!'':
	if instr($object_array[arrpos('$id_array',$args['очки'])],'[:лицо:]')=0:
		$result+='В рюкзаке лежат очки «Ночное зрение» - наденьте их. Иначе'
	else
		time['goto']=1
		goto 'page.46'
	end
elseif $args['pos.bl']='' or $args['pos.sv']='':
	$result+='Сейчас вам могли бы пригодиться очки «Ночное зрение». Но их нет, а значит'
end:1DIN> придётся <a l:href="#n_638">брести во мраке</a>.</p>}
--- page.442 ---------------------------------

# page.443
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Громадными скачками хищник настигает вас. Его когти впиваются вам в тело ([pow]-2[/pow]). [powernow]Остаётся одно — <a l:href="#n_123">драться,</a> защищая свою жизнь.|[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
--- page.443 ---------------------------------

# page.444
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Враг мёртв, аннигилятор у вас в руках, но вы не испытываете радости победы. Куда вы попали? Как возвратиться на Землю?.. Лаборатория носит следы поспешной эвакуации. Ремонтная мастерская цела, но все механизмы деактивированы. А самая неприятная неожиданность ждёт вас у шлюза космобота. Сигнал на табло информирует о том, что космобот отсутствует. Значит, персонал станции не эвакуирован рейсовым звездолетом, а бежал на утлом космическом катере! Но космобот не приспособлен для межзвездных перелетов, только для сбора образцов на поверхности исследуемой планеты! Люди перебрались на планету? Но почему? Какой ужас гнал их со станции — гнал так яростно, что они не дождались прихода аварийного корабля, который могли вызвать сигналом тревоги?
     Ответ на этот вопрос вы, вероятно, сможете найти на верхнем ярусе. Какими бы безумцами ни были обитатели станции, они должны были вести бортовой журнал, а при эвакуации его копия остаётся в капитанской рубке. Кроме того, наверху должен быть центр связи, а послать весточку на Землю очень бы не помешало. Итак, <a l:href="#n_272">наверх</a>!</p>}
if здесь_был[$curloc]=0:
	$args[0]=$func('crt.obj','аннигилятор','','[quest]')
	gosub 'add.obj',$args[0],'','//nope.goto//'
end
--- page.444 ---------------------------------

# page.445
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы собираетесь натереть соком растения лицо и руки. Но это оказывается ни к чему. Достаточно просто разломить мясистый лист — и крылатые кровопийцы исчезают.
     Устроившись в траве поудобнее, вы засыпаете ([pow]1[/pow]).
     А утром идёте прочь от замка — <a l:href="#n_381">на север</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',1
end
--- page.445 ---------------------------------

# page.446
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Осторожно продвигаетесь вперёд, пока не наталкиваетесь на глухую стену. Тупик! Раздосадовано поворачиваете к выходу из коридора, придерживаясь рукой стены. И вот под пальцами вы ощущаете пустоту: в стене, чуть выше уровня глаз, глубокая ниша. Хотите <a l:href="#n_546">исследовать её</a>? Или покинете тупик и <a l:href="#n_502">пойдёте дальше</a> по коридору?</p>}
--- page.446 ---------------------------------

# page.447
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы и не замечаете, как исчезла под ногами дорожка из белых камешков. Хотите <a l:href="#n_140">поискать её</a> или продолжите путь без дороги? В таком случае — куда? На <a l:href="#n_287">север</a>, <a l:href="#n_568">северо-запад</a> или <a l:href="#n_375">северо-восток</a>?</p>}
--- page.447 ---------------------------------

# page.448
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы нажимаете на пряжку и мягко взлетаете над мостовой. Сверху видны разрывы снарядов и вспышки бластеров на соседних улицах, но разглядывать панораму битвы некогда — зелёный огонек на индикаторе пояса начинает мигать. Энергия иссякает! Поспешите нырнуть в открытое <a l:href="#n_132">окно второго этажа</a>? Или, перелетев через линию обстрела, приземлитесь <a l:href="#n_24">на мостовой</a>?</p>}
--- page.448 ---------------------------------

# page.449
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы ловко и быстро <a l:href="#n_37">спускаетесь со стены</a>. Увы, верёвка останется здесь: она прочно закреплена наверху, а отвязать её некому.</p>}
if здесь_был[$curloc]=0:
	$args['вервь']=$func('prv.obj.inBag','вервь')
	if $args['вервь']!"":
		gosub 'put.obj',$args['вервь'],'//nope.goto//'
		gosub 'del.obj.id',$args['вервь']
	end
end
--- page.449 ---------------------------------

# page.450
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не успеваете сделать и десятка шагов, как слышите резкий щелкающий окрик. Вас окружает дюжина существ, похожих на громадных чёрных муравьёв. Они вооружены заостренными палками. Каждый выглядит сильным соперником в одиночку, а уж толпой... Словом, разумнее всего сделать то, что они требуют: проследовать за ними <a l:href="#n_523">в муравейник</a>.</p>}
--- page.450 ---------------------------------

# page.451
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Ах! — разочарованно вскрикивает стрекоза, увидев вашу флягу, — значит, ваша цивилизация тоже до этого додумалась! Но у нас не принято дарить другу то, что у него и так есть. Может быть, вам понравится что-нибудь другое?»
     Что вы выберете? Тяжелую, сочную <a l:href="#n_299">гроздь</a> чего-то, похожего на виноград, но ярко-алого цвета? Круглую зеленую <a l:href="#n_323">ягоду</a> размером с кулак? Длинную тонкую [obj]ВЕРВЬ_000016|лиану[/obj]?
     А может, вы <a l:href="#n_43">раздумали меняться</a>?</p>}
if здесь_был[$curloc]=0:
gosub 'crt.obj','','','[xxx:451:xxx]',0,1,'ROOF'
$args['динамический код предметов']={![page451.картман]
if $args[0]='!addobj.goto!':
	! удаляем динамический код
	args['pit']=arrpos('$id_array',$args[1])
	$args['run']=$strfind($run_array[args['pit']],'!'+'\['+'page451\.'+'картман\]'+'[\s\S]*'+'!'+'\[\/'+'page451\.'+'картман\]')
	gosub 'del.obj.id','СЕМЕН_000014' & $print[]='<font color=#884400>Вы отдали Семена.</font>'
	$object_array[args['pit']]=$replace($object_array[args['pit']],'[hide.onloc]')
	$run_array[args['pit']]=$replace($run_array[args['pit']],$args['run'])
	$result='page.491'
end
![/page451.картман]
}
gosub 'crt.obj','вервь',"ВЕРВЬ_000016",'[hide.onloc] [подарок стрекозы]',0,2,'',$args['динамический код предметов']
end
--- page.451 ---------------------------------

# page.452
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Укрывшись в простенке между домами, швыряете гранату. Переждав раскалённый вихрь взрыва, выглядываете из укрытия. Бронированная черепаха беспомощно лежит на спине. Оказывается, она передвигалась не на колесах и не на гусеницах: брюхо её покрыто бахромой крошечных ножек... Впрочем, некогда разглядывать эту уродину — пора <a l:href="#n_520">идти дальше</a>.</p>}
--- page.452 ---------------------------------

# page.453
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы растираете на ладони сочный лист — и облако насекомых редеет, рассыпается, отступает. Долго ещё осы, жужжа, провожают вас, но напасть не осмеливаются. Наконец с гудением <a l:href="#n_7">исчезают</a> — вероятно, отправляются чинить гнездо, разрушенное вашим неосторожным движением.</p>}
--- page.453 ---------------------------------

# page.454
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Каменная «лестница» в любой момент готова рассыпаться под ногами, но каким-то чудом вам всё же удаётся <a l:href="#n_534">подняться к отверстию</a>.</p>}
--- page.454 ---------------------------------

# page.455
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[powernow]<a l:href="#n_571">Валуны</a>|Валуны[/powernow] защищают от ветра, но не спасают от холода. <avs-insert></avs-insert></p>}
$args['плащ']=$func('prv.bag','\[плащ\]','regexp')
if $args['плащ']!'' and instr($object_array[arrpos('$id_array',$args['плащ'])],'[:плечи:]')!0:
	args['плащ одет']=1
else
	args['плащ одет']=-1
end
$args['d']=$strfind($lvar['исходник'],'<avs-insert>[\s\S]*?<\/avs-insert>')
if args['плащ одет']=1:
	$args['текст замена']='На вас тёплый плащ, можете выспаться спокойно ([pow]1[/pow]).'
else
	$args['текст замена']='[powernow]На вас не надет тёплый плащ, а значит пришлось всю ночь лязгать зубами|На вас не был надет тёплый плащ. Пролязгав зубами всю ночь, к утру вы всё же смогли уснуть, но не проснуться[/powernow] ([pow]-1[/pow]).'
end
$lvar['исходник']=$replace($lvar['исходник'],$args['d'],$args['текст замена'])
if здесь_был[$curloc]=0:
	gosub 'power',args['плащ одет']
end
--- page.455 ---------------------------------

# page.456
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Теперь можно идти дальше. Вскоре коридор вливается в другой тоннель. Кажется, вы направляетесь <a l:href="#n_300">к станции пересадки</a>.</p>}
--- page.456 ---------------------------------

# page.457
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Видимо, вы переоценили своё умение обращаться с корабельными механизмами... или коды управления были изменены...
     В панелях стены загораются аварийные лампы, и металлический голос наполняет все уровни звездолета:
     «Внимание! Экстренная эвакуация экипажа! Членам команды и пассажирам немедленно покинуть корабль! Повторяю: экстренная эвакуация экипажа!..»
     «Быстрее!» — командует Клуша. Но вы и так со всех ног спешите к лифту. Когда звучат подобные команды, мешкать нельзя. Ведь неизвестно, какой именно сигнал тревоги достиг электронного мозга звездолета и как на этот сигнал среагирует система безопасности...
     К счастью, удаётся благополучно миновать люк. Вы <a l:href="#n_541">скрываетесь в лесу</a>, стараясь не слушать рассуждений Клуши о некоторых людях, которых можно подпускать к приборам только в смирительной рубахе...</p>}
--- page.457 ---------------------------------

# page.458
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],582,102):1DIN>"
--- page.458 ---------------------------------

# page.459
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Но почему это существо с такой яростью набросилось на вас? В ответ на этот вопрос Клуша советует вам посмотреть под ноги. Оказывается, вы стоите на каких-то серых осколках и грязно-зелёной мешанине. Выходит, у «бабочки» здесь была кладка, а вы ненароком растоптали все яйца... Впрочем, нет, одно откатилось в сторону и случайно уцелело — продолговатое, серое, размером с кулак. Клуша сообщает, что яйца эти съедобны. Во всяком случае, исследователи, которые их ели, до сих пор живы. Хотите <a l:href="#n_63">проверить это утверждение</a> или <a l:href="#n_239">пойдёте своей дорогой</a>?</p>}
--- page.459 ---------------------------------

# page.460
$lvar['заголовок']={Мир Роботов<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В полумраке вы не замечаете тонкую проволоку, натянутую поперек рельсового пути, задеваете её ногой — страшный взрыв разносит всё вокруг. Кто мог подумать, что тоннель заминирован?..</p>}
--- page.460 ---------------------------------

# page.461
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорога бежит по лесу, уводя вас всё дальше на северо-запад. Темнеет, вы уже начинаете жалеть, что не свернули в деревню. И тут лес расступается. Вы видите высокий холм, на вершине которого гордо поднимает серые стены замок, похожий на рисунок из детской книжки...
     Зайдёте <a l:href="#n_105">в замок</a> и попроситесь на ночлег? Или обойдёте его стороной и проведёте ночь <a l:href="#n_585">в лесу</a>?</p>}
--- page.461 ---------------------------------

# page.462
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Будят вас голоса. Осторожно приподнимаетесь на каменном «балкончике» — и тут же вновь распластываетесь ничком. Одного взгляда вполне достаточно.
     Подземный зал полон народа. Не меньше трёх десятков верзил в форме звездолетчиков... да, тут лучше затаиться. Тем более что один из голосов, доносящихся снизу, вам очень даже знаком. Принадлежит этот голос пиратскому адмиралу по кличке Паук. Это не человек, а стихийное бедствие! Сейчас он, судя по всему, совещается со своим помощником. Разумеется, вы стараетесь не пропустить ни слова.
     Когда голоса стихают, вы сосредоточенно перебираете в мыслях всё, что узнали. А узнали вы многое!
     Оказывается, мерзавцу Бронсону удалось определить звёздные координаты одного из Миров. Вот этой самой планетки. Здесь и назначена встреча похитителя и Паука. Пираты расположились неподалёку от Ворот и ждут, когда прибудет их друг и благодетель. А Ворота — рядом, в небольшой каменной нише на противоположном конце пещеры.
     Попытаетесь <a l:href="#n_310">добраться до Ворот</a>, чтобы перехватить Бронсона в Веренице Миров и не дать ему встретиться с пиратами? Или будете <a l:href="#n_634">дожидаться похитителя здесь</a>, чтобы отобрать аннигилятор?</p>}
--- page.462 ---------------------------------

# page.463
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Перед глазами вашими — необычное и очень красивое зрелище. Деревья переплетены длинными тонкими лианами. Их сплошь усеяли громадные яркие бабочки. Стараясь сохранить равновесие, бабочки вразнобой взмахивают крыльями. От этого лианы раскачиваются, и кажется, будто среди деревьев танцуют пестрые змеи...
     Ваше появление вспугивает бабочек, и они радужным облаком исчезают в небе. Вы уже собираетесь уходить, но ваше внимание привлекают лианы. Они выглядят очень прочными, хотя и тонкими... С трудом удаётся дотянуться до одной из них. Лиана и в самом деле так прочна, что с трудом поддается ножу. Пожалуй, она сможет выдержать большой груз. Если в рюкзаке найдется свободное место — будет у вас в дороге верёвка.
     А теперь <a l:href="#n_303">возвращайтесь на тропинку</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','вервь','','[лиана]'
end
--- page.463 ---------------------------------

# page.464
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хватило одного глотка! Горло словно огнём обжигает, вы задыхаетесь, страшное головокружение валит с ног ([pow]-4[/pow]).[powernow]
     С трудом приходите в себя. Клуша вскользь замечает, что бесконтрольный дурак — явление крайне опасное... но наотрез отказывается уточнить, в чей адрес это сказано.
     Ладно, надо продолжать путь. Но куда? На <a l:href="#n_287">север</a>, <a l:href="#n_568">северо-запад</a> или <a l:href="#n_375">северо-восток</a>?|[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-4
end
--- page.464 ---------------------------------

# page.465
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре у обочины вы замечаете низкий, но просторный бревенчатый дом. Над дверью — вывеска, прочесть которую вы, разумеется, не можете, но Клуша тут же сообщает, что это таверна. <a l:href="#n_417">Войдёте туда заночевать</a>? Или свернёте с дороги и <a l:href="#n_139">переночуете в лесу</a>? Не забывайте, кстати, что вам нечем платить хозяевам...</p>}
--- page.465 ---------------------------------

# page.466
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;К вашему удивлению, пещера освещена. Неяркое серебристое свечение исходит от сотен ползающих по стенам жуков. На фоне этого колышущегося светового покрывала четко выделяется широкая чёрная щель. Исследовав её, обнаруживаете, что расщелина превращается в коридор. Вы идёте по коридору до тех пор, пока он не раздваивается. Куда свернёте: <a l:href="#n_514">налево</a> или <a l:href="#n_618">направо</a>?</p>}
--- page.466 ---------------------------------

# page.468
$lvar['заголовок']={Мир Роботов<avs-enemy>}
$lvar['исходник']={<p align=justify>     Стряхнув со своей спины неизвестного врага, оборачиваетесь. Перед вами худой, оборванный человек с блеском в глазах. Он хрипло кричит что-то бессвязное и замахивается на вас ножом. Сумасшедший!..</p>

<center><font size=+1>БЕЗУМЕЦ

ЛОВКОСТЬ 9     СИЛА 12</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.224'
$lvar['динамический код']={
if $args[0]='!war.ratchdown!':
	if GAME_WAR['ratch.power.'+$temp_id[0]]<3:
		$GAME_WAR['thiswar.'+$curloc]='victory'
		$GAME_WAR['prewin.txt']='Его сила упала до двух! Ура!!!'
		$GAME_WAR['exit.'+$curloc]='page.656'
	end
end
}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','безумец','','<ratch>'
end
--- page.468 ---------------------------------

# page.469
$lvar['заголовок']={Мир Легенд<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Яркий свет сквозь сомкнутые веки ударяет по глазам и заставляет проснуться. Над вами склонились трое стражников с факелами.
     «Этот?» — спрашивает один из них. Второй молча кивает.
     «Идём!» — коротко приказывает вам первый.
     <a l:href="#n_97">Подчинитесь</a> или <a l:href="#n_645">будете сопротивляться</a>?</p>}
--- page.469 ---------------------------------

# page.470
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы продолжаете путь на север. Вскоре справа от тропинки различаете в густой траве странный отблеск. Закатный луч солнца отражается в чем-то блестящем... Хотите свернуть с тропки и <a l:href="#n_260">поинтересоваться</a>, что там сверкает? Или <a l:href="#n_72">не станете задерживаться</a>?</p>}
--- page.470 ---------------------------------

# page.471
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Почва противно чавкает под ногами. Вы начинаете беспокоиться, не забрели ли вы в болото, и потому стараетесь <a l:href="#n_125">держаться ближе к деревьям</a>, которые, к счастью, растут всё чаще и чаще.</p>}
--- page.471 ---------------------------------

# page.472
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы плавно взлетаете над улицей и <a l:href="#n_520">приземляетесь</a> позади стального чудовища, которое продолжает ползти своей дорогой. Увы, полет израсходовал остатки энергии. Зеленое свечение индикатора угасло — больше пояс-антигравитатор вам не пригодится.</p>}
--- page.472 ---------------------------------

# page.473
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Деревня остаётся за спиной. Вы идёте на север, но постепенно дорога становится всё более заброшенной, заросшей. Она превращается в тропу, а затем и вовсе теряется. Вы пытаетесь идти в прежнем направлении, но вскоре понимаете, что <a l:href="#n_173">заблудились</a>.</p>}
--- page.473 ---------------------------------

# page.474
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Воздух наполняет басовитое гудение — и перед вами возникают два черно-серебристых шершня, каждый с крупную птицу размером. Они намерены напасть на вас! Если у вас есть средство избавиться от шершней — воспользуйтесь им. Иначе придётся <a l:href="#n_650">взяться за оружие</a>.</p>}
--- page.474 ---------------------------------

# page.475
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Впереди слышны гулкие удары и топот. Осторожно идёте вы вперёд, держа наготове оружие. Внезапно по правую руку от тропы кусты расступаются, открыв полянку, на которой идёт яростный бой. Два шестиногих существа, похожие на жуков-носорогов, но размером с настоящих носорогов, сцепились в поединке. Они расходятся в противоположные концы полянки, тяжело бегут навстречу друг другу и с грохотом ударяют противника изогнутыми чёрными рогами. Затем вновь расходятся и начинают всё сначала. Поединок, видимо, длится долго: чёрные блестящие бока жуков покрыты царапинами и вмятинами. Жуки так увлечены боем, что, кажется, не замечают ничего вокруг.
     Попробуете <a l:href="#n_379">перебежать открытое пространство</a> и идти дальше по тропинке? Или решите, что благоразумнее <a l:href="#n_52">затаиться в кустах</a> и выждать, пока эти «броневики» не кончат выяснять отношения?</p>}
--- page.475 ---------------------------------

# page.476
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Каким-то чудом вам удаётся выловить из жидкой грязи чёрный цилиндрик с кнопкой на одном торце и «глазком» на другом.
     Клуша выдает фразу, целиком состоящую из слов, которые явно не заложены в её память инженерами. Где она только нахваталась подобных выражений?.. Впрочем, её отвращение можно понять. На ладони у вас лежит самый ненавистный для Клуши предмет — «Чёрный луч». Это прибор, создающий полосу мощных электромагнитных помех. Стоит нажать на кнопку — и любой робот, на которого вы направите этот цилиндрик, будет надолго выведен из строя. Если возьмёте находку с собой, то учтите: чтобы пустить её в дело, надо прибавить 100 к номеру параграфа, на котором будете находиться.
     Клуша обращает ваше внимание на то, что «эта мерзость» явно принадлежит к вашему миру. Обронить её мог только Бронсон. Преступник шёл этим путём! Что ж, это обнадеживает...
     Теперь можно <a l:href="#n_576">продолжить путь</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','чл'
end
--- page.476 ---------------------------------

# page.477
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре лес остаётся за спиной. Перед вами река — полноводная, широкая. Сойдя на берег, склоняетесь над водой, чтобы напиться... и тут на плечи с шумом падает сеть. Трое верзил, возникшие из прибрежных кустов, деловито вяжут вас по рукам и ногам, вы даже не успеваете пустить в ход оружие.
     Из разговоров этих негодяев вы понимаете, что они приняли вас за узника, бежавшего из каменоломни. Они быстро убеждаются в своей ошибке, но отпускать вас не намерены: в каменоломне всегда нужны рабочие руки, а тот ли, этот ли — какая разница? Даже если на вас рыцарский шлем — это ничего не меняет. Мерзавцы просто-напросто утопят шлем в реке.
     Вам <a l:href="#n_143">предстоит ломать киркой каменные глыбы</a>, проклиная барона Кириаса Многоземельного, который поклялся построить себе замок их голубого камня. Правда, его можно понять: камень этот очень и очень прочный. Вы убеждаетесь в этом на свирепом солнцепеке, под свист бичей надсмотрщиков, под стоны умирающих от непосильного труда товарищей...</p>}
$GAME_VALUE['interface']=''
--- page.477 ---------------------------------

# page.478
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Пенная струя пробивает вам дорогу, и вскоре пылающий коридор <a l:href="#n_210">остаётся позади</a>...</p>}
--- page.478 ---------------------------------

# page.479
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорожка, петляя среди колючих кустов, ведёт на северо-восток. Внезапно кусты расступаются. Перед вами возвышается что-то, напоминающие рыцарский замок, только башни странно округлены сверху. Клуша тут же информирует вас, что это муравейник. Муравьи — разумные, но почти не изученные, поскольку на контакт идут крайне неохотно.
     Рискнёте <a l:href="#n_450">подойти к муравейнику</a> в надежде узнать что-либо о Воротах? Или как можно осторожнее, пробираясь кустами, обойдёте муравейник и <a l:href="#n_268">пойдёте дальше на север</a>?</p>}
--- page.479 ---------------------------------

# page.480
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Каменные дома мрачны и безжизненны. Пройдя пару кварталов, обнаруживаете по левую руку подворотню. <a l:href="#n_328">Свернёте туда</a> или <a l:href="#n_88">продолжите путь по улице</a>?</p>}
--- page.480 ---------------------------------

# page.481
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы всё ещё разглядываете своё новое приобретение, как вдруг лёгкий шорох заставляет вас обернуться.
     Чародей исчез. Улетел? Растворился в воздухе? Нет, скорее уж юркнул в придорожные кусты... Жаль, у такого занятного спутника можно было бы многое узнать...
     А теперь пора двигаться дальше, не стоять же на дороге до ночи! Идти в деревню, пожалуй, не стоит: жители её сейчас несколько... э-э... возбуждены. Безопаснее идти по дороге <a l:href="#n_69">в сторону леса</a>. И Клуша, кстати, тоже так считает.</p>}
--- page.481 ---------------------------------

# page.482
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Отличные очки! Вы видите во мраке каждую трещину в крутой стене тоннеля, каждый выступ на пути. И успеваете вовремя остановиться, когда у ваших ног разверзается чёрный провал. На противоположной стороне его — глухая стена. Вы забрели в тупик! Остаётся лишь вернуться на развилку и <a l:href="#n_422">пойти другой дорогой</a>.</p>}
--- page.482 ---------------------------------

# page.483
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Оскорбленное существо высоко подпрыгивает над водой и посылает вам в лицо сильную и точную струю воды. Видимо, плевок морского жителя ядовит, потому что глаза ваши обжигает резкая боль. С трудом удаётся протереть глаза, но вы долго ещё не сможете видеть так же хорошо, как прежде (<font color=#004400><i>ЛОВКОСТЬ уменьшается на 1</i></font>)...
     Пока Вы занимаетесь своими глазами, мерзкое существо <a l:href="#n_599">успевает скрыться</a>.</p>}
if здесь_был[$curloc]=0:
	fast['now']-=1
	$print[]='Ловкость уменьшается: -1'
end
--- page.483 ---------------------------------

# page.484
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;За дверью — небольшая, уютная кают-компания. Как раз сейчас под веселую музыку стол сервируется к обеду. Из прорези в стене выскакивают тарелки, стаканы, вазочки с искусственными цветами; тонкие манипуляторы расставляют всё это на столе. Стол накрыт на десять персон, но где же люди?.. А еда, кстати, выглядит очень аппетитно. Хотите <a l:href="#n_365">перекусить</a> или оставите кают-компанию и <a l:href="#n_604">пойдёте дальше</a> по коридору?</p>}
--- page.484 ---------------------------------

# page.485
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Барон брезгливо морщится.
     «Все ясно... Стража! <a l:href="#n_25">В темницу</a> самозванца! Потом решу, что с ним делать...»
     И не вздумайте сопротивляться: стражники вооружены арбалетами, а со стрелой не поспоришь...</p>}
--- page.485 ---------------------------------

# page.486
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Очнувшись, выбираетесь из-под каменных обломков. Только сейчас вы замечаете огромную глыбу, лежащую рядом. Если бы она упала чуть левее... Ладно, не стоит об этом размышлять. Лучше вернуться к развилке и свернуть <a l:href="#n_346">в другой коридор</a>.</p>}
--- page.486 ---------------------------------

# page.487
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;С трудом дотянувшись до бластера, выжигаете вокруг себя безопасный круг и, на ходу срывая впившиеся в тело обрывки корней, покидаете горный склон. Вот как погибли прежние экспедиции!.. От этой передряги ваша СИЛА уменьшается на 6.[powernow]
     Отступая, вы не глядите по сторонам, думая лишь о том, не метнется ли из-под ног ещё один корень-убийца. Вы стараетесь держаться дна каменистой расселины — там меньше нор. Но вот расселина раздваивается. Куда свернёте — <a l:href="#n_347">налево</a> или <a l:href="#n_531">направо</a>?|[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-6
end
--- page.487 ---------------------------------

# page.488
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вам удаётся проскочить линию огня между всплесками очередей, но две пули всё-таки успевают зацепить вас ([pow]-6[/pow]). [powernow]Раны болезнены, но не смертельны — <a l:href="#n_592">продолжайте свой путь</a>.|Раны оказались смертельными[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-6
end
--- page.488 ---------------------------------

# page.489
$lvar['заголовок']={Мир Легенд<avs_source src="[useof:[зеркало]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Старая служанка по винтовой лестнице ведёт вас в башню, в горницу её светлости баронессы Горфриды.
     Баронесса, высокая и статная женщина средних лет, сидит на деревянном стуле с резной спинкой, а горничная расчёсывает её длинные волосы. Возле стула стоит широкий ушат с водой, и баронесса время от времени поглядывает на своё отражение. Вы замечаете, что в комнате нет ни одного зеркала.
     <DIN1:$args['pos.bl']=$func('prv.obj.inBag','зеркало')
		! проверяем заряды
		if $args['pos.bl']!"":
			$result='У вас в рюкзаке есть зеркало, можете преподнести его в подарок баронессе. Если не хотите'
		else
			$result='Было бы у вас зеркало, можно было бы подарить его баронессе. Но зеркала нет, а значит вы не можете'
		end:1DIN> сделать это — <a l:href="#n_513">начинайте беседу</a>.</p>}
--- page.489 ---------------------------------

# page.490
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Чудовище сотрясается, из пасти его вырывается звук, похожий на гул землетрясения. Точно порыв ветра подхватывает вас и вышвыривает из пещеры-пасти. Похоже, от боли монстр закашлялся, и это <a l:href="#n_354">спасло вас</a>.</p>}
--- page.490 ---------------------------------

# page.491
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Лиана настолько длинна и прочна, что может служить верёвкой. Поблагодарив стрекозу, сматываете своё новое приобретение в моток и <a l:href="#n_43">укладываете в рюкзак</a>.</p>}
--- page.491 ---------------------------------

# page.492
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Нажимаете кнопку — и бешеная стальная черепаха начинает тупо вращаться на одном месте. А вы спокойно <a l:href="#n_520">проходите мимо неё</a>.</p>}
--- page.492 ---------------------------------

# page.493
$lvar['заголовок']={Мир Легенд<avs-enemy>}
$lvar['исходник']={<p align=justify>     Рыцарь упорно требует, чтобы вы назвали имя дамы, во имя которой будете сражаться. С отвращением глядя на него, вы торжественно объявляете, что посвящаете бой красоте, благородству и прочим достоинствам несравненной Клуши Космопатрульной.
     Короткий металлический смешок эхом проносится в вашем сознании: Клуша оценила красивый жест.</p>

<center><font size=+1>ПАЛЕАНДР НЕУКРОТИМЫЙ

ЛОВКОСТЬ 10     СИЛА 12</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.265'	&	!	название локации, на которую можно перейти в случае победы.
$lvar['динамический код']={
if $args[0]='!war.powerdown!':
	if power['now']<3:
		$GAME_WAR['thiswar.'+$curloc]='prelose'
		$GAME_WAR['prelose.txt']='Ваша сила снизилась до 2-х. Увы...'
		$object_array[arrpos('$id_array',$temp_id[0])]+=" [pownow:<<GAME_WAR['ratch.power.'+$temp_id[0]]>>"
		$position_array[arrpos('$id_array',$temp_id[0])]='page.65'
		$GAME_WAR['exit.'+$curloc]='page.65'
	end
end
if $args[0]='!war.ratchdown!':
	if GAME_WAR['ratch.power.'+$temp_id[0]]<3:
		$GAME_WAR['thiswar.'+$curloc]='victory'
		$GAME_WAR['prewin.txt']='Его сила упала до двух! Ура!!!'
		$GAME_WAR['exit.'+$curloc]='page.157'
	end
end
}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','палеандр','','<ratch>'
end
--- page.493 ---------------------------------

# page.494
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы поворачиваетесь и бросаетесь наутек. Сзади свистит петля — и падает в траву, не задев вас.
     Вы бежите, не разбирая дороги, не глядя по сторонам. Когда понимаете, что опасность миновала, замедляете шаг и пытаетесь сориентироваться. Оказывается, всё это время вы бежали на север. А <a l:href="#n_72">впереди</a> уже слышен мерный шелест морских волн, ветер пахнет солью и водорослями.</p>}
--- page.494 ---------------------------------

# page.495
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Странная добыча! Ярко-фиолетовый, с глянцевым блеском плод, такой твердый, что нож скользит по нему, не оставляя даже царапины... Если хотите взять его <a l:href="#n_415">в дорогу</a> — что ж, посмотрите, найдется ли для него место в рюкзаке...<!--
     Когда придумаете, как можно использовать плод, прибавьте 204 к номеру параграфа, на котором будете находиться.--></p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','плод_фиолетовый'
end
--- page.495 ---------------------------------

# page.496
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы скрываетесь в подворотне — и вовремя. Воздух наполняется треском автоматных очередей. Вы вжимаетесь в стену, чтобы вас не задели пули, залетающие сюда рикошетом.
     Колонна всё движется, и вы осторожно оглядываете своё убежище. Да это не просто подворотня — это сквозной проход на соседнюю улицу. <a l:href="#n_536">Свернёте</a> туда или пропустите колонну и <a l:href="#n_212">пойдёте прежним путём</a>?</p>}
--- page.496 ---------------------------------

# page.497
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Укрывшись меж громадными бревнами швыряете гранату в массивную тушу. Ярчайшая вспышка видна даже сквозь сомкнутые веки. Современная боевая технология, разумеется, оказывается победительницей: свирепый ящер <a l:href="#n_257">разнесен в клочки</a>.</p>}
--- page.497 ---------------------------------

# page.498
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],594,214):1DIN>"
--- page.498 ---------------------------------

# page.499
$lvar['заголовок']={Мир Легенд<avs-enemy><non-blaster>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ловко перепрыгнув через скамью, вы подходите к разговорчивому незнакомцу.
     «Как интересно устроен человек, — задумчиво говорите вы. — Тридцать два зуба не могут управиться с одним-единственным языком — прикусить его, когда нужно...»
     Незнакомец изгибает бровь.
     «Надо же, высокородный господин может заметить кого-то, кроме своей драгоценной персоны! Может, храбрый рыцарь даже драться умеет?»
     «Хочешь проверить?» — небрежно откликаетесь вы.
     «Конечно! — радостно вскидывается наглец. — Я, правда, не поддерживаю ушами кастрюлю по кличке «шлем», зато на поясе у меня...»
     Он откидывает полу плаща. Взглядом опытного воина вы мгновенно оцениваете его оружие. Длинный нож, вроде вашего, только рукоять богаче украшена. Словом, ничего особенного...
     (Бластер в ход пускать нельзя. Во-первых, это честный поединок, а во-вторых, за вами во все глаза наблюдает хозяин таверны. Что он подумает — и начнет рассказывать — о вашем оружии?)
     Сталь ударяет о сталь — и вы тут же понимаете, что перед вами потрясающий противник!</p>
   
<center><font size=+1>НАГЛЕЦ

ЛОВКОСТЬ 11     СИЛА 10</font></center>}
$lvar['exit']='page.215'	&	!	название локации, на которую можно перейти в случае победы.
$lvar['динамический код']={
if $args[0]='!war.powerdown!':
	if power['now']<3:
		$GAME_WAR['thiswar.'+$curloc]='prelose'
		$GAME_WAR['prelose.txt']='Ваша сила снизилась до 2-х. Увы...'
		$GAME_WAR['exit.'+$curloc]='page.45'
	end
end
if $args[0]='!war.ratchdown!':
	if GAME_WAR['ratch.power.'+$temp_id[0]]<3:
		$GAME_WAR['thiswar.'+$curloc]='victory'
		$GAME_WAR['prewin.txt']='Его сила упала до двух! Ура!!!'
		$GAME_WAR['exit.'+$curloc]='page.215'
	end
end
}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','наглец','','<ratch>'
end
--- page.499 ---------------------------------

# page.500
$lvar['заголовок']={Мир Роботов<avs-dark>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Только сейчас, когда на вас навалилась смоляная чернота, вы понимаете, что на стенах станции горели слабенькие, но рассчитанные на годы аварийные лампочки. А здесь... ну и темнотища! <DIN1:$args['очки']=$func('prv.bag','\[:ночное_видение:\]','regexp')
if $args['очки']!'':
	if instr($object_array[arrpos('$id_array',$args['очки'])],'[:лицо:]')=0:
		$result+='В рюкзаке лежат очки «Ночное зрение», лучше надеть их. Иначе'
	else
		time['goto']=1
		goto 'page.64'
	end
elseif $args['pos.bl']='' or $args['pos.sv']='':
	$result+='Были бы у вас очки «Ночное зрение», вы могли бы надеть их. А так'
end:1DIN> придётся <a l:href="#n_124">брести наугад во мраке</a> или вообще вернуться на станцию и подняться наверх, <a l:href="#n_436">на улицу</a>.</p>}
--- page.500 ---------------------------------

# page.501
$lvar['заголовок']={Мир Легенд<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропинка вскоре теряется меж поросших мхом корней, вокруг сгущаются сумерки. Клуша назойливо зудит насчет ночлега. Да вы и сами понимаете, что глупо брести в темноте.
     Найдя подходящую полянку, поросшую мягкой высокой травой, сбрасываете наземь рюкзак. <DIN1:$args['зажигалка']=$func('prv.obj.inBag','зажигалка')
if $args['зажигалка']!'':
	$result='У вас есть зажигалка, можете набрать сучьев и <a l:href="#n_613">развести костёр</a>. Если вы не хотите ею пользоваться'
else
	$result='Была бы у вас зажигалка, вы могли бы развести костёр, но зажигалки нет'
end:1DIN>, придётся <a l:href="#n_121">обойтись без огня</a>.</p>}
--- page.501 ---------------------------------

# page.502
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор выводит в громадную пещеру. Настоящий подземный зал: сталактиты и сталагмиты похожи на колонны, а гладкие, ровные стены наводят на мысль о вмешательстве человека?.. Противоположный конец пещеры теряется в полумраке, и вам не определить её настоящих размеров. Да вам сейчас и не хочется об этом думать: волной накатывается усталость, валит с ног... Конечно, под землёй не определишь, день сейчас или ночь, но, похоже, пора выспаться...
     Вы осматриваетесь. Вдоль стены тянется что-то вроде каменной галереи с невысоким карнизом. На неё, кажется, выходят и другие тоннели, но всё же галерея кажется безопасным местом для ночлега. Может быть, сон здесь — не самый безопасный поступок, но вы так измучены...
     Прикорнув у каменного барьерчика, вы сразу <a l:href="#n_462">засыпаете</a> ([pow]1[/pow]).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',1
end
--- page.502 ---------------------------------

# page.503
$lvar['заголовок']={Мир Стрекоз}
$lvar['luck'] = $args[0]
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],307,443):1DIN>"
--- page.503 ---------------------------------

# page.504
$lvar['заголовок']={Исследовательская станция<avs-enemy>}
$lvar['исходник']={<p align=justify>    Подъём по скобам не занимает много времени. Аварийный люк второго яруса открыт. Выбираетесь в коридор, поспешно вспоминая всё, что знаете об орбитальных станциях. Итак, что здесь может быть? Причальный шлюз, шлюз исследовательского космобота, ремонтная мастерская, лаборатория и... и... и Бронсон.
     Он стоит прямо перед вами — мрачный, сутулый верзила с таким же, как у вас, ножом наизготовку. У ног его лежит лиловый рюкзак. Едва взглянув в лицо Бронсону, вы понимаете, что переговоры ни к чему не приведут. В глазах его горит опасный огонь безумия. За свою добычу он будет драться зубами и когтями, ничего не соображая, ни к каким разумным доводам не прислушиваясь...</p>

<center><font size=+1>БРОНСОН

ЛОВКОСТЬ 10     СИЛА 10</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.444'	&	!	название локации, на которую можно перейти в случае победы.
if здесь_был[$curloc]=0:
	gosub 'crt.obj','бронсон','','<ratch>'
end
--- page.504 ---------------------------------

# page.505
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;При взгляде на ваш плюмаж глаза хозяина загораются восторгом.
     «Какая честь! — восклицает он. — В моей скромной таверне — победитель Палеандра Неукротимого! Вся округа будет говорить об этом!.. Нет-нет, высокородный гость, не тянись за своим кошельком. Для тебя всё будет бесплатным — и ужин, и ночлег!..»
     Поскольку вы и не собирались тянуться за своим кошельком, такой поворот событий вас вполне устраивает. Похоже, плюмаж делает вас значительной персоной. Хозяин моментально приносит жареное мясо и вино, а единственный посетитель, подняв голову от стола, уважительно поднимает в вашу сторону кубок. Вы вежливо отвечаете тем же.
     Мясо прибавит 5 к вашей СИЛЕ. А если вы не голодны, возьмите мясо с собой, хозяин не обидится.
     А теперь пора <a l:href="#n_240">идти спать</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','мясо'
end
--- page.505 ---------------------------------

# page.506
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор ведёт всё дальше в толщу скалы. Светящиеся жуки копошатся по стенам, поэтому серебристый свет мягко колышется вокруг. Внезапно коридор раздваивается. Куда свернёте: <a l:href="#n_114">налево</a> или <a l:href="#n_66">направо</a>?</p>}
--- page.506 ---------------------------------

# page.507
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы пытаетесь вскарабкаться по стенке воронки, песок осыпается под руками, и проклятая тварь ухитряется цапнуть вас за щиколотку (причем цапнуть так крепко, что СИЛА уменьшается на 2, а ЛОВКОСТЬ — на 1). [powernow]Но наконец удаётся выбраться, и вы <a l:href="#n_131">идёте дальше</a>, обходя колючие заросли.|[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
	fast['now']-=1
	$print[]='ЛОВКОСТЬ уменьшается: -1'
end
--- page.507 ---------------------------------

# page.508
! ВНИМАНИЕ ЗАЛОЧЕННАЯ ЛОКАЦИЯ
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Резкая боль [page=356]обжигает бок[/page] ([pow]-3[/pow]).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-3
end
!!! УТОЧНИТЬ У ГОЛОТВИНОЙ правильно ли сделан переход. С 508 на 356! В оригинале нет его!
--- page.508 ---------------------------------

# page.509
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вежливо окликнув путника, пытаетесь расспросить его, куда ведёт эта дорога. Но не успеваете даже закончить фразу, как рыцарь в ярости хватается за меч.
     «Презренный! — гремит он. — Как ты посмел прерывать размышления благородного рыцаря? Я научу тебя учтивости!»
     И он наносит удар ([pow]-2[/pow]). [powernow]<a l:href="#n_73">Дадите ему сдачи</a> или <a l:href="#n_557">броситесь бежать</a>?|[/powernow]</p>}
 if здесь_был[$curloc]=0:
	gosub 'power',-2
end
--- page.509 ---------------------------------

# page.510
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре тоннель раздваивается. Куда свернёте: <a l:href="#n_182">налево</a> или <a l:href="#n_406">направо</a>?</p>}
--- page.510 ---------------------------------

# page.511
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В руках у вас ярко-фиолетовый блестящий шарик, похожий на диковинный плод, но настолько твердый, что его не удаётся разрезать ножом. Хотите взять его с собой? В таком случае берите, если считаете, что «плод» может вам пригодиться.
     А теперь <a l:href="#n_55">продолжайте путь</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','плод_фиолетовый'
end
--- page.511 ---------------------------------

# page.512
$lvar['заголовок']={Мир Роботов<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Чуть-чуть не достаёте вы в прыжке до золотистого сияния — и падаете лицом в липкую черноту. Это что-то вроде смолы — цепкая, жгучая химическая гадость, которая не даст вам вырваться и быстро разъест одежду и тело.</p>}
--- page.512 ---------------------------------

# page.513
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Кто ты, путник? — <a l:href="#n_33">вопрошает</a> госпожа Горфрида. — С чем пришел ты в наш замок и куда дальше лежит твоя дорога?»</p>}
--- page.513 ---------------------------------

# page.514
! С П514 ПЕРЕХОД НА П426 (ЕСЛИ ВЫ ХОТИТЕ ПОВЕРНУТЬ НАПРАВО).
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор выводит вас к новой развилке. И опять приходится выбирать, куда повернуть: <a l:href="#n_346">налево</a> или <a l:href="#n_426">направо</a>?</p>}
--- page.514 ---------------------------------

# page.515
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Жаль зарядов, но жизнь дороже... Обойдя чудовищные чёрные туши, вы идёте дальше по тропинке — <a l:href="#n_427">на северо-запад</a>.</p>}
--- page.515 ---------------------------------

# page.516
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тут кипел бой! Возле окна грудой навалены мешки с песком — для защиты от пуль. На этом импровизированном бруствере лежит тот, кто ещё совсем недавно — пожалуй, несколько часов назад — вел стрельбу по улице. Не робот — человек! Он убит в спину: кто-то поднялся по лестнице и застал его врасплох.
     Возле тела лежит бластер почти той же конструкции, что и ваш. Ствол повреждён случайной пулей, но зарядник цел. Передёрнув затвор, обнаруживаете последний неиспользованный заряд. Можете взять его с собой.
     А теперь пора покинуть комнату и <a l:href="#n_288">спуститься по лестнице</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'blast.charge',1
end
--- page.516 ---------------------------------

# page.517
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорога, залитая утренним солнцем, внезапно раздваивается. Свернёте на <a l:href="#n_593">северо-запад</a> или продолжите путь на <a l:href="#n_385">север</a>?</p>}
--- page.517 ---------------------------------

# page.518
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Осторожно идёте вы в непроглядной тьме, стараясь придерживаться стены. Но осмотрительность не помогает — под ногой разверзается бездна, вы [powernow]<a l:href="#n_82">летите вниз</a>|летите вниз[/powernow] в кромешном мраке и крепко обо что-то ударяетесь головой и плечом ([pow]-3[/pow])...</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-3
end
--- page.518 ---------------------------------

# page.519
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ох, и гадость же вы выпили! Всё тело пронзает боль, в глазах темнеет, ноги подкашиваются... Мерзкое ощущение вскоре проходит, но ваша ЛОВКОСТЬ уменьшается на 1... Зато дышать под водой вы теперь сможете. Скорее <a l:href="#n_315">ныряйте в воду</a>, пока не прошло действие чудесной жидкости.</p>}
if здесь_был[$curloc]=0:
	fast['now']-=1
	$print[]='ЛОВКОСТЬ уменьшается: -1'
end
--- page.519 ---------------------------------

# page.520
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По левую руку от вас — кирпичный дом. Когда-то он был многоэтажным, но снаряды оставили от него лишь два этажа, а выше — зубчатые руины. Подъезд распахнут настежь. Хотите <a l:href="#n_4">войти</a> или двинетесь <a l:href="#n_584">по улице дальше</a>?</p>}
--- page.520 ---------------------------------

# page.521
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы выходите на широкую... просеку, как вам показалось сначала. Но сразу понимаете, что ошиблись: деревья не срублены, а повалены широкой полосой. Многие из них обуглены. Что за чудовище устроило здесь логово? Может быть, <a l:href="#n_13">уйти отсюда</a>, пока не поздно? Или <a l:href="#n_437">останетесь здесь</a> и попытаетесь найти Ворота до возвращения зверюги?</p>}
--- page.521 ---------------------------------

# page.522
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Фитилёк вспыхивает, <a l:href="#n_254">освещая коридор</a> неверным дрожащим пламенем.</p>}
--- page.522 ---------------------------------

# page.523
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не раз и не два придётся вам пожалеть о том, что вы очутились в муравейнике. Вас ждёт самое унизительное и горькое [page=143]рабство[/page]: тяжёлый труд по расчистке подземных переходов от мусора, долгие дни и ночи почти без света. Несколько попыток совершить побег приведут лишь к тому, что вы заплутаете в подземных лабиринтах и будете жестоко искусаны изловившими вас шестиногими хозяевами.
     И лишь одно будет вас немного утешать: долгие телепатические разговоры о быте и нравах муравьёв, которые вы (при помощи Клуши) будете вести с ошалевшими от счастья ксенобиологами и этнографами. Так сказать, «наш человек в муравейнике».</p>}
$GAME_VALUE['interface']=''
--- page.523 ---------------------------------

# page.524
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Впереди брезжит свет, причём горят не аварийные лампы, а что-то поярче. Вы <a l:href="#n_372">прибавляете шагу</a>.</p>}
--- page.524 ---------------------------------

# page.525
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Старуха теряет к вам интерес и не собирается поддерживать беседы. На все вопросы она отвечает коротко и с такой явной неохотой, что вы досадливо машете рукой и <a l:href="#n_473">идёте дальше</a>.</p>}
--- page.525 ---------------------------------

# page.526
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Полосы и пятна света шевелятся на стенах, почти не разгоняя полумрак. Не так уж просто здесь что-то разглядеть... Незнакомец замечает убитого вами зверя и склоняется над ним, не теряя настороженности. Затем успокоено распрямляется и уходит прочь — вероятно, он решил, что здесь произошла схватка двух хищников...
     В тот момент, когда тип с бластером выпрямляется, с его пояса падает какой-то чёрный предмет. Незнакомец не замечает этого. Когда он скрывается, вы встаёте и подбираете свою <a l:href="#n_655">находку</a>.</p>}
--- page.526 ---------------------------------

# page.527
$lvar['заголовок']={Мир Стрекоз<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Путь ваш лежит меж странных бочкообразных деревьев, высоко вскинувших кроны мясистых листьев. Деревья перевиты лианами, а меж корней их светятся потрясающие цветы.
     Из этой сияющей массы красок взгляд выхватывает растение с листьями в форме сложенных ладоней. В них мерцает влага (вероятно, осталась от недавнего дождя).
     При виде воды, светло поблескивающей в живых чашах, вы чувствуете, как пересохло горло. Рискнёте <a l:href="#n_619">напиться</a> или <a l:href="#n_207">пройдёте мимо</a>?</p>}
--- page.527 ---------------------------------

# page.528
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы пытаетесь протиснуться в щель — и прочно в ней застреваете. С большим трудом, исцарапанный и испачканный, выбираетесь вы из кирпичной ловушки ([pow]-1[/pow]). [powernow]Остаётся лишь покинуть подвал через окно и <a l:href="#n_360">продолжить путь</a> по переулку.|[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
--- page.528 ---------------------------------

# page.529
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ждать приходится очень долго: Брайт Могучий попросту забыл о вас. А потом, по словам стражников, и вовсе уехал из замка — навестить соседа, сэра Кириаса Многоземельного. И вам остаётся слушать, как шуршат в соломе пучеглазые чёрные зверушки, напоминающие мышей, да вести долгие беседы с верной Клушей. И <a l:href="#n_143">ждать</a>...</p>}
$GAME_VALUE['interface']=''
--- page.529 ---------------------------------

# page.530
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Деревья становятся <a l:href="#n_225">всё гуще</a>, и вскоре за их стеной вы уже не видите озера.</p>}
--- page.530 ---------------------------------

# page.531
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Похоже, опасная зона осталась позади... Но <a l:href="#n_183">куда же вы прибежали</a>?</p>}
--- page.531 ---------------------------------

# page.532
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Конечно, война — это ужасно, — говорит Клуша странным, почти мечтательным тоном, — но мир, населённый исключительно роботами... в этом что-то есть!»
     Вы заверяете Клушу, что эти механические дикари не оценили бы её высокой культуры, и [step]404|входите в нишу[/step].</p>}
--- page.532 ---------------------------------

# page.533
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропка совсем заросла, вы то и дело теряете её в подлеске. Но в конце концов она всё же выводит вас на большую круглую <a l:href="#n_625">поляну</a>.</p>}
--- page.533 ---------------------------------

# page.534
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Да, коридор продолжается! Вы идёте дальше, пока не замечаете на полу тёмное широкое пятно. Подойдя ближе, обнаруживаете, что это глубокая впадина, в которой уютно устроилось нечто живое и довольно противное — этакая помесь скорпиона с раком, размером с крупную собаку. Он весьма недружелюбно глядит на вас двумя парами глаз и шевелит массивными клешнями...
     Пока не поздно, вернётесь к скале и <a l:href="#n_642">спрыгнете с неё</a>, чтобы вновь дойти до развилки? Попытаетесь <a l:href="#n_498">перепрыгнуть впадину</a> (благо она не очень широка)? Или просто спуститесь к этой твари и <a l:href="#n_94">зададите ей хорошую трепку</a>?</p>}
--- page.534 ---------------------------------

# page.535
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стрекоза грациозно устраивается на вашем плече. Крылья она не раскидывает в стороны, а складывает за спиной, как земная бабочка, так что они не мешают вам идти. Да и весит стрекоза совсем немного, так что путь легок для вас.
     Внезапно ваша спутница вспархивает в воздух и зависает над кустами слева от тропки. «Сюда! — зовет она. — Я живу здесь!»
     Вы раздвигаете кусты — и оказываетесь на уютной <a l:href="#n_259">полянке</a>.</p>}
--- page.535 ---------------------------------

# page.536
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Проходной двор выводит на соседнюю улицу. По правую руку от вас где-то неподалёку (квартала за два) грохочут взрывы. Идти туда совсем не хочется, и вы сворачиваете <a l:href="#n_88">налево</a>.</p>}
--- page.536 ---------------------------------

# page.537
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Похоже, вы убедили девушку в своей невиновности. Она молча кивает, исчезает куда-то и быстро возвращается с мотком верёвки. Вдвоём вы поднимаетесь по каменным ступенькам на стену. Закрепив верёвку, вы <a l:href="#n_37">спускаетесь на землю</a>. Девушка, оставшаяся наверху, развязывает узел — и верёвка падает к вашим ногам. Если в рюкзаке найдётся свободное место — можете взять верёвку с собой.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','вервь'
end
--- page.537 ---------------------------------

# page.538
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Оставив тупик, идёте <a l:href="#n_502">дальше по коридору</a>.</p>}
--- page.538 ---------------------------------

# page.539
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Затаившись, лежите вы среди корней, пока не прекращается сверкающий поток. Что-то живое и, кажется, опасное спикировало на вас — и улетело прочь... Ладно, вам совсем не хочется выяснять, что это было. Кажется, можно <a l:href="#n_423">идти дальше</a> — навстречу ветерку, который пахнет морской солью и водорослями.</p>}
--- page.539 ---------------------------------

# page.540
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Обиднее всего, что по кустам вы ползали зря. Поиски не увенчались успехом. Придётся <a l:href="#n_447">идти дальше</a>.</p>}
--- page.540 ---------------------------------

# page.541
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стена леса смыкается за вашей спиной, но теперь перед вами нет никакой тропинки. Побродив наугад в густом подлеске, вы понимаете, что <a l:href="#n_173">заблудились</a> и не представляете себе, в какой стороне осталась поляна.</p>}
--- page.541 ---------------------------------

# page.542
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Коридор уверенно ведёт вперёд. Время от времени в трещинах стен замечаете что-то живое, копошащееся, но напасть зверьё опасается: вероятно, вы слишком крупная добыча.
     Справа резко пахнуло чистым ветром, особенно сладким после затхлого воздуха подземных переходов. В стене — пролом в человеческий рост. Встав меж растрескавшихся каменных глыб, вы с высоты двадцати метров <a l:href="#n_18">оглядываете окрестности</a>.</p>}
--- page.542 ---------------------------------

# page.543
$lvar['заголовок']={Мир Легенд<avs_source src="[avs-game:389|413:avs-game]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Что ж, сыграйте ещё партию. Выиграете или проиграете?</p>}
--- page.543 ---------------------------------

# page.544
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;На вашем месте многие стали бы палить в гнездо слежения — и погибли бы. Но вы, офицер Космического Патруля, знаете, как устроена эта система защиты и как её можно повредить. Узкий луч вонзается в стену выше и левее двери — и гнездо слежения становится чёрным, мёртвым. <a l:href="#n_416">Порядок</a>!</p>}
--- page.544 ---------------------------------

# page.545
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Закон Мерфи срабатывает с отвратительной точностью: ветка, не выдержав двойного веса, с треском ломается. Вы с незнакомцем шмякаетесь под ноги преследователям.
     Бедняге, которого вы пытались спасти, тут же связывают руки, а с вами выходит некоторая заминка...
     
     <font color=#339900>ПРОВЕРЬТЕ СВОЁ ОБАЯНИЕ.</font> Удастся вам убедить толпу, что вы всего лишь безобидный путник, случайно оказавшийся здесь? Или не удастся?</p>
   
   <center>[social]141|213[/social]</center>}
--- page.545 ---------------------------------

# page.546
$lvar['luck']=$args[0]
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Подтянувшись на руках, легко взбираетесь в невысокую, но широкую нишу. Темнотища — хоть глаз выколи! На ощупь изучаете вы холодные камни вокруг...
<DIN1:$result=$func('luck',$lvar['luck'],330,286):1DIN></p>}
--- page.546 ---------------------------------

# page.547
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Едва упав на землю, семя дает крепкий, мясистый росток. Он рвется ввысь, на глазах превращаясь в пышный куст, который всеми ветвями вцепляется в вашего врага. Почуяв серьёзного противника, вампир отпускает вашу руку. Отойдя на шаг, вы с невольным восхищением следите за схваткой двух свирепых растений. Продолжается она недолго. Зелёный воин сокрушает полупрозрачного кровопийцу — и засыхает на ваших глазах.
     Можно идти по тропинке дальше — <a l:href="#n_475">на северо-запад</a>.</p>}
--- page.547 ---------------------------------

# page.548
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не очень-то умелый стрелок засел впереди: пуля свистит рядом, <a l:href="#n_356">не задев вас</a>.</p>}
--- page.548 ---------------------------------

# page.549
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Здесь какая-то непролазная чаща! Ободравшись[powernow]&nbsp;в кровь|[/powernow] о колючие кусты ([pow]-1[/pow]), [powernow]вы всё же огибаете деревню незамеченным и благополучно <a l:href="#n_473">выбираетесь на дорогу</a>|вы теряете сознание от кровопотери.[/powernow].</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
--- page.549 ---------------------------------

# page.550
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;К счастью, вам удаётся добраться до развилки незамеченным. Свернув в другой коридор, вы <a l:href="#n_98">удваиваете бдительность</a>. Теперь вы точно знаете, что подземные коридоры обыскиваются пиратами.</p>}
--- page.550 ---------------------------------

# page.551
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Сначала вы пытаетесь придерживаться прежнего направления, но это трудно: то приходится огибать поваленное дерево, то обходить крошечное лесное озерко, то ломиться сквозь густой подлесок... А потом уже поздно — лес подхватил и закружил вас, заставил <a l:href="#n_173">потерять ориентировку</a>.</p>}
--- page.551 ---------------------------------

# page.552
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;И вновь вы оказываетесь перед прежним выбором: идти <a l:href="#n_392">прямо по улице</a> или свернуть <a l:href="#n_256">направо в переулок</a>?</p>}
--- page.552 ---------------------------------

# page.553
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Барон в растерянности.
     «Обвинить рыцаря — дело нешуточное. Однако... клятва Небесным Мечом...»
     Внезапно от двери раздается гулкий голос:
     «Сэр Майор имеет право доказать своё благородное происхождение с оружием в руках!»
     Вы оборачиваетесь. Задевая рогатым шлемом высокую притолоку, на пороге стоит мрачный верзила в кожаной куртке, расшитой круглыми металлическими бляхами. Похоже, он слышал весь разговор и теперь готов влезть не в своё дело.
     «Я, Эйнар Чёрный Щит, могу оказать сэру Майору услугу и встать против него в честном поединке. Если рыцарь выйдет из боя победителем — значит, он был жертвой клеветы!»
     «Суд Божий мечом? — оживляется барон. — Прекрасно, сэр Эйнар, благодарю тебя... Слышишь, сэр Майор? Согласен ты с этим решением?»
     <a l:href="#n_261">Примете вызов</a>? Или наотрез <a l:href="#n_485">откажетесь драться</a> с этим двурогим буйволом?</p>}
--- page.553 ---------------------------------

# page.554
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Чудовищные клыки сминают и перемалывают вас. Какая ужасная смерть!</p>}
--- page.554 ---------------------------------

# page.555
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Секунду поколебавшись, вы храбро откусываете кусочек... затем ещё и ещё... Вкус необычен, но так приятен, что вы и не замечаете, как съедаете всё целиком. И тут же чувствуете, что голод пропал, да и усталость как рукой сняло (СИЛА восстанавливается до первоначального уровня).
     Жаль, что нельзя достать ещё несколько таких плодов. На всякий случай трогаете нижние ветви ближайшего дерева, но они такие хрупкие, что ломаются в пальцах.
     Клуша раздраженно напоминает, что преступник Бронсон на дереве не сидит... Она права, вам <a l:href="#n_415">надо спешить</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',power['start']-power['now']
end
--- page.555 ---------------------------------

# page.556
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Комната пуста, в ней нет даже мебели. По толстому слою пыли на полу видно, что не были здесь давно. Бежали, вероятно, от ужасов войны... Лишь валяется на высоком подоконнике предмет, напоминающий теннисную ракетку, — инвентарь для какой-нибудь игры, забытый при эвакуации. А рядом на полу — аккуратно свёрнутый моток тонкой оранжевой верёвки. Она выглядит какой-то несерьёзной (тоже, наверное, для игры). Впрочем, на разрыв верёвка оказывается прочной и, вероятно, сможет выдержать солидную тяжесть.
     Если хотите, возьмите ракетку и моток с собой. Больше в комнате делать нечего, и вы её покидаете. <a l:href="#n_400">Выйдете на улицу</a> или <a l:href="#n_128">подниметесь на второй этаж</a>?</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','вервь','','[оранжевая]'
	gosub 'crt.obj','ракетка'
end
--- page.556 ---------------------------------

# page.557
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Рыцарь не преследует вас и вскоре остаётся за поворотом дороги. Вы замедляете ход, но продолжаете идти дальше — судя по солнцу, <a l:href="#n_364">на север</a>.</p>}
--- page.557 ---------------------------------

# page.558
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы отходите не так уж далеко — и видите, что коридор перед вами раздваивается. Куда вы пойдёте: <a l:href="#n_602">прямо</a> или <a l:href="#n_442">налево</a>?</p>}
--- page.558 ---------------------------------

# page.559
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Запас кислорода в баллончике невелик, его в обрез хватает, чтобы добраться <a l:href="#n_315">до подводной пещеры</a>.</p>}
--- page.559 ---------------------------------

# page.560
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы удачно проскакиваете опасную зону меж двумя пулемётными очередями — и вдруг видите, что прямо перед вами по мостовой растекаются клубы густого багрового дыма. <a l:href="#n_168">Газовая атака</a>!</p>}
--- page.560 ---------------------------------

# page.561
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропинка вьётся меж деревьев — и выводит вас на маленькую круглую <a l:href="#n_329">полянку</a>.</p>}
--- page.561 ---------------------------------

# page.562
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#339900>ПРОВЕРЬТЕ СВОЮ ЛОВКОСТЬ</font>. Бросьте кубик дважды. Если сумма выпавших чисел больше вашей ЛОВКОСТИ, то вы промахнулись. Если меньше или равна ей, то ваш нож попал в сердце противника.</p>

<center>[fast]50|282[/fast]</center>}
:переписать
--- page.562 ---------------------------------

# page.563
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Липкая белая верёвка обвивает ваши предплечья и локти, прижав их к телу, а вторая петля перехватывает горло. В глазах темнеет, вы теряете сознание...
     Придя в себя, обнаруживаете, что крепко связаны по рукам и ногам. Поднимаете глаза, ожидая увидеть над собой чудовище, готовое поужинать... Вам отвечает взгляд смеющихся карих глаз. Вы вспоминаете лицо на экране в кабинете шефа — и выдаете монолог, какого сами от себя не ожидали.
     Мэри Коуфорд выслушивает всё с улыбкой и, тряхнув каштановой стрижкой, отвечает:
     «Ох, майор, ну и манеры у вас... Кстати, я охотилась по способу местных пауков. Тут один шестилапый симпатяга вздумал кидать в меня петли... от него в наследство эти веревочки мне и достались... Ну-ну, майор, лежите смирно. Я не паук, не ем старых знакомых. Просто оставлю вас тут. Будем надеяться, что найдут вас не хищники, а здешние стрекозы. Они, по слухам, гуманные или добрые. Или муравьи сюда забредут, они человечину вроде не едят».
     Мэри небрежно заглядывает в ваш рюкзак, а затем ставит его на траву рядом с вами.
     «Ладно, не будем разменивать крупное дело на мелкие кражи. Всего доброго, майор! И не гоняйтесь за моей дичью!»
     Она удаляется легкой походкой, <a l:href="#n_219">оставив вас</a> изнемогать от бессильной ярости.</p>}
--- page.563 ---------------------------------

# page.564
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы уже <a l:href="#n_456">собираетесь уходить</a>, но видите, что у ваших ног валяется серебристая продолговатая коробочка — вероятно, выпала из кармана у кого-то из ваших противников. С любопытством поднимаете странный предмет. Крышка «пенальчика» сдвигается, открыв взору сложную техническую начинку. Клуша моментально разбирается в устройстве находки и сообщает, что принцип работы этой штуки ей ясен. Это воровское устройство, вибромагнитная отмычка. На Земле преступники пользуются схожими приспособлениями. Вы, конечно, не взломщик, но вдруг когда-нибудь вам понадобится взломать замок.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','во'
end
--- page.564 ---------------------------------

# page.565
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Недовольно поджав губы, старушка уходит, а вас отводят на сеновал и устраивают на ночлег. Зарывшись в мягкое ароматное сено, вы <a l:href="#n_245">засыпаете</a> ([pow]2[/pow]).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',2
end
--- page.565 ---------------------------------

# page.566
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Громадные глыбы обрушиваются на вас, грохот эхом отдается в коридоре — и всё стихает. Ваше путешествие окончено.</p>}
--- page.566 ---------------------------------

# page.567
$lvar['заголовок']={Мир Стрекоз}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<DIN1:$args[999]=$func('prv.obj.inBag','шар')
if cube=1 or cube=2 or cube=3:
	$result='C любопытством вы осматриваете свою <a href="exec:gosub ''put.obj'','''+$args[999]+''',''//nope.goto//'' & time[''goto'']=1 & goto ''page.159''" class="plain">находку</a>. Чтож, могло попасться и что похуже.'
else
	$result='С сомнением вы осматриваете свою <a href="exec:gosub ''put.obj'','''+$args[999]+''',''//nope.goto//'' & time[''goto'']=1 & goto ''page.511''" class="plain">находку</a>. Конечно? раз на раз не приходится. Могло попасться и что получше. Но, ничего не поделать.'
end:1DIN>.</p>}
--- page.567 ---------------------------------

# page.568
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вскоре вы выходите на выложенную камешками <a l:href="#n_387">дорожку</a>... но та ли это дорожка, по которой вы шли раньше?</p>}
--- page.568 ---------------------------------

# page.569
$lvar['заголовок']={Мир Легенд<avs_source src="[putlock:[шлем]:putlock]"><checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не успеваете выйти на середину дороги, как в поле зрения попадает первый путник. На нём потрепанная кожаная куртка и невзрачные кожаные штаны, но ошибиться нельзя: это рыцарь. На голове у него громадный шлем, на остром шишаке которого укреплен темно-красный плюмаж, похожий на крашеные метелки ковыля. На поясе — широкий, но короткий меч (пожалуй, не длиннее вашего ножа).
      <DIN1:if $tvar['шлем']="":
		$args['шлем']=$func('prv.bag','\[шлем\]','regexp')
		if $args['шлем']<>'' and instr($object_array[arrpos('$id_array',$args['шлем'])],'[:голова:]')<>0:
			$tvar['шлем']='И у вас на голове красуется <a l:href="#n_285">шлем</a>. Пожалуй вы тоже можете сойти за рыцаря.'
		else
			$tvar['шлем']='Вы бы тоже могли сойти за рыцаря, <a l:href="#n_189">будь у вас на голове</a> шлем.'
		end
		if $args['шлем']<>'' and instr($object_array[arrpos('$id_array',$args['шлем'])],'[:голова:]')=0:
			$tvar['шлем']+=' (<font color=#004400><i>Рыцарь уже заметил вас, так что надевать шлем теперь было бы глупо.</i></font>)'
		end
	end
	$result=$tvar['шлем']:1DIN></p>}
--- page.569 ---------------------------------

# page.570
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ножом тут не отобьешься... Если [blaster]1|[usebl]1|246|бластер[/usebl]|бластер[/blaster]</a> заряжен, можно расчистить себе путь. Иначе <a l:href="#n_314">прорыв</a> будет очень неприятным и опасным... А может быть, вы знаете способ разогнать пауков?</p>}
--- page.570 ---------------------------------

# page.571
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вот и рассвет. Ёжась от утренней сырости, вы долго ходите по морскому берегу. Голые скалы, песок, сухие водоросли... Наклонившись над обрывом, видите внизу, метрах в десяти, длинный широкий карниз. Хотите его <a l:href="#n_35">обследовать</a> или <a l:href="#n_103">пойдёте дальше</a> берегом?</p>}
--- page.571 ---------------------------------

# page.572
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хотите идти по подземному рельсовому пути? В таком случае — <a l:href="#n_420">налево</a> или <a l:href="#n_647">направо</a> вы двинетесь?</p>}
--- page.572 ---------------------------------

# page.573
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы спешите <a l:href="#n_13">спрятаться в подлеске</a>, но, прежде чем заросли укрывают вас от дракона, огненная струя успевает ударить в спину (ожоги уменьшат вашу СИЛУ на 4).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-4
end
--- page.573 ---------------------------------

# page.574
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Незнакомец встревожено останавливается. Он явно почуял что-то неладное. Раздумывать некогда, надо <a l:href="#n_142">действовать</a>!</p>}
--- page.574 ---------------------------------

# page.575
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вот у вас и <a l:href="#n_43">фляга</a>, к тому же она не занимает места в рюкзаке. За водой стрекоза быстро слетала к соседнему роднику. Правда, фляга вмещает воды лишь на 2 глотка, зато каждый глоток в любое время пути увеличит вашу СИЛУ на 2.</p>}
--- page.575 ---------------------------------

# page.576
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Где-то впереди — слабый свет. Вы прибавляете шагу. Тоннель, по которому вы идёте, поворачивает налево и <a l:href="#n_300">вливается в другой, более широкий</a>.</p>}
--- page.576 ---------------------------------

# page.577
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Рыцарь осторожно берёт с вашей ладони оранжевый бант. В глазах его гаснет безумная злоба.
     «Желание Прекрасной Дамы — закон для её рыцаря. Если несравненной госпоже Горфриде угодно, чтобы Затерянную Часовню посетил паломник, её воля будет исполнена. Очисти свой разум от недостойных помышлений, странник, и с открытым сердцем <a l:href="#n_149">переступи запретный порог</a>...»</p>}
if здесь_был[$curloc]=0:
	$args['вервь']=$func('prv.obj.inBag','бант_оранжевый')
	if $args['вервь']!'':
		! выбрасываем
		gosub 'put.obj',$args['вервь'],'//nope.goto//'
		! удаляем
		gosub 'del.obj.id',$args['вервь']
	end
	gosub 'knew.fin','бертольд'
end
--- page.577 ---------------------------------

# page.578
$lvar['заголовок']={Мир Камней<avs_source src="[useof:[огнетушитель]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В воздухе стоит странный густой запах. Не сразу определяете вы, что он идёт от тёмных широких полос на стене. По полу, потолку и стенам коридора ползают, оставляя влажные следы, крупные существа, напоминающие улиток. Не слишком приятное зрелище... Вы хотите прибавить шагу, но тут впереди вдоль стен вспыхивает огненный полукруг... Вот уже горит и пол... Вот как охотятся эти твари! Выделяют самовоспламеняющуюся жидкость и поджаривают дичь живьём!
     <DIN1:$args['pos.bl']=$func('prv.obj.inBag','огнетушитель')
		! проверяем заряды
		if $args['pos.bl']!"":
			$result='Вы можете сбить пламя огнетушителем, что лежит у вас в сумке. Но, если вы не хотите этого делать'
		else
			$result='Было бы у вас, чем потушить огонь, и выпутаться из этой передряги оказалось бы несложно. Но ничего подходящего нет'
		end:1DIN>, придётся <a l:href="#n_174">прорываться сквозь пламя</a>.</p>}
--- page.578 ---------------------------------

# page.579
$lvar['заголовок']={Мир Легенд<avs_source src="[avs-game:389|281:avs-game]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Правила игры просты. Бросьте кубик дважды за себя и дважды за своего партнера. Если сумма чисел, выпавших у вас, окажется больше, чем у противника, вы выиграли. Если же ему выпадет больше очков, то выиграл он.</p>}
--- page.579 ---------------------------------

# page.580
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Решетка крепче, чем выглядит ([pow]-1[/pow]). [powernow]Наконец, вы отбрасываете её в сторону и спрыгиваете в подвал. При виде вас старуха испуганно прижимается к кирпичной стене.
     <font color=#339900>ПРОВЕРЬТЕ СВОЁ ОБАЯНИЕ.</font> Удастся вам убедить старуху в том, что вы не желаете ей зла, или не удастся?|[/powernow]</p>[powernow]<p align=center><br>[social]32|152[/social]</p>|[/powernow]}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
--- page.580 ---------------------------------

# page.581
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Этот уровень — царство механиков. Здесь работали люди, отвечавшие за функционирование всех систем корабля. Вот слева приоткрыта дверь в каюту, видна вешалка, на ней — оранжевый рабочий комбинезон и клеенчатая сумка механика. На всякий случай заглядываете в сумку. Она пуста, но в боковом кармашке — герметически закрытый тюбик питательной пасты. В такой упаковке паста может храниться чуть ли не вечно. Сейчас, как и четыреста лет назад, она годится в пищу и в любой момент восстановит вашу СИЛУ до первоначального уровня.
     Поздравив себя с находкой, протягиваете руку к следующей двери. Но открыть её <a l:href="#n_457">не успеваете</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','питательная_паста'
end
--- page.581 ---------------------------------

# page.582
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Спиной к стене, очень осторожно пробираетесь вы по карнизу. Дважды под ногами обрушиваются камни и с плеском падают в озеро. Но, извернувшись, вы каждый раз удерживаетесь на карнизе.
     В противоположной стене грота обнаруживаете широкую щель и протискиваетесь в неё. Щель расширяется и превращается в <a l:href="#n_222">коридор</a>.</p>}
--- page.582 ---------------------------------

# page.583
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы легко догоняете аборигена, но он не намерен с вами разговаривать. Бросив в траву свою ношу, муравей поудобнее перехватывает заостренную палку.</p>

<center><font size=+1>МУРАВЕЙ

ЛОВКОСТЬ 9     СИЛА 8</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['заголовок']={Мир Стрекоз<avs-enemy><non-blaster>}
$lvar['exit']='page.351'	&	!	название локации, на которую можно перейти в случае победы.
$lvar['динамический код']={
if $args[0]='!war.ratchdown!':
	if GAME_WAR['ratch.power.'+$temp_id[0]]<3:
		$GAME_WAR['thiswar.'+$curloc]='victory'
		$GAME_WAR['prewin.txt']='Его сила упала до двух! Ура!!!'
		$GAME_WAR['exit.'+$curloc]='page.351'
	end
end
}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','муравей','','<ratch>'
end
--- page.583 ---------------------------------

# page.584
$lvar['заголовок']={Мир Роботов<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Пройдя квартал, видите приземистое здание, которое обвивает каменный дракон. Заинтересовавшись, заглядываете внутрь. Здание, украшенное жутковатой статуей, оказывается обычным входом в метро. Хотите <a l:href="#n_616">спуститься</a> туда или пройдёте <a l:href="#n_232">мимо</a>?</p>}
--- page.584 ---------------------------------

# page.585
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Обогнув замок, устраиваетесь на ночлег в придорожных кустах. Огонь разводить нельзя: могут заметить из замка. Ночь не очень холодная, но на вас обрушивается иная напасть: тучами налетают насекомые, похожие на земных комаров, но размером с крупных пчел... Если есть какое-нибудь средство для отпугивания насекомых, пустите его в ход. Иначе вам <a l:href="#n_233">придётся скверно</a>.</p>}
--- page.585 ---------------------------------

# page.586
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Интересно, кто и зачем устроил этот <a l:href="#n_538">тайник</a>? В ящике две банки консервов (каждая прибавит 5 к вашей СИЛЕ), одноразовый тюбик пасты для заживления (она увеличит СИЛУ на 6, но применять её можно только после боя — от голода и усталости паста не поможет). Но главное, ваш неизвестный благодетель позаботился об оружии. В ящичке лежит протонная граната. Конечно, помочь она может не во всякой драке — только если под рукой есть укрытие. <!--Если захотите бросить гранату, прибавьте 60 к номеру параграфа, на котором будете находиться.--></p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','консервы'
	gosub 'crt.obj','консервы'
	gosub 'crt.obj','протонная_граната'
	gosub 'crt.obj','лечебная_паста'
end
--- page.586 ---------------------------------

# page.587
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Сытная еда увеличит СИЛУ на 5. А если в рюкзаке найдется место, возьмите в дорогу кусок жареного мяса. В любую минуту он прибавит 3 к вашей СИЛЕ.
     А теперь пора <a l:href="#n_623">идти дальше</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',5
	gosub 'crt.obj','мясо1'
end
--- page.587 ---------------------------------

# page.588
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хоть отмычка и сконструирована в преступных целях, всё же вы поминаете добрым словом её изобретателя. Легкое жужжание — и <a l:href="#n_92">дверь отпирается</a>.</p>}
--- page.588 ---------------------------------

# page.589
$lvar['заголовок']={Мир Легенд<lock.obj>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стражник салютует вам алебардой.
     «Приветствую тебя, о доблестный рыцарь! — говорит он. — Господин мой, барон Брайт Могучий, всегда рад гостям. Проследуй в пиршественный зал, там уже веселятся благородные рыцари».
     И делает шаг в сторону, уступая вам дорогу. Да, порядки здесь простые. Даже именем вашим не поинтересовался.
     Просторный двор полон слуг: кто-то крутится у костра, над которым жарится туша шестиногого зверя размером с корову, кто-то тащит вязанку хвороста, кто-то несёт бадейку с водой, а кто-то, кажется, вообще ничего не делает, только валяет дурака и увеличивает общую сумятицу.
     Чувствуя себя важной персоной, направляетесь к высокой двери, из-за которой доносятся весёлые крики и музыка (причем крики заметно перекрывают музыку). На пороге вас встречает пышно разодетый сухонький старичок с жезлом, украшенным перьями, — мажордом барона. Он просит вас сообщить своё имя и цель прибытия, дабы он смог достойным образом доложить о вас.
     Вас уже начинают раздражать игры в средневековье. В конце концов, это же потомки землян! Вы кратко объясняете старику, кто вы такой и зачем прибыли сюда. Тот понимающе кивает и исчезает за дверью. Через минуту вы слышите его надтреснутый петушиный голос:
     «Сэр Майор! Путешествует по обету!»
     Что ж, придётся всё-таки играть роль странствующего рыцаря...
     Входите в просторный, с низким каменным потолком, зал — и вас оглушает рёв полусотни глоток.
     Ой, ну и зрелище! «Дух истинного рыцарства»? Да это больше похоже на маскарад в сумасшедшем доме! Хорошо, что вы, в шлеме, так не идущем к вашей одежде, не выглядите здесь развеселым исключением. Тут есть типчики и почуднее. Например, рыжий верзила, водрузивший себе на шлем чучело огненно-красной птицы. Длинные крылья её свисают по обе стороны его лица, как уши у спаниеля. Или вон тот, толстый, в развевающемся зелёно-серебристом одеянии... прямо русалка, если бывают бородатые русалки... И все, несмотря на жару, в шлемах. Все, кроме хозяина.
     Барон поднимается из-за стола — громадный, коренастый, с абсолютно лысой головой и могучим загривком. Он вскидывает ручищу, требуя тишины.
	     <DIN1:if $tvar['плюмаж']='':
	$args['часть тела']=$func('prv.bag','\[шлем\]','regexp')
	! вычисляем строку части тела
	args['pot']=arrpos('$id_array',$args['часть тела'])
	! вычисляем строку шлема
	args['pit']=arrpos('$position_array',$id_array[args['pot']])
	! вычисляем строку плюмажа
	args['rot']=arrpos('$position_array',$id_array[args['pit']])
	! позиция, в которой лежит шлем, соответствует части тела. Ищем идентификатор части тела в таблице и проверяем голова ли это
	! так же проверяем присутствует ли в таблице дочерний шлему объект - плюмаж.
	if instr($object_array[args['pot']],'[:голова:]')!0 and instr($object_array[args['rot']],'[:плюмаж:]')!0:
		$tvar['плюмаж']='И произносит <a l:href="#n_648">следующее</a>...'
	else
		$tvar['плюмаж']='И произносит <a l:href="#n_429">следующее</a>...'
	end
end
$result=$tvar['плюмаж']:1DIN></p>}
--- page.589 ---------------------------------

# page.590
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Как ни осторожно вы стараетесь ползти, но всё же задеваете ненадёжные, насквозь пронизанные трещинами стены лаза чаще, чем вас хотелось бы... Наконец они не выдерживают и, с грохотом обрушиваясь, погребают вас под каменной осыпью.</p>}
--- page.590 ---------------------------------

# page.591
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В беге муравьи вам значительно уступают. Вскоре <a l:href="#n_135">погоня безнадежно отстает</a>. Вы можете остановиться и отдышаться.</p>}
--- page.591 ---------------------------------

# page.592
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Не успеваете отойти далеко, как впереди истошно воет сирена. Прямо на вас движется колонна небольших самоходных установок, покрытых защитного цвета бронёй. Надо срочно убираться с их пути. Но куда: в чернеющую справа <a l:href="#n_496">подворотню</a>? Или попробуете укрыться в <a l:href="#n_172">развалинах</a> по левую руку от вас?</p>}
--- page.592 ---------------------------------

# page.593
$lvar['заголовок']={Мир Легенд<avs_source src="[useof:[лист_вонючка]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорога здесь совсем узкая, ветви деревьев склоняются над ней, иногда приходится пригибаться там, где они сплетаются, преграждая вам путь. Преодолевая одно из таких живых препятствий, вы случайно задеваете головой бурый шар, покачивающийся на тонкой веточке. Раздается злобное гудение, и вокруг вас возникает рой рубиново-красных насекомых. Клуша торопливо сообщает, что насекомые эти близки к земным осам, а вы потревожили их гнездо... Ну, это вы и без Клуши поняли.
     В отличие от своей земной родни, гудящие крылатые чудовища не спешат нападать. Красным облаком пляшут они вокруг вас, примериваясь и прицеливаясь.
     <DIN1:$args['pos.bl']=$func('prv.obj.inBag','лист_вонючка')
		! проверяем заряды
		if $args['pos.bl']!"":
			$result='У вас ведь есть средство от насекомых, скорее пустите его в ход! Иначе'
		else
			$result='К сожалению, вам нечем отпугнуть насекомых, а значит'
		end:1DIN> <a l:href="#n_327">придётся туго</a>.</p>}
--- page.593 ---------------------------------

# page.594
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы перемахиваете через впадину (и через ошарашенную тварь) и <a l:href="#n_34">продолжаете путь</a>. Зверюга не решается вас преследовать.</p>}
--- page.594 ---------------------------------

# page.595
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;За развилкой тропка теряется в траве и кустах. Вы топчетесь на месте, пытаясь найти её... и вдруг с неба доносится шипение и скрежет. Над вашей головой парит существо, похожее на бабочку, но размером с крупного орла. Впрочем, сходство исчезает, когда существо, сложив крылья, пикирует на вас. Теперь ваше внимание привлекает лишь длинный прямой рог, нацеленный прямо на вас. Промахнувшись, свирепая бабочка у самой земли выравнивает полет и начинает разворачиваться для повторной атаки.
     <a l:href="#n_195">Броситесь бежать</a> или <a l:href="#n_627">примете бой</a>?</p>}
--- page.595 ---------------------------------

# page.596
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;За массивным зданием — другое, не менее своеобразное: на плоской крыше его возвышается чёрная статуя грифона. Крылья мифического чудовища прижаты к бокам, львиное туловище напряжено для прыжка... Вы не знаете, что об этом думать, но внутри здание оказывается обычной станцией метро. Хотите <a l:href="#n_56">спуститься вниз</a> по мраморной лестнице или выйдете наружу и пойдёте <a l:href="#n_232">дальше по улице</a>?</p>}
--- page.596 ---------------------------------

# page.597
$lvar['заголовок']={Мир Легенд<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вам приносят жареное мясо и вино. Мясо прибавит 5 к вашей СИЛЕ, а если вы не голодны, можете взять еду с собой.
     Вы пытаетесь расспросить хозяина о Бронсоне и Воротах, но тот либо ничего не знает, либо не любит болтать лишнего.
     Вы потягиваете кислое вино... и внезапно замечаете, что незнакомец в сером плаще, подняв голову, с интересом вас разглядывает. Посетитель таверны молод, широкоплеч, по сброшенному капюшону рассыпаются длинные русые волосы. Карие глаза смотрят прямо, дерзко.
     <DIN1:if $tvar['шлем']='':
	$args['часть тела']=$func('prv.bag','\[шлем\]','regexp')
	! вычисляем строку части тела
	args['pot']=arrpos('$id_array',$args['часть тела'])
	if instr($object_array[args['pot']],'[:голова:]')!0:
		$tvar['шлем']='Вы пришли в таверну <a l:href="#n_171">в рыцарском шлеме</a> или без него?'
	else
		$tvar['шлем']='Вы пришли в таверну в рыцарском шлеме или <a l:href="#n_81">без него</a>?'
	end
end
$result=$tvar['шлем']:1DIN></p>}
--- page.597 ---------------------------------

# page.599
$lvar['заголовок']={Мир Стрекоз<avs_source src="[useof:[подводная_маска] [жидкость]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Что будете делать дальше? Может быть, у вас есть водолазная маска или какое-нибудь средство, позволяющее дышать под водой? Или ничего подобного <a l:href="#n_363">нет</a>?</p>}
--- page.599 ---------------------------------

# page.600
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы не успеваете отпрыгнуть, и часть стены [powernow]<a l:href="#n_208">обрушивается на вас</a>|обрушивается на вас[/powernow] ([pow]-3[/pow]).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-3
end
--- page.600 ---------------------------------

# page.601
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Погоня вихрем проносится под деревом. Человечек улепётывает шустро — похоже, подобные приключения ему не в новинку. Добравшись до чащи, он скрывается в подлеске, и толпа, побесновавшись на опушке, убирается в сторону деревни.
     Выждав немного, спускаетесь с дерева. Что-то расхотелось вам посещать эту тихую деревушку. Может быть, там принято подобным образом встречать всех путников? Пожалуй, безопаснее будет направиться <a l:href="#n_69">к лесу</a>.</p>}
--- page.601 ---------------------------------

# page.602
$lvar['заголовок']={Мир Камней<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Да сколько же здесь этих развилок! Вот опять тоннель перед вами раздваивается. Два коридора бегут почти в одном направлении. Какой изберёте: <a l:href="#n_86">левый</a> или <a l:href="#n_298">правый</a>?</p>}
--- page.602 ---------------------------------

# page.603
$lvar['заголовок']={Мир Стрекоз}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
if cube=2 or cube=4 or cube=6:
	args['page']=107
else
	args['page']=183
end
$lvar['исходник']="<p align=justify>[knew]мв|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Жаль, что при Переходе нельзя воспользоваться Модификатором Вероятностей. Любопытно было бы спросить, почему, но если этот вопрос задать Клуше, она тут же завалит вас энциклопедическими выкладками и кучей непонятных терминов. Лучше тогда вообще обходиться без модификатора. Лекции по теории вероятносетй слушать некогда, да и нет желания.
     И всё же откуда начнётся ваш путь в этом мире? [page=<<args['page']>>]Куда[/page] завёл вас Переход?|"+$func('base.txt','vm',args['page'])+"[/knew]</p>"
--- page.603 ---------------------------------

# page.604
$lvar['заголовок']={Исследовательская станция}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дорогу преграждает баррикада, сооружённая из обломков мебели и пластикатовых кусков обшивки, выдранных из стены. Кто это сделал, зачем?.. Вы наклоняетесь, чтобы разобрать это нелепое препятствие...
     Нет, этого делать не стоит: из пластиката кое-где торчат серебристые полоски оборванных энерговодов. А вдруг хоть один ещё подсоединен к обшивке? Так шарахнет!.. Безопасней повернуться и пойти по коридору <a l:href="#n_192">в противоположную сторону</a>.</p>}
--- page.604 ---------------------------------

# page.605
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Такой человек не забредал в замок, — с сожалением говорит баронесса, выслушав описание внешности Бронсона. — Я наверняка знала бы об этом. Жизнь здесь скучная, муж вечно пирует с соседями или охотится. Вот я и беседую со всеми путниками, что заходят сюда. Всё-таки развлечение... Вот ты, например, — <a l:href="#n_33">кто ты таков</a>, добрый человек?»</p>}
--- page.605 ---------------------------------

# page.606
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Начинается бешеная пальба, пули так и свистят вокруг, полумрак пещеры полосуют разряды бластеров. К счастью, пираты слишком ошарашены. Скорее всего, они просто не поняли, что за тень пронеслась над их головами. Ни один из выстрелов <a l:href="#n_202">не достигает цели</a>.</p>}
--- page.606 ---------------------------------

# page.607
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Заросли становятся всё реже; ветер доносит до вас запах, который ни с чем нельзя спутать, — запах солёной воды и водорослей. Так пахнет ветер с моря и на вашей родной планете! На миг вы расслабляетесь — и тут же над вашей головой свистит петля...</p>

<p align=center><font color=#339900>ПРОВЕРЬТЕ СВОЮ ЛОВКОСТЬ</font>.

[fast]83|563[/fast]</p>}
--- page.607 ---------------------------------

# page.608
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Умница Клуша моментально высчитывает уязвимое место установки — узкую смотровую щель. Точный выстрел — и жуткий гибрид сейфа с мясорубкой останавливается, всё медленнее вращая смертоносную крестовину. Путь <a l:href="#n_520">вперёд</a> открыт!</p>}
--- page.608 ---------------------------------

# page.609
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;После долгих поисков замечаете у корней гиганта-дерева полузаросшую тропку, бегущую на восток. Пойдёте <a l:href="#n_533">по ней</a> или предпочтёте ломиться напрямик <a l:href="#n_477">на север</a>, откуда пахнет речной свежестью?</p>}
--- page.609 ---------------------------------

# page.610
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы так и не узнаете, чьи же скользкие лапы с когтями и перепонками вцепились в вас, стиснули, уволокли на дно... и кто вами в конце концов пообедал.</p>}
--- page.610 ---------------------------------

# page.611
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Стрекоза увлечённо начинает долгий рассказ о селекции, о редких видах растений. Увы, в этом вопросе вы не слишком разбираетесь...
     <DIN1:$args['семена']=$func('prv.obj.inBag','семена')
if $args['семена']!'':
	$result='У вас ещё остались «семена-убийцы», а значит вы сможете <a l:href="#n_179">поддержать беседу</a>: покажите стрекозе своё «сокровище». Если не хотите этого сделать'
else
	$result='Вы не знаете ничего о разведении растений, и не знаете как поддержать беседу, поэтому'
end
end:1DIN> — потихоньку <a l:href="#n_43">закругляйте разговор</a> и собирайтесь в путь.</p>}
--- page.611 ---------------------------------

# page.612
$lvar['заголовок']={Мир Роботов<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Зря вы это затеяли! Кто бы ни был ваш противник — он знает эти места лучше вас. И умеет затаиться... Грохочет второй выстрел — и оказывается точнее первого.</p>}
--- page.612 ---------------------------------

# page.613
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Костёр пляшет в ночном мраке, делая всё кругом привычным, уютным, земным. Сначала вас тревожат мелькающие среди деревьев зелёные глаза каких-то животных. Но вскоре вы понимаете, что зверьё боится огня, и спокойно засыпаете ([pow]1[/pow]).
     А утром, затоптав догорающий костёр, вновь пускаетесь <a l:href="#n_401">в дорогу</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',1
end
--- page.613 ---------------------------------

# page.614
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Обвал грохочет совсем близко, но, к счастью, ни одна глыба <a l:href="#n_338">не задевает вас</a>.</p>}
--- page.614 ---------------------------------

# page.615
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы пытаетесь укрыться меж скал от резкого ветра, приносящего ледяные брызги прибоя, но вам это не удаётся. Всю ночь вы <a l:href="#n_571">не смыкаете глаз</a>, стуча зубами и ворочаясь на жёстких камнях ([pow]-1[/pow]).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
--- page.615 ---------------------------------

# page.616
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Лестница превратилась в кашу из каменных обломков — вероятно, сюда залетел снаряд. Но целы металлические перила — фигурные, в виде драконов. Придерживаясь за чешуйчатый бок бронзового зверя, перепрыгивая с одной мраморной глыбы на другую, спускаетесь вниз.
     Сама станция сохранилась неплохо. И даже освещена слабенькой аварийной лампочкой — автономное питание, такие могут работать годами.
     Платформа рассечена монорельсовой колеёй, убегающей в два тоннеля. С одной половины платформы на другую переброшен мраморный мостик в виде сцепившихся драконов. Кажется, зверюги не дерутся, а играют: морды у них весёлые.
     Больше на станции нет ничего примечательного. Хотите <a l:href="#n_12">исследовать тоннели</a> или <a l:href="#n_184">не станете этого делать</a>?</p>}
--- page.616 ---------------------------------

# page.617
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a l:href="#n_249">Вода</a> изумительная — чистая, вкусная, ледяная ([pow]3[/pow]). <DIN1:$args['pos.bl']=$func('prv.obj.inBag','фляга')
if $args['pos.bl']!'' and $tvar['water']!'true':
	$result='У вас ведь есть фляга, можете её <a href="exec:$tvar[''water'']=''true'' & gosub ''flaga'',''<<$args["pos.bl"]>>'',''вода''" class="plain">наполнить</a>'
elseif $args['pos.bl']='':
	$result='Была бы у вас фляга, можно было бы её наполнить'
else
	$result='Вы достали флягу и наполнили её этой чудесной водой'
end:1DIN>.</p>}
if здесь_был[$curloc]=0:
	gosub 'power',3
end
--- page.617 ---------------------------------

# page.618
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Здесь немного темнее, но всё же можно различить дорогу. Поэтому взгляд без труда обнаруживает боковое ответвление, отбегающее направо от основного коридора. Хотите его <a l:href="#n_70">исследовать</a> или <a l:href="#n_542">продолжите путь</a>?</p>}
--- page.618 ---------------------------------

# page.619
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы склоняетесь над пахнущей мёдом жидкостью и берёте лист, чтобы поднести его ко рту. Тут же ваша ладонь плотно приклеивается к зелёной кожице. И сразу из-под листа вылетают три тонких и прочных щупальца и крепко впиваются в вас. Это растение-хищник, напоминающее земную <a l:href="#n_47">росянку</a>!</p>}
--- page.619 ---------------------------------

# page.620
$lvar['заголовок']={Исследовательская станция<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Попасть в центр связи не удаётся. Вы пытаетесь разблокировать пульт управления и вернуть станцию на прежнюю орбиту, но и тут терпите неудачу... Блестяще выполнить задание — и погибнуть на пороге успеха! Как обидно!</p>}
--- page.620 ---------------------------------

# page.621
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Солнце уже переваливает за полдень, когда вы набредаете на поляну, окруженную высокими кустиками, ветви которых усеяны бурыми ягодами. Не хотите ли их <a l:href="#n_421">попробовать</a>? Кстати, Клуша решительно против этого. Она тут же начинает читать вам лекцию о растительных ядах. Может быть, послушаетесь её и <a l:href="#n_241">уйдёте прочь</a>?</p>}
--- page.621 ---------------------------------

# page.622
$lvar['заголовок']={Мир Камней<avs-enemy>}
$lvar['исходник']={<center><font size=+1>СЕРЕБРИСТЫЙ ЗВЕРЬ

ЛОВКОСТЬ 9     СИЛА 10</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.126'	&	!	название локации, на которую можно перейти в случае победы.
if здесь_был[$curloc]=0:
	gosub 'crt.obj','зверь3','','<ratch>'
end
--- page.622 ---------------------------------

# page.623
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Тропинка бежит, не теряясь, в высокой траве и обрывается на маленькой <a l:href="#n_11">полянке</a>.</p>}
--- page.623 ---------------------------------

# page.624
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Дверь заперта. Попытаетесь <a l:href="#n_176">выломать её</a>? Если не хотите с нею возиться, можете попытаться <a l:href="#n_352">подняться по лестнице</a> на второй этаж или просто <a l:href="#n_584">покинуть подъезд</a>.</p>}
--- page.624 ---------------------------------

# page.625
$lvar['заголовок']={Мир Легенд<avs_source src="[useof:[бант_оранжевый]:useof]">}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;На поляне скособочилась сложенная из серых глыб часовенка с покосившимся крестом на крыше. Меж камнями пробиваются прямые и острые, как стрела, побеги.
     Рядом с часовенкой — маленький костёр, на котором жарится тушка шестиногого зверька размером с зайца. У огня спиной к вам сидит человек в чёрном плаще и серебристом шлеме. Заслышав ваши шаги, он вскакивает и хватается за меч.
     «Стой, путник! — возглашает он басом. — Кто бы ты ни был — стой! Я, рыцарь Бертольд из Соргейля, дал обет: охранять место сие, осенённое благодатью Господней, от кощунственного вторжения человеческого!»
     Глаза у него совершенно безумные. Фанатик.
     Согласитесь <a l:href="#n_205">уйти</a> или всё же хотите взглянуть на часовню? Тогда придётся <a l:href="#n_333">драться</a>. [knew]бертольд|Но вы ведь [page=577]наверняка знаете[/page], что сказать этому ненормальному?|Быть может и существует способ договориться с этим ненормальным, но вам ничего не приходит на ум.[/knew]</p>}
--- page.625 ---------------------------------

# page.626
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Раз здесь Паук — значит, вы рискуете нарваться на его разведчиков, обшаривающих окрестности...
     Точно в ответ на ваши мысли, впереди слышатся шаги. По коридоры разносится звонкое клацанье. Вы знаете, что такой звук издают магнитные подковки на обуви космонавтов — очень удобная вещь при невесомости...
     Пока не поздно, вернётесь к развилке и <a l:href="#n_550">изберёте другой путь</a>? Или постараетесь <a l:href="#n_78">спрятаться</a> в какой-нибудь из щелей, чтобы идущий навстречу человек не заметил вас?</p>}
--- page.626 ---------------------------------

# page.627
$lvar['заголовок']={Мир Стрекоз<avs-enemy>}
$lvar['исходник']={<center><font size=+1>«БАБОЧКА»

ЛОВКОСТЬ 8     СИЛА 8</font>

В любой момент вы можете <a l:href="#n_195">отступить</a>. Но, может быть, вам удастся победить противника.</center>}
lvar['штраф.ловк']=-1	&	!	возможный штраф к ловкости
$lvar['exit']='page.459'	&	!	название локации, на которую можно перейти в случае победы.
if здесь_был[$curloc]=0:
	gosub 'crt.obj','бабочка','','<ratch>'
end
--- page.627 ---------------------------------

# page.628
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],548,508):1DIN>"
--- page.628 ---------------------------------

# page.629
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Ни шагу дальше, о злосчастный путник! — восклицает Владычица Древнего Леса. — Страшная опасность ожидает тебя впереди! Свирепый, огнедышащий, неустрашимый дракон!»
     Вы благодарны за предупреждение и прикидываете, в какую сторону лучше исчезнуть. Золотоволосая незнакомка продолжает:
     «Чудовище сие охраняет <a l:href="#n_161">Заклятое Место</a>, где неведомые чародеи оставили колдовской знак: две медные чаши, меж коими струится волшебный свет... Это место гибельно для смертных, о путник!»</p>}
--- page.629 ---------------------------------

# page.630
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Слева, у самого пола, замечаете чёрное отверстие. Какой-то лаз... Нагнувшись, заглядываете туда — и присвистываете. Длинный, как труба, ход в скале, а стенки пестрят чёрными трещинами. Как они ещё до сих пор не обрушились? Но всё-таки интересно — куда ведёт этот лаз? Хотите это <a l:href="#n_134">выяснить</a>? Или не станете рисковать и <a l:href="#n_502">пойдёте дальше</a> по коридору?</p>}
--- page.630 ---------------------------------

# page.631
$lvar['заголовок']={Мир Стрекоз<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В раздумье расхаживаете вы по каменному карнизу, насвистывая «Гимн Космического Патруля». Внезапно по гладкой поверхности воды кругами разбегаются волны. В метре от вас всплывает странное существо, похожее на скользкий мешок с множеством перепончатых лапок. Очень неприятное существо. Оно зависает перед вами, точно ожидая чего-то. Пока не поздно, [blaster]1|[usebl]1|203|срежете его выстрелом из бластера[/usebl]|срежете его выстрелом из бластера[/blaster] (если, конечно, есть заряд)? <a l:href="#n_483">Швырнёте в него камнем</a>? Или попробуете <a l:href="#n_191">заговорить</a> с ним?</p>}
--- page.631 ---------------------------------

# page.632
$lvar['заголовок']={Исследовательская станция<avs-enemy>}
$lvar['исходник']={<p align=justify>     Сороконожка сражается передней парой лап с клешнями, причем каждый её выпад сопровождается волной боли и ужаса, накатывающей на ваш мозг.</p>

<center><font size=+1>СОРОКОНОЖКА

ЛОВКОСТЬ 12     СИЛА 6</font>

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.144'	&	!	название локации, на которую можно перейти в случае победы.
if здесь_был[$curloc]=0:
	gosub 'crt.obj','сороконожка0','','<ratch>'
end
--- page.632 ---------------------------------

# page.633
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Предупреждали же вас! Вы даже не успеваете дойти до чёрного замка Зигмунда Мрачного. Брошенная из кустов петля перехватывает горло, и вы приходите в себя уже в подземелье. При вас ни оружия, ни вещей, а сами вы прикованы к стене цепью. Зигмунд Мрачный приказывает держать вас <a l:href="#n_143">в темнице</a> до тех пор, пока кто-нибудь из ваших родных или друзей не внесёт выкуп.</p>}
$GAME_VALUE['interface']=''
--- page.633 ---------------------------------

# page.634
$lvar['заголовок']={Мир Камней<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы забыли, что Паук — негодяй осмотрительный. На всякий случай он посылает своих головорезов обшарить ближайшие тоннели и коридоры. Вас обнаруживают и убивают на месте. Теперь никто не помешает Пауку завладеть аннигилятором.
     Космическому Патрулю придётся долго бороться с бандитом, который метит в звёздные императоры. Увы, эта борьба будет идти уже без вашего участия.</p>}
--- page.634 ---------------------------------

# page.635
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;От потери крови вы теряете сознание и приходите в себя уже [page=523]в муравейнике[/page].</p>}
$GAME_VALUE['interface']=''
--- page.635 ---------------------------------

# page.636
$lvar['заголовок']={Мир Роботов<checkpoint>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Хотите исследовать <a l:href="#n_148">второй тоннель</a>? Или вам <a l:href="#n_184">надоели подземные приключения</a>?</p>}
--- page.636 ---------------------------------

# page.637
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;На свет появляется набор странных предметов: бархатный мешочек с двумя крупными, похожими на шишечки, семенами; серебряные кольцо с прозрачным камнем; небольшой синий кувшинчик с плотно притёртой пробкой; шёлковый пояс кошмарной пёстрой расцветки. И вам предлагают выбрать одну из этих вещей. Расспрашивать об их назначении неудобно, выбирать приходится наугад. Что возьмёте? <a l:href="#n_177">Мешочек с семенами</a>? <a l:href="#n_253">Кольцо</a>? <a l:href="#n_313">Кувшинчик</a>? <a l:href="#n_353">Пояс</a>? Или вежливо <a l:href="#n_101">откажетесь</a> от подарка?</p>}
--- page.637 ---------------------------------

# page.638
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вы идёте, осторожно придерживаясь рукою стены... и вдруг что-то вцепляется в эту руку и с силой тянет вас вперёд. Вас обвивает что-то гибкое, жёсткое и обжигающее ([pow]-5[/pow]). [powernow]С трудом вырвавшись, отступаете на безопасное расстояние. Будь здесь светло, вы бы показали этим тварям! Но драться во мраке с неизвестным противником... Нет уж, разумнее вернуться к повороту и пойти <a l:href="#n_602">другой дорогой</a>.|[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-5
end
--- page.638 ---------------------------------

# page.639
$lvar['заголовок']={Мир Стрекоз<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Все попытки освободиться бесполезны — корни разрывают вас на куски и растаскивают по норам. В этом мире каждое растение добывает удобрение по-своему...</p>}
--- page.639 ---------------------------------

# page.640
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Один конец верёвки закрепляете на ближайшей статуе, другой, завязанный петлей, набрасываете на острый обломок мрамора рядом с Воротами и <a l:href="#n_532">перебираетесь</a> на узкую площадку возле нижней чаши. Увы верёвку придётся здесь бросить: кто же отвяжет для вас её дальний конец?</p>}
if здесь_был[$curloc]=0:
! отдаём баронессе зеркало. Для этого:
	! ищем в рюкзаке
	$args['вервь']=$func('prv.obj.inBag','вервь')
	if $args['вервь']!'':
		! выбрасываем
		gosub 'put.obj',$args['вервь'],'//nope.goto//'
		! удаляем
		gosub 'del.obj.id',$args['вервь']
	end
end
--- page.640 ---------------------------------

# page.642
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Прыжок со скалы оказывается неудачным, вы подворачиваете ногу ([lovk]-1[/lovk]). Прихрамывая, возвращаетесь к развилке и сворачиваете <a l:href="#n_66">в другой коридор</a>.</p>}
if здесь_был[$curloc]=0:
	gosub 'lovk',-1
end
--- page.642 ---------------------------------

# page.643
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Поняв, что сделка не состоится, морской житель исчезает в бездне. Вы <a l:href="#n_599">остаётесь один</a> на каменном карнизе.</p>}
--- page.643 ---------------------------------

# page.644
$lvar['luck'] = $args[0]
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']="<DIN1:$result=$func('luck',$lvar['luck'],296,488):1DIN>"
--- page.644 ---------------------------------

# page.645
$lvar['заголовок']={Мир Легенд<avs-death>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Расшвыряв стражников, распахиваете дверь — и падаете со стрелой в груди. Во дворе вас поджидали арбалетчики.</p>}
--- page.645 ---------------------------------

# page.646
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Выхватываете бластер — и видите, что чудовище уже направило на вас что-то вроде небольшой пушки. Теперь главное — <a href='exec:gosub "blast.charge",-1 & time["goto"]=1 & goto "page.110"' class='plain'>выстрелить первым</a>.</p>}
--- page.646 ---------------------------------

# page.647
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Пройдя немного, обнаруживаете, что путь преграждает баррикада из каменных плит, вывороченных рельсов, металлических труб.
     Попробуете <a l:href="#n_164">разобрать баррикаду</a> или повернёте? В таком случае — направитесь во <a l:href="#n_420">второй вход в тоннель</a> или <a l:href="#n_76">оставите затею с исследованием метро</a>?</p>}
--- page.647 ---------------------------------

# page.648
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Добро пожаловать, сэр Майор... — начинает хозяин... и тут же, заметив ваш плюмаж, испускает зычный вопль: — Эй, доблестные рыцари! Нас почтил своим присутствием победитель Палеандра Неукротимого!»
     Наступает почтительная тишина. Затем барон бесцеремонно спихивает со скамьи своего задремавшего соседа, жестом предлагает вам занять его место и просит рассказать о поединке с сэром Палеандром.
     Все присутствующие с уважением выслушивают ваш рассказ, а затем дружно пьют за здоровье прекрасной Клуши.
     Потом шум и гам возобновляются, а вы наваливаетесь на сочное <a l:href="#n_229">жареное мясо</a> (СИЛА восстанавливается до первоначального уровня).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',power['start']-power['now']
end
--- page.648 ---------------------------------

# page.649
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Медленно приходите вы в себя. Вы лежите на камнях, устланных сухой травой. Вокруг темно... в пещере вы, что ли? Но воздух здесь не затхлый, не застоявшийся — он чист, свеж и пахнет морем.
     В ваше сознание врывается радостный голос Клуши, которая, оказывается, с тревогой дожидалась, пока вы очнётесь. Ваша помощница объясняет, что на вас напала зеркальная оса. Тело этого насекомого покрыто сверкающей оболочкой: так оса ослепляет противника... Она принесла вас на корм будущим личинкам, которые скоро вылупятся из яиц. Как и некоторые её земные родственницы, оса парализует жертву ударом жала и тащит в логово. Но с вами этот номер не прошёл: доза яда мала для человека. Вы <a l:href="#n_283">можете двигаться</a> (хотя ЛОВКОСТЬ всё-таки понизилась на 1)...</p>}
if здесь_был[$curloc]=0:
	gosub 'lovk',-1
end
--- page.649 ---------------------------------

# page.650
$lvar['заголовок']={Мир Камней<avs-enemy>}
$lvar['исходник']={<p align=justify>     В отличие от земных сородичей, шершни не оставляют жало в ране врага и могут наносить противнику несколько ударов.</p>

<center><font size=+1>1-Й ШЕРШЕНЬ

ЛОВКОСТЬ 8     СИЛА 8


2-Й ШЕРШЕНЬ
   
ЛОВКОСТЬ 8     СИЛА 6

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.274'
if здесь_был[$curloc]=0:
	gosub 'crt.obj','шершень1','','<ratch>'
	gosub 'crt.obj','шершень2','','<ratch>'
end
--- page.650 ---------------------------------

# page.651
! В FB2 версии здесь тупик. Если вам кажется, что 364 пункт перехода не соответствует действительности сообщите
! СПРОСИТЬ У ГОЛОТВИНОЙ !!!
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Вам поручено серьёзное задание. Чтобы не провалить его, вы даже Бабу Ягу готовы признать королевой красоты... Впрочем, ваш ответ рыцарю составлен в более почтительных выражениях. Палеандр Неукротимый вполне удовлетворен и величаво удаляется на юг. Вы тоже продолжаете путь — разумеется, в другую сторону, на [page=364]север[/page].</p>}
--- page.651 ---------------------------------

# page.652
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Улица позади завалена грудами битого кирпича, есть лишь один путь — <a l:href="#n_480">вперёд</a>.</p>}
--- page.652 ---------------------------------

# page.653
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ветви оказываются на удивление хрупкими. Стараясь держаться как можно ближе к стволу, взбираетесь к пышной кроне и протягиваете руку к плоду. И тут сук, с виду толстый и надёжный, подламывается, и вы <a l:href="#n_371">шмякаетесь в траву</a>. Хорошо, что здесь мягкая почва ([pow]-2[/pow]).</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-2
end
--- page.653 ---------------------------------

# page.654
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В конце концов, он же не к вам обращается... Вы молча допиваете вино и идёте по лестнице в комнату, предназначенную <a l:href="#n_240">для ночлега</a>. Вслед звенит молодой, задорный смех незнакомца и мелко шелестит угодливое хихиканье хозяина таверны.</p>}
--- page.654 ---------------------------------

# page.655
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В руке у вас цилиндрик из чёрной пластмассы. На одном торце его — большая красная кнопка, на другом — круглый прозрачный «глазок».
     Вы прекрасно знаете, что это такое, и не нуждаетесь в подсказке. Тем не менее вы её получаете.
     «Чёрный луч...», — с ужасом и отвращением шепчет Клуша.
     Да, это <a l:href="#n_62">прибор</a>, создающий полосу сильнейших электромагнитных помех. Одно нажатие кнопки — и любой робот, на которого направлен этот пенал, будет надолго выведен из строя.
     Если хотите, можете взять его с собой.</p>}
if здесь_был[$curloc]=0:
	gosub 'crt.obj','чл'
end
--- page.655 ---------------------------------

# page.656
$lvar['заголовок']={Мир Роботов}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Ваш безумный противник с воплем бросается прочь. Вы не преследуете беднягу. К тому же становится ясно: он защищал своё <a l:href="#n_320">логово</a>.</p>}
--- page.656 ---------------------------------

# page.657
$lvar['заголовок']={Мир Легенд<avs-enemy>}
$lvar['исходник']={<center><font size=+1>1-Й РАЗБОЙНИК
   
ЛОВКОСТЬ 9     СИЛА 8
   

2-Й РАЗБОЙНИК
   
ЛОВКОСТЬ 9     СИЛА 9


3-Й РАЗБОЙНИК
   
ЛОВКОСТЬ 8     СИЛА 10

<font color=#004400><i>Удастся</i></font> ли вам победить?</center>}
$lvar['exit']='page.403'	&	!	название локации, на которую можно перейти в случае победы.
if здесь_был[$curloc]=0:
	gosub 'crt.obj','разбойник1','','<ratch>'
	gosub 'crt.obj','разбойник2','','<ratch>'
	gosub 'crt.obj','разбойник3','','<ratch>'
end
--- page.657 ---------------------------------

# page.658
$lvar['заголовок']={Мир Стрекоз}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Здесь почти нет травы, под ногами шуршит песок. Идти всё труднее... Внезапно вы, как в омут, проваливаетесь в песок чуть ли не по плечи. Выбраться удаётся, но с трудом ([pow]-1[/pow]).[powernow]
     Здесь не пройти. Будете <a l:href="#n_251">ломиться сквозь кусты</a> или <a l:href="#n_391">обойдёте их с другой стороны</a>?|[/powernow]</p>}
if здесь_был[$curloc]=0:
	gosub 'power',-1
end
--- page.658 ---------------------------------

# page.659
$lvar['заголовок']={Мир Камней}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Почти сразу ход выводит вас в круглую пещеру, усеянную острыми сталактитами и сталагмитами. Впереди видно чёрное пятно: коридор продолжается дальше. Здесь мерзко пахнет, воздух вокруг движется какими-то странными толчками. Хотите, пока не поздно, <a l:href="#n_190">уйти отсюда</a>? Или рискнёте <a l:href="#n_270">идти дальше</a>?</p>}
--- page.659 ---------------------------------

# page.660
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;«Ну, ещё раз! — войдя в азарт, предлагает ваш партнер. — Можешь оставить прежний заклад, а я ставлю вот это...» И жестом фокусника он извлекает откуда-то большую серебряную монету, на которой отчеканены корона и роза.
     Хотите <DIN2:gosub 'get.daughter.obj',$curloc
if arrsize('$temp_id')>0:
	$result='<a l:href="#n_119">сыграть</a><lock.put>'
	$GAME_VALUE['obj.inGame']=$temp_id[0]
else
	$result='сыграть'
end
killvar '$temp_id':2DIN>? Или распрощаетесь с незнакомцем и отправитесь <a l:href="#n_240">спать</a>?
     
     <DIN3:gosub 'get.daughter.obj',$curloc
if arrsize('$temp_id')=0:
	$result=$func('base.txt','help.putobj')
else
	$result=''
end
killvar '$temp_id':3DIN></p>}
if здесь_был[$curloc]=0:
	if $GAME_VALUE['obj.inGame']!'': $position_array[arrpos('$id_array',$GAME_VALUE['obj.inGame'])]=$curloc
end
--- page.660 ---------------------------------

# page.661
$lvar['заголовок']={Мир Стрекоз}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Судьба вознаграждает вас за неприятности: рука нащупывает меж корней что-то крепкое и круглое.</p>}
$lvar['исходник']+="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик брошен, выпало <<cube>>. <DIN1:if cube=2 or cube=4 or cube=6:
	$result='Это чётное число, а значит вы нашли [page=27]это[/page]'
else
	$result='Это нечётное число, а значит вы нашли [page=340]это[/page]'
end:1DIN>.</i></font></p>"
--- page.661 ---------------------------------

# page.662
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Рыцарь удаляется по дороге, а вы, на секунду поколебавшись, идёте в другую сторону, чтобы не оказаться попутчиком этой неприятной личности. По солнцу, которое уже клонится к закату, определяете, что идёте <a l:href="#n_364">на север</a>.</p>}
--- page.662 ---------------------------------

# page.663
$lvar['заголовок']={Мир Легенд}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Бертольд из Соргейля <a l:href="#n_149">падает замертво</a>, шлем его откатывается куда-то в колючие заросли, окружающие поляну. Вы глядите на погибшего противника с некоторым уважением: в конце концов, он честно исполнил свой долг.</p>}
--- page.663 ---------------------------------

# page.664
$lvar['заголовок']={Победа!<avs-victory>}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Всё хорошо, что хорошо кончается... Откинувшись в шезлонге, вы лениво размышляете: где лучше провести наконец-то выпавший вам отпуск — в Лунном Городе Развлечений или на экскурсии в венерианских джунглях?
     Бета-аннигилятор занял своё законное место в Лаборатории Мерфи, экспедиция спасена, пираты остались в дураках, Мэри Коуфорд без всякой пользы для себя прогулялась по Веренице Миров, а вас ждёт повышение в звании.
     И — надо же! — не сработал Великий Закон Мерфи. Значит, не всегда верно, что если неприятность может произойти, то она обязательно...
     Резкий звонок обрывает ваши размышления. На экране видеофона появляется лицо секретарши шефа.
     «Майор, вас срочно вызывают в штаб Патруля. — Голос секретарши подозрительно мягок. — Боюсь, ваш отпуск откладывается. В Лаборатории Мерфи опять неприятности...</p>

}  
--- page.664 ---------------------------------

# page.665
$lvar['заголовок']={Запасная страница}
$lvar['исходник']={<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Lucus vostrom tenada im. Adiventis laneda strum et pelstrim neo. Grinu datum lucus sabota et pelstrim eldo vostrum. Vostrom stasum im. Denevis laneda diculus imano. Et mas tolum im en vostrom sabula trada. Sabula trada im en vostrom tabelas baen. Oroces tredis mas tolum vettisa, em vettisa tredis oroces mas tolum.</p>}
--- page.665 ---------------------------------

# page.130
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={130}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>, а значит вам <DIN1:if cube=1 or cube=2 or cube=3:
	$result='[page=345]сюда[/page]'
else
	$result='[page=178]сюда[/page]'
end:1DIN>.</i></font></p>"
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.130 ---------------------------------

# page.151
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={151}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>. <DIN1:if cube=2 or cube=4 or cube=6:
	$result='Это чётное число, а значит вам [page=366]сюда[/page]'
else
	$result='Это нечётное число, а значит вам [page=178]сюда[/page]'
end:1DIN>.</i></font></p>"
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.151 ---------------------------------

# page.242
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={242}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>, а значит вам <DIN1:if cube=1 or cube=2 or cube=3:
	$result='[page=290]сюда[/page]'
else
	$result='[page=345]сюда[/page]'
end:1DIN>.</i></font></p>"
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.242 ---------------------------------

# page.263
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={263}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>. <DIN1:if cube=2 or cube=4 or cube=6:
	$result='Это чётное число, а значит вам [page=366]сюда[/page]'
else
	$result='Это нечётное число, а значит вам [page=290]сюда[/page]'
end:1DIN>.</i></font></p>"
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.263 ---------------------------------

# page.318
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={318}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>, а значит вам <DIN1:if cube=1 or cube=2 or cube=3:
	$result='[page=366]сюда[/page]'
else
	$result='[page=345]сюда[/page]'
end:1DIN>.</i></font></p>"
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.318 ---------------------------------

# page.404
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={404}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>, а значит вам <DIN1:if cube=1 or cube=4:
	$result='[page=366]сюда[/page]'
elseif cube=2 or cube=5:
	$result='[page=290]сюда[/page]'
else
	$result='[page=345]сюда[/page]'
end:1DIN>.</i></font></p>"
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.404 ---------------------------------

# page.467
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={467}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>, а значит вам <DIN1:if cube=1 or cube=4:
	$result='[page=366]сюда[/page]'
elseif cube=2 or cube=5:
	$result='[page=290]сюда[/page]'
else
	$result='[page=178]сюда[/page]'
end:1DIN>.</i></font></p>"
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.467 ---------------------------------

# page.598
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={598}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>, а значит вам <DIN1:if cube=1 or cube=4:
	$result='[page=178]сюда[/page]'
elseif cube=2 or cube=5:
	$result='[page=366]сюда[/page]'
else
	$result='[page=345]сюда[/page]'
end:1DIN>.</i></font></p>"
:[кубик]
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.598 ---------------------------------

# page.641
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={641}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>, а значит вам <DIN1:if cube=1 or cube=4:
	$result='[page=290]сюда[/page]'
elseif cube=2 or cube=5:
	$result='[page=345]сюда[/page]'
else
	$result='[page=178]сюда[/page]'
end:1DIN>.</i></font></p>"
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.641 ---------------------------------

# page.75
!{ ЛОКАЦИЯ НЕ ИСПОЛЬЗУЕТСЯ 
$lvar['заголовок']={75}
if здесь_был[$curloc]=0:
	cube=rand(1,6)
end
$lvar['исходник']="<p align=justify>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=#004400><i>Кубик-брошен, выпало <<cube>>. <DIN1:if cube=2 or cube=4 or cube=6:
	$result='Это чётное число, а значит вам [page=290]сюда[/page]'
else
	$result='Это нечётное число, а значит вам [page=178]сюда[/page]'
end:1DIN>.</i></font></p>"
}
$lvar['исходник']="Если вы видите это, значит в игре допущена ошибка. Пожалуйста сохраните игру и вышлите файл сохранения на aleksversus@mail.ru"
--- page.75 ---------------------------------

QSP-Game база мест на теле и в рюкзаке
# base.body
$args[0] = $args[0]
$args[1]=$TRIM($replace($args[1],'<body>'))
$args['obj']+="<body> "
:запястье
if $args[0]='запястье':
	$args['obj'] += '[:запястье:] [name:Запястье:name]'
end
:место_в_рюкзаке
if $args[0]='место_в_рюкзаке':
	$args['obj'] += '[:место_в_рюкзаке:] [name:Место в рюкзаке:name]'
end
:ножны
if $args[0]='ножны':
	$args['obj'] += '[:ножны:] [name:Ножны:name]'
end
:кобура
if $args[0]='кобура':
	$args['obj'] += '[:кобура:] [name:Кобура:name]'
end
:пояс
if $args[0]='пояс':
	$args['obj'] += '[:пояс:] [name:Место для пояса:name]'
end
:пояс_фляга
if $args[0]='пояс_фляга':
	$args['obj'] += '[:пояс_фляга:] [name:Место для фляги:name]'
end
:пояс_кошель
if $args[0]='пояс_кошель':
	$args['obj'] += ' [:пояс_кошель:] [name:Место под кошель:name]'
end
:лицо
if $args[0]='лицо':
	$args['obj'] += ' [:лицо:] [name:Лицо:name]'
end
:голова
if $args[0]='голова':
	$args['obj'] += ' [:голова:] [name:Голова:name]'
end
:рука_левая
if $args[0]='рука_левая':
	$args['obj'] += ' [:рука_левая:] [name:Рука левая:name]'
end
:плечи
if $args[0]='плечи':
	$args['obj'] += ' [:плечи:] [name:Плечи:name]'
end
:шея
if $args[0]='шея':
	$args['obj'] += ' [:шея:] [name:Шея:name]'
end
:плечо
if $args[0]='плечо':
	$args['obj'] += ' [:плечо:] [name:Плечо:name]'
end
:запястье
if $args[0]='запястье':
	$args['obj'] += ' [:запястье:] [name:Запястье:name]'
end
$args['obj']+=$args[1]
$result=$args['obj']
--- base.body ---------------------------------

QSP-Game база знаний, которые можно приобретать
# base.knew
$args[0] = $args[0]
$args[1] = $args[1]
:выход_27
if $args[0]='выход_27':
	$args['obj'] += '[:выход_27:] [name:Найдены Ворота №27.:name] [page:27] [t:выход:t]'
end
:выход_103
if $args[0]='выход_103':
	$args['obj'] += '[:выход_103:] [name:Найдены Ворота №103.:name] [page:103] [t:выход:t]'
end
:выход_215
if $args[0]='выход_215':
	$args['obj'] += '[:выход_215:] [name:Найдены Ворота №215.:name] [page:215] [t:выход:t]'
end
:выход_48
if $args[0]='выход_48':
	$args['obj'] += '[:выход_48:] [name:Найдены Ворота №48.:name] [page:48] [t:выход:t]'
end
:тюрьма
if $args[0]='тюрьма':
	$args['obj'] += '[:тюрьма:] [name:Чтобы выбраться из подземной тюрьмы замка, нужно сдвинуть  шестой нижний камень (если считать от двери). За ним — подземный ход.:name] [page:117]'
end
:лапа_дракона
if $args[0]='лапа_дракона':
	$args['obj'] += '[:лапа_дракона:] [name:Если вдруг придётся столкнуться с грабителями, нужно сказать им: «У дракона тяжёлая лапа».:name] [page:]'
end
:великое_древо
if $args[0]='великое_древо':
	$args['obj'] += '[:великое_древо:] [name:Возле корней Великого древа начинается тропка к заброшенной часовне. Только придётся хорошо её поискать.:name] [page:89]'
end
:защитник_служанок
if $args[0]='защитник_служанок':
	$args['obj'] += '[:защитник_служанок:] [name:Вы заступились за служанку перед поваром.:name] [page:245] [hide]'
end
:мв
if $args[0]='мв':
	$args['obj'] += '[:мв:] [name:Вы узнали про модификатор вероятностей.:name] [hide]'
end
:бертольд
if $args[0]='бертольд':
	$args['obj'] += '[:бертольд:] [name:Встретив рыцаря по имени Бертольд, отдайте ему оранжевый бант, что повязан у вас на запястье, и скажите, что подарок этот прислала его Прекрасная Дама.:name]'
end
$args['obj']+=$args[1]
$result=$args['obj']
--- base.knew ---------------------------------

QSP-Game база предметов, которые доступны в игре
# base.obj
$args[0] = $args[0]
$args[1]=$TRIM($replace($args[1],'<obj>'))
$args[2] = $args[2]
if $args[2]='': $args['obj']+="<obj> "
:ворот
if $args[0]='ворот':
	if $args[2]='': $args['obj'] += '[:ворот:] [np:[браслет] [снаряжение]:np] [name:Коммуникатор:name] [text:Наглухо запаянный на руке металлический браслет. Он выполняет [knew]мв|четыре|три[/knew] функции. Во-первых, это автопереводчик. Вы можете общаться с любым разумным существом в Веренице Миров. Во-вторых, с помощью браслета поддерживается телепатическая связь с Клушей.[knew]мв|&nbsp;В-третьих, в браслет встроен модификатор вероятностей, основное назначение которого - эм... концентрировать удачу, если в двух словах.|[/knew] Есть на браслете и маленький чёрный глазок. Если он замигает красным — значит, где-то поблизости аннигилятор, а при нём, надо полагать, и похититель... :text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:палаш
if $args[0]='палаш':
	if $args[2]='': $args['obj'] += '[:палаш:] [np:[оружие] [холодное] [меч] [снаряжение]:np] [name:Длинный нож:name] [text:Длинный, похожий на палаш, нож, прочный, лёгкий, с рукоятью из пластиката. Обычное оружие исследователей Вереницы Миров.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:бластер
if $args[0]='бластер':
	if $args[2]='': $args['obj'] += '[:бластер:]  [np:[оружие] [огнестрельное] [пистолет] [снаряжение]:np] [name:Бластер:name] [maxchrg:] [text:Вы можете в любой момент убить любого из противников смертоносным лучом. Сделать это можно даже в разгаре боя. Но по причинам, объясненным в Предисловии, число зарядов невелико, их приходится беречь.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:ночное_видение
if $args[0]='ночное_видение':
	if $args[2]='': $args['obj'] += '[:ночное_видение:] [name:Инфракрасные очки «Ночное зрение»|Инфракрасных очков «Ночное зрение»|Инфракрасным очкам «Ночное зрение»|Инфракрасные очки «Ночное зрение»|Инфракрасными очками «Ночное зрение»|Инфракрасных очках «Ночное зрение»:name] [np:[доспех] [очки] [инфракрасное зрение]:np] [text:Они позволяют видеть в темноте.:text] [useoff:avs-dark:useoff]'
	if $args[2]='notspec': $args['obj'] += 'Инфракрасные очки имеет смысл надевать только в тёмноте.'
end
:зажигалка
if $args[0]='зажигалка':
	if $args[2]='': $args['obj'] += '[:зажигалка:] [name:Зажигалка|Зажигалки|Зажигалке|Зажигалку|Зажигалкой|Зажигалке:name] [np::np] [text:Пригодится для разведения огня.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:питательная_паста
if $args[0]='питательная_паста':
	if $args[2]='': $args['obj'] += '[:питательная_паста:] [name:Тюбик питательной пасты|Тюбика питательной пасты|Тюбику питательной пасты|Тюбик питательной пасты|Тюбиком питательной пасты|Тюбике питательной пасты:name] [np:[еда]:np] [text:Питательная паста, которая в любой момент восстановит ваши силы до первоначального уровня.:text][eating:'+"$print[]='Вы съели порцию питательной пасты.' & gosub 'power',power['start']-power['now']"+':eating]'
	if $args[2]='notspec': $args['obj'] += ''
end
:лечебная_паста
if $args[0]='лечебная_паста':
	if $args[2]='': $args['obj'] += '[:лечебная_паста:] [name:Тюбик заживляющей пасты|Тюбика заживляющей пасты|Тюбику заживляющей пасты|Тюбик заживляющей пасты|Тюбиком заживляющей пасты|Тюбике заживляющей пасты:name] [np:[лекарство]:np] [text:Заживляющая паста, которую можно использовать только после боя. Восстанавливает 6 единиц СИЛЫ.:text][eating:$print[]="Вы использовали порцию заживляющей пасты для лечения ран после боя." & gosub "power",6:eating]'
	if $args[2]='notspec': $args['obj'] += 'Лечебную пасту можно использовать только для заживления ран, полученных в бою.'
end
:протонная_граната
! прибавить 60 к параграфу
if $args[0]='протонная_граната':
	if $args[2]='': $args['obj'] += '[:протонная_граната:] [name:Протонная граната|Протонной гранаты|Протонной гранате|Протонную гранату|Протонной гранатой|Протонной гранате:name] [np:[снаряд] [оружие]:np] [useon:60]  [text:Сильное оружие. Следует помнить: не во всякой ситуации её можно использовать. Надо, чтобы рядом было какое-нибудь укрытие.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:свеча
if $args[0]='свеча':
	if $args[2]='': $args['obj'] += '[:свеча:] [name:Свеча|Свечи|Свече|Свечу|Свечой|Свече:name] [np::np] [text:Длинный огарок свечи.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:антигравитатор
! прибавить 80
if $args[0]='антигравитатор':
	if $args[2]='':
		$args['obj'] += '[:антигравитатор:] [name:Антигравитатор|Антигравитатора|Антигравитатору|Антигравитатор|Антигравитатором|Антигравитаторе:name] [np:[доспех] [пояс] [заряженный]:np] [useon:80] [text:Металлический пояс-антигравитатор. <DIN1:if charge_array[arrpos("$id_array",$temp_mi)]>0:
	$result="Судя по миганию зелёного индикатора на пряжке – нуждается в подзарядке. Впрочем, если в этом действительно появится необходимость, можно пролететь некоторое расстояние."
else
	$result="Индикатор на пряжке больше не мигает. Пояс уже не сможет поднять вас в воздух."
end:1DIN>:text] [pos:пояс:pos]'
	end
	if $args[2]='notspec': $args['obj'] += ''
end
:рог
! прибавить 96 к номеру параграфа
if $args[0]='рог':
	if $args[2]='': $args['obj'] += '[:рог:] [name:Обломок рога|Обломка рога|Обломку рога|Обломок рога|Обломком рога|Обломке рога:name] [np::np] [useon:96] [text:Тяжёлый чёрный крюк, очень прочный, гладкий, на изломе шероховатый.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:подводная_маска
! вычесть 40 из параграфа
if $args[0]='подводная_маска':
	if $args[2]='': $args['obj'] += '[:подводная_маска:] [name:Подводная маска|Подводной маски|Подводной маске|Подводную маску|Подводной маской|Подводной маске:name] [np:[заряженный]:np] [useon:-40] [text:Маска для подводного плавания с трубкой, к которой прикреплен баллончик сжатого воздуха. Воздуха в ней не много – хватит минут на пятнадцать.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:кошель
if $args[0]='кошель':
	$args['obj'] += "[:кошель:] [name:Карман|Кармана|Карману|Карман|Карманом|Кармане:name] [np:[кошель]:np] [text::text] [pos:пояс-кошель:pos]"
	if $args[2]='notspec': $args['obj'] += ''
end
:короны_розы
if $args[0]='короны_розы':
	if $args[2]='': $args['obj'] += '[:короны_розы:] [name:Большие серебряные монеты с изображением короны и розы|Больших серебряных монет с изображением короны и розы|Большим серебряным монетам с изображением короны и розы|Большие серебряные монеты с изображением короны и розы|Большими серебряными монетами с изображением короны и розы|Больших серебряных монетах с изображением короны и розы:name] [np:[монета]:np] [text::text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:бант_оранжевый
if $args[0]='бант_оранжевый':
	if $args[2]='': $args['obj'] += '[:бант_оранжевый:] [name:Оранжевая лента|Оранжевой ленты|Оранжевой ленте|Оранжевую ленту|Оранжевой лентой|Оранжевой ленте:name] [np::np] [text:Оранжевый бант, подаренный баронессой.:text] [useon:-48] [pos:запястье:pos]'
	if $args[2]='notspec': $args['obj'] += ''
end
:фляга
if $args[0]='фляга':
	$args['obj'] += "[:фляга:] [name:Фляга|Фляги|Фляге|Флягу|Флягой|Фляге:name] [np:[фляга] [напиток]:np] [maxchrg:2][text:<DIN1:$args[0]=$temp_mi
if instr($object_array[arrpos('$id_array',$args[0])],'[подарок'+' стрекозы]')!0:
	$args[111]='Изобретённое стрекозой приспособление для транспортировки жидкости. Сухой плод, похожий на небольшую бутылочку, обвязанный лианой.'
elseif instr($object_array[arrpos('$id_array',$args[0])],'[сосуд'+' из под'+' духов]')!0:
	$args[111]='Покрытый узорами сосудик на серебрянной цепочке. Здесь когда-то хранились духи, теперь вы используете его как фляжку.'
else
	$args[111]='Крохотная фляжка, в которую помещается не больше двух глотков жидкости.'
end
$result=$args[111]:1DIN>:text] [eating:args[33]=arrpos('$position_array',$args[0])
args[9]=func('get.tag.num',$object_array[args[33]],'power')
$print[]='Вы сделали глоток.'
if power['now']+args[9]<=power['start']:
	power['now']+=args[9]
	$print[]='СИЛА увеличилась на '+str(args[9])+'.'
elseif power['start']-power['now']<args[9] and power['start']-power['now']!0:
	args[8]=power['start']-power['now']
	power['now']=power['start']
	$print[]='СИЛА увеличилась на '+str(args[8])+'.'
else
	$print[]='Но он потрачен зря. Ваша СИЛА и так уже достигла максимального уровня.'
end
:eating][pos:пояс_фляга:pos]"
	if $args[2]='notspec': $args['obj'] += ''
end
	:вода
	if $args[0]='вода':
		$args['obj']+="[:вода:] [name:Вода|Воды|Воде|Воду|Водой|Воде:name] [np:[жидкость] [наполнитель]:np] [power:2] [hide.kolvo]"
	end
	:нектар
	if $args[0]='нектар':
		$args['obj']+="[:нектар:] [name:Нектар|Нектара|Нектару|Нектар|Нектаром|Нектаре:name] [np:[жидкость] [наполнитель]:np] [power:4] [hide.kolvo]"
	end
	:сок
	if $args[0]='сок':
		$args['obj']+="[:сок:] [name:Сок|Сока|Соку|Сок|Соком|Соке:name] [np:[жидкость] [наполнитель]:np] [power:4] [hide.kolvo]"
	end
:шкура
if $args[0]='шкура':
	if $args[2]='': $args['obj'] += '[:шкура:] [name:Шкура|Шкуры|Шкуре|Шкуру|Шкурой|Шкуре:name] [np::np] [text:Красивая переливчатая мягкая шкура.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:смола
if $args[0]='смола':
	if $args[2]='': $args['obj'] += '[:смола:] [name:Смола|Смолы|Смоле|Смолу|Смолой|Смоле:name] [np::np] [text:Тонкая, коричневая, на ощупь напоминающая мягкую пластмассу, лента источает восхитительный запах. Это потёки ароматической смолы, год за годом сочившейся из ветвей и застывавшей на воздухе. Учёные из Лаборатории Мерфи собираются предложить её парфюмерной промышленности.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:плюмаж
if $args[0]='плюмаж':
	if $args[2]='': $args['obj'] += '[:плюмаж:] [name:Плюмаж|Плюмажа|Плюмажу|Плюмаж|Плюмажем|Плюмаже:name] [np::np] [text:Тёмно-красная оторочка из перьев.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:плод
! вычесть 176
if $args[0]='плод':
	if $args[2]='': $args['obj'] += '[:плод:] [name:Плод|Плода|Плоду|Плод|Плодом|Плоде:name] [np:[снаряд]:np] [useon:-176] [text:Чёрный шар размером с яблоко. Он так твёрд, что нож не оставляет на нём и царапины.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:плод_фиолетовый
! прибавить 204
if $args[0]='плод_фиолетовый':
	if $args[2]='': $args['obj'] += '[:плод_фиолетовый:] [name:Плод|Плода|Плоду|Плод|Плодом|Плоде:name] [np:[снаряд]:np] [useon:204] [text:Ярко-фиолетовый, с глянцевым блеском плод, такой твердый, что нож скользит по нему, не оставляя даже царапины.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:меорвин
if $args[0]='меорвин':
	if $args[2]='': $args['obj'] += '[:меорвин:] [name:Меорвин|Меорвина|Меорвину|Меорвин|Меорвином|Меорвине:name] [np:[еда]:np] [text:Меорвин. Тонкая пластиковая трубочка с зелёным шариком внутри. Сильнейший тонизатор... и реакцию улучшает. Одного такого шарика хватит на две недели... Если проглотите шарик, ваша ЛОВКОСТЬ увеличится на 1.:text] [eating:$print[]="<font color=#884400>Вы приняли меорвин.</font>" & gosub "lovk",1:eating]'
	if $args[2]='notspec': $args['obj'] += ''
end
:огнетушитель
! вычесть 100
if $args[0]='огнетушитель':
	if $args[2]='': $args['obj'] += '[:огнетушитель:] [name:Огнетушитель|Огнетушителя|Огнетушителю|Огнетушитель|Огнетушителем|Огнетушителе:name] [np:[заряженный]:np] [useon:-100] [text:Маленький огнетушитель одноразового действия, раскрашенный красными и белыми полосами.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:семена
! прибавить 160
if $args[0]='семена':
	if $args[2]='': $args['obj'] += '[:семена:] [name:Семена|Семян|Семенам|Семена|Семенами|Семенах:name] [np:[снаряд]:np] [useon:160] [text:Мешочек с семенами. Из каждого семечка мгновенно вырастает ужасный сорняк, который убивает все растения вокруг, а потом засыхает сам.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:вервь
if $args[0]='вервь':
	$args['obj'] += "[:вервь:] [name:Верёвка|Верёвки|Верёвка|Верёвку|Верёвкой|Верёвке:name] [np:[верёвка]:np] [text:<DIN1:$args[0]=$temp_mi
args[1]=arrpos('$id_array',$args[0])
if instr($object_array[args[1]],'[подарок '+'стрекозы]'):
	$args[111]='Длинная и прочная лиана, которую вам подарила Стрекоза. Прекрасно заменяет верёвку.'
elseif instr($object_array[args[1]],'[пу'+'ты]'):
	$args[111]='Длинная и прочная верёвка, которой вас чуть было не связали трое головорезов.'
elseif instr($object_array[args[1]],'[ли'+'ана]'):
	$args[111]='Длинная и прочная лиана, которую вы срезали с дерева. Прекрасно заменяет верёвку.'
elseif instr($object_array[args[1]],'[оран'+'жевая]'):
	$args[111]='Тонкая оранжевая верёвка. Хотя и выглядит несерьёзно, она очень прочная.'
else
	$args[111]='Длинная и прочная верёвка.'
	if $args[2]='notspec': $args['obj'] += ''
end
$result=$args[111]:1DIN>:text]"
	if $args[2]='notspec': $args['obj'] += ''
end
:ягода
if $args[0]='ягода':
	if $args[2]='': $args['obj'] += '[:ягода:] [name:Ягода|Ягоды|Ягоде|Ягоду|Ягодой|Ягоде:name] [np:[еда]:np] [text:Круглая мясистая зелёная ягода, которая в любой момент увеличит вашу СИЛУ на 5.:text] [eating:$print[]="<font color=#884400>Вы съели ягоду.</font>" & gosub "power",5:eating]'
	if $args[2]='notspec': $args['obj'] += ''
end
:кольцо
! прибавить 40
if $args[0]='кольцо':
	if $args[2]='':
		$args['obj'] += '[:кольцо:] [name:Кольцо|Кольца|Кольцу|Кольцо|Кольцом|Кольце:name] [np:[кольцо] [заряженный]:np] [useon:40]  [text:Подарок мага. <DIN1:if charge_array[arrpos("$id_array",$temp_mi)]>0:
	$result="Кольцо, которое позволит взлететь... но лишь один раз... если повезёт..."
else
	$result="Кольцо, с помощью которого вам удалось пролевитировать некоторое время. Больше не работает."
end:1DIN>:text]'
	end
	if $args[2]='notspec': $args['obj'] += ''
end
:зеркало
! вычесть 268
if $args[0]='зеркало':
	if $args[2]='': $args['obj'] += '[:зеркало:] [name:Зеркало|Зеркала|Зеркалу|Зеркало|Зеркалом|Зеркале:name] [np::np] [useon:-268]  [text:Полуметровое зеркало в форме астры. Тонкое, прочное, и такое гибкое, что его можно скатать в трубку.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:шлем
if $args[0]='шлем':
	if $args[2]='': $args['obj'] += '[:шлем:] [name:Шлем|Шлема|Шлему|Шлем|Шлемом|Шлеме:name] [np:[доспех] [шлем]:np] [text:Красивый рыцарский шлем. Пожалуй, в таком вас могут принять за настоящего рыцаря.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:шар
if $args[0]='шар':
	if $args[2]='': $args['obj'] += '[:шар:] [name:Шар|Шара|Шару|Шар|Шаром|Шаре:name] [np:[неизвестное]:np] [text:Некий шар.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:лист_вонючка
! вычесть 140
if $args[0]='лист_вонючка':
	if $args[2]='': $args['obj'] += '[:лист_вонючка:] [name:Лист|Листа|Листу|Лист|Листом|Листе:name] [np:[снаряд]:np] [text:Толстый мясистый лист бурого цвета с безобразными наростами. Его запах может отпугивать насекомых.:text] [useon:-140]'
	if $args[2]='notspec': $args['obj'] += ''
end
:жидкость
if $args[0]='жидкость':
	if $args[2]='':
		$args['obj'] += '[:жидкость:] [name:Жидкость|Жидкости|Жидкости|Жидкость|Жидкостью|Жидкости:name] [np:[снаряд]:np] [text:<DIN1:if charge_array[arrpos("$id_array",$temp_mi)]>0:
	$result="Крохотный кувшинчик с жидкостью, один глоток которой позволит недолго дышать под водой. Не стоит забывать, что эта жидкость вредна для здоровья."
else
	$result="Крохотный кувшинчик, в котором когда-то хранили жидкость, позволявшую дышать под водой."
end:1DIN>:text] [useon:-80]'
	end
	if $args[2]='notspec': $args['obj'] += ''
end
:перчатка
if $args[0]='перчатка':
	if $args[2]='': $args['obj'] += '[:перчатка:] [name:Перчатка|Перчатки|Перчатке|Перчатку|Перчаткой|Перчатке:name] [text:Красная кожаная перчатка:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:маска_кроко
if $args[0]='маска_кроко':
	if $args[2]='': $args['obj'] += '[:маска_кроко:] [name:Маска зверя|Маски зверя|Маске зверя|Маску зверя|Маской зверя|Маске зверя:name] [np::np] [text:Маска зверя, похожего на крокодила.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:рыбка
if $args[0]='рыбка':
	if $args[2]='': $args['obj'] += '[:рыбка:] [name:Рыбка|Рыбки|Рыбке|Рыбку|Рыбкой|Рыбке:name] [text:Картонная рыбка с глазками-бусинками.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:деревянный_кинжал
if $args[0]='деревянный_кинжал':
	if $args[2]='': $args['obj'] += '[:деревянный_кинжал:] [name:Деревянный кинжал|Деревянного кинжала|Деревянному кинжалу|Деревянный кинжал|Деревянным кинжалом|Деревянном кинжале:name] [text:Деревянный кинжал.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:птица
if $args[0]='птица':
	if $args[2]='': $args['obj'] += '[:птица:] [name:Жаркое|Жаркого|Жаркому|Жаркое|Жарким|Жарком:name] [np:[еда]:np] [text:Жареная птица, которую вам дали разбойники. Завёрнута в листья. В любой момент увеличит вашу СИЛУ на 3.:text] [eating:$print[]="<font color=#884400>Вы съели дичь.</font>" & gosub "power",3:eating]'
	if $args[2]='notspec': $args['obj'] += ''
end
:пояс
! вычесть 60
if $args[0]='пояс':
	if $args[2]='': $args['obj'] += '[:пояс:] [name:Пояс|Пояса|Поясу|Пояс|Поясом|Поясе:name] [np:[доспех] [одежда] [пояс]:np] [useon:-60] [text:Аляповатый шёлковый пояс. Назначение его - тайна, покрытая мраком. Может быть он отпугивает драконов, а может и дразнит.:text] [useoff:avs-pojas:useoff]'
	if $args[2]='notspec': $args['obj'] += 'Вокруг не видно ни одного дракона. К чему облачаться в эту нелепицу?'
end
:консервы
if $args[0]='консервы':
	if $args[2]='': $args['obj'] += '[:консервы:] [name:Консервы|Консервов|Консервам|Консервы|Консервами|Консервах:name] [np:[еда]:np] [text:Консервированное мясо в банке. В любую минуту прибавят 5 к вашей СИЛЕ.:text] [eating:$print[]="<font color=#884400>Вы съели консервы.</font>" & gosub "power",5:eating]'
	if $args[2]='notspec': $args['obj'] += ''
end
:плащ
if $args[0]='плащ':
	$args['obj'] += "[:плащ:] [name:Плащ|Плаща|Плащу|Плащ|Плащом|Плаще:name] [np:[доспех] [одежда] [плащ]:np] [text:<DIN1:$args[0]=$temp_mi
args[1]=arrpos('$id_array',$args[0])
if instr($object_array[args[1]],'[подарок '+'лапы]'):
	$args[111]='Мягкий и тёплый серый плащ, подаренный вам незнакомцем, назвавшимся Драконьей Лапой.'
elseif instr($object_array[args[1]],'[стару'+'ха]'):
	$args[111]='Мягкий и тёплый серый плащ, купленный у старушки в одной из деревень.'
else
	$args[111]='Мягкий и тёплый серый плащ.'
	if $args[2]='notspec': $args['obj'] += ''
end
$result=$args[111]:1DIN>:text] [pos:плечи:pos]"
	if $args[2]='notspec': $args['obj'] += ''
end
:клык
if $args[0]='клык':
	if $args[2]='': $args['obj'] += '[:клык:] [name:Клык|Клыка|Клыку|Клык|Клыком|Клыке:name] [np:[доспех] [амулет]:np] [text:Согласно теории одного из исследователей вереницы миров клыки хищных пауков являются природными устройствами для фокусирования биоэнергии, а при непосредственном контакте клыка с телом индивидуума повышаются физические характеристики данного индивидуума.:text] [pos:шея:pos]'
	if $args[2]='notspec': $args['obj'] += ''
end
:чл
! прибавить 100
if $args[0]='чл':
	if $args[2]='': $args['obj'] += '[:чл:] [name:«Чёрный Луч»|«Чёрного Луча»|«Чёрному Лучу»|«Чёрный Луч»|«Чёрным Лучом»|«Чёрном Луче»:name] [np::np] [useon:100] [text:Прибор, создающий полосу мощных электромагнитных помех. Стоит нажать на кнопку — и любой робот, на которого вы направите этот цилиндрик, будет надолго выведен из строя.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:мясо
if $args[0]='мясо':
	if $args[2]='': $args['obj'] += '[:мясо:] [name:Мясо|Мяса|Мясу|Мясо|Мясом|Мясе:name] [np:[еда]:np] [text:Жаренное мясо. В любую минуту прибавит 5 к вашей СИЛЕ.:text] [eating:$print[]="<font color=#884400>Вы съели мясо.</font>" & gosub "power",5:eating]'
	if $args[2]='notspec': $args['obj'] += ''
end
:мясо1
if $args[0]='мясо1':
	if $args[2]='': $args['obj'] += '[:мясо:] [name:Кусочек Мяса|Кусочка Мяса|Кусочку Мяса|Кусочек Мяса|Кусочком Мяса|Кусочке Мяса:name] [np:[еда]:np] [text:Жаренное мясо. В любую минуту прибавит 3 к вашей СИЛЕ.:text] [eating:$print[]="<font color=#884400>Вы съели мясо.</font>" & gosub "power",3:eating]'
	if $args[2]='notspec': $args['obj'] += ''
end
:ракетка
if $args[0]='ракетка':
	if $args[2]='': $args['obj'] += '[:ракетка:] [name:Ракетка|Ракетки|Ракетке|Ракетку|Ракеткой|Ракетке:name] [text:Предмет, напоминающий теннисную ракетку, — инвентарь для какой-нибудь игры.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:во
! прибавить 172
if $args[0]='во':
	if $args[2]='': $args['obj'] += '[:во:] [name:Виброотмычка|Виброотмычки|Виброотмычке|Виброотмычку|Виброотмычкой|Виброотмычке:name] [useon:172] [text:Серебристая продолговатая коробочка. По заявлениям Клуши - это самая что ни на есть виброотмычка. Такими пользуются даже преступники на Земле.:text]'
	if $args[2]='notspec': $args['obj'] += ''
end
:аннигилятор
if $args[0]='аннигилятор':
	if $args[2]='': $args['obj'] += '[:аннигилятор:] [name:Аннигилятор|Аннигилятора|Аннигилятору|Аннигилятор|Аннигилятором|Аннигиляторе:name] [text:Аннигилятор в лиловом пластиковом рюкзачке. Кошмарная штуковина способная превратить в ослепительную вспышку большой остров. А если по этому образцу построить приборчик покрупнее, можно пускать на распыл планеты...:text] [pos:плечо:pos]'
	if $args[2]='notspec': $args['obj'] += ''
end
if $args[2]='':
	$args['obj']+=$args[1]
	if instr($args['obj'],'[pos:')=0: $args['obj']+='[pos:место_в_рюкзаке:pos]'
elseif $args[2]='notspec':
	if $args['obj']!'':
		$args['obj'] = '<font color=#880000>'+ $args['obj'] +'</font>'
	else
		$args['obj'] = $func('base.txt','notspec')
	end
end
$result=$args['obj']
--- base.obj ---------------------------------

QSP-Game База противников, присутствующих в игре
$args[0] = $args[0]
$args[1] = $args[1]
$args[2] = $args[2]
# base.ratch
$args[9]=$args[9]
:куст_хищник
if $args[0]='куст_хищник':
	if $args[2]='': $args['obj'] += '[:куст_хищник:] [name:Куст-Хищник|Куста-Хищника|Кусту-Хищнику|Куст-Хищник|Кустом-Хищником|Кусте-Хищнике:name] [np::np] [power:10] [fast:9] [sex:male:sex]'
	if $args[2]='blow':
		$args['obj'] += "[pblow:
	2:Вы [pcube] пытаетесь уколоть Куст. Острый нож вонзается в тонкую ветку [pblow], расщепляя её пополам. Кажется, Куст [ecube] дрожит от боли [eblow].:2
	3:Вы [pcube] бьёте наотмашь, обрубая короткую веточку [pblow]. Куст [ecube] выгибается и трепещет [eblow].:3
	4:Лезвие ножа застревает в сплетённом щупальце, но вы [pcube] с усилием вырываете [pblow] его у Куста [ecube], отсекая часть ветви [eblow].:4
	5:Ваш нож [pcube] разит будто молния, вонзаясь в крепкую ветвь [pblow]. Куст отчаянно бьёт [ecube] щупальцами по воздуху, но не успевает задеть вас [eblow].:5
	6:Кусту [ecube] удаётся ухватить вас за руку парой щупалец [eblow]. Но вы не теряетесь [pcube] и обрубаете обе ветки [pblow]. Куст отклоняется назад.:6
	7:Нож взлетает над головой [pcube] и обрушивается на Куст сверху вниз. Однако ваша попытка разрубить его надвое не совсем удаётся [pblow] - вы лишь отсекаете [ecube] одну из ветвей-щупалец [eblow].:7
	8:Дважды [pcube] вы обрушиваете свой нож на толстую ветвь, но только с третьего раза вам удаётся перерубить её [pblow]. Будь Куст [ecube] каким-нибудь зверем, он отскочил бы в сторону [eblow].:8
	9:Вы проводите серию [pcube] лёгких и быстрых ударов, отсекая множество мелких веточек [pblow]. Куст [ecube] аж затрясся от боли и ярости [eblow].:9
	10:Трясущиеся ветви отлетают в разные стороны, судорожно вздрагивая и скрючиваясь, а вы [pcube] продолжаете рубить на одном дыхании [pblow]. Внезапно обломок ветви устремляется вам в голову [ecube]. Уф! Вы едва успели увернуться. Ещё бы сантиметр [eblow], и...:10
	11:Раз за разом вы [pcube] вонзаете острие в основание Куста [pblow]; брызжет жёлто-зелёный сок, но хищник [ecube], кажется, не собирается сдаваться [eblow].:11
	12:Вы [pcube] размахиваетесь и что есть мочи рубите Куст [ecube] острым лезвием [pblow]. Толстенная ветвь обламывается у самого корня. Дрожащие щупальца скручиваются в спирали и кольца [eblow].:12
:pblow]
[eblock:
	2:Вы пытаетесь уколоть [pcube] Куст, нацелившись остриём на одну из толстых веток [pblow]. В самый последний миг она изгибается [ecube] и удар пропадает даром [eblow].:2
	3:Вы бьёте наотмаш [pcube] по какой-то короткой веточке [pblow], которая тут же ускользает. Нож со свистом рассекает воздух [ecube], так и не причинив Кусту никакого ущерба [eblow].:3
	4:Лезвие ножа застревает в сплетённом щупальце [pcube]. Вы нажимаете сильнее [pblow], и Куст [ecube], видимо почувствовав, что вы собираетесь сделать, тут же отпускает нож [eblow].:4
	5:Нож сверкает будто молния [pcube], устремляясь к толстенной ветви [pblow]. Куст отчаянно бьёт вас по руке [ecube] и отражает смертоносный удар [eblow].:5
	6:Кусту [ecube] удаётся ухватить вас за руку парой щупалец [eblow]. Вы замахиваетесь [pcube], чтобы перерубить ветви ножом [pblow], и Куст тут же вас отпускает.:6
	7:Нож взлетает над головой [pcube] и обрушивается на Куст сверху вниз [pblow]. Однако ваша попытка разрубить его надвое не удаётся. Куст словно пытается отскочить назад [ecube], и все ветви его уходят в сторону от вашего удара [eblow].:7
	8:Дважды [pcube] вы обрушиваете свой нож на толстую ветвь [pblow], и дважды [ecube] она ускользает от вас [eblow].:8
	9:Вы пытаетесь [pcube] провести серию быстрых и лёгких ударов [pblow], но Кусту [ecube] каким-то образом удаётся уклониться от каждого из них [eblow].:9
	10:Раз за разом пытаетесь [pcube] вы вонзить острое лезвие в ветку [pblow], неуловимо [ecube] ускользающую и возвращающуюся вновь [eblow].:10
	11:Трясущиеся ветви будто бы разбегаются в стороны, когда вы [pcube] пытаетесь пригвоздить их к земле [pblow]. Утомившись, вы оставляете это бесплодное [ecube] занятие [eblow].:11
	12:Вы [pcube] размахиваетесь и что есть мочи ударяете по Кусту [pblow]. Жутко звякнув [ecube], лезвие вонзается в землю. Вы промахнулись? Нет, это Куст увернулся [eblow].:12
:eblock]
[eblow:
	2:Хлёсткими ударами [ecube] Куст лупит вас по щекам [eblow]. И весьма [pcube] болезненно лупит [pblow].:2
	3:Вражеские ветви [ecube] опутывают руки и ноги и швыряют вас о земь [eblow]. От удара [pcube] перехватывает дыхание [pblow], а Куст, кажется, готов к новой атаке.:3
	4:Удары толстых щупалец [ecube] сбивают вас с ног [eblow]. Вам [pcube] с трудом удаётся подняться [pblow].:4
	5:Щупальца [ecube] обвивают вас и присасываются намертво, причиняя невыносимую жгучую боль [eblow]. Лишь собрав все силы [pcube], вам удаётся оторвать их от себя [pblow].:5
	6:Куст [ecube] отвлекает ваше внимание верхними ветками, в то время как одна из нижних хватает вас за ногу и роняет на землю [eblow]. Вы [ecube] едва не выпускаете нож из рук [pblow].:6
	7:Нож взлетает над головой, готовый разрубить Куст [ecube] пополам, но ветви-щупальца тут же оплетают ваши ноги [eblow], и вы [pcube] падаете на землю, больно ударяясь спиной [pblow].:7
	8:Дважды вы обрушиваете свой нож на толстую ветвь, но оба раза он вязнет [ecube] в путах более мелких веточек. Куст едва не выхватывает у вас из рук оружие [eblow], и всё крепче сжимает [pcube] в объятиях многочисленных щупалец [pblow].:8
	9:Сразу несколько ветвей-щупалец [ecube] устремляется к вам [eblow]. Вы не успеваете [pcube] защититься и тяжкий удар едва не ломает вам рёбра [pblow].:9
	10:Ветви и подобранные с земли сучки [ecube] взмывают вверх, чтобы спустя мгновение вонзиться в ваши плечи и грудь [eblow]. Даже вы, майор, [pcube] не можете смолчать, почувствовав столь сильную боль [pblow].:10
	11:Куст [ecube] ухватывает руку, в которой вы сжимаете нож, и отличным хуком [eblow] справа сбивает вас [pcube] с ног [pblow].:11
	12:Дрожащие щупальца [ecube] охватывают вас тугими кольцами, и намертво присасываются к открытой коже [eblow]. Вы напрягаете тело и нечеловеческим усилием сбрасываете с себя живые путы. Раны, оставленные ветвями, сильно кровоточат [pcube], но это пол беды. Хуже всего то, что всё тело теперь чудовищно болит [pblow].:12
:eblow]
[pblock:
	2:Куст [ecube] пытается влепить вам пару пощёчин [eblow], но вы [pcube] легко отмахиваетесь от его ударов [pblow].:2
	3:Вражеские ветви [ecube] пытаются ухватить вас за руки и за ноги [eblow]. Вам удаётся отскочить в сторону [pcube], и ветви в бессильной ярости смыкаются вокруг воздуха [pblow].:3
	4:Удары толстых щупалец [ecube] едва не сбиваеют вас с ног [eblow], но вам [pcube] удаётся отбить их [pblow].:4
	5:Щупальца [ecube] пытаются обвить вас [eblow], но вы легко ускользаете [pcube] от их смертельных объятий [pblow].:5
	6:Куст пытается отвлечь внимание [ecube] нижними ветками, а сам пытается вырвать нож у вас из рук [eblow]. Вы вовремя замечаете это [pcube] и отбрасываете тонкую ветвь в сторону [pblow].:6
	7:Нож взлетает над головой, но вам приходится отказаться от идеи разрубить Куст пополам, ведь юркие ветви [ecube] в тот же миг устремляются к вашим ногам [eblow]. В последнее мгновенье [pcube] вам удаётся отпрыгнуть [pblow].:7
	8:Куст [ecube] крепко обхватывает вас [eblow], но вам удаётся сгрупироваться [pcube] и ловким борцовским приёмом выскользнуть из его смертельных объятий [pblow].:8
	9:Сразу несколько ветвей-щупалец [ecube] устремляется к вам, чтобы нанести тяжёлый удар в грудь [eblow]. Однако в этот раз вам [pcube] удаётся отбить их [pblow].:9
	10:Ветви и подобранные с земли сучки взмывают вверх [ecube]. Куст бросает их в вас, намереваясь пронзить плечи и грудь [eblow]. Вы делаете шаг назад [pcube], а затем отпрыгиваете в сторону. Его удар пропадает даром [pblow].:10
	11:Куст ухватывает руку [ecube], в которой вы держите нож, и пытается лягнуть вас одним из щупальец [eblow]. Точным движением вы отбрасываете ветку в сторону [pcube], а после вырываете и руку с ножом [pblow].:11
	12:Дрожащие щупальца пытаются охватить вас тугими кольцами [ecube], но им это не удаётся [eblow]. Вы ловко выскальзываете [pcube] из их чудовищных пут [pblow].:12
:pblock]
[pdeath:Куст хватает вас за ногу и волочёт в свои смертельные объятия. Спустя минуту вы опутаны сотнями веток-щупалец, которые сдавливают и терзают вас до тех пор, пока вы не теряете сознание.:pdeath]
[edeath:Могучим ударом вы рассекаете десятки ветвей и веточек, вонзая нож в самый корень. Вы рубите ещё и ещё, разбрасывая кругом ошмётки-щепки, и вскоре Куст оказывается срублен.:edeath]"
	end
end
:змея
if $args[0]='змея':
	if $args[2]='': $args['obj'] += '[:змея:] [name:Змея|Змеи|Змее|Змею|Змеёй|Змее:name] [np::np] [power:12] [fast:12] [sex:female:sex]'
	if $args[2]='blow':
		$args['obj'] += "[pblow:
	2:Вы [pcube] пытаетесь пронзить змеюку. Острый нож прокалывает толстую шкуру [pblow]. Змея [ecube], извиваясь, отхлёстывается в сторону [eblow].:2
	3:Вы [pcube] бьёте наотмашь. Лезвие вязнет в угольно-чёрной шкуре [pblow]. Змея [ecube] отчаянно бьёт хвостом и соскальзывает с лезвия [eblow].:3
	4:Лезвие ножа застревает в кончике хвоста, но вы [pcube] с усилием вырываете[pblow] его [ecube], едва уворчаиваясь от ответного выпада змеюки [eblow].:4
	5:Ваш нож [pcube] разит будто молния, вонзаясь в крепкую плоть [pblow]. Змея сворчаивается в пружину [ecube], очаянно бия хвостом по воздуху [eblow].:5
	6:Змее [ecube] удаётся обвиться вокруг ноги, и она начинает усиленно сдавливать вас [eblow]. Но вы не теряетесь [pcube] и несколько раз подряд вонзаете острие ножа в упругую плоть [ecube]. Змея ослабляет хватку и отползает подальше, жутко шипя.:6
	7:Нож взлетает над головой [pcube] и обрушивается на Змею сверху вниз. Однако ваша попытка отрубить ей голову не совсем удаётся [pblow] - вы лишь срываете [ecube] кусок чёрной кожи [eblow].:7
	8:Дважды [pcube] вы обрушиваете свой нож на упругое тело, но только с третьего раза вам удаётся пробить тугую шкуру [pblow]. Змея [ecube] тут же ускальзывает в сторону [eblow].:8
	9:Вы проводите серию [pcube] лёгких и быстрых ударов, отсекая лоскутки чешуйчатой кожи [pblow]. Змея [ecube] аж забилась от боли и ярости [eblow].:9
	10:Чёрные лохмотья отлетают в разные стороны, а вы [pcube] продолжаете рубить на одном дыхании [pblow]. Внезапно острые зубы устремляется к вашей шее [ecube]. Уф! Вы едва успели увернуться. Ещё бы сантиметр [eblow], и...:10
	11:Раз за разом вы [pcube] вонзаете острие в древоподобную тушу [pblow]; брызжет алая кровь, но рептилия [ecube], кажется, не собирается сдаваться [eblow].:11
	12:Вы [pcube] размахиваетесь и что есть мочи рубите Змею [ecube] острым лезивем [pblow]. Толстенное туловище извивается, скручиваясь в спирали и кольца [eblow].:12
:pblow]
[eblock:
	2:Вы пытаетесь пронзить [pcube] змеюку, нацелившись остриём чуть ниже плоской головы [pblow]. В самый последний миг рептилия изгибается [ecube] и удар пропадает даром [eblow].:2
	3:Вы бьёте наотмаш [pcube] пытаясь отрубить страшную голову [pblow], но она тут же ускользает. Нож со свистом рассекает воздух [ecube], так и не причинив Змее никакого вреда [eblow].:3
	4:Лезвие ножа проскальзывает по чешуе [pcube]. Вы пытаетесь повернуть оружие так, чтобы распороть Змее пузо [pblow], но та [ecube], видимо почувствовав, что вы собираетесь сделать, тут же с огромной скоростью отползает [eblow].:4
	5:Нож сверкает будто молния [pcube], устремляясь к чудовищно-толстой шее [pblow]. Змеиный хвост больно бьёт вас по руке [ecube] и отражает смертоносный удар [eblow].:5
	6:Змее [ecube] удаётся обвить вас за руку самым кончиком хвоста [eblow]. Вы замахиваетесь [pcube], чтобы перерубить хотя бы эту тонкую часть тулова [pblow], и Змея тут же вас отпускает.:6
	7:Нож взлетает над головой [pcube] и обрушивается на Змею сверху вниз [pblow]. Однако ваша попытка разрубить её жутку морду не удаётся. Змея пружиной [ecube] отскакивает в сторону [eblow].:7
	8:Дважды [pcube] вы обрушиваете свой нож на прочную шкуру [pblow], и дважды [ecube] изгиб змеиного тела ускользает от вас [eblow].:8
	9:Вы пытаетесь [pcube] провести серию быстрых и лёгких ударов [pblow], но Змее [ecube] каким-то образом удаётся уклониться от каждого из них [eblow].:9
	10:Раз за разом пытаетесь [pcube] вы вонзить острое лезвие в плоскую голову [pblow], неуловимо [ecube] ускользающую и возвращающуюся вновь [eblow].:10
	11:Извивы угольно-чёрной туши будто бы разбегаются в стороны, когда вы [pcube] пытаетесь пригвоздить их к земле [pblow]. Утомившись, вы оставляете это бесплодное [ecube] занятие [eblow].:11
	12:Вы [pcube] размахиваетесь и что есть мочи ударяете по чёрной чешуе [pblow]. Жутко звякнув [ecube], лезвие вонзается в землю. Вы промахнулись? Нет, это Змея увернулась [eblow].:12
:eblock]
[eblow:
	2:Хлёсткими ударами [ecube] хвоста Змея лупит вас по щекам [eblow]. Должно быть со стороны это выглядит забавно [pcube], вот только вам почему-то не до смеха [pblow].:2
	3:Могучий хвост [ecube] обхватывает вас и швыряет о земь [eblow]. От удара [pcube] перехватывает дыхание [pblow], а Змея, кажется, готова к новой атаке.:3
	4:Толстые кольца, извиваясь [ecube], сбивают вас с ног [eblow]. Вам [pcube] с трудом удаётся подняться [pblow].:4
	5:Змея [ecube] обвивает вас и сдавливает намертво, причиняя невыносимую боль [eblow]. Лишь собрав все силы [pcube], вам удаётся выбраться их её смертельных объятий [pblow].:5
	6:Змея [ecube] отвлекает ваше внимание жутким шипением, в то время как хлёсткие кольца роняют вас на землю [eblow]. Вы [eblow] едва не выпускаете нож из рук [pblow].:6
	7:Нож взлетает над головой, готовый разрубить Змею [ecube], но вы путаетесь в сплетении длинного хвоста [eblow], и [pcube] падаете на землю, больно ударяясь спиной [pblow].:7
	8:Дважды вы обрушиваете свой нож на толстую кожу, но оба раза он вязнет [ecube] в соскальзывает по чешуе, не причиняя Змее никакого вреда. Вы теряетесь в потоке перекатывающегося клубка мышц [eblow], котороый всё крепче сжимает [pcube] вас [pblow].:8
	9:Могучий хвост [ecube] устремляется к вам [eblow]. Вы не успеваете [pcube] защититься и тяжкий удар едва не ломает вам рёбра [pblow].:9
	10:Змея пытается вцепиться вам в горло, но [ecube] слегка промахивается, и огромное её туловище плашмя падает вам на плечо [eblow]. Даже вы, майор, [pcube] не можете смолчать, почувствовав столь сильную боль [pblow].:10
	11:Змея [ecube] выстреливает пружиной [eblow] и сбивает вас [pcube] с ног [pblow].:11
	12:Пульсирующая чёрная масса [ecube] охватывают вас тугими кольцами [eblow]. Вы напрягаете тело и нечеловеческим усилием сбрасываете с себя живые путы. Все кости болят [pcube], но это ещё пол беды [pblow]. Хуже всего то, что чёрный монстр уже готов к новой атаке.:12
:eblow]
[pblock:
	2:Как хлыстом, Змея пытается [ecube] сбить вас ударами хвоста [eblow], но вы [pcube] легко отмахиваетесь от её ударов [pblow].:2
	3:Могучий хвост [ecube] пытается обвить вас [eblow]. Вам удаётся вовремя выскочить из сжимающихся чёрных колец [pcube], и змея в бессильной ярости скручивается и отползает [pblow].:3
	4:Толстые кольца [ecube] едва не сбиваеют вас с ног [eblow], но вам [pcube] удаётся перескочить их [pblow].:4
	5:Змея [ecube] пытается обвить вас [eblow], но вы легко ускользаете [pcube] из её смертельных объятий [pblow].:5
	6:Змеюка жутко шипит, будто готовясь вцепиться зубами [ecube], но вы вовремя замечаете петли чёрных колец [eblow]. Вы уклоняетесь от могучего захвата [pcube] и отбрасываете кончик хвоста в сторону [pblow].:6
	7:Нож взлетает над головой, но вам приходится отказаться от идеи разрубить Змею пополам, ведь юркий хвост [ecube] в тот же миг устремляется к вашим ногам [eblow]. В последнее мгновение [pcube] вам удаётся отпрыгнуть [pblow].:7
	8:Змея [ecube] крепко обхватывает вас [eblow], но вам удаётся сгрупироваться [pcube] и ловким борцовским приёмом выскользнуть из её смертельных объятий [pblow].:8
	9:Сразу несколько колец могучего хвоста [ecube] устремляются к вам, чтобы нанести тяжёлый удар в грудь [eblow]. Однако в этот раз вам [pcube] удаётся отклонить их [pblow].:9
	10:Чудовище пытается вцепиться вам в плечо [ecube], но промахивается [eblow]. Вы делаете шаг назад [pcube], а затем отпрыгиваете в сторону. Удар змеюки пропадает даром [pblow].:10
	11:Змея [ecube] выстреливает пружиной [eblow], пытаясь лягнуть вас. Точным движением вы отклоняете её в сторону [pcube], слегка отбив руку, держащую нож [pblow]. Но это пустяки. :11
	12:Пульсирующая чёрная масса пытается охватить вас тугими кольцами [ecube], но монстру это не удаётся [eblow]. Вы ловко выскальзываете [pcube] из их могучих пут [pblow].:12
:pblock]
[pdeath:Страшные зубы вонзаются в ваше плечо, и вы чувствуете, как вспыхивают мышцы. Даже если яд не смертелен... - думаете вы, но додумать не успеваете. Взор застилает туманом, и вы погружаетесь в темноту.:pdeath]
[edeath:Ужасаясь собственному везению, вы хватаете змеюку за морду и сжимаете челюсти вместе. Почему-то тварь не пытается распахнуть пасть (может быть ошарашена?), а вы рубите и рубите куда-то в шею, пока не понимаете, что чёрное тело больше ничем не скрелпено с ужасной плоской головой.:edeath]"
	end
end
:муравей
if $args[0]='муравей':
	if $args[2]='': $args['obj'] += '[:муравей:] [name:Муравей|Муравья|Муравью|Муравья|Муравьём|Муравье:name] [np::np] [power:8] [fast:9] [sex:male:sex]'
end
:муравей1
if $args[0]='муравей1':
	if $args[2]='': $args['obj'] += '[:муравей1:] [name:Первый Муравей|Первого Муравья|Первому Муравью|Первого Муравья|Первым Муравьём|Первом Муравье:name] [np::np] [power:10] [fast:8] [sex:male:sex]'
end
:муравей2
if $args[0]='муравей2':
	if $args[2]='': $args['obj'] += '[:муравей2:] [name:Второй Муравей|Второго Муравья|Второму Муравью|Второго Муравья|Вторым Муравьём|Втором Муравье:name] [np::np] [power:8] [fast:8] [sex:male:sex]'
end
:муравей3
if $args[0]='муравей3':
	if $args[2]='': $args['obj'] += '[:муравей3:] [name:Первый Муравей|Первого Муравья|Первому Муравью|Первого Муравья|Первым Муравьём|Первом Муравье:name] [np::np] [power:10] [fast:9] [sex:male:sex]'
end
:муравей4
if $args[0]='муравей4':
	if $args[2]='': $args['obj'] += '[:муравей4:] [name:Второй Муравей|Второго Муравья|Второму Муравью|Второго Муравья|Вторым Муравьём|Втором Муравье:name] [np::np] [power:8] [fast:9] [sex:male:sex]'
end
:муравей5
if $args[0]='муравей5':
	if $args[2]='': $args['obj'] += '[:муравей5:] [name:Третий Муравей|Третьего Муравья|Третьему Муравью|Третьего Муравья|Третьим Муравьём|Третьем Муравье:name] [np::np] [power:9] [fast:9] [sex:male:sex]'
end
if instr($args[0],'муравей')!'':
	if $args[2]='blow':
		$args['obj'] += "Муравей. Заострённые палки, лапы.
11 вариантов удара (очки героя больше очков врага), 11 вариантов удара врага (очки врага больше очков героя)
22 варианта блокировки (кубики героя больше кубиков врага, или кубики врага больше кубиков героя, но очки равны)
1 вариант смерти врага
1 вариант смерти героя

[pblow:
	2:Вы [pcube] пытаетесь уколоть [name.В]. Острый нож вонзается в толстый хитиновый слой [pblow], пробивая в нём дыру [ecube]. Муравей дрожит от боли [eblow].:2
	3:Вы [pcube] бьёте наотмашь, отбивая острую палку [pblow]. [name] [ecube] истошно вопит от боли [eblow].:3
	4:Лезвие ножа застревает в древесине палки, но вы [pcube] с усилием вырываете[pblow] его [ecube], и бьёте [name.В] по лапам [eblow].:4
	5:Ваш нож [pcube] разит будто молния, вонзаясь в крепкую плоть [pblow]. [name] отчаянно бьёт [ecube] палкой по воздуху, но не успевает задеть вас [eblow].:5
	6:[name.Д] [ecube] удаётся ухватить вас за руку [eblow]. Но вы не теряетесь [pcube] и обршиваете лезвие на одну из лап [ecube]. [name] с трудом отклоняется назад.:6
	7:Нож взлетает над головой [pcube] и обрушивается на [name.В] сверху вниз. Однако ваша попытка разрубить его надвое не совсем удаётся [pblow] - вы лишь отбрасывате [ecube] заострённую палку вниз и в сторону [eblow].:7
	8:Дважды [pcube] вы обрушиваете свой нож на палку, что сжимает [name], но только с третьего раза вам удаётся пробить защиту [pblow]. [name] [ecube] резво отскакивает в сторону, раненный острым лезвием [eblow].:8
	9:Вы проводите серию [pcube] лёгких и быстрых ударов, нанося множество мелких ран [name.Д] [pblow]. Он [ecube] аж затрясся от боли и ярости [eblow].:9
	10:Щепки отлетают от палки, а вы [pcube] продолжаете рубить на одном дыхании [pblow]. Внезапно тяжёлая лапа устремляется вам в голову [ecube]. Уф! Вы едва успели увернуться. Ещё бы сантиметр [eblow], и [name] лишил бы вас сознания.:10
	11:Раз за разом вы [pcube] вонзаете острие в брюхо [name.Р] [pblow]; брызжет густая кровь, но насекомое [ecube], кажется, не собирается сдаваться [eblow].:11
	12:Вы [pcube] размахиваетесь и что есть мочи рубите [name.В] [ecube] острым лезвием [pblow]. [name] отдёргивает лапу, визжа от боли [eblow].:12
:pblow]
[eblock:
	2:Нож сверкает будто молния [pcube], врезаясь в стремительную палку [pblow]. [name] отчаянно отражает [ecube] все ваши удары [eblow].:2
	3:Вы пытаетесь пробить [pcube] защиту [name.Р] [pblow]. Утомившись, оставляете это бесплодное [ecube] занятие [eblow].:3
	4:Вы пытаетесь уколоть [pcube] [name.В], нацелившись остриём в хитиновую грудь [pblow]. В самый последний миг [name] уворачивается [ecube], и удар пропадает даром [eblow].:4
	5:[name] [ecube] перехватывает ваш удар [eblow]. Вы проводите обманный манёвр [pcube], нож проныривает под палку [pblow], но [name] тут же отбрасывает его в сторону и отступает.:5
	6:Раз за разом пытаетесь [pcube] вы вонзить острое лезвие в грудь [name.Д] [pblow], но тот ловкими движениями [ecube] отбрасывает нож от себя [eblow].:6
	7:Дважды [pcube] вы обрушиваете свой нож на толстую палку [pblow], которая словно пружина [ecube] отшвыривает его обратно [eblow].:7
	8:Вы бьёте наотмаш [pcube], надеясь поразить [name.В] в плечо [pblow]. [name] легко уворачивается. Нож со свистом рассекает воздух [ecube], так и не причинив [name.Д] никакого ущерба [eblow].:8
	9:Вы пытаетесь [pcube] провести серию быстрых и лёгких ударов [pblow], но [name.Д] [ecube] каким-то образом удаётся уклониться от каждого из них [eblow].:9
	10:Лезвие ножа застревает в прочной палке [pcube]. Вы нажимаете сильнее, пытаясь скользящим ударом пробить защиту [name.Р] [pblow], однако [name] [ecube] тут же дёргает палку вверх и отбрасывает вас от себя [eblow].:10
	11:Вы [pcube] размахиваетесь и что есть мочи ударяете по [name.Д] [pblow]. Жутко звякнув [ecube], лезвие вонзается в землю. Вы промахнулись? Нет, это [name] увернулся [eblow].:11
	12:Нож взлетает над головой [pcube] и обрушивается на [name.В] сверху вниз [pblow]. Однако ваша попытка разрубить его надвое не удаётся. [name] словно ловко отскакивает назад [ecube], прикрываясь палкой [eblow].:12
:eblock]
[eblow:
	2:[name] размахивается [ecube] и бьёт вас палкой по плечу [eblow]. До чего же [pcube] больно [pblow]!:2
	3:Палка мчится к вашим ногам [ecube]. Вы не успеваете отпрыгнуть и падаете на землю [eblow]. От удара [pcube] перехватывает дыхание [pblow], а [name], кажется, готов к новой атаке.:3
	4:Удары тяжёлой палки [ecube] сбивают вас с ног [eblow]. Вам [pcube] с трудом удаётся подняться [pblow].:4
	5:Палка [ecube] вонзается вам в плечо, причиняя невыносимую жгучую боль [eblow]. К счастью [pcube], вам удаётся выдернуть острие [pblow].:5
	6:[name] [ecube] проводит обманный манёвр и сбивает вас с ног [eblow]. Вы [ecube] едва не выпускаете нож из рук [pblow].:6
	7:Нож взлетает над головой, готовый разрубить [name.В] [ecube] пополам, но палка тут же поднимается навстречу и отбрасывает вас на землю [eblow]. Вы [pcube] падаете, больно ударяясь спиной [pblow].:7
	8:Дважды вы обрушиваете свой нож на [name.В], но оба раза он натыкается [ecube] на прочную палку. [name] едва не выбивает у вас из рук оружие [eblow], и болезненно [pcube] ударяет нижним концом палки вам по коленям [pblow].:8
	9:Тупой конец палки [ecube] устремляется к вам по сложной траектории[eblow]. Вы не успеваете [pcube] защититься, и тяжкий удар едва не ломает вам рёбра [pblow].:9
	10:[name] взметает облако песка и пыли [ecube]. Спустя мгновение тупой конец палки ударяет вас в голову [eblow]. Отплёвываясь и прикрывая лицо от новых ударов, [pcube] вы отскакиваете в сторону [pblow].:10
	11:[name] [ecube] палкой отбрасывает нож, и внезапно [eblow] бьёт вас тупым концом [pcube] по рёбрам [pblow].:11
	12:Вы пытаетесь провести удар снизу вверх, но [name] [ecube] ловко парирует и вонзает острый конец палки вам в бедро [eblow]. Вы тут же выдёргиваете палку [pcube] из кровоточащей раны [pblow].:12
:eblow]
[pblock:
	2:[name] размахивается [ecube] и пытается ударить вас палкой по плечу [eblow], но вы вовремя выставляете прочное лезвие ножа [pcube], блокируя удар [pblow]!:2
	3:Палка [ecube] мчится к вашим ногам [eblow]. Вы мгновенно реагируете [pcube] на столь неприкрытую попытку повалить вас на землю и отскакиваете [pblow].:3
	4:Удары тяжёлой палки [ecube] едва не сбивают вас с ног [eblow]. Вам [pcube] с трудом удаётся парировать их [pblow].:4
	5:Палка [ecube] чуть было не вонзилась вам в плечо [eblow]. К счастью [pcube], вам удаётся отбить острие [pblow].:5
	6:[name] [ecube] проводит обманный манёвр, надеясь сбить вас с ног [eblow]. Вы [ecube] едва не выпускаете нож из рук, но всё же удерживаете и оружие и равновесие [pblow].:6
	7:Нож взлетает над головой, готовый разрубить [name.В] [ecube] пополам, но палка тут же поднимается навстречу и отбрасывает вас на землю [eblow]. Вы [pcube] приземляетесь на ноги ловко, как кошка [pblow].:7
	8:Острая палка [ecube] пролетает в сантиметре от вашего уха [eblow]. Лишь чудом [pcube] вам удаётся увернуться [pblow].:8
	9:Тупой конец палки [ecube] устремляется к вам по сложной траектории[eblow]. Вот только и вы не лыком шиты [pcube]. Одним точным движением вы отбиваете этот замысловатый удар [pblow].:9
	10:[name] взметает [ecube] облако песка и пыли [eblow]. Вы вовремя отворачиваетесь [pcube] и отскакиваете в сторону, уклоняясь от последовавшего за этим удара[pblow].:10
	11:[name] [ecube] палкой отбрасывает нож, и пытается [eblow] сокрушить вас ударом по рёбрам. Вы отражаете удар рукой [pcube], хотя и чуть отбиваете её [pblow]:11
	12:Острый конец палки [ecube] устремляется вам в бедро [eblow]. Вы тут же отбрасываете его [pcube], избегая болезненного укола [pblow].:12
:pblock]
[pdeath:[name] отшвыривает ваш нож в сторону. Острое лезвие вонзается в землю, а к вашей груди устремляется острая палка. Вы не успеваете даже подумать о том, что произошло, как [name] пронзает вас насквозь.:pdeath]
[edeath:[name] пытается отшвырнуть ваш нож в сторону, но вы ловко поворачиваете лезвие, которое проскальзывает под палкой и глубоко пронзает хитиновую грудь насекомого. [name] падает в землю.:edeath]"
	end
end
:шар_хищник
if $args[0]='шар_хищник':
	if $args[2]='': $args['obj'] += '[:шар_хищник:] [name:Шар-Хищник|Шара-Хищника|Шару-Хищнику|Шар-Хищник|Шаром-Хищником|Шаре-Хищнике:name] [np::np] [power:6] [fast:10] [sex:male:sex]'
	if $args[2]='blow':
		$args['obj'] += "[pblow:
	2:Вы [pcube] пытаетесь пронзить Шар. Острый нож прокалывает толстую шкуру [pblow]. Чудище [ecube] откатывается в сторону [eblow].:2
	3:Вы [pcube] бьёте наотмашь. Лезвие вязнет в щетинистой шкуре монстра [pblow]. Шар [ecube] подпрыгивает на месте и укатывается подальше [eblow].:3
	4:Лезвие ножа застревает в упругой плоти, но вы [pcube] с усилием вырываете[pblow] его [ecube], едва уворчаиваясь от ответного выпада хищника [eblow].:4
	5:Ваш нож [pcube] разит будто молния, вонзаясь в крепкую плоть [pblow]. Шар перекатывается из стороны в сторону [ecube], но не может уйти от быстрых ударов, тогда он отскакивает назад [eblow].:5
	6:Шар [ecube] накатывается на вас в попытке задавить массой [eblow]. Но вы не теряетесь [pcube] и несколько раз подряд вонзаете острие ножа в упругую плоть [ecube]. Шар тут же отпрыгивает обратно.:6
	7:Нож взлетает над головой [pcube] и обрушивается на хищника сверху вниз. Однако ваша попытка разрубить его не совсем удаётся [pblow] - вы лишь срываете [ecube] несколько толстых щетин с кусками кожи [eblow]. Удивительно, но никаких ран на Шаре не видно.:7
	8:Дважды [pcube] вы обрушиваете свой нож на упругое тело, но только с третьего раза вам удаётся пробить тугую шкуру [pblow]. Шар [ecube] тут же укатывается в сторону [eblow].:8
	9:Вы проводите серию [pcube] лёгких и быстрых ударов, отсекая толстые щетины одну за другой [pblow]. Шар [ecube] аж как-то ужался от боли и ярости [eblow].:9
	10:Серые щетинки с кусками плоти отлетают в разные стороны, а вы [pcube] продолжаете рубить на одном дыхании [pblow]. Внезапно острые когти устремляется к вашей шее [ecube]. Уф! Вы едва успели увернуться. Ещё бы сантиметр [eblow], и...:10
	11:Раз за разом вы [pcube] вонзаете острие в сферическую тушу [pblow]; брызжет алая кровь, но хищник [ecube], кажется, не собирается сдаваться [eblow].:11
	12:Вы [pcube] размахиваетесь и что есть мочи рубите по шару [ecube] острым лезивем [pblow]. Громадное тело съёживается и ощетинивается [eblow].:12
:pblow]
[eblock:
	2:Вы [pcube] пытаетесь пронзить Шар. Острый нож проскальзывает по толстой шкуре [pblow]. Чудище [ecube] откатывается в сторону [eblow].:2
	3:Вы [pcube] бьёте наотмашь. Лезвие пружинит от серой щетины монстра [pblow]. Шар [ecube] подпрыгивает на месте и укатывается подальше [eblow].:3
	4:Лезвие ножа мчится к упругой плоти, но вы [pcube] едва успеваете отдёрнуть руку [pblow], когда из шара вдруг возникает тонкая лапа [ecube] с острыми когтями [eblow].:4
	5:Ваш нож [pcube] разит будто молния, но [pblow] Шар перекатывается из стороны в сторону [ecube], и с лёгкостью уходит от быстрых ударов, а после отскакивает назад [eblow].:5
	6:Шар [ecube] накатывается на вас в попытке задавить массой [eblow]. Но вы не теряетесь [pcube] и несколько раз подряд выбрасываете острие ножа [ecube]. Шар тут же отпрыгивает обратно.:6
	7:Нож взлетает над головой [pcube] и обрушивается на хищника сверху вниз. Однако ваша попытка разрубить его не удаётся [pblow] хищник легко [ecube] уходит от удара [eblow].:7
	8:Дважды [pcube] вы обрушиваете свой нож на упругое тело, но вам так и не удаётся ранить монстра [pblow]. Шар [ecube] легко укатывается в сторону [eblow].:8
	9:Вы проводите серию [pcube] лёгких и быстрых ударов, пытаясь попасть туда, откуда появлялись лапы [pblow]. Однако [ecube] чудище каким-то образом уворачивается, перекатываясь на месте [eblow].:9
	10:Вы пытаетесь отрубить  [pcube] появляющиеся и исчезающие лапы [pblow]. Вот только хищник [ecube] будто бы предугадывает каждое ваше движение [eblow]. В бессильном гневе вы прекращаете безнадёжное занятие.:10
	11:Раз за разом вы [pcube] пытаетесь вонзить нож в сферическую тушу [pblow]; Однако Шар [ecube], кажется, не собирается сдаваться [eblow], и ловко уворачивается от всех ваших выпадов, перекатываясь на месте.:11
	12:Вы [pcube] размахиваетесь и что есть мочи рубите сверху вниз [ecube] острым лезивем [pblow]. Громадное тело съёживается и отскакивает [eblow]. Нож вонзается в землю.:12
:eblock]
[eblow:
	2:Острые когти [ecube] вонзаются в ваши плечи [eblow]. Хотя лапы чудовища и сильны, но вам удаётся [pcube] отбросить их [pblow].:2
	3:Шар накатывается на вас [ecube] и швыряет на земь [eblow]. От удара [pcube] перехватывает дыхание [pblow], а Шар уже готовится к новой атаке.:3
	4:Тяжёлый удар [ecube], от которого вам не удаётся увернуться, валит вас на землю [eblow]. С большим трудом [pcube] вам удаётся подняться [pblow].:4
	5:Шар выбрасывает тонкие лапы [ecube], и когти вонзаются вам в бок, причиняя невыносимую боль [eblow]. Хищник тут же выдёргивает их [pcube] и прячет в густой щетине [pblow].:5
	6:Шар [ecube] выбрасывает вперёд одну когтистую лапу. Пока вы отвлекаетесь, отбивая столь внезапную атаку, он выбрасывает вторую, сильно царапая вам руку [eblow]. Вы [eblow] едва не упускаете нож [pblow].:6
	7:Нож взлетает над головой, готовый разрубить сферического монстра [ecube], но вы оступаетесь. Хищник хлёстко бьёт лапой по плечу [eblow], и вы [pcube] падаете на землю, больно ударяясь спиной [pblow].:7
	8:Дважды вы обрушиваете свой нож на толстую кожу, но оба раза он вязнет [ecube] и соскальзывает по жёсткой щетине, не причиняя хищнику никакого вреда. Вы не успеваете уследить за быстро мелькающими когтями [eblow], которые отчаянно царапают [pcube] вас [pblow].:8
	9:Громадный шар с необычайной скоростью [ecube] устремляется к вам [eblow]. Вы не успеваете [pcube] защититься и тяжкий удар едва не ломает вам рёбра [pblow].:9
	10:Хищник пытается вцепиться вам в горло, но [ecube] слегка промахивается, и острые когти лишь пропарывают плечо [eblow]. Даже вы, майор, [pcube] не можете смолчать, почувствовав столь сильную боль [pblow].:10
	11:Шар [ecube] выбрасывает острые когти [eblow] и вонзает их [pcube] прямо вам в бедро [pblow].:11
	12:Пульсирующая серый шар [ecube] подпрыгивает в воздух и обрушивается на вас сверху [eblow]. Вы напрягаете тело и нечеловеческим усилием отбиваете чудовищный удар. Все кости болят [pcube], но это ещё пол беды [pblow]. Хуже всего то, что монстр уже готов к новой атаке.:12
:eblow]
[pblock:
	2:Острые когти [ecube] устремляются к вашим плечам [eblow]. Хотя лапы чудовища и сильны, но вам удаётся [pcube] отбросить их [pblow].:2
	3:Шар накатывается на вас [ecube] в попытке раздавить [eblow]. Вы вовремя отпрыгиваете в сторону [pcube] и угрожающе выставляете перед собой нож [pblow].:3
	4:Тяжёлый удар [ecube] скачущего, как мячик, хищника едва не приминает вас к земле [eblow]. Каким-то чудом [pcube] вам удаётся уйти от этой ужасной атаки [pblow].:4
	5:Шар выбрасывает тонкие лапы [ecube], и когти едва не пронзают вам бок [eblow]. Не успеваете вы полоснуть по ним [pcube], как лапы вновь исчезают в густой щетине [pblow].:5
	6:Шар [ecube] выбрасывает вперёд одну когтистую лапу. Пока вы отвлекаетесь, отбивая столь внезапную атаку, он выбрасывает вторую [eblow]. Чего-то подобного вы и ожидали, [eblow] а потому вам не составляет труда отбить атаку [pblow].:6
	7:Нож взлетает над головой, готовый разрубить сферического монстра [ecube], но вы оступаетесь. Хищник мгновенно выбрасывает когтистую лапу [eblow], вот только достать вас не получается: вы упали на землю [pcube]. Благо падение не причинило большого вреда. Вы тут же вскакиваете [pblow].:7
	8:Вы не успеваете уследить [ecube] за быстро мелькающими когтями [eblow], которые отчаянно пытаются поцарапать вас [pcube], поэтому просто уходите чуть в сторону и назад [pblow].:8
	9:Громадный шар с необычайной скоростью [ecube] устремляется к вам [eblow]. Вы выставляете вперёд нож [pcube], и хищник тут же замирает в миллиметре от опасного острия [pblow].:9
	10:Хищник пытается вцепиться вам в горло, но [ecube] слегка промахивается, и острые когти устремляются к плечу [eblow]. Вы подставляете клинок под удар [pcube]: когти глухо скрежещут по металлу и исчезают в серой щетине [pblow].:10
	11:Шар [ecube] выбрасывает острые когти [eblow], пытаясь вонзить их прямо вам в бедро [pcube], вот только вы поднимаете клинок и легко отражаете нехитрый удар [pblow].:11
	12:Пульсирующая серый шар [ecube] подпрыгивает в воздух и обрушивается на вас сверху [eblow]. Вы напрягаете тело [pcube] и нечеловеческим усилием отскакиваете как можно дальше [pblow]. Земля под рухнувшим хищником вздымается ужасающей волной и застывает в виде кромки кратера.:12
:pblock]
[pdeath:Острые когти вонзаются в ваше плечо, ногу прожигает адсокой болью. Шар-Хищник вдруг взмывает вверх и точным броском обрушивается на вас, погружая мир в щетинистую вонючую темноту.:pdeath]
[edeath:Когтистая лапа устремляется к вашему лицу. Рука действует рефлекторно и одним быстрым махом отрубает тонкую конечность. Шар съёживается и пытается отскочить, но вы догоняете серого монстра и вонзаете, и вонзаете, и вонзаете! в него нож, пока не понимаете, что чудовище перестало двигаться.:edeath]"
	end
end
:сороконожка
if $args[0]='сороконожка':
	if $args[2]='': $args['obj'] += '[:сороконожка:] [name:Сороконожка|Сороконожки|Сороконожке|Сороконожку|Сороконожкой|Сороконожке:name] [np::np] [power:6] [fast:7] [sex:female:sex]'
end
:сороконожка0
if $args[0]='сороконожка0':
	if $args[2]='': $args['obj'] += '[:сороконожка0:] [name:Сороконожка|Сороконожки|Сороконожке|Сороконожку|Сороконожкой|Сороконожке:name] [np::np] [power:6] [fast:12] [sex:female:sex]'
end
:росянка
if $args[0]='росянка':
	if $args[2]='': $args['obj'] += '[:росянка:] [name:«Росянка»|«Росянки»|«Росянке»|«Росянку»|«Росянкой»|«Росянке»:name] [np::np] [power:8] [fast:7] [sex:female:sex]'
end
:рыцарь
if $args[0]='рыцарь':
	if $args[2]='': $args['obj'] += '[:рыцарь:] [name:Рыцарь|Рыцаря|Рыцарю|Рыцаря|Рыцарем|Рыцаре:name] [np::np] [power:12] [fast:10] [sex:male:sex]'
end
:жук
if $args[0]='жук':
	if $args[2]='': $args['obj'] += '[:жук:] [name:Жук|Жука|Жуку|Жука|Жуком|Жуке:name] [np::np] [power:9] [fast:9] [sex:male:sex]'
end
:ракоскорпион
if $args[0]='ракоскорпион':
	if $args[2]='': $args['obj'] += '[:ракоскорпион:] [name:Ракоскорпион|Ракоскорпиона|Ракоскорпиону|Ракоскорпиона|Ракоскорпионом|Ракоскорпионе:name] [np::np] [power:9] [fast:9] [sex:male:sex]'
end
:зверь1
if $args[0]='зверь1':
	if $args[2]='': $args['obj'] += '[:зверь1:] [name:Первый Зверь|Первого Зверя|Первому Зверю|Первого Зверя|Первым Зверем|Первом Звере:name] [np::np] [power:10] [fast:9] [sex:male:sex]'
end
:зверь2
if $args[0]='зверь2':
	if $args[2]='': $args['obj'] += '[:зверь2:] [name:Второй Зверь|Второго Зверя|Второму Зверю|Второго Зверя|Вторым Зверем|Втором Звере:name] [np::np] [power:8] [fast:9] [sex:male:sex]'
end
:зверь3
if $args[0]='зверь3':
	if $args[2]='': $args['obj'] += '[:зверь3:] [name:Серебристый Зверь|Серебристого Зверя|Серебристому Зверю|Серебристого Зверя|Серебристым Зверем|Серебристом Звере:name] [np::np] [power:10] [fast:9] [sex:male:sex]'
end
:кузнечик
if $args[0]='кузнечик':
	if $args[2]='': $args['obj'] += '[:кузнечик:] [name:«Кузнечик»|«Кузнечика»|«Кузнечику»|«Кузнечика»|«Кузнечиком»|«Кузнечике»:name] [np::np] [power:10] [fast:10] [sex:male:sex]'
end
:повар
if $args[0]='повар':
	if $args[2]='': $args['obj'] += '[:повар:] [name:Повар|Повара|Повару|Повара|Поваром|Поваре:name] [np::np] [power:12] [fast:8] [sex:male:sex]'
end
:грабитель3
if $args[0]='грабитель3':
	if $args[2]='': $args['obj'] += '[:грабитель3:] [name:Первый Грабитель|Первого Грабителя|Первому Грабителю|Первого Грабителя|Первым Грабителем|Первом Грабителе:name] [np::np] [power:10] [fast:9] [sex:male:sex]'
end
:грабитель4
if $args[0]='грабитель4':
	if $args[2]='': $args['obj'] += '[:грабитель4:] [name:Второй Грабитель|Второго Грабителя|Второму Грабителю|Второго Грабителя|Вторым Грабителем|Втором Грабителе:name] [np::np] [power:11] [fast:9] [sex:male:sex]'
end
:грабитель5
if $args[0]='грабитель5':
	if $args[2]='': $args['obj'] += '[:грабитель5:] [name:Третий Грабитель|Третьего Грабителя|Третьему Грабителю|Третьего Грабителя|Третьим Грабителем|Третьем Грабителе:name] [np::np] [power:12] [fast:8] [sex:male:sex]'
end
:стражник
if $args[0]='стражник':
	if $args[2]='': $args['obj'] += '[:стражник:] [name:Стражник|Стражника|Стражнику|Стражника|Стражником|Стражнике:name] [np::np] [power:8] [fast:8] [sex:male:sex]'
end
:паук
if $args[0]='паук':
	if $args[2]='': $args['obj'] += '[:паук:] [name:Паук|Паука|Пауку|Паука|Пауком|Пауке:name] [np::np] [power:8] [fast:9] [sex:male:sex]'
end
:робот
if $args[0]='робот':
	if $args[2]='': $args['obj'] += '[:робот:] [name:Робот|Робота|Роботу|Робота|Роботом|Роботе:name] [np::np] [power:8] [fast:8] [sex:male:sex] [blow:3]'
end
:эйнар
if $args[0]='эйнар':
	if $args[2]='': $args['obj'] += '[:эйнар:] [name:Эйнар Чёрный Щит|Эйнара Чёрного Щита|Эйнару Чёрному Щиту|Эйнара Чёрный Щит|Эйнаром Чёрным Щитом|Эйнаре Чёрном Щите:name] [np::np] [power:12] [fast:10] [sex:male:sex]'
end
:куст_вампир
if $args[0]='куст_вампир':
	if $args[2]='': $args['obj'] += '[:куст_вампир:] [name:Куст-Вампир|Куста-Вампира|Кусту-Вампиру|Куст-Вампир|Кустом-Вампиром|Кусте-Вампире:name] [np::np] [power:8] [fast:11] [sex:male:sex]'
end
:бертольд
if $args[0]='бертольд':
	if $args[2]='': $args['obj'] += '[:бертольд:] [name:Бертольд из Соргейля|Бертольда из Соргейля|Бертольду из Соргейля|Бертольда из Соргейля|Бертольдом из Соргейля|Бертольде из Соргейля:name] [np::np] [power:10] [fast:10] [sex:male:sex]'
end
:обезьянопаук
if $args[0]='обезьянопаук':
	if $args[2]='': $args['obj'] += '[:обезьянопаук:] [name:Обезьянопаук|Обезьянопаука|Обезьянопауку|Обезьянопаука|Обезьянопауком|Обезьянопауке:name] [np::np] [power:10] [fast:10] [sex:male:sex]'
end
:пират
if $args[0]='пират':
	if $args[2]='': $args['obj'] += '[:пират:] [name:Пират|Пирата|Пирату|Пирата|Пиратом|Пирате:name] [np::np] [power:9] [fast:9] [sex:male:sex]'
end
:безумец
if $args[0]='безумец':
	if $args[2]='': $args['obj'] += '[:безумец:] [name:Безумец|Безумца|Безумцу|Безумца|Безумцем|Безумце:name] [np::np] [power:12] [fast:9] [sex:male:sex]'
end
:палеандр
if $args[0]='палеандр':
	if $args[2]='': $args['obj'] += '[:палеандр:] [name:Палеандр Неукротимый|Палеандра Неукротимого|Палеандру Неукротимому|Палеандра Неукротимого|Палеандром Неукротимым|Палеандре Неукротимом:name] [np::np] [power:12] [fast:10] [sex:male:sex]'
end
:наглец
if $args[0]='наглец':
	if $args[2]='': $args['obj'] += '[:наглец:] [name:Наглец|Наглеца|Наглецу|Наглеца|Наглецом|Наглеце:name] [np::np] [power:10] [fast:11] [sex:male:sex]'
end
:бронсон
if $args[0]='бронсон':
	if $args[2]='': $args['obj'] += '[:бронсон:] [name:Бронсон|Бронсона|Бронсону|Бронсона|Бронсоном|Бронсоне:name] [np::np] [power:10] [fast:10] [sex:male:sex]'
end
:бабочка
if $args[0]='бабочка':
	if $args[2]='': $args['obj'] += '[:бабочка:] [name:«Бабочка»|«Бабочки»|«Бабочке»|«Бабочку»|«Бабочкой»|«Бабочке»:name] [np::np] [power:8] [fast:8] [sex:female:sex]'
end
:шершень1
if $args[0]='шершень1':
	if $args[2]='': $args['obj'] += '[:шершень1:] [name:Первый Шершень|Первого Шершня|Первому Шершню|Первого Шершня|Первым Шершнем|Первом Шершне:name] [np::np] [power:8] [fast:8] [sex:male:sex]'
end
:шершень2
if $args[0]='шершень2':
	if $args[2]='': $args['obj'] += '[:шершень2:] [name:Второй Шершень|Второго Шершня|Второму Шершню|Второго Шершня|Вторым Шершнем|Втором Шершне:name] [np::np] [power:6] [fast:8] [sex:male:sex]'
end
:разбойник1
if $args[0]='разбойник1':
	if $args[2]='': $args['obj'] += '[:разбойник1:] [name:Первый Разбойник|Первого Разбойника|Первому Разбойнику|Первого Разбойника|Первым Разбойником|Первом Разбойнике:name] [np::np] [power:8] [fast:9] [sex:male:sex]'
end
:разбойник2
if $args[0]='разбойник2':
	if $args[2]='': $args['obj'] += '[:разбойник2:] [name:Второй Разбойник|Второго Разбойника|Второму Разбойнику|Второго Разбойника|Вторым Разбойником|Втором Разбойнике:name] [np::np] [power:9] [fast:9] [sex:male:sex]'
end
:разбойник3
if $args[0]='разбойник3':
	if $args[2]='': $args['obj'] += '[:разбойник3:] [name:Третий Разбойник|Третьего Разбойника|Третьему Разбойнику|Третьего Разбойника|Третьим Разбойником|Третьем Разбойнике:name] [np::np] [power:10] [fast:8] [sex:male:sex]'
end
$args['obj']+=$args[1]
$result=$args['obj']
--- base.ratch ---------------------------------

QSP-Game ! выводит нужный текст
$args[0] = $args[0]	&	!	какой текст выбрать
$args[1], $args[2], $args[3] и т.д.	&	!	модификации текста
# base.txt
$args[9] = $args[9]
if $args[0] = 'table.mainsets':
	if $AVS_PLAYERTYPE['size']="MINI":
		$args['res']=''
		$args['2.2']='&nbsp;'
		$args['2.3']='&nbsp;'
		$args['2.4']='&nbsp;'
		$args['2.5']='&nbsp;'
		$args['2.6']='&nbsp;'
		$args['2.7']='&nbsp;'
		$args['2.8']='&nbsp;'
		$args['2.9']='&nbsp;'
		$args['2.10']='&nbsp;'
		$args['2.11']='&nbsp;'
		$args['2.12']='&nbsp;'
		if $args[1]<>'':
			$args[$args[1]]='<span style="color:#aaaa00;">'
			$args['1:'+$args[1]]='</span>'
			$args['2.'+$args[1]]='&gt;'
			$args['c']='Вариант|'
			$args['1.2']='[cur]&nbsp;2|2[/cur]'
			$args['1.3']='[cur]&nbsp;3|3[/cur]'
			$args['1.4']='[cur]&nbsp;4|4[/cur]'
			$args['1.5']='[cur]&nbsp;5|5[/cur]'
			$args['1.6']='[cur]&nbsp;6|6[/cur]'
			$args['1.7']='[cur]&nbsp;7|7[/cur]'
			$args['1.8']='[cur]&nbsp;8|8[/cur]'
			$args['1.9']='[cur]&nbsp;9|9[/cur]'
			$args['1.10']='[cur]10|10[/cur]'
			$args['1.11']='[cur]11|11[/cur]'
			$args['1.12']='[cur]12|12[/cur]'
		else
			$args['c']='На кубиках|'
			$args['1.2']='&nbsp;2'
			$args['1.3']='&nbsp;3'
			$args['1.4']='&nbsp;4'
			$args['1.5']='&nbsp;5'
			$args['1.6']='&nbsp;6'
			$args['1.7']='&nbsp;7'
			$args['1.8']='&nbsp;8'
			$args['1.9']='&nbsp;9'
			$args['1.10']='10'
			$args['1.11']='11'
			$args['1.12']='12'
		end
		$args['res']+=$args['c']+'ЛОВКОСТЬ|СИЛА|ОБАЯНИЕ<br>'
		$args['res']+='<h3>'+$args['2']+$args['2.2']+$args['1.2']+'|&nbsp;8|22|8&nbsp; &nbsp;'+$args['1:2']+$args['8']+$args['2.8']+$args['1.8']+'10|16|7'+$args['1:8']+'</h3>'
		$args['res']+='<h3>'+$args['3']+$args['2.3']+$args['1.3']+'|10|20|6&nbsp; &nbsp;'+$args['1:3']+$args['9']+$args['2.9']+$args['1.9']+'&nbsp;8|24|7'+$args['1:9']+'</h3>'
		$args['res']+='<h3>'+$args['4']+$args['2.4']+$args['1.4']+'|12|16|5&nbsp; &nbsp;'+$args['1:4']+$args['10']+$args['2.10']+$args['1.10']+'&nbsp;9|22|6'+$args['1:10']+'</h3>'
		$args['res']+='<h3>'+$args['5']+$args['2.5']+$args['1.5']+'|&nbsp;9|18|8&nbsp; &nbsp;'+$args['1:5']+$args['11']+$args['2.11']+$args['1.11']+'10|18|7'+$args['1:11']+'</h3>'
		$args['res']+='<h3>'+$args['6']+$args['2.6']+$args['1.6']+'|11|20|6&nbsp; &nbsp;'+$args['1:6']+$args['12']+$args['2.12']+$args['1.12']+'11|20|5'+$args['1:12']+'</h3>'
		$args['res']+='<h3>'+$args['7']+$args['2.7']+$args['1.7']+'|&nbsp;9|20|7&nbsp; &nbsp;'+$args['1:7']+'</h3>'
	else
		$args['res']='<table border=1 cellpadding=5 width=100%>'
		$args[$args[1]]=' bgcolor=#ffffbb'
		if $args[1]='':
			$args['c']='На кубиках:'
			$args['1.2']='2'
			$args['1.3']='3'
			$args['1.4']='4'
			$args['1.5']='5'
			$args['1.6']='6'
			$args['1.7']='7'
			$args['1.8']='8'
			$args['1.9']='9'
			$args['1.10']='10'
			$args['1.11']='11'
			$args['1.12']='12'
		else
			$args['c']='Варианты:'
			$args['1.2']='[cur]2|2[/cur]'
			$args['1.3']='[cur]3|3[/cur]'
			$args['1.4']='[cur]4|4[/cur]'
			$args['1.5']='[cur]5|5[/cur]'
			$args['1.6']='[cur]6|6[/cur]'
			$args['1.7']='[cur]7|7[/cur]'
			$args['1.8']='[cur]8|8[/cur]'
			$args['1.9']='[cur]9|9[/cur]'
			$args['1.10']='[cur]10|10[/cur]'
			$args['1.11']='[cur]11|11[/cur]'
			$args['1.12']='[cur]12|12[/cur]'
		end
		$args['res']+='<tr name=mainsets><td align=center width=25%>'+$args['c']+'</td><td align=center width=25%>ЛОВКОСТЬ</td><td align=center width=25%>СИЛА</td><td align=center width=25%>ОБАЯНИЕ</td></tr>'
		$args['res']+='<tr '+$args['2']+'><td align=center >'+$args['1.2']+'</td><td align=center>8</td><td align=center>22</td><td align=center>8</td></tr>'
		$args['res']+='<tr '+$args['3']+'><td align=center >'+$args['1.3']+'</td><td align=center>10</td><td align=center>20</td><td align=center>6</td></tr>'
		$args['res']+='<tr '+$args['4']+'><td align=center >'+$args['1.4']+'</td><td align=center>12</td><td align=center>16</td><td align=center>5</td></tr>'
		$args['res']+='<tr '+$args['5']+'><td align=center >'+$args['1.5']+'</td><td align=center>9</td><td align=center>18</td><td align=center>8</td></tr>'
		$args['res']+='<tr '+$args['6']+'><td align=center >'+$args['1.6']+'</td><td align=center>11</td><td align=center>20</td><td align=center>6</td></tr>'
		$args['res']+='<tr '+$args['7']+'><td align=center >'+$args['1.7']+'</td><td align=center>9</td><td align=center>20</td><td align=center>7</td></tr>'
		$args['res']+='<tr '+$args['8']+'><td align=center >'+$args['1.8']+'</td><td align=center>10</td><td align=center>16</td><td align=center>7</td></tr>'
		$args['res']+='<tr '+$args['9']+'><td align=center >'+$args['1.9']+'</td><td align=center>8</td><td align=center>24</td><td align=center>7</td></tr>'
		$args['res']+='<tr '+$args['10']+'><td align=center >'+$args['1.10']+'</td><td align=center>9</td><td align=center>22</td><td align=center>6</td></tr>'
		$args['res']+='<tr '+$args['11']+'><td align=center >'+$args['1.11']+'</td><td align=center>10</td><td align=center>18</td><td align=center>7</td></tr>'
		$args['res']+='<tr '+$args['12']+'><td align=center >'+$args['1.12']+'</td><td align=center>11</td><td align=center>20</td><td align=center>5</td></tr>'
		$args['res']+='</table>'
	end
	jump 'end_keep'
end
if $args[0]='table.numbers':
	args['i']=0
	:numluck
	if args['i']<arrsize('$num_luck') and args['i']<6:
		$args['luck']+=$num_luck[args['i']]
		args['i']+=1
		if args['i']<arrsize('$num_luck'): $args['luck']+=',&nbsp;'
		jump 'numluck'
	end
	args['i']=0
	:unluck
	if args['i']<arrsize('$num_unluck') and args['i']<6:
		$args['unluck']+=$num_unluck[args['i']]
		args['i']+=1
		if args['i']<arrsize('$num_unluck'): $args['unluck']+=',&nbsp;'
		jump 'unluck'
	end
	if $AVS_PLAYERTYPE['size']="MINI":
			$args['res']='<table width=100% cellspacing=0>'
	elseif $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']="qSpider":
		$args['res']='<table cellspacing=0 class="avs_game_stat_table">'
	else
		$args['res']='<table width=280 cellspacing=0>'
	end
	$args['res']+='<tr name=luck bgcolor=#e1ffe1><td align=left><span style="color:#000000;">Числа удачи:</span></td><td align=center><span style="color:#000000;font-weight:bolder;">'+$args['luck']+'</span></td></tr>'
	$args['res']+='<tr name=unluck bgcolor=#ffe1e1><td align=left><span style="color:#000000;">Числа неудачи:</span></td><td align=center><span style="color:#000000;text-decoration:line-through;">'+$args['unluck']+'</span></td></tr>'
	$args['res']+='</table>'
	jump 'end_keep'
end
if $args[0] = 'table.char':
	if $AVS_PLAYERTYPE['size']="MINI":
		$args['res']='<table width=100% cellspacing=0>'
	elseif $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<table class="avs_game_stat_table">'
	else
		$args['res']='<table width=280 cellspacing=0>'
	end
	$args['res']+='<tr name=fst bgcolor=#e1ffff><td align=left><span style="color:#000000;">Ловкость:</span></td><td align=right><span style="color:#000000;"><<fast["now"]>>/<b><<fast["start"]>></b></span></td></tr>'
	$args['res']+='<tr name=pwr bgcolor=#ffffe1><td align=left><span style="color:#000000;">Сила:</span></td><td align=right><span style="color:#000000;"><<power["now"]>>/<b><<power["start"]>></b></span></td></tr>'
	$args['res']+='<tr name=scl bgcolor=#fff0ff><td align=left><span style="color:#000000;">Обаяние:</span></td><td align=right><span style="color:#000000;"><<social["now"]>>/<b><<social["start"]>></b></span></td></tr>'
	$args['res']+='</table>'
	jump 'end_keep'
end
if $args[0] = 'table.blast':
	if $AVS_PLAYERTYPE['size']="MINI":
		$args['res']='<table width=100% cellspacing=0>'
	elseif $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<table class="avs_game_objs_table">'
	else
		$args['res']='<table width=280 cellspacing=0>'
	end
	killvar '$temp_id'
	gosub 'get.daughter.obj','INVENTORY','','$temp_id'
	:blast
	if arrsize('$temp_id')>0:
		args['pos.body']=arrpos('$id_array',$temp_id[0])
		args['pos.obj']=arrpos('$position_array',$temp_id[0])
		$args['hide']='false'
		if args['pos.obj']<>-1:
			if instr($object_array[args['pos.obj']],'[hide.inInv]')<>0:
				$args['hide']='true'
			else
				if instr($object_array[args['pos.obj']],'[quest]')<>0:
					$args['color']='114444'
					$args['attrib']='<b>'
					$args['/attrib']='</b>'
					$args['bgcolor']='fcfcfc'
				elseif instr($object_array[args['pos.body']],'[:место_в_рюкзаке:]')=0:
					$args['color']='008888'
					$args['attrib']='<b>'
					$args['/attrib']='</b>'
					$args['bgcolor']='fcfcfc'
				else
					$args['color']='008888'
					$args['attrib']=''
					$args['/attrib']=''
					$args['bgcolor']='fcfcfc'
				end
				$args['name']='<a href="exec:gosub ''onObjClick'',''<<$id_array[args["pos.obj"]]>>''" class="plain">'
				$args['name']+='<font color=#'+$args['color']+'>'+$args['attrib']
				$args['name']+=$func('get.word.padez',$func('get.tag.cont',$object_array[args['pos.obj']],'name'),'И')
				$args['name']+=$args['/attrib']+'</font></a>'
				args['charge']=charge_array[args['pos.obj']]
				args['maxcharge']=func('get.tag.num',$object_array[args['pos.obj']],'maxchrg')
				if instr($object_array[args['pos.obj']],'[maxchrg:')<>0 and args['maxcharge']=0:
					$args['ch']='<span style="color:#000000;">'+$str(args['charge'])+'<span style="font-weight:bold;font-size:large">/∞</span></span>'
				elseif instr($object_array[args['pos.obj']],'[maxchrg:')<>0 and args['maxcharge']<>0:
					$args['ch']='<span style="color:#000000;">'+$str(args['charge'])+'<span style="font-weight:bold;">/'+$str(args['maxcharge'])+'</span></span>'
				else
					$args['ch']='&nbsp;'
				end
			end
		else
			if instr($object_array[args['pos.body']],'[hide.inInv]')<>0:
				$args['hide']='true'
			else
				$args['color']='888888'
				$args['attrib']=''
				$args['/attrib']=''
				$args['name']='<font color=#'+$args['color']+'>'+$args['attrib']
				$args['name']+=$func('get.tag.cont',$object_array[args['pos.body']],'name')
				$args['name']+=$args['/attrib']+'</font>'
				$args['bgcolor']='fcfcfc'
				$args['ch']='&nbsp;'
			end
		end
		if $args['hide']='false':
			$args['res']+='<tr name=blastobj bgcolor=#'+$args['bgcolor']+'><td align=left>'+$args['name']+'</td><td align=right>'+$args['ch']+'</td></tr>'
		end
		killvar 'temp_id',0
		jump 'blast'
	end
	$args['res']+='</table>'
end
:невозможные_действия
if $args[0]='f':
	if $args[1]='место_в_рюкзаке': $args['res']='Вы не можете взять это. Рюкзак полон.'
	if $args[1]='пояс': $args['res']='Вы не можете надеть на себя два пояса.'
	if $args[1]='лицо': $args['res']='Вы не можете надеть ещё одну маску на лицо.'
	if $args[1]='голова': $args['res']='Вы не можете надеть ещё один головной убор.'
	if $args[1]='пояс_фляга': $args['res']='У вас уже есть фляга.'
	if $args[1]='плечи': $args['res']='У вас на плечах уже что-то надето.'
	if $args[1]='шея': $args['res']='У вас на шее уже что-то надето.'
	$args['add.colors and attributes']='nope'
end
if $args[0]='невозможное_действие':
	$args['res']="Пример невозможного действия."
	$args['add.colors and attributes']='nope'
end
if $args[0]='empt':
	$args['res']='Сосуд пуст.'
	$args['add.colors and attributes']='nope'
end
if $args[0]='n':
	$args['res']='Нельзя выбросить этот предмет. Возможно он необходим для выполнения задания.'
	$args['add.colors and attributes']='nope'
end
if $args[0]='notspec':
	$args['res']='Нет подходящих условий для использования предмета.'
	$args['add.colors and attributes']='nope'
end
if $args[0]='notput':
	$args['res']='Здесь и сейчас вы не можете выбросить этот предмет.'
	$args['add.colors and attributes']='nope'
end
if $args[0]='discharge':
	$args['res']='Этим предметом больше нельзя воспользоваться.'
	$args['add.colors and attributes']='nope'
end
if $args[0]='gift.no':
	$args['res']='К сожалению, в кошельке больше не осталось монет.'
	$args['add.colors and attributes']='nope'
end
:одевание
if $args[0]='used':
	if $args[1]='лицо': $args['res']='Вы надели '+$args[2]+'.'
	if $args[1]='пояс': $args['res']='Вы надели '+$args[2]+'.'
	if $args[1]='голова': $args['res']='Вы надели '+$args[2]+'.'
	$args['add.colors and attributes']='used'
end
if $args[0]='одевание':
	$args['res']="Пример действия надевания."
	$args['add.colors and attributes']='used'
end
:взять
if $args[0]='взять':
	$args['res']="Пример действия подъёма."
	$args['add.colors and attributes']='take'
end
if $args[0]='add':
	$args['name']=$func('get.word.padez',$func('get.tag.cont',$object_array[arrpos('$id_array',$args[1])],'name'),'В')
	$args['res']='Вы взяли '+$args['name']+'.'
	$args['add.colors and attributes']='take'
end
if $args[0]='get':
	$args['name']=$func('get.word.padez',$func('get.tag.cont',$object_array[arrpos('$id_array',$args[1])],'name'),'И')
	$args['res']='Получены '+$args['name']+'.'
	$args['add.colors and attributes']='take'
end
:выбросить
if $args[0]='выбросить':
	$args['res']="Пример действия выбрасывания."
	$args['add.colors and attributes']='put'
end
if $args[0]='put':
	$args['name']=$func('get.word.padez',$func('get.tag.cont',$object_array[arrpos('$id_array',$args[1])],'name'),'В')
	$args['res']='Вы выбросили '+$args['name']+'.'
	$args['add.colors and attributes']='put'
end
if $args[0]='gift':
	$args['name']=$func('get.word.padez',$func('get.tag.cont',$object_array[arrpos('$id_array',$args[1])],'name'),'В')
	$args['res']='Вы отдали '+$args['name']+'.'
	$args['add.colors and attributes']='put'
end
if $args[0]='s':
	$args['name']=$func('get.word.padez',$func('get.tag.cont',$object_array[arrpos('$id_array',$args[1])],'name'),'В')
	$args['res']='Вы продали '+$args['name']+'.'
	$args['add.colors and attributes']='put'
end
:лог боя
if $args[0]='war.round':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<span class="avs_text_warround">Раунд <<GAME_WAR["round"]+1>></span>'
	else
		$args['res']="<font size=+1><b>Раунд <<GAME_WAR['round']+1>>.</b></font>"
	end
	jump 'end_keep'
end
if $args[0]='war':
	$args['href']='<a href="exec:gosub ''int.war''" title="вызов обработчика боя" class="plain">'
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<avs-enemy><br><br><br><center>'+$args['href']+'<span style="font-size:large">Сражаться</span></a></center></avs-enemy><br>'
	else
		$args['res']='<avs-enemy><br><br><br><center>'+$args['href']+'<font size=+1>Сражаться</font></a></center></avs-enemy><br>'
	end
end
if $args[0]='sell':
	$args['res']='<br><br><br><center>Чтобы продать предмет, нужно щёлкнуть по его названию и в появившемся меню выбрать пункт "Продать".</center>'
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_stat">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#008800><i>'+$args['res']+'</i></font>'
	end
end
if $args[0]='ed':
	args['rand']=rand(1,10)
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['open.f']='<span style="color:#998888;">'
		$args['close.f']='</span>'
	else
		$args['open.f']='<font color=#998888>'
		$args['close.f']='</font>'
	end
	$args['res']=$args['open.f']
	if $args[1]='female':
		if args['rand']=1: $args['res']+='Уснула навеки...'
		if args['rand']=2: $args['res']+='Покойся с миром...'
		if args['rand']=3: $args['res']+='Пала в смертельной схватке...'
		if args['rand']=4: $args['res']+='Не выдержала напряжения...'
		if args['rand']=5: $args['res']+='Погибла в этом бою...'
		if args['rand']=6: $args['res']+='Отправилась к праотцам...'
		if args['rand']=7: $args['res']+='Больше не поднимется...'
		if args['rand']=8: $args['res']+='Обрела вечный покой...'
		if args['rand']=9: $args['res']+='Теперь не угрожает вашей безопасности...'
		if args['rand']=10: $args['res']+='Ей уже ничего не нужно...'
	else
		if args['rand']=1: $args['res']+='Уснул навеки...'
		if args['rand']=2: $args['res']+='Покоится с миром...'
		if args['rand']=3: $args['res']+='Пал в смертельной схватке...'
		if args['rand']=4: $args['res']+='Не выдержал напряжения...'
		if args['rand']=5: $args['res']+='Погиб в этом бою...'
		if args['rand']=6: $args['res']+='Отправился к праотцам...'
		if args['rand']=7: $args['res']+='Больше не поднимется...'
		if args['rand']=8: $args['res']+='Обрёл вечный покой...'
		if args['rand']=9: $args['res']+='Теперь не угрожает вашей безопасности...'
		if args['rand']=10: $args['res']+='Ему уже ничего не нужно...'
	end
	$args['res']+=$args['close.f']
end
if $args[0]='attack':
	$args['res']='<a href="exec:gosub ''int.war.attack'',''<<$args[1]>>''"><font color=#886600>Сражаться</font></a>'
end
if $args[0]='eo':
	$args['res']='<font color=#888899>Вы сражаетесь с другим противником.</font>'
end
if $args[0]='eea':
	if $args[2]='female': $args['sex']='её' else $args['sex']='его'
	$args['res']='<font color=#888800>'+$args[1]+' атакует вас, но '+$args['sex']+' удар слишком слаб, чтобы причинить вам неудобства.</font>'
end
if $args[0]='wehn':
	$args['res']='<font color=#888800>Удар '+$args[1]+' был встречен вашим могучим ударом. Силы оказались равны.</font>'
end
if $args[0]='ef':
	$args['res']='<font color=#880000>'+$args[1]+' наносит вам удар. Ваша жизненная сила уменьшается.</font>
	<font size=-1 color=#880000>[<<power["now"]>> = <<power["now"]+args[2]>> - <<args[2]>>]</font>'
end
if $args[0]='hf':
	if $args[2]='female': $args['sex']='её' else $args['sex']='его'
	$args['res']='<font color=#008800>Вы наносите удар '+$args[1]+', и вам удаётся ранить '+$args['sex']+'.</font>
	<font size=-1 color=#008800>[<<args[3]>> = <<args[3]+2>> - 2]</font>'
end
if $args[0]='hve':
	$args['res']='<font color=#008888>Вы одолели '+$args[1]+'.</font>'
end
if $args[0]='hveb':
	$args['res']='<font color=#008888>Вы выхватываете бластер и одним выстрелом испепеляете '+$args[1]+'.</font>'
end
if $args[0]='blaster-attack':
	$args['res']='<a href="exec:gosub ''int.war.blaster'',''<<$args[1]>>''"><font color=#995500>Застрелить&nbsp;из&nbsp;бластера</font></a>'
end
if $args[0]='wv':
	if $args[2]!'': $args['res']='<center><font size=+1>'+$args[2]+'</font></center><br>'
	$args['res']+='<center><font size=+1><a href="exec:time[''goto'']=1 & goto ''<<$args[1]>>''" class="plain" title="wv">Вы победили!!!</a></font></center>'
end
if $args[0]='wp':
	if $args[2]!'': $args['res']='<center><font size=+1>'+$args[2]+'</font></center><br>'
	$args['res']+='<center><font size=+1><a href="exec:time[''goto'']=1 & goto ''<<$args[1]>>''" class="plain">Вы проиграли!!!</a></font></center>'
end
if $args[0]='wl':
	$args['res']='<br><br><center><font size=+1><a href="exec:goto ''[start]''" class="plain">Вы проиграли.<br>Начать с начала</a></font></center>'
end
:GAME_OVER
if $args[0]='go':
	$args['res']='<br><br><center><a href="exec:goto ''[start]''" class="plain"><font size=+1>Победа!!! Игра пройдена.</font><br><font size=-1>(вернуться в главное меню)</font></a></center>'
end
if $args[0]='off':
	$args['res']='<br><br><center><font size=+1>Силы покинули вас.</font></center>'
end
if $args[0]='pow':
	if args[1]<0:	$args['res']='СИЛА уменьшается на <<-args[1]>>'
	if args[1]>0:	$args['res']='СИЛА увеличивается на <<args[1]>>'
	if args[1]=0:	$args['res']='СИЛА неизменна'
	$args['add.colors and attributes']='stat'
end
if $args[0]='lovk':
	if args[1]<0:	$args['res']='ЛОВКОСТЬ уменьшается на <<-args[1]>>'
	if args[1]>0:	$args['res']='ЛОВКОСТЬ увеличивается на <<args[1]>>'
	if args[1]=0:	$args['res']='ЛОВКОСТЬ неизменна'
	$args['add.colors and attributes']='stat'
end
if $args[0]='powup':
	if args[1]<0:	$args['res']='СИЛА уменьшается: <<args[1]>>'
	if args[1]>0:	$args['res']='СИЛА увеличивается: +<<args[1]>>'
	if args[1]=0:	$args['res']='СИЛА не изменилась.'
	$args['add.colors and attributes']='stup'
end
if $args[0]='lovkup':
	if args[1]<0:	$args['res']='ЛОВКОСТЬ уменьшается: <<args[1]>>'
	if args[1]>0:	$args['res']='ЛОВКОСТЬ увеличивается: +<<args[1]>>'
	if args[1]=0:	$args['res']='ЛОВКОСТЬ не изменилась.'
	$args['add.colors and attributes']='stup'
end
if $args[0]='изменение_стата':
	$args['res']='Изменение состояния.'
end
:обаяние
if $args[0]='soc':
	$args['res']='Требовалось обаяния <<args[1]>>. Ваше обаяние <<args[2]>>.'
end
if $args[0]='soc.prove':
	$args['res']='<a href="exec:gosub ''social'',''cube''" class="plain">Проверить обаяние</a>'
end
if $args[0]='soc.lose':
	$args['res']='<a href="exec:time[''goto'']=1 & social[''now'']-=1 & goto ''page.<<args[1]>>''" class="plain">Вам не удалось убедить собеседника в этот раз.</a>'
end
if $args[0]='soc.win':
	$args['res']='<a href="exec:time[''goto'']=1 & social[''now'']+=1 & goto ''page.<<args[1]>>''" class="plain">В этот раз вам удалось убедить собеседника.</a>'
end
:ловкость
if $args[0]='fst':
	$args['res']='Требовалось ловкости <<args[1]>>. Ваша ловкость <<args[2]>>.'
end
if $args[0]='fst' or $args[0]='soc':
	if args[1]>args[2]: $args['add.colors and attributes']='noit' else $args['add.colors and attributes']='ysit'
end
if $args[0]='fst.lose':
	$args['res']='<a href="exec:time[''goto'']=1 & goto ''page.<<args[1]>>''" class="plain">Вы оказались не слишком ловки в этот раз.</a>'
end
if $args[0]='fst.win':
	$args['res']='<a href="exec:time[''goto'']=1 & goto ''page.<<args[1]>>''" class="plain">В этот раз вы оказались достаточно ловки.</a>'
end
if $args[0]='fst.prove':
	$args['res']='<a href="exec:gosub ''fast'',''cube''" class="plain">Проверить ловкость</a>'
end
:выводим знания
if $args[0] = 'table.knew':
	$args['res']='<br><br>'
	if $AVS_PLAYERTYPE['size']="MINI":
		$args['res']+='<table width=100% cellspacing=0>'
	elseif $AVS_PLAYERTYPE['type']="QN" or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']+='<table class="avs_game_knews_table">'
	else
		$args['res']+='<table cellspacing=0 width=100%>'
	end
	$args['res']+='<tr name=note bgcolor=#f9f9f9><td align=left>Ваши записи:</td></tr>'
	killvar '$temp_id'
	gosub 'get.daughter.obj','KNOWLEDGE','','$temp_id'
	args['b']=arrsize('$temp_id')
	args['t']=0
	:knew
	if arrsize('$temp_id')>0:
		if args['i'] mod 2 =0: $args['color']='f9f9f9' else $args['color']='fdfdfd'
		args['pos.obj']=arrpos('$id_array',$temp_id[0])
		$args['name']=$func('get.tag.cont',$object_array[args['pos.obj']],'name')
		if instr($object_array[args['pos.obj']],'[выполнено]')<>0:
			$args['fc']='aaaaaa'
			$args['fin']=' (Сделано)'
		else
			$args['fc']='8888ff'
			$args['fin']=''
		end
		if instr($object_array[args['pos.obj']],'[hide]')=0 or $args[1]='test':
			$args['res']+='<tr bgcolor=#<<$args["color"]>> name=notetext><td align=left><span style="color:#<<$args["fc"]>>;"><i>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<<$args["name"]>><<$args["fin"]>></i></span></td></tr>'
			args['t']+=1
		end
		killvar 'temp_id',0
		args['i']+=1
		jump 'knew'
	end
	$args['res']+='</table>'
	if args['b']=0 or args['t']=0: $args['res']='&nbsp;'
	killvar '$temp_id'
	jump 'end_keep'
end
:game
if $args[0]='game.enemy':
	$args['win']=$func('get.word.inPos',$args[1],1)
	$args['lose']=$func('get.word.inPos',$args[1],2)
	tvar['cube.hero']=tvar['cube.hero.1']+tvar['cube.hero.2']
	tvar['cube.enemy']=tvar['cube.enemy.1']+tvar['cube.enemy.2']
	$args['ссылка бросить']='<a href="exec:tvar[''cube.hero.1'']=rand(1,6) & tvar[''cube.hero.2'']=rand(1,6) & tvar[''cube.enemy.1'']=rand(1,6) & tvar[''cube.enemy.2'']=rand(1,6) & goto $curloc" class="plain">'
	$args['выпало']="Вам выпало <<tvar['cube.hero.1']>> и <<tvar['cube.hero.2']>>, вашему противнику <<tvar['cube.enemy.1']>> и <<tvar['cube.enemy.2']>>."
	if tvar['cube.hero']=0:
		$args['res']=$args['ссылка бросить']+'Бросить кубики</a>'
	elseif tvar['cube.hero']=tvar['cube.enemy']:
		$args['res']=$args['выпало']+'<br>Суммы выпавших очков равны.<br>'+$args['ссылка бросить']+'Бросить кубики ещё раз</a>'
	elseif tvar['cube.hero']>tvar['cube.enemy']:
		$args['res']=$args['выпало']+'<br>У вас выпало больше очков, чем у противника.<br>[page='+$args['win']+']Вы выиграли![/page]'
		$GAME_VALUE['game.cube.result']='win'
		GAME_VALUE['game.cube.party']+=1
	else
		$GAME_VALUE['game.cube.result']='lose'
		GAME_VALUE['game.cube.party']+=1
		$args['res']=$args['выпало']+'<br>У противника выпало больше очков, чем у вас.<br>[page='+$args['lose']+']Выиграл он![/page]'
	end
	$args['res']='<br><br><p align=center>'+$args['res']+'</p>'
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_stup">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#000044><i>'+$args['res']+'</i></font>'
	end
end
:сохранения
if $args[0]='сохранения':
	$args['res']='Пример текста при сохранении.' & $args['add.colors and attributes']='save'
end
if $args[0]='nosave':
	$args['res']='Сейчас нельзя сохранить игру.' & $args['add.colors and attributes']='save'
end
if $args[0]='save':
	$args['res']='Игра сохранена.' & $args['add.colors and attributes']='save'
end
if $args[0]='chpload':
	$args['res']='Контрольная точка загружена.' & $args['add.colors and attributes']='save'
end
if $args[0]='qckload':
	$args['res']='Быстрое сохранение загружено.' & $args['add.colors and attributes']='save'
end
if $args[0]='notchp':
	$args['res']='Контрольные точки ещё не созданы.' & $args['add.colors and attributes']='save'
end
if $args[0]='notqck':
	$args['res']='Быстрые сохранения не сделаны.' & $args['add.colors and attributes']='save'
end
:текст_по_модификатору_вероятностей
if $args[0]='vm':
	$args['res']="     Переход должен был выбросить вас где-то неподалёку от Ворот. Вот только <a href=""exec:gosub 'crt.obj','мв','','<knew>',0,1,'KNOWLEDGE' & time['goto']=1 & goto 'page.<<args[1]>>'"" class='plain'>где именно</a>? Эх, как бы пригодился модификатор вероятностей: нажал кнопку - и сразу к Воротам...
     Клуша мгновенно реагирует на этот мечтательный вздох: нет, модификатор не стоит использовать при Переходе, и - да, он у вас имеется.
     Вы тут же бросаете взгляд на браслет. Так и есть! Если смотреть под определённым углом, видны слабо светящиеся цифры красного и зелёного цветов. Господа учёные второпях забыли сообщить о столь полезном приборе.
     «Это новая модель, - гордо объявляет Клуша, - Модификатор реагирует на мыслеприказ, концентрирует до шести благоприятных исходов, анализирует удачу и...»
     «...отнимает шансы на успех в будущем!» - нетерпеливо заканчиваете вы.
     «...и позволяет восстанавливать исходные вероятностные потоки к благоприятному состоянию в случае наиболее успешного течения событий» - невозмутимо заканчивает КЛУ-6.
     «В случае успешного течения событий»... Как всегда, всё решает случай.
"
end
if $args[0]='vm_1':
	$args['res.1']="&nbsp;Эх, сейчас бы пригодился модификатор вероятностей!
     «Шеф, так ведь он у вас есть! -- моментально реагирует Клуша. -- Новая модель! C телепатическим управлением!»
     Отлично! Короткий мыслеприказ, и модификатор откликается. Мгновенный анализ возможных вероятностей и концентрация наиболее благоприятных исходов. Пусть это и отнимает шансы на успех в будущем, но сейчас вам позарез нужна удача!
"
	$args['res']="<p align=justify>[knew]мв|&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Пришло время воспользоваться модификатором вероятностей. Короткий мыслеприказ, и модификатор откликается. Остаётся лишь положиться на удачу...|"+$args['res.1']+"[/knew]</p>

	"
end
if $args[0]='vm_2':
	$args['res']='<p align="center"><span style="color:#339900;">ПРОВЕРЬТЕ СВОЮ УДАЧУ</span>. Повезёт вам или нет?</</p>
	
<p align="center"><a href="exec:goto $curloc,$str(rand(1,6))" class="plain">Проверить удачу</a></p>'
end
if $args[0]='vm_3':
	$args['res']='<p align=center>На браслете замигало и погасло число <span style="color:#008800;"><<$args[1]>></span>. Через секунду оно уже светилось красным.

<a href="exec:gosub ''crt.obj'',''мв'','''',''<knew>'',0,1,''KNOWLEDGE'' & time[''goto'']=1 & goto ''page.<<args[2]>>''" class="plain">Вам повезло!</a></p>'
end
if $args[0]='vm_4':
	$args['res']='<p align=center>На браслете замигало и погасло число <span style="color:#880000;"><<$args[1]>></span>.

<a href="exec:gosub ''crt.obj'',''мв'','''',''<knew>'',0,1,''KNOWLEDGE'' & time[''goto'']=1 & goto ''page.<<args[2]>>''" class="plain">Вам не повезло...</a></p>'
end
if $args[0]='vm_5':
	$args['res']='<span style="color:#880000;">Произошла ошибка. Сделайте скриншот и обратитесь к разработчику</span>'
end
if $args[0]='note.objLoc':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']="<span class=""avs_text_objonloc"">Предметы на локации:</span><br><br>"
	else
		$args['res']="<font size=-1>Предметы на локации:</font><br><br>"
	end
end
:отдать предмет
if $args[0]='help.putobj':
	$args['res']='Чтобы отдать предмет, просто щёлкните по его названию и выберите во всплывающем меню пункт "Выбросить". Ссылка перехода активируется после сброса необходимого количества предметов.'
	$args['add.colors and attributes']='stat'
end
if $args['add.colors and attributes']='put':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_put">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#886600>'+$args['res']+'</font>'
	end
end
if $args['add.colors and attributes']='stat':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_stat">'+$args['res']+'</div>'
	else
		$args['res']='<span style="color:#008800;"><i>'+$args['res']+'</i></span>'
	end
end
if $args['add.colors and attributes']='save':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<span class="avs_text_print_save">'+$args['res']+'</span>'
	else
		$args['res']='<span style="color:#990066;"><b>'+$args['res']+'</b></span>'
	end
end
if $args['add.colors and attributes']='stup':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_stup">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#000044><i>'+$args['res']+'</i></font>'
	end
end
if $args['add.colors and attributes']='nope':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_nope">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#880000>'+$args['res']+'</font>'
	end
end
if $args['add.colors and attributes']='noit':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_noit">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#662222>'+$args['res']+'</font>'
	end
end
if $args['add.colors and attributes']='ysit':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_ysit">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#226622>'+$args['res']+'</font>'
	end
end
if $args['add.colors and attributes']='prov':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_prov">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#339900>'+$args['res']+'</font>'
	end
end
if $args['add.colors and attributes']='take':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_take">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#008888>'+$args['res']+'</font>'
	end
end
if $args['add.colors and attributes']='used':
	if $AVS_PLAYERTYPE['type']='QN' or $AVS_PLAYERTYPE['type']='qSpider':
		$args['res']='<div class="avs_text_print_used">'+$args['res']+'</div>'
	else
		$args['res']='<font color=#008800>'+$args['res']+'</font>'
	end
end
:зарядить_разрядить_бластер
if $args[0]='blaster.incharge' or $args[0]='blaster.decharge':
	if $AVS_PLAYERTYPE['size']="MINI":
		$args['c']='444499'
		$args['c2']='666699'
	else
		$args['c']='000044'
		$args['c2']='222244'
	end
	if $args[0]='blaster.incharge': $args['res']='<span style="color:#<<$args["c"]>>">Заряд бластера увеличивается: +<<args[1]>></span>'
	if $args[0]='blaster.decharge': $args['res']='<span style="color:#<<$args["c"]>>">Заряд бластера уменьшается: <<args[1]>></span>'
end
:жидкость
if $args[0]='liquid.drop':
	$args['res']='<span style="color:#884400;">Вы вылили <<$args[1]>> из фляги.</span>'
end
if $args[0]='liquid.full':
	$args['res']='<span style="color:#008888;">Вы наполнили флягу <<$args[1]>>.</span>'
end
if $args[0]='liquid.nopeflask':
	$args['res']='<span style="color:#880000;">У вас нет фляги.</span>'
end
:выбросить_рюкзак
if $args[0]='bag.drop':
	$args['res']='<span style="color:#886600;">Рюкзак выброшен. Вам больше некуда складывать вещи.</span>'
end
:end_keep
$result=$args['res']
--- base.txt ---------------------------------

# !--test--!
if $user_text='logs':
	$func('#array.prnt#','$log','[only result]')
elseif instr(lcase($user_text),'sqrt')=1:
	$args[0]=$trim($replace($replace($replace($user_text,'sqrt'),'('),')'))
	if isnum($args[0])=0: $args[0]=$dyneval("$result=$str(<<$args[0]>>)")
	$func('#sqrt#',$args[0])
else
	dynamic $user_text
end
--- !--test--! ---------------------------------

# !easy.math!
if $args[0]="":
	showobjs 0
	showstat 0
	showacts 0
	$fname="Consolas"
	usehtml=0
	$usercom='!--test--!'	
	"easy.math v 2.3.0 для QSP 5.7.0"
	"
	По всем вопросам и предложениям обращаться:

	*	aleksversus@mail.ru
	*	aleksversus.narod.ru
	*	https://vk.com/id40090736
	
	Обучающие видео по программированию на QSP:
	
	*	https://www.youtube.com/channel/UCwX8RW2B9yTUFdlivtCGAgA

	Любую функцию можно опробовать прямо здесь, введя её в поле ввода.

	Для нормального функционирования библиотеки с Quest Navigator - в начале игры напишите следующую строку:

		$AVS_PLAYERTYPE='[QN]'

	"
elseif $args[0]='version':
	result=2300
end
--- !easy.math! ---------------------------------

# #+#
$args[9]=$args[9]
i_easy_math_plus=0
:initial
if i_easy_math_plus<9:
	if $args[i_easy_math_plus]='': $args[i_easy_math_plus]=str(args[i_easy_math_plus]) else $args[i_easy_math_plus]=$args[i_easy_math_plus]
	if instr($args[i_easy_math_plus],'-')=1: $args[i_easy_math_plus]=$replace($args[i_easy_math_plus],'-') & minus_easy_math_plus[i_easy_math_plus]=1
	if instr($args[i_easy_math_plus],'.')=0: $args[i_easy_math_plus]+='.0'
	if len(mid($args[i_easy_math_plus],instr($args[i_easy_math_plus],'.')+1))>len_easy_math_plus['pos']: len_easy_math_plus['pos']=len(mid($args[i_easy_math_plus],instr($args[i_easy_math_plus],'.')+1))
	i_easy_math_plus+=1
	jump 'initial'
end
i_easy_math_plus=0
:к_целому
if i_easy_math_plus<9:
	$args[i_easy_math_plus]=$replace($args[i_easy_math_plus]+$func('#zero#',len_easy_math_plus['pos']-len(mid($args[i_easy_math_plus],instr($args[i_easy_math_plus],'.')+1))),'.')
	i_easy_math_plus+=1
	jump 'к_целому'
end
$args[9]='0'
i_easy_math_plus=0
:for
if i_easy_math_plus<9:
	args['max_len']=max(len($args[i_easy_math_plus]),len($args[i_easy_math_plus+1]))
	o_easy_math_plus=1
	:logic
	if o_easy_math_plus>-1:
		if minus_easy_math_plus[i_easy_math_plus+o_easy_math_plus]=1:
			$args['<<o_easy_math_plus>>']=$func('#dev#',$func('#zero#',args['max_len']+2,'9'),$args[i_easy_math_plus+o_easy_math_plus])
		else
			$args['<<o_easy_math_plus>>']=$func('#zero#',args['max_len']-len($args[i_easy_math_plus+o_easy_math_plus])+2)+$args[i_easy_math_plus+o_easy_math_plus]
		end
		o_easy_math_plus-=1
		jump 'logic'
	end
	$args['sum']=$func('#add#',$args['1'],$args['0'])
	if val(mid($args['sum'],1,1))>0:
		$args['sum']=$func('#dev#',$func('#zero#',args['max_len']+2,'9'),$args['sum'])
		minus_easy_math_plus[i_easy_math_plus+1]=1
	else
		minus_easy_math_plus[i_easy_math_plus+1]=0
	end
	$args[i_easy_math_plus]=''
	$args[i_easy_math_plus+1]=$args['sum']
	i_easy_math_plus+=1
	jump 'for'
else
	$result=mid($args[9],1,len($args[9])-len_easy_math_plus['pos'])+'.'+mid($args[9],len($args[9])-len_easy_math_plus['pos']+1)
	$result=$func('#dz#',$result)
	if minus_easy_math_plus[9]=1 and $result!'0': $result='-'+$result
end
killvar 'minus_easy_math_plus'
killvar 'i_easy_math_plus'
killvar 'o_easy_math_plus'
killvar 'len_easy_math_plus'
--- #+# ---------------------------------

# #+col#
$args[9]=$args[9]
if instr($args[1],'-')!0: $args['+']='-' else $args['+']='+'
$args[1] = $replace($args[1],'-')
dynamic 'r_col_plus = '+$func('#hex-dec#',mid($args[0],1,2))+$args['+']+$func('#hex-dec#',$args[1])
dynamic 'g_col_plus = '+$func('#hex-dec#',mid($args[0],3,2))+$args['+']+$func('#hex-dec#',$args[1])
dynamic 'b_col_plus = '+$func('#hex-dec#',mid($args[0],5,2))+$args['+']+$func('#hex-dec#',$args[1])
if r_col_plus>255: r_col_plus=255
if r_col_plus<0: r_col_plus=0
if g_col_plus>255: g_col_plus=255
if g_col_plus<0: g_col_plus=0
if b_col_plus>255: b_col_plus=255
if b_col_plus<0: b_col_plus=0
$result['+col'] = $func('#dec-col#',r_col_plus)+$func('#dec-col#',g_col_plus)+$func('#dec-col#',b_col_plus)
killvar 'r_col_plus'
killvar 'g_col_plus'
killvar 'b_col_plus'
--- #+col# ---------------------------------

# #-#
args[9]=args[9]
result=iif(args[1]-args[0]>0,args[1]-args[0],args[0]-args[1])
--- #-# ---------------------------------

# #add#
if $args[0]='': $args[0]=str(args[0]) else $args[0] = $args[0]
if $args[1]='': $args[1]=str(args[1]) else $args[1] = $args[1]
args['max_len']=max(len($args[0]),len($args[1]))
$args[0]=$func('#zero#',args['max_len']-len($args[0]))+$args[0]
$args[1]=$func('#zero#',args['max_len']-len($args[1]))+$args[1]
:prev
$result=''
args['i'] = args['max_len']
args['lst_byte'] = 0
:for
if args['i']>0:
	args['res_byte']=val(mid($args[0],args['i'],1))+val(mid($args[1],args['i'],1))+args['lst_byte']
	args['lst_byte']=args['res_byte']/10
	args['res_byte']=args['res_byte'] mod 10
	$result=str(args['res_byte'])+$result
	args['i']-=1
	jump 'for'
elseif args['lst_byte']>0:
	$args[0]=$result
	$args[1]=$func('#zero#',args['max_len']-len(str(args['lst_byte'])))+str(args['lst_byte'])
	jump 'prev'
end
--- #add# ---------------------------------

# #array.clr#
$args[0] = $args[0]
$args[1] = $args[1]
args['size']=arrsize($args[0])
:for
if instr($args[0],'$')=1:
	args['pos']=arrpos($args[0],$args[1])
else
	args['pos']=arrpos($args[0],args[1])
end
if args['pos']!-1 and arrsize($args[0])>0 and args['size']>0:
	killvar $args[0],args['pos']
	args['size']-=1
	jump 'for'
end
--- #array.clr# ---------------------------------

# #array.dsrt#
$args[0] = $args[0]
$args[1] = $replace($args[1],'$')
if $args[2] = '': $args[2] = $args[0]
$args[9]=$args[9]
killvar 'easy_math_sort_array'
killvar $args['$']+'easy_math_copy_array'
if instr($args[0],'$')=1: $args['$']='$' else $args['$']=''
copyarr 'easy_math_sort_array',$args[1]
args['i']=0
:for
if args['i'] < arrsize('easy_math_sort_array'):
	args['j']=arrpos('easy_math_sort_array',args['i'])
	dynamic $args['$']+"easy_math_copy_array[args[0]] = "+$args[0]+"[args[1]]",args['i'],args['j']
	args['i']+=1
	jump 'for'
end
copyarr $args[2],$args['$']+"easy_math_copy_array"
--- #array.dsrt# ---------------------------------

# #array.ins#
$args[9] = $args[9]
if instr($args[0],'$')=1:
	$args[3]='$'
	$args[5]="'"+$args[1]+"'"
else 
	$args[3]=''
	$args[5]='<<args[1]>>'
end
if $args[2]!'':
	if $args[3]='$': $args[4]="'щЭcmыz9!T7K1АЙ@>FуОk7aСeV0mвзZхaAVSMARKUPDOWN'" else $args[4]='-2147483648'
	args[2]=dyneval("
				<<$args[3]>>args[0]=<<$args[0]>>['<<$args[2]>>']
				<<$args[0]>>['<<$args[2]>>']=<<$args[4]>>
				result=arrpos('<<$args[0]>>',<<$args[4]>>)
				<<$args[0]>>[result]=<<$args[3]>>args[0]
			")
end
copyarr "<<$args[3]>>easy_math_copy_array_1",$args[0],0,args[2]
copyarr "<<$args[3]>>easy_math_copy_array_2",$args[0],args[2]
copyarr $args[0],"<<$args[3]>>easy_math_copy_array_1"
dynamic "
	<<$args[0]>>[]=<<$args[5]>>
	:for
	if arrsize('<<$args[3]>>easy_math_copy_array_2')>0:
		<<$args[0]>>[]=<<$args[3]>>easy_math_copy_array_2[0]
		killvar '<<$args[3]>>easy_math_copy_array_2',0
		jump 'for'
	end
"
killvar '<<$args[3]>>easy_math_copy_array_1'
killvar '<<$args[3]>>easy_math_copy_array_2'
--- #array.ins# ---------------------------------

# #array.prnt#
$args[9] = $args[9]
$args[1] = UCASE($args[1])
if $args[2]='': $args[2]='
'
if args[3]<0: args[3]=0
if args[4]<args[3]: args[4]=0
:for
if args[3]<arrsize($args[0]):
	if instr($args[1],'[ONLY RESULT]')=0: $args['array.prnt'] += $args[0]+"[<<args[3]>>]="
	if instr($args[1],'[TRIM]')<>0: $args['trim.open']='TRIM(' & $args['trim.close']=')'
	$args['array.prnt'] += $dyneval("$result = <<$args['trim.open']>><<$args[0]>>[args[0]]<<$args['trim.close']>>",args[3])+$args[2]
	args[3]+=1
	if args[3]<=args[4] or args[4]=0: jump 'for'
end
if instr($args[1],'[NOT LAST]')<>0: 
	$args['array.prnt']=$mid($args['array.prnt'],1,len($args['array.prnt'])-len($args[2]))
end
$result=$args['array.prnt']
--- #array.prnt# ---------------------------------

# #array.prnt.few#
$args[9]=$args[9]
args['last']=arrsize('$args')-1
if $strfind($args[args['last']],'\S+\s+\S+')!'':
	$args['construct']=UCASE($args[args['last']])
	if instr($args['construct'],'[NO TABLE]')!0: $args['table']='' else $args['table']='yep'
	if instr($args['construct'],'[ONLY RESULT]')!0: $args['table']='' & $args['only result']='only result'
	jump 'print'
elseif arrcomp('$args','[\s\S]*(\S+\W+\S+)+[\s\S]*')!-1 and arrcomp('$args','[\s\S]*(\S+\W+\S+)+[\s\S]*')!arrsize('$args')-1:
	$result="Error: array's name is not correct. args pos:<<arrcomp('$args','[\s\S]*(\S+\W+\S+)+[\s\S]*')>>"
	exit
else
	if $args['table']!'' or $strfind($args[args['last']],'\S+\s+\S+')='': $args['table']='<table border=1 cellpadding=5>'
	:print
	if $args['table']!'': $args['table']+='<tr><td>#</td>'
	args['i']=0
	:mass
	if args['i']<9 and $strfind($args[args['i']],'\S+\s+\S+')='' and $args[args['i']]!'':
		$args[args['i']]=$TRIM($args[args['i']])
		if $args['table']!'': $args['table']+="<td><<$args[args['i']]>></td>"
		if arrsize($args[args['i']])>args['size']: args['size']=arrsize($args[args['i']])
		args['i']+=1
		jump 'mass'
	end
	if args['size']=0: $result='All your massives are empty.' & exit
	if $args['table']!'': $args['table']+='</tr>'
	args['b']=0
	:for
	if args['b']<args['size']:
		args['i']=0
		if $args['table']!'': $args['table']+="<tr><td><<args['b']>></td>"
		:zap
		if args['i']<9 and $strfind($args[args['i']],'\S+\s+\S+')='' and $args[args['i']]!'':
			if $args['only result']!'only result' and $args['table']='': $args['cell'] = $args[args['i']]+"[<<args['b']>>]="
			if $args['table']='yep':
				$args['cell'] += $dyneval("if <<$args[args['i']]>>[args[0]]!'': $result = $replace(<<$args[args['i']]>>[args[0]],' ','&nbsp;') else $result='&nbsp;'",args['b'])
			else
				$args['cell'] += $dyneval("$result = <<$args[args['i']]>>[args[0]]",args['b'])
			end
			if $args['table']!'':
				$args['table']+='<td>'+$args['cell']+'</td>'
			else
				$args['result']+=$args['cell']+'	'
			end
			$args['cell']=''
			args['i']+=1
			jump 'zap'
		end
		if $args['table']!'': $args['table']+="</tr>" else $args['result']+='
'
		args['b']+=1
		jump 'for'
	end
	if $args['table']!'': $args['table']+='</table>'
end
killvar '$result'
if $args['table']!'':
	$result=$args['table']
elseif $args['result']!'':
	$result=$mid($args['result'],1,len($args['result'])-1)
else
	$result='Oops. If you see this message, that so wrong. Save the game and ask me on aleksversus@mail.ru. Error of easy.math.libs in array.prnt.few'
end
--- #array.prnt.few# ---------------------------------

# #array.rand#
$args[0] = $args[0]	
args[1] = args[1]
args[2] = args[2]
args[3] = args[3]
if args[4] = 0: args[4] = 1000
:for
if args[1] >0:
	dynamic $args[0]+'['+str(args[2])+'] = rand('+str(args[3])+','+str(args[4])+')'
	args[1]-=1
	args[2]+=1
	jump 'for'
end
--- #array.rand# ---------------------------------

# #array.rstd#
$args[0] = $args[0]
$args[1] = $replace($args[1],'$')
if $args[2] = '': $args[2] = $args[0]
$args[9]=$args[9]
killvar 'easy_math_sort_array'
killvar $args['$']+'easy_math_copy_array'
if instr($args[0],'$')=1: $args['$']='$' else $args['$']=''
copyarr 'easy_math_sort_array',$args[1]
args['i']=0
:for
if args['i'] < arrsize('easy_math_sort_array'):
	dynamic $args['$']+"easy_math_copy_array[args[0]] = "+$args[0]+"[args[1]]",args['i'],easy_math_sort_array[args['i']]
	args['i']+=1
	jump 'for'
end
copyarr $args[2],$args['$']+"easy_math_copy_array"
--- #array.rstd# ---------------------------------

# #array.simp#
$args[0] = $args[0]
$args[1] = $args[1]
if instr($args[0],'$')!0 or instr($args[1],'$')!0: $args['$']='$'
$args[2] = $args[2]
$args[9]=$args[9]
$result['array.simp']='true'
if instr($args[2],'simp')!0 or instr($args[2],'/se')!0:
	gs '#array.sort#',$args[0],'','','easy_math_sort_0_array'
	gs '#array.sort#',$args[1],'','','easy_math_sort_1_array'
	$args[0]=$args['$']+'easy_math_sort_0_array'
	$args[1]=$args['$']+'easy_math_sort_1_array'
	if instr($args[2],'/se')!0:
		gs '#array.clr#',$args[0]
		gs '#array.clr#',$args[1]
	end
end
if arrsize($args[0])!arrsize($args[1]) and instr($args[2],'conc')=0:
	$result['array.simp']='false'
	jump 'overkill_and_exit'
elseif (arrsize($args[0])=0 or arrsize($args[1])=0) and arrsize($args[0])!arrsize($args[1]):
	$result['array.simp']='false'
	jump 'overkill_and_exit'
elseif arrsize($args[0])>arrsize($args[1]) and instr($args[2],'conc')!0:
	$args['t']=$args[0]
	$args[0]=$args[1]
	$args[1]=$args['t']
end
args[9]=arrsize($args[0])-1
:for_you
if args[9]>-1:
	if instr($args[2],'conc')!0:
		$result['array.simp']=DYNEVAL("if arrpos('<<$args[0]>>',<<$args[1]>>[args[0]])!-1: $result['dyn']='true' else $result['dyn']='false'",args[9])
		if $result['array.simp']!'false': jump 'overkill_and_exit'
	else
		$result['array.simp']=DYNEVAL("if <<$args[0]>>[args[0]]=<<$args[1]>>[args[0]]: $result['dyn']='true' else $result['dyn']='false'",args[9])
		if $result['array.simp']='false': jump 'overkill_and_exit'
	end
	args[9]-=1
	jump 'for_you'
end
:overkill_and_exit
killvar 'easy_math_sort_0_array'
killvar 'easy_math_sort_1_array'
exit
--- #array.simp# ---------------------------------

# #array.sort#
$args[0] = $args[0]
$args[1] = $args[1]
$args[2] = $replace($args[2],'$')
if $args[3]='': $args[3] = $args[0]
$args[9]=$args[9]
killvar 'easy_math_sort_array'
killvar 'easy_math_copy_array'
if instr($args[0],'$')=1: $args['$']='$' else $args['$']=''
copyarr $args['$']+'easy_math_copy_array',$args[0]
if $args[2]!'':
	args['i']=0
	:for
	if args['i']<arrsize($args['$']+'easy_math_copy_array'):
		easy_math_sort_array[args['i']]=args['i']
		args['i']+=1
		jump 'for'
	end
end
args['i'] = 0
:prohody
if args['i']<arrsize($args['$']+'easy_math_copy_array'):
	args['j']=args['i']+1
	:sorting
	if args['j']<arrsize($args['$']+'easy_math_copy_array'):
		dynamic "if (<<$args['$']>>easy_math_copy_array[args[0]] < <<$args['$']>>easy_math_copy_array[args[1]] and ($args[2]='' or $args[2]='up')) or (<<$args['$']>>easy_math_copy_array[args[0]] > <<$args['$']>>easy_math_copy_array[args[1]] and $args[2]='down'):
			<<$args['$']>>args['tmp'] = <<$args['$']>>easy_math_copy_array[args[0]]
			<<$args['$']>>easy_math_copy_array[args[0]] = <<$args['$']>>easy_math_copy_array[args[1]]
			<<$args['$']>>easy_math_copy_array[args[1]] = <<$args['$']>>args['tmp']
			if $args[3]!'':
				args['temp'] = easy_math_sort_array[args[0]]
				easy_math_sort_array[args[0]] = easy_math_sort_array[args[1]]
				easy_math_sort_array[args[1]] = args['temp']
			end
		end",args['i'],args['j'],$args[1],$args[2]
		args['j']+=1
		jump 'sorting'
	end
	args['i']+=1
	jump 'prohody'
end
if $args[2]!'': copyarr $args[2],'easy_math_sort_array'
copyarr $args[3],$args['$']+'easy_math_copy_array'
killvar 'easy_math_sort_array'
killvar $args['$']+'easy_math_copy_array'
--- #array.sort# ---------------------------------

# #array.srch#
if $args[0]='': $result='error' & exit
if $args[1]='': $args[1]='max' else $args[1]=LCASE($args[1])
if $args[2]='':	args[2]=min($args[0]) else args[2]=val($args[2])
if $args[3]='': args[3]=max($args[0]) else args[3]=val($args[3])
if args[4] < 0: args[4]=0
if args[5] = 0: args[5]=arrsize($args[0])-1
$args[6] = lcase($args[6])
$args[9]=$args[9]
if args[2]>args[3]:
	args['t']=args[2]
	args[2]=args[3]
	args[3]=args['t']
end
if args[4]>args[5]:
	args['t']=args[4]
	args[4]=args[5]
	args[5]=args['t']
end
$args['result']='false'
copyarr 'easy_math_copy_array',$args[0]
:for
if no args[4]>args[5]:
	if easy_math_copy_array[args[4]]>=args[2] and easy_math_copy_array[args[4]]<=args[3]:
		if $args[1]='max':
			if (args['m']=0 and $args['result']='false') or easy_math_copy_array[args[4]]>args['m']:
				args['m']=easy_math_copy_array[args[4]]
				args['pos']=args[4]
				$args['result']='true'
			end 
		elseif $args[1]='min':
			if (args['m']=0 and $args['result']='false') or easy_math_copy_array[args[4]]<args['m']:
				args['m']=easy_math_copy_array[args[4]]
				args['pos']=args[4]
				$args['result']='true'
			end 
		else
			$result='easy.math''s error. Please, tell me about it: aleksversus@mail.ru'
		end
	end
	args[4]+=1
	jump 'for'
end
killvar 'easy_math_copy_array'
if $args[6]='pos' and $args['result']='true':
	$result="<<args['pos']>>"
elseif $args['result']='true':
	$result="<<args['m']>>"
else
	$result='false'
end
--- #array.srch# ---------------------------------

# #array.strt#
args[9] = args[9]
if args[2]<args[3]:
	$args['reverse']='yes'
end
args['b']=args[3]
if instr($args[0],'$')=1: $args['q']="'"
:for
if args[4]<args[1]:
	dynamic "<<$args[0]>>[<<args[4]>>]=<<$args['q']>><<args['b']>><<$args['q']>>"
	args[4]+=1
	if $args['reverse']!'yes':
		args['b']+=1
		if args['b']>args[2] and (args[2]!0 or args[3]!0): args['b']=args[3]
	else
		args['b']-=1
		if args['b']<args[2] and (args[2]!0 or args[3]!0): args['b']=args[3]
	end
	jump 'for'
end
--- #array.strt# ---------------------------------

# #chk.array.word#
$args[9] = $args[9]
if args[4] = 0: args[4] = arrsize($args[0])
if $args[2]='first' or $args[2]='':
	if instr($AVS_PLAYERTYPE,'[QN]')<>0:
		args['b']=arrcomp($args[0],'[\s\S]*'+$args[1]+'[\s\S]*',args[3])
	else
		args['b']=arrcomp(args[3],$args[0],'[\s\S]*'+$args[1]+'[\s\S]*')
	end
	if args['b']>args[4]: result=-1 else result=args['b']
elseif $args[2]='last':
	args['i']=args[3]
	:for
	if instr($AVS_PLAYERTYPE,'[QN]')<>0:
		args['b']=arrcomp($args[0],'[\s\S]*'+$args[1]+'[\s\S]*',args['i'])
	else
		args['b']=arrcomp(args['i'],$args[0],'[\s\S]*'+$args[1]+'[\s\S]*')
	end
	if args['b']!-1 and args['b']<=args[4]:
		result=args['b']
		args['i']=result+1
		jump 'for'
	else
		exit
	end
end
--- #chk.array.word# ---------------------------------

# #chk.obj.word#
$args[9]=$args[9]
args['i'] = 1
:loop
if no args['i'] > countobj:
	if instr($getobj(args['i']),$args[0])!0:
		result = args['i']
		exit
	end
	args['i']+=1
	jump 'loop'
end
--- #chk.obj.word# ---------------------------------

# #col-inv#
if $args[0]='': exit
$args['r'] = '-'+$mid($args[0],1,2)
$args['g'] = '-'+$mid($args[0],3,2)
$args['b'] = '-'+$mid($args[0],5,2)
$args['rr'] = $mid($func('#+col#','ffffff',$args['r']),1,2)
$args['gg'] = $mid($func('#+col#','ffffff',$args['g']),1,2)
$args['bb'] = $mid($func('#+col#','ffffff',$args['b']),1,2)
$result = $args['rr']+$args['gg']+$args['bb']
--- #col-inv# ---------------------------------

# #col-rgb#
! функция преобразует цвет из шестнадцатеричного формата в формат rgb, который использует qsp
if $args[0]='': result = 0 & exit
args['result']=rgb(func('#hex-dec#',$mid($args[0],1,2)),func('#hex-dec#',$mid($args[0],3,2)),func('#hex-dec#',$mid($args[0],5,2)))
result=args['result']
--- #col-rgb# ---------------------------------

# #coords.get#
args[0] = args[0]
args[1] = args[1]
$args[2]=$args[2]
args['y']=args[0]/args[1]
args['x']=args[0]-args['y']*args[1]
if $args[2]="": $result = "x:<<args['x']>> y:<<args['y']>>"
if UCASE($args[2])="X": result=args['x']
if UCASE($args[2])="Y": result=args['y']
--- #coords.get# ---------------------------------

# #dec-col#
$result=''
:start
if args[0]>16777215: jump 'end_keep'
if args[0]<0: args[0]=-args[0] & $args['+']='-' & jump 'start'
args['основание']=16
:новое_основание
if args[0]/args['основание']<16:
	if args[0]<16:
		$result=$result+$mid('0123456789abcdef',args[0]+1,1)
		jump 'end_keep'
	else
		$result=$result+$mid('0123456789abcdef',args[0]/args['основание']+1,1)
		args[0]=args[0] mod args['основание']
		args['основание']=16
		jump 'новое_основание'
	end
else
	args['основание']=args['основание']*16
	jump 'новое_основание'
end
:end_keep
if len($result)=1:
	$result='0'+$result
elseif $result='':
	$result='00'
end
$result=$args['+']+$result
--- #dec-col# ---------------------------------

# #dec-hex#
$result=''
args[9]=args[9]
if args[0]<0: args[0]=-args[0] & $args['+']='-'
args['основание']=16
:новое_основание
if args[0]/args['основание']<16:
	if args[0]<16:
		$result=$result+$mid('0123456789abcdef',args[0]+1,1)
		jump 'end_keep'
	else
		$result=$result+$mid('0123456789abcdef',args[0]/args['основание']+1,1)
		args[0]=args[0] mod args['основание']
		args['основание'] = 16
		jump 'новое_основание'
	end
else
	args['основание']=args['основание']*16
	jump 'новое_основание'
end
:end_keep
$result=$args['+']+$result
--- #dec-hex# ---------------------------------

# #dev#
if $args[0]='': $args[0]=str(args[0]) else $args[0] = $args[0]
if $args[1]='': $args[1]=str(args[1]) else $args[1] = $args[1]
args['max_len']=max(len($args[0]),len($args[1]))
$args[0]=$func('#zero#',args['max_len']-len($args[0]))+$args[0]
$args[1]=$func('#zero#',args['max_len']-len($args[1]))+$args[1]
:prev
$result=''
args['i'] = args['max_len']
args['lst_byte'] = 0
:for
if args['i']>0:
	args['res_byte']=val(mid($args[0],args['i'],1))-val(mid($args[1],args['i'],1))+args['lst_byte']
	if args['res_byte']<0:
		args['res_byte']=10+args['res_byte']
		args['lst_byte']=-1
	else
		args['lst_byte']=0
	end
	$result=str(args['res_byte'])+$result
	args['i']-=1
	jump 'for'
elseif args['lst_byte']=-1:
	$args[0]=$result
	$args[1]=$func('#zero#',args['max_len']-1)+'1'
	jump 'prev'
end
--- #dev# ---------------------------------

# #dz#
$args[9] = $args[9]
if args[1]<1: args[1]=1
if instr($args[0],'.')=0: $result=$args[0] & exit
$args['start'] = mid($args[0],1,instr($args[0],'.')-1)
$args['end'] = mid($args[0],instr($args[0],'.')+1)
args['len']=len(str(args[1]))-1
:for
args['i']=len($args['end'])
if len($args['end'])>args['len'] and mid($args['end'],args['i'],1)='0':
	$args['end']=mid($args['end'],1,args['i']-1)
	jump 'for'
end
if $args['end']!'': $result=$args['start']+'.'+$args['end'] else $result=$args['start']
:for2
if instr($result,'0')=1 and instr($result,'.')!2:
	$result=mid($result,2)
	jump 'for2'
end
if $result='': $result='0'
--- #dz# ---------------------------------

# #even#
$args[9]=$args[9]
if args[1]=0 or $strfind(str(args[1]),'1[0]+')='': args[1]=100
if $args[2]='up':
	:up
	if args[0]>0: result = val(str(args[0]/args[1]+1)+mid(str(args[1]),2))
	if args[0]<0: result = val(str(args[0]/args[1]-1)+mid(str(args[1]),2))
	exit
elseif $args[2]='down':
	:down
	result = args[0]/args[1]*args[1]
	exit
elseif $args[2]='' and args[0]>0:
	if val(mid(str(args[0]-args[0]/args[1]*args[1]),1,1))<5: jump 'down' else jump 'up'
elseif $args[2]='' and args[0]<0:
	if val(mid(str(-1*args[0]-(-1*args[0]/args[1]*args[1])),1,1))<5: jump 'down' else jump 'up'
end
--- #even# ---------------------------------

# #hash#
! функция, вычисляющая псевдохэш строки
! работает следующим образом: перебирает символы строки начиная с первого и сравнивает с таблицей символов
! номер символа в таблице символов умножается на позицию символа в строке и плюсуется к предыдущему значению
! игнорируются символы пробелов, табуляций, переводов строк и некоторые специальные, а так же все прочие
! символы не указанные в таблице символов
--- #hash# ---------------------------------

# #hex-dec#
result=0
$args[0]=lcase($args[0])
args['i']=0
:next
if args['i']<len($args[0]):
	args['t']=instr('0123456789abcdef',mid($args[0],len($args[0])-args['i'],1)) - 1
	args['j']=args['i']
	:multiple
	if args['j']>0:
		args['t']=args['t'] * 16
		args['j']-=1
		if args['j']>0: jump 'multiple'
	end
	args['i']+=1
	result+=args['t']
	if args['i']<len($args[0]): jump 'next'
end
--- #hex-dec# ---------------------------------

# #indiv#
args[9] = args[9]
if (args[0]<0 and args[1]>0) or (args[0]>0 and args[1]<0): $args['+']='-'
if args[0]<0: args[0]=-args[0]
if args[1]<0: args[1]=-args[1]
if args[1]=0: args[1]=100
if args[2]=0: args[2]=1000000000
$args[2]=str(args[2])
args['i']=0
:for
args['rez']=args[0]/args[1]
args['ost']=args[0] mod args[1]
if args['i']=1: $args['res.indiv']+='.'
$args['res.indiv']+=str(args['rez'])
args[0]=args['ost']*10
args['i']+=1
if args['i']<len($args[2]): jump 'for'
$args['res.indiv']=$args['+']+$func('#dz#',$args['res.indiv'])
$result=$args['res.indiv']
--- #indiv# ---------------------------------

# #invert#
if instr($args[0],'-')=1: $result=$mid($args[0],2) else $result='-'+$args[0]
if $result = '-': $result=''
--- #invert# ---------------------------------

# #raz#
$args[9]=$args[9]
if args[0]<0: args[0]=-args[0]
args['10']=1
:for
if args[0]/args['10']>9:
	args['10']=args['10']*10
	jump 'for'
else
	result = args['10']
	exit
end
--- #raz# ---------------------------------

# #razdiv#
$args[9] = $args[9]
if instr($args[0],'.')=0: result=1 & exit
args['div'] = len($replace($args[0],$strfind($args[0],'[-\d]+\.')))
result=1
:for
if args['div']>0:
	result=result*10
	args['div']-=1
	jump 'for'
end
--- #razdiv# ---------------------------------

# #re.rgb#
! Функция, обратная функции RGB. На основе числового кода получает составляющие
! -16777216+(r*1)+(g*256)+(b*256*256)
if args[0]>0: args[0]=-args[0]	&	!	числовой код
$args[1]=$args[1]				&	!	какую составляющую хотим получить red, green, blue
args['blue']=(args[0]+16777216)/256/256
args['green']=(args[0]+16777216-args['blue']*256*256)/256
args['red']=(args[0]+16777216-args['blue']*256*256-args['green']*256)
if instr($args[1],'red')<>0: args['c']+=1
if instr($args[1],'green')<>0: args['c']+=1
if instr($args[1],'blue')<>0: args['c']+=1
if $args[1]='' or args['c']>1:
	$result="<<args['red']>>|<<args['green']>>|<<args['blue']>>"
else
	result=args[$trim($args[1])]
end
--- #re.rgb# ---------------------------------

# #rndstr#
if args[0]=0: args[0]=rand(1,8)
$args[9]=$args[9]
if $args[1]='буквы и цифры':
	$args['symbols']='QWERTYUIOPASDFGHJKLZXCVBNM1234567890qwertyuiopasdfghjklzxcvbnmёйцукенгшщзхъфывапролджэячсмитьбюЁЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ'
	$args[1] = ''
elseif $args[1]='только это':
	$args[1] = ''
else
	$args['symbols']='QWERTYUIOP{}ASDFGHJKL:"ZXCVBNM<>?1234567890'+"!@#$%^&*()_+-=`~qwertyuiop[]asdfghjkl;'zxcvbnm,./\|№"
	$args['symbols']+="ёйцукенгшщзхъфывапролджэячсмитьбюЁЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ"
end
if $args[1]<>'':
	args['i']=len($args['symbols'])
	:for
	if len($args[1])>0 and args['i']>0:
		if len($args[1])>1:
			$args['1'] = mid ($args[1],1,1)
			$args[1] = mid ($args[1],2)
		else
			$args['1']=$args[1]
			$args[1]=''
		end
		$args['symbols']=$replace($args['symbols'],$args['1'])
		args['i']-=1
		if len($args[1])>0: jump 'for'
	end
end
if $args[2]<>'': $args['symbols']+=$args[2]
:while
if args[0]>0:
	$result['rndstr']+=(mid($args['symbols'],rand(1,len($args['symbols'])),1))
	args[0]-=1
	if args[0]>0: jump 'while'
end
--- #rndstr# ---------------------------------

# #rounddiv#
$args[9] = $args[9]
if args[1]!0: $args[1] = str(args[1])
if $args[1]='': $args[1]='1'
$result=$args[0]
if instr($args[0],'.')=0: exit
if instr($args[1],'.')!0:
	if (func('#razdiv#',$args[0])=<func('#razdiv#',$args[1])): exit
	args['res'] = func('#even#',val($replace($args[0],'.')),func('#razdiv#',$args[0])/func('#razdiv#',$args[1]),$args[2])
	$result = $func('#indiv#',args['res'],func('#razdiv#',$args[0]))
	exit
else
	args['res'] = func('#even#',val($replace($args[0],'.')),func('#razdiv#',$args[0])*func('#raz#',val($args[1])),$args[2])
	$result = $func('#indiv#',args['res'],func('#razdiv#',$args[0]))
	exit
end
--- #rounddiv# ---------------------------------

# #rtp#
$args[0] = $args[0]
$args[1] = $args[1]
if instr($args[0],'$')=1: $args[9]='$'
dynamic "<<$args[9]>>args[0] = <<$args[0]>>
<<$args[0]>> = <<$args[1]>>
<<$args[1]>> = <<$args[9]>>args[0]"
--- #rtp# ---------------------------------

# #sim#
$args[9]=$args[9]
$args[0]=$func('#dz#',$args[0],'1')
$args[1]=$func('#dz#',$args[1],'1')
if instr($args[0],'.')=0: $args[0]+='.0'
if instr($args[1],'.')=0: $args[1]+='.0'
if $args[0]=$args[1]: $result=$func('#dz#',$args[0]) & exit
args['0']=val(mid($args[0],1,instr($args[0],'.')-1))
args['1']=val(mid($args[1],1,instr($args[1],'.')-1))
if args['0']>args['1']:
	$result=$func('#dz#',$args[0])
	exit
elseif args['0']<args['1']:
	$result=$func('#dz#',$args[1])
	exit
end
$args['00']=mid($args[0],instr($args[0],'.')+1)
if instr($args[0],'-'): $args['00']='-'+$args['00']
if instr($args[0],'-'): $args['00']='-'+$args['00']
$args['11']=mid($args[1],instr($args[1],'.')+1)
args['max']=max(func('#razdiv#',$args['00']),func('#razdiv#',$args['11']))
if func('#undiv#',$args['00'],args['max'])>func('#undiv#',$args['11'],args['max']):
	$result=$args[0]
else
	$result=$args[1]
end
$result=$func('#dz#',$result)
--- #sim# ---------------------------------

# #sqrt#
$args[9] = $args[9]
if args[1] = 0: args[1] = 100
if $args[2]='': $args[2]='1'
:still
$args['res']=$func('#:#',$func('#+#',$args[2],$func('#:#',$args[0],$args[2],args[1])),'2',args[1])
$args['quad'] = $func('#*#',$args['res'],$args['res'])
if $args['res']!$args[2]:
	$args[2]=$args['res']
	jump 'still'
else
	$result=$args['res']
	exit
end
--- #sqrt# ---------------------------------

# #str.inArray#
$args[9]=$args[9]
$args[3] = UCASE($args[3])
if $args[2] = '':
$args[2]='
'
end
if $strfind($args[3],'REGULAR')='': $args[0] = $args[0]+$args[2] else $args[0]=$args[0]
if $args[1]='':
	exit
elseif instr($args[1],'$')<>1:
	$args[1]='$'+$args[1]
end
killvar $args[1]
killvar '$easy_math_copy_array'
:for
if len($args[0])>0:
	if $strfind($args[3],'REGULAR')='':
		args['div']=instr($args[0],$args[2])
		$args['div.']=$args[2]
	else
		args['div']=strpos($args[0],$args[2])
		$args['div.']=$strfind($args[0],$args[2])
	end
	if args['div']>0:
		$args['vs']=$mid($args[0],1,args['div']-1)
		$args[0]=$mid($args[0],args['div']+len($args['div.']))
	else
		$args['vs']=$args[0]
		$args[0]=''
	end
	if ($args['vs']<>'' and $strfind($args[3],'NOTSPACE')<>'') or $strfind($args[3],'NOTSPACE')='':
		if $strfind($args[3],'LEFT')='LEFT' and $strfind($args[3],'REGULAR')<>'REGULAR': $args['l']=$args[2]
		if $strfind($args[3],'RIGHT')='RIGHT' and $strfind($args[3],'REGULAR')<>'REGULAR': $args['r']=$args[2]
		if $strfind($args[3],'LCASE')='LCASE': $args['vs']=LCASE($args['vs'])
		if $strfind($args[3],'UCASE')='UCASE': $args['vs']=UCASE($args['vs'])
		$easy_math_copy_array[]=$args['l']+$args['vs']+$args['r']
	end
	jump 'for'
end
if $strfind($args[3],'TRIM')<>'':
	if $easy_math_copy_array[0]='' or $easy_math_copy_array[0]=$args[2] or $easy_math_copy_array[0]=$args[2]+$args[2]:
		killvar '$easy_math_copy_array',0
	end
	if $easy_math_copy_array[]='' or $easy_math_copy_array[]=$args[2] or $easy_math_copy_array[]=$args[2]+$args[2]:
		killvar '$easy_math_copy_array',arrsize('$easy_math_copy_array')-1
	end
end
copyarr $args[1],'$easy_math_copy_array'
killvar '$easy_math_copy_array'
--- #str.inArray# ---------------------------------

# #str.thin#
$args[9] = $args[9]
if args[1] < 1: args[1]=1
if $args[2] = '': $args[2]=' '
$args[3]=$UCASE($args[3])
if instr($args[3],'[UP]')<>0:
	:for_up
	if len($args[0])>0:
		$args['t']=$mid($args[0],len($args[0])-2) 
		$args[0]=$mid($args[0],1,len($args[0])-3)
		if instr($args[3],'[LEFT]')<>0 or len($args[0])>0:
			$args['res']=$args[2]+$args['t']+$args['res']
		else
			$args['res']=$args['t']+$args['res']
		end
		jump 'for_up'
	end
	if instr($args[3],'[RIGHT]')<>0: $args['res']+=$args[2]
else
	:for_down
	if len($args[0])>0:
		$args['t']=$mid($args[0],1,args[1])
		$args[0]=$mid($args[0],args[1]+1)
		if instr($args[3],'[RIGHT]')<>0 or len($args[0])>0:
			$args['res']+=$args['t']+$args[2]
		else
			$args['res']+=$args['t']
		end
		jump 'for_down'
	end
	if instr($args[3],'[LEFT]')<>0: $args['res']=$args[2]+$args['res']
end
$result = $args['res']
--- #str.thin# ---------------------------------

# #sum#
$args[9]=$args[9]
if $args[0]='': exit
if $args[1]='':
	$args[1] = ' '
elseif $args[1]='/se':
	$args[1]=''
end
if instr($args[0],'$')=1:
	$args['$']='$'
end
:for
if args['i']<arrsize($args[0]):
	if $args['$']='$':
		$args['result'] += $dyneval ("$result=<<$args[0]>>[<<args['i']>>]")+$args[1]
	else
		args['result']	+=	dyneval ("result=<<$args[0]>>[<<args['i']>>]")
	end
	args['i'] += 1
	jump 'for'
end
if $args['$']='$':
	$result	= $args['result']
else
	result	= args['result']
end
--- #sum# ---------------------------------

# #undiv#
$args[9]=$args[9]
if isnum($args[0])=-1 and args[1]!0:
	result=val($args[0])*args[1]
	exit
elseif isnum($args[0])=-1 and args[1]=0:
	result=val($args[0])
end
$args[1] = mid(str(args[1]),2)
if $args[1]='': result=val($replace($args[0],'.')) & exit
$args['end']=mid($args[0],instr($args[0],'.')+1)
if len($args['end'])>=len($args[1]):
	result=val(mid($args[0],1,instr($args[0],'.')-1)+mid($args['end'],1,len($args[1])))
else
	result=val(mid($args[0],1,instr($args[0],'.')-1)+$args['end']+mid($args[1],1,len($args[1])-len($args['end'])))
end
--- #undiv# ---------------------------------

# #widetrim#
$args[9] = $args[9]
$args[1] = UCASE($args[1])
gosub '#str.inArray#',$args[0],'$easy_math_temp_massive','','trim'
:for1
if arrsize('$easy_math_temp_massive')>0 and ($easy_math_temp_massive[0]='' or strcomp($easy_math_temp_massive[0],'\s+'))=-1:
	killvar '$easy_math_temp_massive',0
	jump 'for1'
end
:for2
if arrsize('$easy_math_temp_massive')>0 and ($easy_math_temp_massive[]='' or strcomp($easy_math_temp_massive[],'\s+'))=-1:
	killvar '$easy_math_temp_massive',arrsize('$easy_math_temp_massive')-1
	jump 'for2'
end
if instr($args[1],'[TRIM]')<>0: $args['addcomm']='[TRIM]'
$args['res']=$func('#array.prnt#','$easy_math_temp_massive','[only result]'+$args['addcomm'])
$args['res']=$mid($args['res'],1,len($args['res'])-1)
killvar '$easy_math_temp_massive'
$result=$args['res']
--- #widetrim# ---------------------------------

# #zero#
args[0] = args[0]
if $args[1]='': $args[1]='0' else $args[1] = $args[1]
:for
if args[0]>0:
	$result+=$args[1]
	args[0]-=1
	jump 'for'
end
--- #zero# ---------------------------------

# #^#
args[9]=args[9]
result=1
:for
if args[1]>0: 
	result=result*args[0]
	args[1]-=1
	jump 'for'
end
--- #^# ---------------------------------

# #*#
$args[9]=$args[9]
i_easy_math_um = 0
:initial
if i_easy_math_um<9:
	if len($args[i_easy_math_um])=0:
		if args[i_easy_math_um]=0: $args[i_easy_math_um]='1' else $args[i_easy_math_um]=str(args[i_easy_math_um])
	else
		$args[i_easy_math_um] = $args[i_easy_math_um]
		if $args[i_easy_math_um]='0': $result='0' & exit
	end
	if instr($args[i_easy_math_um],',')!0: $args[i_easy_math_um]=$replace($args[i_easy_math_um],',','.')
	if instr($args[i_easy_math_um],'-')=1: $args[i_easy_math_um]=$replace($args[i_easy_math_um],'-')	&	args[11]=1-args[11]
	if instr($args[i_easy_math_um],'.')!0: args[10]+=len(mid($args[i_easy_math_um],instr($args[i_easy_math_um],'.')+1))
	$args[i_easy_math_um]=$replace($args[i_easy_math_um],'.')
	i_easy_math_um+=1
	jump 'initial'
end
$args[9]='1'
i_easy_math_um=9
:for
$args['summ']='0'
if i_easy_math_um>0:
	j_easy_math_um=len($args[i_easy_math_um-1])
	:следующий_разряд
	if j_easy_math_um>0:
		a_easy_math_um=len($args[i_easy_math_um])
		args['last']=0
		$args['result']=$func('#zero#',len($args[i_easy_math_um-1])-j_easy_math_um)
		:умножение
		if a_easy_math_um>0:
			args['is']=val(mid($args[i_easy_math_um],a_easy_math_um,1))*val(mid($args[i_easy_math_um-1],j_easy_math_um,1))
			args['is']+=args['last']
			args['last']=args['is']/10
			args['is']=args['is'] mod 10
			$args['result']=str(args['is'])+$args['result']
			a_easy_math_um-=1
			if a_easy_math_um=0: $args['result']=str(args['last'])+$args['result']
			jump 'умножение'
		end
		$args['summ']=$func('#+#',$args['summ'],$args['result'])
		j_easy_math_um-=1
		jump 'следующий_разряд'
	end
	i_easy_math_um-=1
	$args[i_easy_math_um]=$args['summ']
	jump 'for'
end
$result=$args[i_easy_math_um]
$result=$func('#dz#',mid($result,1,len($result)-args[10])+'.'+mid($result,len($result)-args[10]+1))
if args[11]=1: $result='-'+$result
killvar 'i_easy_math_um'
killvar 'j_easy_math_um'
killvar 'a_easy_math_um'
--- #*# ---------------------------------

# #:#
$args[9]=$args[9]
$args[0]=$func('#dz#',$args[0],1)
$args[1]=$func('#dz#',$args[1],1)
args[2] = args[2]
args['max']=max(func('#razdiv#',$args[0]),func('#razdiv#',$args[1]))
args[0] = func('#undiv#',$args[0],args['max'])
args[1] = func('#undiv#',$args[1],args['max'])
$result=$func('#indiv#',args[0],args[1],args[2])
--- #:# ---------------------------------

# get.tag.cont
if $args[1]='<!--!>' and $strfind($args[0],'<!--([\s\S]+?)-->')!'':
	$result = $strfind($args[0],'<!--([\s\S]+?)-->',1)
elseif $strfind($args[0],'\['+$args[1]+':([\s\S]+?):'+$args[1]+'\]')!'':
	$result = $strfind($args[0],'\['+$args[1]+':([\s\S]+?):'+$args[1]+'\]',1)
elseif $strfind($args[0],'\('+$args[1]+':([\s\S]+?):'+$args[1]+'\)')!'':
	$result = $strfind($args[0],'\('+$args[1]+':([\s\S]+?):'+$args[1]+'\)',1)
elseif $strfind($args[0],'\['+$args[1]+'\]([\s\S]+?)\[\/'+$args[1]+'\]')!'':
	$result = $strfind($args[0],'\['+$args[1]+'\]([\s\S]+?)\[\/'+$args[1]+'\]?',1)
elseif $strfind($args[0],'<'+$args[1]+':([\s\S]+?):'+$args[1]+'>')!'':
	$result = $strfind($args[0],'<'+$args[1]+':([\s\S]+?):'+$args[1]+'>',1)
elseif $strfind($args[0],'<'+$args[1]+'>([\s\S]+?)<\/'+$args[1]+'>')!'':
	$result = $strfind($args[0],'<'+$args[1]+'>([\s\S]+?)<\/'+$args[1]+'>',1)
elseif $strfind($args[0],$args[1]+':([\s\S]+?):'+$args[1])!'':
	$result = $strfind($args[0],$args[1]+':([\s\S]+?):'+$args[1],1)
end
--- get.tag.cont ---------------------------------

# get.tag.num
$args[9]=$args[9]
if $mid($args[1],len($args[1])-1)='\h': $args[1] = $replace($args[1],'\h') & $args['hex']='hex'
if $strfind($args[0],'(\[|<|\{|\()'+$args[1]+':'+'([0-9A-Fa-f\-]*?)'+'(\]|>|\}|\))')!'':
	$args['result.num'] = $strfind($args[0],'(\[|<|\{|\()'+$args[1]+':'+'([0-9A-Fa-f\-]*?)'+'(\]|>|\}|\))',2)
	jump 'results'
elseif $strfind($args[0],'\['+$args[1]+':'+'([^][]*?)'+'\]')!'':
	$args['result.num'] = $strfind($args[0],'\['+$args[1]+':'+'([^][]+?)'+'\]',1)
	jump 'results'
elseif $strfind($args[0],'<'+$args[1]+':'+'([^><]*?)'+'>')!'':
	$args['result.num'] = $strfind($args[0],'<'+$args[1]+':'+'([^><]+?)'+'>',1)
	jump 'results'
elseif $strfind($args[0],'\{'+$args[1]+':'+'([^}{]*?)'+'\}')!'':
	$args['result.num'] = $strfind($args[0],'\{'+$args[1]+':'+'([^}{]+?)'+'\}',1)
	jump 'results'
elseif $strfind($args[0],'\('+$args[1]+':'+'([^)(]*?)'+'\)')!'':
	$args['result.num'] = $strfind($args[0],'\('+$args[1]+':'+'([^)(]+?)'+'\)',1)
	jump 'results'
elseif $strfind($args[0],$args[1]+'=("|'+"')([\s\S]*?)\1")!'':
	$args['result.num'] = $strfind($args[0],$args[1]+'=("|'+"')([\s\S]*?)\1",2)
	jump 'results'
elseif $strfind($args[0],$args[1]+'(:|=#)[\S]+')!'':
	$args['result.num'] = $strfind($args[0],$args[1]+'(:|=#)([\S]+)',2)
	:results
	if $args['hex']='hex' and $strfind($args['result.num'],'^([0-9A-Fa-f\-]+)([\S]*)$')='':
		exit
	elseif $args['hex']='hex':
		$args['result.num'] = $strfind($args['result.num'],'^([0-9A-Fa-f\-]+)([\S]*)$',1)
	end
	if isnum($args['result.num'])=-1:
		result=val($args['result.num'])
	else
		$result=$args['result.num']
	end
end
--- get.tag.num ---------------------------------

# get.word.inPos
if $args[2] = '': $args[2]='|'
$args[0] = $args[0]+$args[2]
args[1] = args[1]
:for
if len($args[0])>0 and args[1]>0:
	if instr($args[0],$args[2])>0:
		$args['cs'] = $mid ($args[0],1,instr($args[0],$args[2]))
		$args[0] = $mid($args[0],instr($args[0],$args[2])+1)
	else
		$args['cs']=$args[0]
		$args[0]=''
	end
	! *pl str(args[1])+'^'+$args['1']
	args[1]-=1
	if args[1]>0: jump 'for'
end
$result=$replace($args['cs'],$args[2])
--- get.word.inPos ---------------------------------

# kill.var.olegus
$args[0]=$args[0]
if instr($args[0],'$')<>1: $args[0]='$'+$args[0]
$args[9]=$args[9]
args['i']=1
:for
if $args[args['i']]<>'':
	$args['rnd']=$func('#rndstr#',32)
	dynamic "<<$args[0]>>['<<$args[args['i']]>>']=$args[0]",$args['rnd']
	killvar $args[0],arrpos($args[0],$args['rnd'])
	args['i']+=1
	jump 'for'
end
--- kill.var.olegus ---------------------------------

